[0m02:17:25.204240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71b083241550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71b083411ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71b0835c3790>]}


============================== 02:17:25.225342 | 82d54a8c-b597-458a-ac52-b5227ddd57c2 ==============================
[0m02:17:25.225342 [info ] [MainThread]: Running with dbt=1.10.6
[0m02:17:25.230250 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --select acris_cases', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:17:25.247539 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'legal_demo'
[0m02:17:25.250795 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.177186, "process_in_blocks": "56", "process_kernel_time": 0.642111, "process_mem_max_rss": "106916", "process_out_blocks": "0", "process_user_time": 2.408915}
[0m02:17:25.252923 [debug] [MainThread]: Command `dbt run` failed at 02:17:25.252729 after 0.18 seconds
[0m02:17:25.254635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71b083241a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71b083412210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71b083218d10>]}
[0m02:17:25.259237 [debug] [MainThread]: Flushing usage events
[0m02:17:25.645495 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:19:00.042710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c3ec5ffa310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c3ec5ffa410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c3ec5ff9a10>]}


============================== 02:19:00.054912 | 099abce6-30d9-4184-b030-c7c08cc91970 ==============================
[0m02:19:00.054912 [info ] [MainThread]: Running with dbt=1.10.6
[0m02:19:00.057472 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '.', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir . --select acris_cases', 'send_anonymous_usage_stats': 'True'}
[0m02:19:00.073425 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'legal_demo'
[0m02:19:00.076538 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.14420138, "process_in_blocks": "0", "process_kernel_time": 0.621356, "process_mem_max_rss": "107160", "process_out_blocks": "0", "process_user_time": 2.501358}
[0m02:19:00.078728 [debug] [MainThread]: Command `dbt run` failed at 02:19:00.078524 after 0.15 seconds
[0m02:19:00.080267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c3ec5ffa110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c3ec5e642d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c3ec5e65010>]}
[0m02:19:00.081961 [debug] [MainThread]: Flushing usage events
[0m02:19:00.380393 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:25:07.145871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac023abdc90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac023a72290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac023a73f90>]}


============================== 02:25:07.156597 | ca05c3d5-f8a3-4c5e-bb43-ecab851d7ebc ==============================
[0m02:25:07.156597 [info ] [MainThread]: Running with dbt=1.10.6
[0m02:25:07.158727 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '.', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir . --select acris_cases', 'send_anonymous_usage_stats': 'True'}
[0m02:25:07.594381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ca05c3d5-f8a3-4c5e-bb43-ecab851d7ebc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac023ac8490>]}
[0m02:25:07.670514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ca05c3d5-f8a3-4c5e-bb43-ecab851d7ebc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac02669e010>]}
[0m02:25:07.674007 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m02:25:07.834923 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m02:25:07.840939 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m02:25:07.842564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ca05c3d5-f8a3-4c5e-bb43-ecab851d7ebc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac023ae1550>]}
[0m02:25:09.058073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ca05c3d5-f8a3-4c5e-bb43-ecab851d7ebc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac023a94810>]}
[0m02:25:09.142902 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m02:25:09.200345 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m02:25:09.285407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ca05c3d5-f8a3-4c5e-bb43-ecab851d7ebc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac01dd54a90>]}
[0m02:25:09.286974 [info ] [MainThread]: Found 1 model, 429 macros
[0m02:25:09.288788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ca05c3d5-f8a3-4c5e-bb43-ecab851d7ebc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac01f703a50>]}
[0m02:25:09.292840 [info ] [MainThread]: 
[0m02:25:09.295539 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:25:09.297697 [info ] [MainThread]: 
[0m02:25:09.300968 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m02:25:09.303929 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_legal_demo'
[0m02:25:09.370409 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo"
[0m02:25:09.372700 [debug] [ThreadPool]: On list_legal_demo: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"legal_demo"'
    
  
  
[0m02:25:09.374248 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:25:09.412405 [debug] [ThreadPool]: SQL status: OK in 0.038 seconds
[0m02:25:09.415981 [debug] [ThreadPool]: On list_legal_demo: Close
[0m02:25:09.418369 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_legal_demo, now create_legal_demo_main)
[0m02:25:09.420310 [debug] [ThreadPool]: Creating schema "database: "legal_demo"
schema: "main"
"
[0m02:25:09.429433 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m02:25:09.431373 [debug] [ThreadPool]: On create_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "create_legal_demo_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='legal_demo'
        and type='sqlite'
    
  
[0m02:25:09.433024 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:25:09.436279 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m02:25:09.438612 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m02:25:09.440186 [debug] [ThreadPool]: On create_legal_demo_main: BEGIN
[0m02:25:09.442103 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:25:09.443363 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m02:25:09.444721 [debug] [ThreadPool]: On create_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "create_legal_demo_main"} */

    
    
        create schema if not exists "legal_demo"."main"
    
[0m02:25:09.447082 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:25:09.449413 [debug] [ThreadPool]: On create_legal_demo_main: COMMIT
[0m02:25:09.451171 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m02:25:09.452681 [debug] [ThreadPool]: On create_legal_demo_main: COMMIT
[0m02:25:09.455326 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:25:09.456868 [debug] [ThreadPool]: On create_legal_demo_main: Close
[0m02:25:09.459528 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_legal_demo_main, now list_legal_demo_main)
[0m02:25:09.467100 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo_main"
[0m02:25:09.468803 [debug] [ThreadPool]: On list_legal_demo_main: BEGIN
[0m02:25:09.470315 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:25:09.473734 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m02:25:09.475009 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo_main"
[0m02:25:09.476379 [debug] [ThreadPool]: On list_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo_main"} */
select
      'legal_demo' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'legal_demo'
  
[0m02:25:09.490755 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m02:25:09.493643 [debug] [ThreadPool]: On list_legal_demo_main: ROLLBACK
[0m02:25:09.496138 [debug] [ThreadPool]: Failed to rollback 'list_legal_demo_main'
[0m02:25:09.497751 [debug] [ThreadPool]: On list_legal_demo_main: Close
[0m02:25:09.499994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ca05c3d5-f8a3-4c5e-bb43-ecab851d7ebc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac01f896b90>]}
[0m02:25:09.501680 [debug] [MainThread]: Using duckdb connection "master"
[0m02:25:09.503161 [debug] [MainThread]: On master: BEGIN
[0m02:25:09.504513 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:25:09.506387 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m02:25:09.507736 [debug] [MainThread]: On master: COMMIT
[0m02:25:09.509020 [debug] [MainThread]: Using duckdb connection "master"
[0m02:25:09.510261 [debug] [MainThread]: On master: COMMIT
[0m02:25:09.511923 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m02:25:09.514377 [debug] [MainThread]: On master: Close
[0m02:25:09.570850 [debug] [Thread-1 (]: Began running node model.legal_demo.acris_cases
[0m02:25:09.572789 [info ] [Thread-1 (]: 1 of 1 START sql table model main.acris_clean .................................. [RUN]
[0m02:25:09.574955 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_legal_demo_main, now model.legal_demo.acris_cases)
[0m02:25:09.577482 [debug] [Thread-1 (]: Began compiling node model.legal_demo.acris_cases
[0m02:25:09.592313 [debug] [Thread-1 (]: Writing injected SQL for node "model.legal_demo.acris_cases"
[0m02:25:09.616071 [debug] [Thread-1 (]: Began executing node model.legal_demo.acris_cases
[0m02:25:09.660665 [debug] [Thread-1 (]: Writing runtime sql for node "model.legal_demo.acris_cases"
[0m02:25:09.731794 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m02:25:09.733487 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: BEGIN
[0m02:25:09.735162 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:25:09.737645 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m02:25:09.739163 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m02:25:09.740551 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */

  
    
    

    create  table
      "legal_demo"."main"."acris_clean__dbt_tmp"
  
    as (
      --
-- This model loads the already‑downloaded CSV into DuckDB and
-- materializes it as a table named `acris_clean`.  Because the
-- pipeline does not download data, the file must exist under
-- `data/first_500k_acris.csv` prior to running `dbt run`.  The
-- absolute path points at `/opt/airflow/data/first_500k_acris.csv` when
-- executed inside the Airflow containers.  Locally, dbt resolves
-- relative paths against the project root, so this model continues to
-- work outside of Docker.



SELECT *
FROM read_csv_auto('/opt/airflow/data/first_500k_acris.csv', header=True, delim=',');
    );
  
  
[0m02:25:09.742601 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */

  
    
    

    create  table
      "legal_demo"."main"."acris_clean__dbt_tmp"
  
    as (
      --
-- This model loads the already‑downloaded CSV into DuckDB and
-- materializes it as a table named `acris_clean`.  Because the
-- pipeline does not download data, the file must exist under
-- `data/first_500k_acris.csv` prior to running `dbt run`.  The
-- absolute path points at `/opt/airflow/data/first_500k_acris.csv` when
-- executed inside the Airflow containers.  Locally, dbt resolves
-- relative paths against the project root, so this model continues to
-- work outside of Docker.



SELECT *
FROM read_csv_auto('/opt/airflow/data/first_500k_acris.csv', header=True, delim=',');
    );
  
  
[0m02:25:09.744203 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m02:25:09.745843 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: ROLLBACK
[0m02:25:09.752474 [debug] [Thread-1 (]: Failed to rollback 'model.legal_demo.acris_cases'
[0m02:25:09.754324 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: Close
[0m02:25:09.758267 [debug] [Thread-1 (]: Runtime Error in model acris_cases (models/acris_cases.sql)
  Parser Error: syntax error at or near ";"
[0m02:25:09.761556 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca05c3d5-f8a3-4c5e-bb43-ecab851d7ebc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac01d213610>]}
[0m02:25:09.763911 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model main.acris_clean ......................... [[31mERROR[0m in 0.19s]
[0m02:25:09.769307 [debug] [Thread-1 (]: Finished running node model.legal_demo.acris_cases
[0m02:25:09.771107 [debug] [Thread-4 (]: Marking all children of 'model.legal_demo.acris_cases' to be skipped because of status 'error'.  Reason: Runtime Error in model acris_cases (models/acris_cases.sql)
  Parser Error: syntax error at or near ";".
[0m02:25:09.775416 [debug] [MainThread]: Using duckdb connection "master"
[0m02:25:09.776939 [debug] [MainThread]: On master: BEGIN
[0m02:25:09.778348 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:25:09.780584 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m02:25:09.783185 [debug] [MainThread]: On master: COMMIT
[0m02:25:09.784618 [debug] [MainThread]: Using duckdb connection "master"
[0m02:25:09.785875 [debug] [MainThread]: On master: COMMIT
[0m02:25:09.787770 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m02:25:09.789051 [debug] [MainThread]: On master: Close
[0m02:25:09.790548 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:25:09.791924 [debug] [MainThread]: Connection 'model.legal_demo.acris_cases' was properly closed.
[0m02:25:09.793242 [info ] [MainThread]: 
[0m02:25:09.795044 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.49 seconds (0.49s).
[0m02:25:09.798173 [debug] [MainThread]: Command end result
[0m02:25:09.845799 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m02:25:09.855244 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m02:25:09.869509 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m02:25:09.871068 [info ] [MainThread]: 
[0m02:25:09.872754 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m02:25:09.874875 [info ] [MainThread]: 
[0m02:25:09.877005 [error] [MainThread]: [31mFailure in model acris_cases (models/acris_cases.sql)[0m
[0m02:25:09.878894 [error] [MainThread]:   Runtime Error in model acris_cases (models/acris_cases.sql)
  Parser Error: syntax error at or near ";"
[0m02:25:09.880598 [info ] [MainThread]: 
[0m02:25:09.882313 [info ] [MainThread]:   compiled code at target/compiled/legal_demo/models/acris_cases.sql
[0m02:25:09.884357 [info ] [MainThread]: 
[0m02:25:09.886104 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m02:25:09.888645 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.8589, "process_in_blocks": "3256", "process_kernel_time": 0.882548, "process_mem_max_rss": "158012", "process_out_blocks": "472", "process_user_time": 4.247517}
[0m02:25:09.890300 [debug] [MainThread]: Command `dbt run` failed at 02:25:09.890152 after 2.86 seconds
[0m02:25:09.892090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac023abdc90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac02821c790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac0268bd490>]}
[0m02:25:09.893514 [debug] [MainThread]: Flushing usage events
[0m02:25:10.171013 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:27:19.904636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x734f41a95950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x734f41defa50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x734f41a96810>]}


============================== 02:27:19.915943 | 5c29070e-962c-473b-9459-b7edf4184569 ==============================
[0m02:27:19.915943 [info ] [MainThread]: Running with dbt=1.10.6
[0m02:27:19.918009 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '.', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir . --select acris_cases', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m02:27:20.203366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5c29070e-962c-473b-9459-b7edf4184569', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x734f41aed6d0>]}
[0m02:27:20.278737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5c29070e-962c-473b-9459-b7edf4184569', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x734f446b76d0>]}
[0m02:27:20.283225 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m02:27:20.458383 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m02:27:20.651092 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:27:20.653575 [debug] [MainThread]: Partial parsing: updated file: legal_demo://models/acris_cases.sql
[0m02:27:20.955160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5c29070e-962c-473b-9459-b7edf4184569', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x734f3dab9210>]}
[0m02:27:21.068284 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m02:27:21.126313 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m02:27:21.244857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5c29070e-962c-473b-9459-b7edf4184569', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x734f41baa390>]}
[0m02:27:21.246545 [info ] [MainThread]: Found 1 model, 429 macros
[0m02:27:21.248801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5c29070e-962c-473b-9459-b7edf4184569', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x734f41bbf590>]}
[0m02:27:21.253033 [info ] [MainThread]: 
[0m02:27:21.254986 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:27:21.256619 [info ] [MainThread]: 
[0m02:27:21.258497 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m02:27:21.260951 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_legal_demo'
[0m02:27:21.319751 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo"
[0m02:27:21.322273 [debug] [ThreadPool]: On list_legal_demo: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"legal_demo"'
    
  
  
[0m02:27:21.324009 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:27:21.361689 [debug] [ThreadPool]: SQL status: OK in 0.038 seconds
[0m02:27:21.365766 [debug] [ThreadPool]: On list_legal_demo: Close
[0m02:27:21.368375 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_legal_demo, now create_legal_demo_main)
[0m02:27:21.370470 [debug] [ThreadPool]: Creating schema "database: "legal_demo"
schema: "main"
"
[0m02:27:21.380087 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m02:27:21.382437 [debug] [ThreadPool]: On create_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "create_legal_demo_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='legal_demo'
        and type='sqlite'
    
  
[0m02:27:21.384089 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:27:21.388285 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m02:27:21.392062 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m02:27:21.393620 [debug] [ThreadPool]: On create_legal_demo_main: BEGIN
[0m02:27:21.396473 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:27:21.398456 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m02:27:21.399796 [debug] [ThreadPool]: On create_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "create_legal_demo_main"} */

    
    
        create schema if not exists "legal_demo"."main"
    
[0m02:27:21.401789 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:27:21.403881 [debug] [ThreadPool]: On create_legal_demo_main: COMMIT
[0m02:27:21.405213 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m02:27:21.406554 [debug] [ThreadPool]: On create_legal_demo_main: COMMIT
[0m02:27:21.408308 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:27:21.409610 [debug] [ThreadPool]: On create_legal_demo_main: Close
[0m02:27:21.412448 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_legal_demo_main, now list_legal_demo_main)
[0m02:27:21.420118 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo_main"
[0m02:27:21.421810 [debug] [ThreadPool]: On list_legal_demo_main: BEGIN
[0m02:27:21.423192 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:27:21.425067 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m02:27:21.426227 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo_main"
[0m02:27:21.427342 [debug] [ThreadPool]: On list_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo_main"} */
select
      'legal_demo' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'legal_demo'
  
[0m02:27:21.440817 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m02:27:21.443662 [debug] [ThreadPool]: On list_legal_demo_main: ROLLBACK
[0m02:27:21.445652 [debug] [ThreadPool]: Failed to rollback 'list_legal_demo_main'
[0m02:27:21.447110 [debug] [ThreadPool]: On list_legal_demo_main: Close
[0m02:27:21.450784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5c29070e-962c-473b-9459-b7edf4184569', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x734f3d63aa50>]}
[0m02:27:21.452404 [debug] [MainThread]: Using duckdb connection "master"
[0m02:27:21.453699 [debug] [MainThread]: On master: BEGIN
[0m02:27:21.455065 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:27:21.457312 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m02:27:21.458658 [debug] [MainThread]: On master: COMMIT
[0m02:27:21.459902 [debug] [MainThread]: Using duckdb connection "master"
[0m02:27:21.461185 [debug] [MainThread]: On master: COMMIT
[0m02:27:21.463320 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m02:27:21.464860 [debug] [MainThread]: On master: Close
[0m02:27:21.472861 [debug] [Thread-1 (]: Began running node model.legal_demo.acris_cases
[0m02:27:21.475158 [info ] [Thread-1 (]: 1 of 1 START sql table model main.acris_clean .................................. [RUN]
[0m02:27:21.477323 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_legal_demo_main, now model.legal_demo.acris_cases)
[0m02:27:21.479315 [debug] [Thread-1 (]: Began compiling node model.legal_demo.acris_cases
[0m02:27:21.490340 [debug] [Thread-1 (]: Writing injected SQL for node "model.legal_demo.acris_cases"
[0m02:27:21.503869 [debug] [Thread-1 (]: Began executing node model.legal_demo.acris_cases
[0m02:27:21.549359 [debug] [Thread-1 (]: Writing runtime sql for node "model.legal_demo.acris_cases"
[0m02:27:21.563054 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m02:27:21.564791 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: BEGIN
[0m02:27:21.566389 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:27:21.568771 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m02:27:21.570264 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m02:27:21.571613 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */

  
    
    

    create  table
      "legal_demo"."main"."acris_clean__dbt_tmp"
  
    as (
      --
-- This model loads the already‑downloaded CSV into DuckDB and
-- materializes it as a table named `acris_clean`.  Because the
-- pipeline does not download data, the file must exist under
-- `data/first_500k_acris.csv` prior to running `dbt run`.  The
-- absolute path points at `/opt/airflow/data/first_500k_acris.csv` when
-- executed inside the Airflow containers.  Locally, dbt resolves
-- relative paths against the project root, so this model continues to
-- work outside of Docker.



SELECT *
FROM read_csv_auto('/opt/airflow/data/first_500k_acris.csv', header=True, delim=',')
    );
  
  
[0m02:27:24.024129 [debug] [Thread-1 (]: SQL status: OK in 2.451 seconds
[0m02:27:24.034813 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m02:27:24.037076 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
alter table "legal_demo"."main"."acris_clean__dbt_tmp" rename to "acris_clean"
[0m02:27:24.039656 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:27:24.056355 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: COMMIT
[0m02:27:24.058559 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m02:27:24.060326 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: COMMIT
[0m02:27:24.120899 [debug] [Thread-1 (]: SQL status: OK in 0.059 seconds
[0m02:27:24.128886 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m02:27:24.131120 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */

      drop table if exists "legal_demo"."main"."acris_clean__dbt_backup" cascade
    
[0m02:27:24.133611 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:27:24.137509 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: Close
[0m02:27:24.172001 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c29070e-962c-473b-9459-b7edf4184569', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x734f41a962d0>]}
[0m02:27:24.174809 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main.acris_clean ............................. [[32mOK[0m in 2.69s]
[0m02:27:24.176902 [debug] [Thread-1 (]: Finished running node model.legal_demo.acris_cases
[0m02:27:24.180482 [debug] [MainThread]: Using duckdb connection "master"
[0m02:27:24.182065 [debug] [MainThread]: On master: BEGIN
[0m02:27:24.183640 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:27:24.185944 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m02:27:24.187282 [debug] [MainThread]: On master: COMMIT
[0m02:27:24.188666 [debug] [MainThread]: Using duckdb connection "master"
[0m02:27:24.190050 [debug] [MainThread]: On master: COMMIT
[0m02:27:24.191994 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m02:27:24.193679 [debug] [MainThread]: On master: Close
[0m02:27:24.195305 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:27:24.196681 [debug] [MainThread]: Connection 'model.legal_demo.acris_cases' was properly closed.
[0m02:27:24.198546 [info ] [MainThread]: 
[0m02:27:24.200365 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.94 seconds (2.94s).
[0m02:27:24.202725 [debug] [MainThread]: Command end result
[0m02:27:24.245109 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m02:27:24.254098 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m02:27:24.268674 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m02:27:24.270193 [info ] [MainThread]: 
[0m02:27:24.272317 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:27:24.274203 [info ] [MainThread]: 
[0m02:27:24.276000 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m02:27:24.278827 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.468714, "process_in_blocks": "48", "process_kernel_time": 1.475115, "process_mem_max_rss": "301332", "process_out_blocks": "0", "process_user_time": 7.347289}
[0m02:27:24.280547 [debug] [MainThread]: Command `dbt run` succeeded at 02:27:24.280399 after 4.47 seconds
[0m02:27:24.282346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x734f462385d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x734f46222790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x734f46222610>]}
[0m02:27:24.284181 [debug] [MainThread]: Flushing usage events
[0m02:27:24.523702 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:24:38.092403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bdff7e67e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bdffa1b7290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bdff7a6c650>]}


============================== 22:24:38.147469 | 9dec2846-15c4-4801-b552-521f6d386944 ==============================
[0m22:24:38.147469 [info ] [MainThread]: Running with dbt=1.7.4
[0m22:24:38.150198 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '.', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir .', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:24:38.653446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9dec2846-15c4-4801-b552-521f6d386944', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bdff7a5e710>]}
[0m22:24:38.759353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9dec2846-15c4-4801-b552-521f6d386944', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bdff77bf890>]}
[0m22:24:38.762322 [info ] [MainThread]: Registered adapter: duckdb=1.7.4
[0m22:24:38.775772 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m22:24:38.849184 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m22:24:38.851848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9dec2846-15c4-4801-b552-521f6d386944', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bdfee485050>]}
[0m22:24:39.883415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9dec2846-15c4-4801-b552-521f6d386944', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bdfee5e7ed0>]}
[0m22:24:40.041243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9dec2846-15c4-4801-b552-521f6d386944', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bdfee34abd0>]}
[0m22:24:40.043304 [info ] [MainThread]: Found 1 model, 0 sources, 0 exposures, 0 metrics, 394 macros, 0 groups, 0 semantic models
[0m22:24:40.045250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9dec2846-15c4-4801-b552-521f6d386944', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bdfee481a50>]}
[0m22:24:40.048720 [info ] [MainThread]: 
[0m22:24:40.051242 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:24:40.054336 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_legal_demo'
[0m22:24:40.069517 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo"
[0m22:24:40.071485 [debug] [ThreadPool]: On list_legal_demo: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"legal_demo"'
    
  
  
[0m22:24:40.072972 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:24:40.119150 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:24:40.122033 [debug] [MainThread]: Connection 'list_legal_demo' was properly closed.
[0m22:24:40.124278 [info ] [MainThread]: 
[0m22:24:40.127621 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.07 seconds (0.07s).
[0m22:24:40.129507 [error] [MainThread]: Encountered an error:
Runtime Error
  Serialization Error: Failed to deserialize: expected end of object, but found field id: 100
[0m22:24:40.132071 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.2725427, "process_user_time": 5.211611, "process_kernel_time": 0.932223, "process_mem_max_rss": "238796", "process_in_blocks": "13336", "process_out_blocks": "8384", "command_success": false}
[0m22:24:40.133925 [debug] [MainThread]: Command `dbt run` failed at 22:24:40.133693 after 2.27 seconds
[0m22:24:40.135411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bdff7a5e6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bdff76e7b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bdfee3baed0>]}
[0m22:24:40.136834 [debug] [MainThread]: Flushing usage events
[0m23:08:18.853270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x701fce4918d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x701fce93fb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x701fce97fe10>]}


============================== 23:08:18.862168 | 64385e00-f6ca-441d-8348-fa3169204e04 ==============================
[0m23:08:18.862168 [info ] [MainThread]: Running with dbt=1.7.4
[0m23:08:18.864283 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir .', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:08:19.319844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '64385e00-f6ca-441d-8348-fa3169204e04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x701fce202890>]}
[0m23:08:19.422674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '64385e00-f6ca-441d-8348-fa3169204e04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x701fcf12e050>]}
[0m23:08:19.425822 [info ] [MainThread]: Registered adapter: duckdb=1.7.4
[0m23:08:19.449366 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m23:08:19.544849 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:08:19.546937 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:08:19.554472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '64385e00-f6ca-441d-8348-fa3169204e04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x701fc516b150>]}
[0m23:08:19.600380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '64385e00-f6ca-441d-8348-fa3169204e04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x701fc50087d0>]}
[0m23:08:19.602181 [info ] [MainThread]: Found 1 model, 0 sources, 0 exposures, 0 metrics, 394 macros, 0 groups, 0 semantic models
[0m23:08:19.603884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '64385e00-f6ca-441d-8348-fa3169204e04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x701fc4f4a450>]}
[0m23:08:19.607550 [info ] [MainThread]: 
[0m23:08:19.610145 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m23:08:19.613605 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_legal_demo'
[0m23:08:19.628615 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo"
[0m23:08:19.630822 [debug] [ThreadPool]: On list_legal_demo: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"legal_demo"'
    
  
  
[0m23:08:19.632550 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:08:19.664009 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:08:19.665882 [debug] [MainThread]: Connection 'list_legal_demo' was properly closed.
[0m23:08:19.668103 [info ] [MainThread]: 
[0m23:08:19.670177 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.06 seconds (0.06s).
[0m23:08:19.672299 [error] [MainThread]: Encountered an error:
Runtime Error
  Serialization Error: Failed to deserialize: expected end of object, but found field id: 100
[0m23:08:19.675045 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.90418535, "process_user_time": 4.24044, "process_kernel_time": 0.875265, "process_mem_max_rss": "238724", "process_out_blocks": "8384", "command_success": false, "process_in_blocks": "0"}
[0m23:08:19.677174 [debug] [MainThread]: Command `dbt run` failed at 23:08:19.676959 after 0.91 seconds
[0m23:08:19.679049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x701fce70a8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x701fce194190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x701fd30455d0>]}
[0m23:08:19.681111 [debug] [MainThread]: Flushing usage events
[0m23:22:06.488048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x702ca1c57810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x702ca1492c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x702ca17738d0>]}


============================== 23:22:06.496593 | 036b1260-6870-4e1d-83b7-a96f0b8219dd ==============================
[0m23:22:06.496593 [info ] [MainThread]: Running with dbt=1.7.4
[0m23:22:06.498435 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '.', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir .', 'send_anonymous_usage_stats': 'True'}
[0m23:22:06.900431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '036b1260-6870-4e1d-83b7-a96f0b8219dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x702ca1477390>]}
[0m23:22:07.018854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '036b1260-6870-4e1d-83b7-a96f0b8219dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x702c983ca010>]}
[0m23:22:07.022057 [info ] [MainThread]: Registered adapter: duckdb=1.7.4
[0m23:22:07.043698 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m23:22:07.079003 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m23:22:07.081363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '036b1260-6870-4e1d-83b7-a96f0b8219dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x702c9e2873d0>]}
[0m23:22:08.303182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '036b1260-6870-4e1d-83b7-a96f0b8219dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x702c983f2590>]}
[0m23:22:08.354517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '036b1260-6870-4e1d-83b7-a96f0b8219dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x702c96826510>]}
[0m23:22:08.357119 [info ] [MainThread]: Found 1 model, 0 sources, 0 exposures, 0 metrics, 394 macros, 0 groups, 0 semantic models
[0m23:22:08.359049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '036b1260-6870-4e1d-83b7-a96f0b8219dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x702c96815ad0>]}
[0m23:22:08.363294 [info ] [MainThread]: 
[0m23:22:08.366210 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m23:22:08.370126 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_legal_demo'
[0m23:22:08.389723 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo"
[0m23:22:08.391594 [debug] [ThreadPool]: On list_legal_demo: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"legal_demo"'
    
  
  
[0m23:22:08.393042 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:22:08.418512 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:22:08.420550 [debug] [MainThread]: Connection 'list_legal_demo' was properly closed.
[0m23:22:08.422249 [info ] [MainThread]: 
[0m23:22:08.424006 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.06 seconds (0.06s).
[0m23:22:08.425852 [error] [MainThread]: Encountered an error:
Runtime Error
  Serialization Error: Failed to deserialize: expected end of object, but found field id: 100
[0m23:22:08.428406 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.0632756, "process_user_time": 4.663525, "process_kernel_time": 0.720544, "process_mem_max_rss": "232008", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:22:08.430080 [debug] [MainThread]: Command `dbt run` failed at 23:22:08.429820 after 2.06 seconds
[0m23:22:08.431525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x702ca1d29750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x702ca1476710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x702ca62ecc50>]}
[0m23:22:08.433014 [debug] [MainThread]: Flushing usage events
[0m23:30:09.212564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7288d541bed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7288d5704110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7288d7037690>]}


============================== 23:30:09.223444 | 1cf9e49e-d872-4dda-a51d-afb59cf9e83b ==============================
[0m23:30:09.223444 [info ] [MainThread]: Running with dbt=1.7.4
[0m23:30:09.225487 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir .', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:30:09.615010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1cf9e49e-d872-4dda-a51d-afb59cf9e83b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7288cc3ca6d0>]}
[0m23:30:09.715667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1cf9e49e-d872-4dda-a51d-afb59cf9e83b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7288d5a29650>]}
[0m23:30:09.718558 [info ] [MainThread]: Registered adapter: duckdb=1.7.4
[0m23:30:09.739923 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m23:30:09.768156 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m23:30:09.770406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1cf9e49e-d872-4dda-a51d-afb59cf9e83b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7288cc304550>]}
[0m23:30:10.842940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1cf9e49e-d872-4dda-a51d-afb59cf9e83b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7288cc2be610>]}
[0m23:30:10.894934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1cf9e49e-d872-4dda-a51d-afb59cf9e83b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7288ca980810>]}
[0m23:30:10.897208 [info ] [MainThread]: Found 1 model, 0 sources, 0 exposures, 0 metrics, 394 macros, 0 groups, 0 semantic models
[0m23:30:10.899007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1cf9e49e-d872-4dda-a51d-afb59cf9e83b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7288cc2ac350>]}
[0m23:30:10.902531 [info ] [MainThread]: 
[0m23:30:10.905167 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m23:30:10.908975 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_legal_demo'
[0m23:30:10.924198 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo"
[0m23:30:10.926435 [debug] [ThreadPool]: On list_legal_demo: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"legal_demo"'
    
  
  
[0m23:30:10.928327 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:30:10.957454 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:30:10.959380 [debug] [MainThread]: Connection 'list_legal_demo' was properly closed.
[0m23:30:10.960949 [info ] [MainThread]: 
[0m23:30:10.962538 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.06 seconds (0.06s).
[0m23:30:10.964650 [error] [MainThread]: Encountered an error:
Runtime Error
  Serialization Error: Failed to deserialize: expected end of object, but found field id: 100
[0m23:30:10.967552 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.8375803, "process_user_time": 4.542755, "process_kernel_time": 0.717906, "process_mem_max_rss": "232008", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:30:10.969626 [debug] [MainThread]: Command `dbt run` failed at 23:30:10.969367 after 1.84 seconds
[0m23:30:10.971223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7288d53fe250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7288d5b867d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7288ca902b90>]}
[0m23:30:10.972963 [debug] [MainThread]: Flushing usage events
[0m00:57:43.183262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7970c1f47110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7970c1e52b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7970c1ffaf10>]}


============================== 00:57:43.210668 | 1aeae182-8554-4d4a-955a-845dd0ba5458 ==============================
[0m00:57:43.210668 [info ] [MainThread]: Running with dbt=1.7.4
[0m00:57:43.212708 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'profiles_dir': '.', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt debug --profiles-dir .', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:57:43.217077 [info ] [MainThread]: dbt version: 1.7.4
[0m00:57:43.218720 [info ] [MainThread]: python version: 3.11.9
[0m00:57:43.220364 [info ] [MainThread]: python path: /home/airflow/.local/bin/python
[0m00:57:43.222014 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.36
[0m00:57:43.475044 [info ] [MainThread]: Using profiles dir at .
[0m00:57:43.477398 [info ] [MainThread]: Using profiles.yml file at ./profiles.yml
[0m00:57:43.480162 [info ] [MainThread]: Using dbt_project.yml file at /opt/airflow/dbt/dbt_project.yml
[0m00:57:43.482533 [info ] [MainThread]: adapter type: duckdb
[0m00:57:43.484313 [info ] [MainThread]: adapter version: 1.7.4
[0m00:57:43.574959 [info ] [MainThread]: Configuration:
[0m00:57:43.577686 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m00:57:43.580620 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m00:57:43.583390 [info ] [MainThread]: Required dependencies:
[0m00:57:43.585699 [debug] [MainThread]: Executing "git --help"
[0m00:57:43.591972 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m00:57:43.594523 [info ] [MainThread]: Connection:
[0m00:57:43.596523 [info ] [MainThread]:   database: legal_demo
[0m00:57:43.598572 [info ] [MainThread]:   schema: main
[0m00:57:43.600714 [info ] [MainThread]:   path: /opt/airflow/data/legal_demo.duckdb
[0m00:57:43.603407 [info ] [MainThread]:   config_options: None
[0m00:57:43.607585 [info ] [MainThread]:   extensions: None
[0m00:57:43.610012 [info ] [MainThread]:   settings: None
[0m00:57:43.612081 [info ] [MainThread]:   external_root: .
[0m00:57:43.613794 [info ] [MainThread]:   use_credential_provider: None
[0m00:57:43.615928 [info ] [MainThread]:   attach: None
[0m00:57:43.618246 [info ] [MainThread]:   filesystems: None
[0m00:57:43.620313 [info ] [MainThread]:   remote: None
[0m00:57:43.622894 [info ] [MainThread]:   plugins: None
[0m00:57:43.625223 [info ] [MainThread]:   disable_transactions: False
[0m00:57:43.627359 [info ] [MainThread]: Registered adapter: duckdb=1.7.4
[0m00:57:43.629612 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m00:57:43.631526 [debug] [MainThread]: Using duckdb connection "debug"
[0m00:57:43.633143 [debug] [MainThread]: On debug: select 1 as id
[0m00:57:43.634572 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:57:43.661136 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m00:57:43.663411 [info ] [MainThread]: [31m2 checks failed:[0m
[0m00:57:43.666520 [info ] [MainThread]: Error from git --help: User does not have permissions for this command: "git"

[0m00:57:43.669831 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Runtime Error
  Serialization Error: Failed to deserialize: expected end of object, but found field id: 100

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m00:57:43.674510 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 0.561532, "process_user_time": 4.511921, "process_kernel_time": 1.149073, "process_mem_max_rss": "152384", "process_out_blocks": "19288", "command_success": false, "process_in_blocks": "0"}
[0m00:57:43.676718 [debug] [MainThread]: Command `dbt debug` failed at 00:57:43.676426 after 0.56 seconds
[0m00:57:43.678345 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m00:57:43.680043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7970c194f850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7970c1c4dd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7970c6939110>]}
[0m00:57:43.681506 [debug] [MainThread]: Flushing usage events
[0m01:02:34.892510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737d411994d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737d41013c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737d40d4fb90>]}


============================== 01:02:34.901828 | 03b076ec-770e-47e2-b7ae-d704571dae35 ==============================
[0m01:02:34.901828 [info ] [MainThread]: Running with dbt=1.7.4
[0m01:02:34.903941 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir .', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:02:35.282718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '03b076ec-770e-47e2-b7ae-d704571dae35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737d4145ca90>]}
[0m01:02:35.383885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '03b076ec-770e-47e2-b7ae-d704571dae35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737d410d1050>]}
[0m01:02:35.386939 [info ] [MainThread]: Registered adapter: duckdb=1.7.4
[0m01:02:35.408999 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m01:02:35.497506 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:02:35.499895 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:02:35.508683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '03b076ec-770e-47e2-b7ae-d704571dae35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737d3db436d0>]}
[0m01:02:35.559493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '03b076ec-770e-47e2-b7ae-d704571dae35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737d375a3c10>]}
[0m01:02:35.562154 [info ] [MainThread]: Found 1 model, 0 sources, 0 exposures, 0 metrics, 394 macros, 0 groups, 0 semantic models
[0m01:02:35.564551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '03b076ec-770e-47e2-b7ae-d704571dae35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737d37550ed0>]}
[0m01:02:35.616637 [info ] [MainThread]: 
[0m01:02:35.619583 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m01:02:35.624119 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_legal_demo'
[0m01:02:35.639784 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo"
[0m01:02:35.641561 [debug] [ThreadPool]: On list_legal_demo: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"legal_demo"'
    
  
  
[0m01:02:35.643091 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:02:35.734526 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m01:02:35.738998 [debug] [ThreadPool]: On list_legal_demo: Close
[0m01:02:35.747770 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_legal_demo, now create_legal_demo_main)
[0m01:02:35.750034 [debug] [ThreadPool]: Creating schema "database: "legal_demo"
schema: "main"
"
[0m01:02:35.758848 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m01:02:35.760922 [debug] [ThreadPool]: On create_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "create_legal_demo_main"} */

    
        select type from duckdb_databases()
        where database_name='legal_demo'
        and type='sqlite'
    
  
[0m01:02:35.762618 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:02:35.785127 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m01:02:35.832518 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m01:02:35.834895 [debug] [ThreadPool]: On create_legal_demo_main: BEGIN
[0m01:02:35.837543 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m01:02:35.839257 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m01:02:35.840870 [debug] [ThreadPool]: On create_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "create_legal_demo_main"} */

    
    
        create schema if not exists "legal_demo"."main"
    
[0m01:02:35.844158 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m01:02:35.847089 [debug] [ThreadPool]: On create_legal_demo_main: COMMIT
[0m01:02:35.849232 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m01:02:35.851082 [debug] [ThreadPool]: On create_legal_demo_main: COMMIT
[0m01:02:35.854989 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m01:02:35.856424 [debug] [ThreadPool]: On create_legal_demo_main: Close
[0m01:02:35.866312 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_legal_demo_main, now list_legal_demo_main)
[0m01:02:35.874093 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo_main"
[0m01:02:35.876871 [debug] [ThreadPool]: On list_legal_demo_main: BEGIN
[0m01:02:35.878865 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:02:35.898343 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m01:02:35.900377 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo_main"
[0m01:02:35.901825 [debug] [ThreadPool]: On list_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo_main"} */
select
      'legal_demo' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'legal_demo'
  
[0m01:02:35.952746 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m01:02:35.957415 [debug] [ThreadPool]: On list_legal_demo_main: ROLLBACK
[0m01:02:35.961077 [debug] [ThreadPool]: Failed to rollback 'list_legal_demo_main'
[0m01:02:35.963407 [debug] [ThreadPool]: On list_legal_demo_main: Close
[0m01:02:35.972612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '03b076ec-770e-47e2-b7ae-d704571dae35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737d375ed2d0>]}
[0m01:02:35.975124 [debug] [MainThread]: Using duckdb connection "master"
[0m01:02:35.976548 [debug] [MainThread]: On master: BEGIN
[0m01:02:35.978088 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:02:35.998962 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m01:02:36.001049 [debug] [MainThread]: On master: COMMIT
[0m01:02:36.002595 [debug] [MainThread]: Using duckdb connection "master"
[0m01:02:36.004516 [debug] [MainThread]: On master: COMMIT
[0m01:02:36.007387 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m01:02:36.009271 [debug] [MainThread]: On master: Close
[0m01:02:36.016217 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:02:36.018160 [info ] [MainThread]: 
[0m01:02:36.032657 [debug] [Thread-1 (]: Began running node model.legal_demo.acris_cases
[0m01:02:36.035377 [info ] [Thread-1 (]: 1 of 1 START sql table model main.acris_clean .................................. [RUN]
[0m01:02:36.038539 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.legal_demo.acris_cases'
[0m01:02:36.040216 [debug] [Thread-1 (]: Began compiling node model.legal_demo.acris_cases
[0m01:02:36.050260 [debug] [Thread-1 (]: Writing injected SQL for node "model.legal_demo.acris_cases"
[0m01:02:36.087882 [debug] [Thread-1 (]: Timing info for model.legal_demo.acris_cases (compile): 01:02:36.041689 => 01:02:36.087080
[0m01:02:36.089783 [debug] [Thread-1 (]: Began executing node model.legal_demo.acris_cases
[0m01:02:36.133948 [debug] [Thread-1 (]: Writing runtime sql for node "model.legal_demo.acris_cases"
[0m01:02:36.213729 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m01:02:36.215742 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: BEGIN
[0m01:02:36.218556 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:02:36.241011 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m01:02:36.243329 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m01:02:36.244826 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */

  
    
    

    create  table
      "legal_demo"."main"."acris_clean__dbt_tmp"
  
    as (
      --
-- This model loads the already‑downloaded CSV into DuckDB and
-- materializes it as a table named `acris_clean`.  Because the
-- pipeline does not download data, the file must exist under
-- `data/first_500k_acris.csv` prior to running `dbt run`.  The
-- absolute path points at `/opt/airflow/data/first_500k_acris.csv` when
-- executed inside the Airflow containers.  Locally, dbt resolves
-- relative paths against the project root, so this model continues to
-- work outside of Docker.



SELECT *
FROM read_csv_auto('/opt/airflow/data/first_500k_acris.csv', header=True, delim=',')
    );
  
  
[0m01:02:39.184660 [debug] [Thread-1 (]: SQL status: OK in 3.0 seconds
[0m01:02:39.195608 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m01:02:39.197801 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
alter table "legal_demo"."main"."acris_clean__dbt_tmp" rename to "acris_clean"
[0m01:02:39.201401 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m01:02:39.226063 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: COMMIT
[0m01:02:39.229109 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m01:02:39.231353 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: COMMIT
[0m01:02:39.305835 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m01:02:39.314700 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m01:02:39.316689 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
drop table if exists "legal_demo"."main"."acris_clean__dbt_backup" cascade
[0m01:02:39.322640 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m01:02:39.327046 [debug] [Thread-1 (]: Timing info for model.legal_demo.acris_cases (execute): 01:02:36.091197 => 01:02:39.326437
[0m01:02:39.329378 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: Close
[0m01:02:39.385781 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03b076ec-770e-47e2-b7ae-d704571dae35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737d40d962d0>]}
[0m01:02:39.389160 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main.acris_clean ............................. [[32mOK[0m in 3.35s]
[0m01:02:39.391504 [debug] [Thread-1 (]: Finished running node model.legal_demo.acris_cases
[0m01:02:39.395970 [debug] [MainThread]: Using duckdb connection "master"
[0m01:02:39.397586 [debug] [MainThread]: On master: BEGIN
[0m01:02:39.399186 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:02:39.425745 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m01:02:39.427776 [debug] [MainThread]: On master: COMMIT
[0m01:02:39.429235 [debug] [MainThread]: Using duckdb connection "master"
[0m01:02:39.430659 [debug] [MainThread]: On master: COMMIT
[0m01:02:39.433028 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m01:02:39.434733 [debug] [MainThread]: On master: Close
[0m01:02:39.444059 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:02:39.446479 [debug] [MainThread]: Connection 'list_legal_demo_main' was properly closed.
[0m01:02:39.448225 [debug] [MainThread]: Connection 'model.legal_demo.acris_cases' was properly closed.
[0m01:02:39.449746 [info ] [MainThread]: 
[0m01:02:39.451623 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.83 seconds (3.83s).
[0m01:02:39.454801 [debug] [MainThread]: Command end result
[0m01:02:39.560486 [info ] [MainThread]: 
[0m01:02:39.562524 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:02:39.564322 [info ] [MainThread]: 
[0m01:02:39.566113 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m01:02:39.568619 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.7474866, "process_user_time": 7.547697, "process_kernel_time": 1.615628, "process_mem_max_rss": "296208", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m01:02:39.570964 [debug] [MainThread]: Command `dbt run` succeeded at 01:02:39.570602 after 4.75 seconds
[0m01:02:39.572799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737d41304a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737d45b8eb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737d45b6fb10>]}
[0m01:02:39.574605 [debug] [MainThread]: Flushing usage events
[0m01:50:57.507055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x739524c6a910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7395250b1910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7395250e2350>]}


============================== 01:50:57.519078 | c2ff5d34-1abd-4933-8082-9a8778faca94 ==============================
[0m01:50:57.519078 [info ] [MainThread]: Running with dbt=1.7.4
[0m01:50:57.521222 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '.', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir .', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:50:57.961368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c2ff5d34-1abd-4933-8082-9a8778faca94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7395249a1c50>]}
[0m01:50:58.084636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c2ff5d34-1abd-4933-8082-9a8778faca94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x739524d24fd0>]}
[0m01:50:58.087835 [info ] [MainThread]: Registered adapter: duckdb=1.7.4
[0m01:50:58.118599 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m01:50:58.236679 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:50:58.238912 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:50:58.252392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c2ff5d34-1abd-4933-8082-9a8778faca94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73951b7c0750>]}
[0m01:50:58.351827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c2ff5d34-1abd-4933-8082-9a8778faca94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73951b8b20d0>]}
[0m01:50:58.354917 [info ] [MainThread]: Found 1 model, 0 sources, 0 exposures, 0 metrics, 394 macros, 0 groups, 0 semantic models
[0m01:50:58.359274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c2ff5d34-1abd-4933-8082-9a8778faca94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7395250e1990>]}
[0m01:50:58.366530 [info ] [MainThread]: 
[0m01:50:58.373495 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m01:50:58.377948 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_legal_demo'
[0m01:50:58.416269 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo"
[0m01:50:58.420296 [debug] [ThreadPool]: On list_legal_demo: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"legal_demo"'
    
  
  
[0m01:50:58.423079 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:50:58.499202 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m01:50:58.504411 [debug] [ThreadPool]: On list_legal_demo: Close
[0m01:50:58.517949 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_legal_demo, now create_legal_demo_main)
[0m01:50:58.521044 [debug] [ThreadPool]: Creating schema "database: "legal_demo"
schema: "main"
"
[0m01:50:58.541398 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m01:50:58.543888 [debug] [ThreadPool]: On create_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "create_legal_demo_main"} */

    
        select type from duckdb_databases()
        where database_name='legal_demo'
        and type='sqlite'
    
  
[0m01:50:58.550264 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:50:58.580256 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m01:50:58.582964 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m01:50:58.584760 [debug] [ThreadPool]: On create_legal_demo_main: BEGIN
[0m01:50:58.588186 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m01:50:58.589642 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m01:50:58.591483 [debug] [ThreadPool]: On create_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "create_legal_demo_main"} */

    
    
        create schema if not exists "legal_demo"."main"
    
[0m01:50:58.594517 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m01:50:58.597545 [debug] [ThreadPool]: On create_legal_demo_main: COMMIT
[0m01:50:58.599428 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m01:50:58.601263 [debug] [ThreadPool]: On create_legal_demo_main: COMMIT
[0m01:50:58.605067 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m01:50:58.607041 [debug] [ThreadPool]: On create_legal_demo_main: Close
[0m01:50:58.617051 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_legal_demo_main, now list_legal_demo_main)
[0m01:50:58.626518 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo_main"
[0m01:50:58.628654 [debug] [ThreadPool]: On list_legal_demo_main: BEGIN
[0m01:50:58.629997 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:50:58.650823 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m01:50:58.652583 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo_main"
[0m01:50:58.653897 [debug] [ThreadPool]: On list_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo_main"} */
select
      'legal_demo' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'legal_demo'
  
[0m01:50:58.687442 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m01:50:58.695967 [debug] [ThreadPool]: On list_legal_demo_main: ROLLBACK
[0m01:50:58.698275 [debug] [ThreadPool]: Failed to rollback 'list_legal_demo_main'
[0m01:50:58.700178 [debug] [ThreadPool]: On list_legal_demo_main: Close
[0m01:50:58.708144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c2ff5d34-1abd-4933-8082-9a8778faca94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73951b9addd0>]}
[0m01:50:58.710703 [debug] [MainThread]: Using duckdb connection "master"
[0m01:50:58.712624 [debug] [MainThread]: On master: BEGIN
[0m01:50:58.714180 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:50:58.736606 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m01:50:58.738369 [debug] [MainThread]: On master: COMMIT
[0m01:50:58.739930 [debug] [MainThread]: Using duckdb connection "master"
[0m01:50:58.741336 [debug] [MainThread]: On master: COMMIT
[0m01:50:58.743403 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m01:50:58.745061 [debug] [MainThread]: On master: Close
[0m01:50:58.750391 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:50:58.752269 [info ] [MainThread]: 
[0m01:50:58.764945 [debug] [Thread-1 (]: Began running node model.legal_demo.acris_cases
[0m01:50:58.768518 [info ] [Thread-1 (]: 1 of 1 START sql table model main.acris_clean .................................. [RUN]
[0m01:50:58.771754 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.legal_demo.acris_cases'
[0m01:50:58.773214 [debug] [Thread-1 (]: Began compiling node model.legal_demo.acris_cases
[0m01:50:58.782355 [debug] [Thread-1 (]: Writing injected SQL for node "model.legal_demo.acris_cases"
[0m01:50:58.794557 [debug] [Thread-1 (]: Timing info for model.legal_demo.acris_cases (compile): 01:50:58.774287 => 01:50:58.794051
[0m01:50:58.799110 [debug] [Thread-1 (]: Began executing node model.legal_demo.acris_cases
[0m01:50:58.840513 [debug] [Thread-1 (]: Writing runtime sql for node "model.legal_demo.acris_cases"
[0m01:50:58.854287 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m01:50:58.856011 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: BEGIN
[0m01:50:58.857388 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:50:58.881311 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m01:50:58.882947 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m01:50:58.884865 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */

  
    
    

    create  table
      "legal_demo"."main"."acris_clean__dbt_tmp"
  
    as (
      --
-- This model loads the already‑downloaded CSV into DuckDB and
-- materializes it as a table named `acris_clean`.  Because the
-- pipeline does not download data, the file must exist under
-- `data/first_500k_acris.csv` prior to running `dbt run`.  The
-- absolute path points at `/opt/airflow/data/first_500k_acris.csv` when
-- executed inside the Airflow containers.  Locally, dbt resolves
-- relative paths against the project root, so this model continues to
-- work outside of Docker.



SELECT *
FROM read_csv_auto('/opt/airflow/data/first_500k_acris.csv', header=True, delim=',')
    );
  
  
[0m01:51:01.441451 [debug] [Thread-1 (]: SQL status: OK in 3.0 seconds
[0m01:51:01.454277 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m01:51:01.456947 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
alter table "legal_demo"."main"."acris_clean" rename to "acris_clean__dbt_backup"
[0m01:51:01.460479 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m01:51:01.468468 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m01:51:01.470372 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
alter table "legal_demo"."main"."acris_clean__dbt_tmp" rename to "acris_clean"
[0m01:51:01.472834 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m01:51:01.496928 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: COMMIT
[0m01:51:01.499471 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m01:51:01.501619 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: COMMIT
[0m01:51:01.574945 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m01:51:01.583170 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m01:51:01.585539 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
drop table if exists "legal_demo"."main"."acris_clean__dbt_backup" cascade
[0m01:51:01.594382 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m01:51:01.598124 [debug] [Thread-1 (]: Timing info for model.legal_demo.acris_cases (execute): 01:50:58.801395 => 01:51:01.597821
[0m01:51:01.600152 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: Close
[0m01:51:01.669365 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c2ff5d34-1abd-4933-8082-9a8778faca94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73951b864250>]}
[0m01:51:01.672456 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main.acris_clean ............................. [[32mOK[0m in 2.90s]
[0m01:51:01.675300 [debug] [Thread-1 (]: Finished running node model.legal_demo.acris_cases
[0m01:51:01.679935 [debug] [MainThread]: Using duckdb connection "master"
[0m01:51:01.682014 [debug] [MainThread]: On master: BEGIN
[0m01:51:01.683664 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:51:01.704831 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m01:51:01.706531 [debug] [MainThread]: On master: COMMIT
[0m01:51:01.707994 [debug] [MainThread]: Using duckdb connection "master"
[0m01:51:01.709540 [debug] [MainThread]: On master: COMMIT
[0m01:51:01.711653 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m01:51:01.713434 [debug] [MainThread]: On master: Close
[0m01:51:01.718457 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:51:01.720614 [debug] [MainThread]: Connection 'list_legal_demo_main' was properly closed.
[0m01:51:01.722020 [debug] [MainThread]: Connection 'model.legal_demo.acris_cases' was properly closed.
[0m01:51:01.723474 [info ] [MainThread]: 
[0m01:51:01.725172 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.35 seconds (3.35s).
[0m01:51:01.727157 [debug] [MainThread]: Command end result
[0m01:51:01.763556 [info ] [MainThread]: 
[0m01:51:01.765545 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:51:01.768971 [info ] [MainThread]: 
[0m01:51:01.770969 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m01:51:01.773551 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.3499074, "process_user_time": 5.821006, "process_kernel_time": 1.668239, "process_mem_max_rss": "298664", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m01:51:01.775789 [debug] [MainThread]: Command `dbt run` succeeded at 01:51:01.775447 after 4.35 seconds
[0m01:51:01.777646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7395297c6c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7395297c7b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x739524f621d0>]}
[0m01:51:01.779430 [debug] [MainThread]: Flushing usage events
[0m02:04:40.482550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x771367df2650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x771367e93dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x771367c8c6d0>]}


============================== 02:04:40.539632 | b29313cc-ee13-40bb-8486-2e84481bc756 ==============================
[0m02:04:40.539632 [info ] [MainThread]: Running with dbt=1.7.4
[0m02:04:40.542462 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir .', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m02:04:41.076147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b29313cc-ee13-40bb-8486-2e84481bc756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x771367717110>]}
[0m02:04:41.198860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b29313cc-ee13-40bb-8486-2e84481bc756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x771367ac9ed0>]}
[0m02:04:41.201283 [info ] [MainThread]: Registered adapter: duckdb=1.7.4
[0m02:04:41.223591 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m02:04:41.371279 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:04:41.373911 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:04:41.383497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b29313cc-ee13-40bb-8486-2e84481bc756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77135e55c550>]}
[0m02:04:41.435075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b29313cc-ee13-40bb-8486-2e84481bc756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77135e571210>]}
[0m02:04:41.437094 [info ] [MainThread]: Found 1 model, 0 sources, 0 exposures, 0 metrics, 394 macros, 0 groups, 0 semantic models
[0m02:04:41.439170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b29313cc-ee13-40bb-8486-2e84481bc756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77136b0f1990>]}
[0m02:04:41.442723 [info ] [MainThread]: 
[0m02:04:41.445286 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m02:04:41.448453 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_legal_demo'
[0m02:04:41.464857 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo"
[0m02:04:41.467468 [debug] [ThreadPool]: On list_legal_demo: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"legal_demo"'
    
  
  
[0m02:04:41.469323 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:04:41.514963 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:04:41.518763 [debug] [ThreadPool]: On list_legal_demo: Close
[0m02:04:41.530315 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_legal_demo, now create_legal_demo_main)
[0m02:04:41.532854 [debug] [ThreadPool]: Creating schema "database: "legal_demo"
schema: "main"
"
[0m02:04:41.543081 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m02:04:41.544949 [debug] [ThreadPool]: On create_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "create_legal_demo_main"} */

    
        select type from duckdb_databases()
        where database_name='legal_demo'
        and type='sqlite'
    
  
[0m02:04:41.546655 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:04:41.576269 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:04:41.579257 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m02:04:41.580883 [debug] [ThreadPool]: On create_legal_demo_main: BEGIN
[0m02:04:41.582928 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:04:41.584613 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m02:04:41.586263 [debug] [ThreadPool]: On create_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "create_legal_demo_main"} */

    
    
        create schema if not exists "legal_demo"."main"
    
[0m02:04:41.591244 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:04:41.594880 [debug] [ThreadPool]: On create_legal_demo_main: COMMIT
[0m02:04:41.596465 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m02:04:41.598013 [debug] [ThreadPool]: On create_legal_demo_main: COMMIT
[0m02:04:41.601809 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:04:41.603336 [debug] [ThreadPool]: On create_legal_demo_main: Close
[0m02:04:41.614789 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_legal_demo_main, now list_legal_demo_main)
[0m02:04:41.624901 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo_main"
[0m02:04:41.627392 [debug] [ThreadPool]: On list_legal_demo_main: BEGIN
[0m02:04:41.629221 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:04:41.653393 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:04:41.655820 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo_main"
[0m02:04:41.657846 [debug] [ThreadPool]: On list_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo_main"} */
select
      'legal_demo' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'legal_demo'
  
[0m02:04:41.689179 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:04:41.697401 [debug] [ThreadPool]: On list_legal_demo_main: ROLLBACK
[0m02:04:41.700322 [debug] [ThreadPool]: Failed to rollback 'list_legal_demo_main'
[0m02:04:41.702026 [debug] [ThreadPool]: On list_legal_demo_main: Close
[0m02:04:41.710894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b29313cc-ee13-40bb-8486-2e84481bc756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x771367e50790>]}
[0m02:04:41.712846 [debug] [MainThread]: Using duckdb connection "master"
[0m02:04:41.714408 [debug] [MainThread]: On master: BEGIN
[0m02:04:41.715856 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:04:41.739853 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m02:04:41.741926 [debug] [MainThread]: On master: COMMIT
[0m02:04:41.743453 [debug] [MainThread]: Using duckdb connection "master"
[0m02:04:41.744846 [debug] [MainThread]: On master: COMMIT
[0m02:04:41.746587 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m02:04:41.747994 [debug] [MainThread]: On master: Close
[0m02:04:41.752861 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:04:41.754683 [info ] [MainThread]: 
[0m02:04:41.767230 [debug] [Thread-1 (]: Began running node model.legal_demo.acris_cases
[0m02:04:41.769471 [info ] [Thread-1 (]: 1 of 1 START sql table model main.acris_clean .................................. [RUN]
[0m02:04:41.771974 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.legal_demo.acris_cases'
[0m02:04:41.773994 [debug] [Thread-1 (]: Began compiling node model.legal_demo.acris_cases
[0m02:04:41.783887 [debug] [Thread-1 (]: Writing injected SQL for node "model.legal_demo.acris_cases"
[0m02:04:41.798775 [debug] [Thread-1 (]: Timing info for model.legal_demo.acris_cases (compile): 02:04:41.775450 => 02:04:41.798205
[0m02:04:41.800589 [debug] [Thread-1 (]: Began executing node model.legal_demo.acris_cases
[0m02:04:41.841500 [debug] [Thread-1 (]: Writing runtime sql for node "model.legal_demo.acris_cases"
[0m02:04:41.855780 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m02:04:41.857531 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: BEGIN
[0m02:04:41.859254 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:04:41.887256 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:04:41.889102 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m02:04:41.890803 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */

  
    
    

    create  table
      "legal_demo"."main"."acris_clean__dbt_tmp"
  
    as (
      --
-- This model loads the already‑downloaded CSV into DuckDB and
-- materializes it as a table named `acris_clean`.  Because the
-- pipeline does not download data, the file must exist under
-- `data/first_500k_acris.csv` prior to running `dbt run`.  The
-- absolute path points at `/opt/airflow/data/first_500k_acris.csv` when
-- executed inside the Airflow containers.  Locally, dbt resolves
-- relative paths against the project root, so this model continues to
-- work outside of Docker.



SELECT *
FROM read_csv_auto('/opt/airflow/data/first_500k_acris.csv', header=True, delim=',')
    );
  
  
[0m02:04:45.314950 [debug] [Thread-1 (]: SQL status: OK in 3.0 seconds
[0m02:04:45.324155 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m02:04:45.326222 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
alter table "legal_demo"."main"."acris_clean" rename to "acris_clean__dbt_backup"
[0m02:04:45.328973 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:04:45.335781 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m02:04:45.337875 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
alter table "legal_demo"."main"."acris_clean__dbt_tmp" rename to "acris_clean"
[0m02:04:45.340197 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:04:45.368151 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: COMMIT
[0m02:04:45.370497 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m02:04:45.372319 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: COMMIT
[0m02:04:45.444733 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:04:45.454930 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m02:04:45.457480 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
drop table if exists "legal_demo"."main"."acris_clean__dbt_backup" cascade
[0m02:04:45.466312 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:04:45.469705 [debug] [Thread-1 (]: Timing info for model.legal_demo.acris_cases (execute): 02:04:41.802163 => 02:04:45.469357
[0m02:04:45.471742 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: Close
[0m02:04:45.554160 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b29313cc-ee13-40bb-8486-2e84481bc756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7713677099d0>]}
[0m02:04:45.558300 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main.acris_clean ............................. [[32mOK[0m in 3.78s]
[0m02:04:45.565754 [debug] [Thread-1 (]: Finished running node model.legal_demo.acris_cases
[0m02:04:45.572123 [debug] [MainThread]: Using duckdb connection "master"
[0m02:04:45.574475 [debug] [MainThread]: On master: BEGIN
[0m02:04:45.576343 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:04:45.603694 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m02:04:45.607356 [debug] [MainThread]: On master: COMMIT
[0m02:04:45.609066 [debug] [MainThread]: Using duckdb connection "master"
[0m02:04:45.610906 [debug] [MainThread]: On master: COMMIT
[0m02:04:45.613932 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m02:04:45.617912 [debug] [MainThread]: On master: Close
[0m02:04:45.623720 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:04:45.625446 [debug] [MainThread]: Connection 'list_legal_demo_main' was properly closed.
[0m02:04:45.627140 [debug] [MainThread]: Connection 'model.legal_demo.acris_cases' was properly closed.
[0m02:04:45.628735 [info ] [MainThread]: 
[0m02:04:45.630593 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.18 seconds (4.18s).
[0m02:04:45.633769 [debug] [MainThread]: Command end result
[0m02:04:45.669309 [info ] [MainThread]: 
[0m02:04:45.671253 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:04:45.672980 [info ] [MainThread]: 
[0m02:04:45.674874 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m02:04:45.677268 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.2697487, "process_user_time": 9.074019, "process_kernel_time": 1.918251, "process_mem_max_rss": "301336", "process_in_blocks": "3864", "process_out_blocks": "8384"}
[0m02:04:45.679202 [debug] [MainThread]: Command `dbt run` succeeded at 02:04:45.678962 after 5.27 seconds
[0m02:04:45.680521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77136c62f290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77136c59d850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77136c55f450>]}
[0m02:04:45.683233 [debug] [MainThread]: Flushing usage events
[0m02:23:32.245817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7236ae438550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7236ae70ff90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7236ae7787d0>]}


============================== 02:23:32.255598 | 79cfed43-90cb-486a-ba77-a0190079e4d0 ==============================
[0m02:23:32.255598 [info ] [MainThread]: Running with dbt=1.7.4
[0m02:23:32.257769 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir .', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:23:32.683392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '79cfed43-90cb-486a-ba77-a0190079e4d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7236ae077b50>]}
[0m02:23:32.801053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '79cfed43-90cb-486a-ba77-a0190079e4d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7236a4f046d0>]}
[0m02:23:32.803962 [info ] [MainThread]: Registered adapter: duckdb=1.7.4
[0m02:23:32.829032 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m02:23:32.928215 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:23:32.930646 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:23:32.938493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '79cfed43-90cb-486a-ba77-a0190079e4d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7236ae8029d0>]}
[0m02:23:32.987358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '79cfed43-90cb-486a-ba77-a0190079e4d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7236a4e2a110>]}
[0m02:23:32.989305 [info ] [MainThread]: Found 1 model, 0 sources, 0 exposures, 0 metrics, 394 macros, 0 groups, 0 semantic models
[0m02:23:32.991066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '79cfed43-90cb-486a-ba77-a0190079e4d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7236ae34c7d0>]}
[0m02:23:32.995126 [info ] [MainThread]: 
[0m02:23:32.997568 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m02:23:33.001458 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_legal_demo'
[0m02:23:33.017952 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo"
[0m02:23:33.020119 [debug] [ThreadPool]: On list_legal_demo: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"legal_demo"'
    
  
  
[0m02:23:33.021981 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:23:33.074339 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:23:33.078705 [debug] [ThreadPool]: On list_legal_demo: Close
[0m02:23:33.087326 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_legal_demo, now create_legal_demo_main)
[0m02:23:33.089359 [debug] [ThreadPool]: Creating schema "database: "legal_demo"
schema: "main"
"
[0m02:23:33.099387 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m02:23:33.101301 [debug] [ThreadPool]: On create_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "create_legal_demo_main"} */

    
        select type from duckdb_databases()
        where database_name='legal_demo'
        and type='sqlite'
    
  
[0m02:23:33.102938 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:23:33.133415 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:23:33.136274 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m02:23:33.137890 [debug] [ThreadPool]: On create_legal_demo_main: BEGIN
[0m02:23:33.139997 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:23:33.141535 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m02:23:33.142999 [debug] [ThreadPool]: On create_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "create_legal_demo_main"} */

    
    
        create schema if not exists "legal_demo"."main"
    
[0m02:23:33.145751 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:23:33.147959 [debug] [ThreadPool]: On create_legal_demo_main: COMMIT
[0m02:23:33.149467 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m02:23:33.150987 [debug] [ThreadPool]: On create_legal_demo_main: COMMIT
[0m02:23:33.153991 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:23:33.155526 [debug] [ThreadPool]: On create_legal_demo_main: Close
[0m02:23:33.165743 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_legal_demo_main, now list_legal_demo_main)
[0m02:23:33.173336 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo_main"
[0m02:23:33.175151 [debug] [ThreadPool]: On list_legal_demo_main: BEGIN
[0m02:23:33.176690 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:23:33.200183 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:23:33.201825 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo_main"
[0m02:23:33.203737 [debug] [ThreadPool]: On list_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo_main"} */
select
      'legal_demo' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'legal_demo'
  
[0m02:23:33.240389 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:23:33.250092 [debug] [ThreadPool]: On list_legal_demo_main: ROLLBACK
[0m02:23:33.252731 [debug] [ThreadPool]: Failed to rollback 'list_legal_demo_main'
[0m02:23:33.254349 [debug] [ThreadPool]: On list_legal_demo_main: Close
[0m02:23:33.260946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '79cfed43-90cb-486a-ba77-a0190079e4d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7236ae70fad0>]}
[0m02:23:33.262887 [debug] [MainThread]: Using duckdb connection "master"
[0m02:23:33.264364 [debug] [MainThread]: On master: BEGIN
[0m02:23:33.265831 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:23:33.293605 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m02:23:33.295786 [debug] [MainThread]: On master: COMMIT
[0m02:23:33.297237 [debug] [MainThread]: Using duckdb connection "master"
[0m02:23:33.299201 [debug] [MainThread]: On master: COMMIT
[0m02:23:33.301538 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m02:23:33.303159 [debug] [MainThread]: On master: Close
[0m02:23:33.308857 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:23:33.310755 [info ] [MainThread]: 
[0m02:23:33.322005 [debug] [Thread-1 (]: Began running node model.legal_demo.acris_cases
[0m02:23:33.323835 [info ] [Thread-1 (]: 1 of 1 START sql table model main.acris_clean .................................. [RUN]
[0m02:23:33.326081 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.legal_demo.acris_cases'
[0m02:23:33.327700 [debug] [Thread-1 (]: Began compiling node model.legal_demo.acris_cases
[0m02:23:33.337887 [debug] [Thread-1 (]: Writing injected SQL for node "model.legal_demo.acris_cases"
[0m02:23:33.352166 [debug] [Thread-1 (]: Timing info for model.legal_demo.acris_cases (compile): 02:23:33.329035 => 02:23:33.351705
[0m02:23:33.354133 [debug] [Thread-1 (]: Began executing node model.legal_demo.acris_cases
[0m02:23:33.409598 [debug] [Thread-1 (]: Writing runtime sql for node "model.legal_demo.acris_cases"
[0m02:23:33.420830 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m02:23:33.422505 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: BEGIN
[0m02:23:33.423922 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:23:33.448464 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:23:33.450607 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m02:23:33.452211 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */

  
    
    

    create  table
      "legal_demo"."main"."acris_clean__dbt_tmp"
  
    as (
      --
-- This model loads the already‑downloaded CSV into DuckDB and
-- materializes it as a table named `acris_clean`.  Because the
-- pipeline does not download data, the file must exist under
-- `data/first_500k_acris.csv` prior to running `dbt run`.  The
-- absolute path points at `/opt/airflow/data/first_500k_acris.csv` when
-- executed inside the Airflow containers.  Locally, dbt resolves
-- relative paths against the project root, so this model continues to
-- work outside of Docker.



SELECT *
FROM read_csv_auto('/opt/airflow/data/first_500k_acris.csv', header=True, delim=',')
    );
  
  
[0m02:23:36.176763 [debug] [Thread-1 (]: SQL status: OK in 3.0 seconds
[0m02:23:36.186330 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m02:23:36.188012 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
alter table "legal_demo"."main"."acris_clean" rename to "acris_clean__dbt_backup"
[0m02:23:36.190749 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:23:36.196817 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m02:23:36.198667 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
alter table "legal_demo"."main"."acris_clean__dbt_tmp" rename to "acris_clean"
[0m02:23:36.200648 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:23:36.222779 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: COMMIT
[0m02:23:36.225012 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m02:23:36.226871 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: COMMIT
[0m02:23:36.303817 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:23:36.312289 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m02:23:36.314600 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
drop table if exists "legal_demo"."main"."acris_clean__dbt_backup" cascade
[0m02:23:36.323453 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:23:36.327005 [debug] [Thread-1 (]: Timing info for model.legal_demo.acris_cases (execute): 02:23:33.355714 => 02:23:36.326619
[0m02:23:36.329942 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: Close
[0m02:23:36.398617 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '79cfed43-90cb-486a-ba77-a0190079e4d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7236a4c797d0>]}
[0m02:23:36.400868 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main.acris_clean ............................. [[32mOK[0m in 3.07s]
[0m02:23:36.402880 [debug] [Thread-1 (]: Finished running node model.legal_demo.acris_cases
[0m02:23:36.407206 [debug] [MainThread]: Using duckdb connection "master"
[0m02:23:36.408975 [debug] [MainThread]: On master: BEGIN
[0m02:23:36.410488 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:23:36.432249 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m02:23:36.433848 [debug] [MainThread]: On master: COMMIT
[0m02:23:36.435339 [debug] [MainThread]: Using duckdb connection "master"
[0m02:23:36.436829 [debug] [MainThread]: On master: COMMIT
[0m02:23:36.438789 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m02:23:36.440181 [debug] [MainThread]: On master: Close
[0m02:23:36.444990 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:23:36.446894 [debug] [MainThread]: Connection 'list_legal_demo_main' was properly closed.
[0m02:23:36.448222 [debug] [MainThread]: Connection 'model.legal_demo.acris_cases' was properly closed.
[0m02:23:36.449738 [info ] [MainThread]: 
[0m02:23:36.451292 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.45 seconds (3.45s).
[0m02:23:36.453291 [debug] [MainThread]: Command end result
[0m02:23:36.489878 [info ] [MainThread]: 
[0m02:23:36.492223 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:23:36.494137 [info ] [MainThread]: 
[0m02:23:36.496075 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m02:23:36.498787 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.3288956, "process_user_time": 8.057662, "process_kernel_time": 2.143518, "process_mem_max_rss": "298732", "process_out_blocks": "8384", "process_in_blocks": "0"}
[0m02:23:36.500682 [debug] [MainThread]: Command `dbt run` succeeded at 02:23:36.500459 after 4.33 seconds
[0m02:23:36.502479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7236ae047850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7236ae047550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7236b2f07950>]}
[0m02:23:36.504208 [debug] [MainThread]: Flushing usage events
[0m02:38:40.447532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c880bc04cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c880baa25d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c880bae9290>]}


============================== 02:38:40.459845 | 8915698e-837b-482b-8f6b-be70ce853288 ==============================
[0m02:38:40.459845 [info ] [MainThread]: Running with dbt=1.7.4
[0m02:38:40.462261 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '.', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir .', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m02:38:41.009128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8915698e-837b-482b-8f6b-be70ce853288', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c880b5f5dd0>]}
[0m02:38:41.113654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8915698e-837b-482b-8f6b-be70ce853288', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c880b949790>]}
[0m02:38:41.116183 [info ] [MainThread]: Registered adapter: duckdb=1.7.4
[0m02:38:41.134262 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m02:38:41.258610 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:38:41.260398 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:38:41.267519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8915698e-837b-482b-8f6b-be70ce853288', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c88022c9290>]}
[0m02:38:41.308586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8915698e-837b-482b-8f6b-be70ce853288', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c8802308350>]}
[0m02:38:41.310468 [info ] [MainThread]: Found 1 model, 0 sources, 0 exposures, 0 metrics, 394 macros, 0 groups, 0 semantic models
[0m02:38:41.311984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8915698e-837b-482b-8f6b-be70ce853288', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c880b5407d0>]}
[0m02:38:41.315042 [info ] [MainThread]: 
[0m02:38:41.317137 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m02:38:41.320374 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_legal_demo'
[0m02:38:41.336209 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo"
[0m02:38:41.338564 [debug] [ThreadPool]: On list_legal_demo: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"legal_demo"'
    
  
  
[0m02:38:41.340444 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:38:41.378547 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:38:41.382468 [debug] [ThreadPool]: On list_legal_demo: Close
[0m02:38:41.393723 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_legal_demo, now create_legal_demo_main)
[0m02:38:41.396436 [debug] [ThreadPool]: Creating schema "database: "legal_demo"
schema: "main"
"
[0m02:38:41.407526 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m02:38:41.409833 [debug] [ThreadPool]: On create_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "create_legal_demo_main"} */

    
        select type from duckdb_databases()
        where database_name='legal_demo'
        and type='sqlite'
    
  
[0m02:38:41.411402 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:38:41.439354 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:38:41.442140 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m02:38:41.444080 [debug] [ThreadPool]: On create_legal_demo_main: BEGIN
[0m02:38:41.446228 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:38:41.447792 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m02:38:41.449305 [debug] [ThreadPool]: On create_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "create_legal_demo_main"} */

    
    
        create schema if not exists "legal_demo"."main"
    
[0m02:38:41.451528 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:38:41.454045 [debug] [ThreadPool]: On create_legal_demo_main: COMMIT
[0m02:38:41.455715 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m02:38:41.457099 [debug] [ThreadPool]: On create_legal_demo_main: COMMIT
[0m02:38:41.459952 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:38:41.461398 [debug] [ThreadPool]: On create_legal_demo_main: Close
[0m02:38:41.470996 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_legal_demo_main, now list_legal_demo_main)
[0m02:38:41.478813 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo_main"
[0m02:38:41.480910 [debug] [ThreadPool]: On list_legal_demo_main: BEGIN
[0m02:38:41.482537 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:38:41.506299 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:38:41.508149 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo_main"
[0m02:38:41.509611 [debug] [ThreadPool]: On list_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo_main"} */
select
      'legal_demo' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'legal_demo'
  
[0m02:38:41.540579 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:38:41.549299 [debug] [ThreadPool]: On list_legal_demo_main: ROLLBACK
[0m02:38:41.552336 [debug] [ThreadPool]: Failed to rollback 'list_legal_demo_main'
[0m02:38:41.554043 [debug] [ThreadPool]: On list_legal_demo_main: Close
[0m02:38:41.561569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8915698e-837b-482b-8f6b-be70ce853288', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c88082d8cd0>]}
[0m02:38:41.563153 [debug] [MainThread]: Using duckdb connection "master"
[0m02:38:41.564735 [debug] [MainThread]: On master: BEGIN
[0m02:38:41.566019 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:38:41.587250 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m02:38:41.589043 [debug] [MainThread]: On master: COMMIT
[0m02:38:41.590391 [debug] [MainThread]: Using duckdb connection "master"
[0m02:38:41.591707 [debug] [MainThread]: On master: COMMIT
[0m02:38:41.593545 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m02:38:41.594941 [debug] [MainThread]: On master: Close
[0m02:38:41.599851 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:38:41.601284 [info ] [MainThread]: 
[0m02:38:41.613370 [debug] [Thread-1 (]: Began running node model.legal_demo.acris_cases
[0m02:38:41.615585 [info ] [Thread-1 (]: 1 of 1 START sql table model main.acris_clean .................................. [RUN]
[0m02:38:41.617919 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.legal_demo.acris_cases'
[0m02:38:41.619490 [debug] [Thread-1 (]: Began compiling node model.legal_demo.acris_cases
[0m02:38:41.629852 [debug] [Thread-1 (]: Writing injected SQL for node "model.legal_demo.acris_cases"
[0m02:38:41.643068 [debug] [Thread-1 (]: Timing info for model.legal_demo.acris_cases (compile): 02:38:41.621020 => 02:38:41.642636
[0m02:38:41.644813 [debug] [Thread-1 (]: Began executing node model.legal_demo.acris_cases
[0m02:38:41.683386 [debug] [Thread-1 (]: Writing runtime sql for node "model.legal_demo.acris_cases"
[0m02:38:41.696665 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m02:38:41.698205 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: BEGIN
[0m02:38:41.699839 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:38:41.725067 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:38:41.727075 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m02:38:41.729005 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */

  
    
    

    create  table
      "legal_demo"."main"."acris_clean__dbt_tmp"
  
    as (
      --
-- This model loads the already‑downloaded CSV into DuckDB and
-- materializes it as a table named `acris_clean`.  Because the
-- pipeline does not download data, the file must exist under
-- `data/first_500k_acris.csv` prior to running `dbt run`.  The
-- absolute path points at `/opt/airflow/data/first_500k_acris.csv` when
-- executed inside the Airflow containers.  Locally, dbt resolves
-- relative paths against the project root, so this model continues to
-- work outside of Docker.



SELECT *
FROM read_csv_auto('/opt/airflow/data/first_500k_acris.csv', header=True, delim=',')
    );
  
  
[0m02:38:44.783107 [debug] [Thread-1 (]: SQL status: OK in 3.0 seconds
[0m02:38:44.792780 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m02:38:44.795037 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
alter table "legal_demo"."main"."acris_clean" rename to "acris_clean__dbt_backup"
[0m02:38:44.797969 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:38:44.802993 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m02:38:44.805243 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
alter table "legal_demo"."main"."acris_clean__dbt_tmp" rename to "acris_clean"
[0m02:38:44.808018 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:38:44.832524 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: COMMIT
[0m02:38:44.835120 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m02:38:44.884018 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: COMMIT
[0m02:38:44.914365 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:38:44.925195 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m02:38:44.927107 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
drop table if exists "legal_demo"."main"."acris_clean__dbt_backup" cascade
[0m02:38:44.935140 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:38:44.939032 [debug] [Thread-1 (]: Timing info for model.legal_demo.acris_cases (execute): 02:38:41.646329 => 02:38:44.938474
[0m02:38:44.942067 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: Close
[0m02:38:45.019526 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8915698e-837b-482b-8f6b-be70ce853288', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c880831cd50>]}
[0m02:38:45.022689 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main.acris_clean ............................. [[32mOK[0m in 3.40s]
[0m02:38:45.025413 [debug] [Thread-1 (]: Finished running node model.legal_demo.acris_cases
[0m02:38:45.030835 [debug] [MainThread]: Using duckdb connection "master"
[0m02:38:45.032587 [debug] [MainThread]: On master: BEGIN
[0m02:38:45.033954 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:38:45.103665 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m02:38:45.106138 [debug] [MainThread]: On master: COMMIT
[0m02:38:45.107952 [debug] [MainThread]: Using duckdb connection "master"
[0m02:38:45.109750 [debug] [MainThread]: On master: COMMIT
[0m02:38:45.112412 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m02:38:45.114059 [debug] [MainThread]: On master: Close
[0m02:38:45.119740 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:38:45.121654 [debug] [MainThread]: Connection 'list_legal_demo_main' was properly closed.
[0m02:38:45.123398 [debug] [MainThread]: Connection 'model.legal_demo.acris_cases' was properly closed.
[0m02:38:45.125181 [info ] [MainThread]: 
[0m02:38:45.126731 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.81 seconds (3.81s).
[0m02:38:45.128673 [debug] [MainThread]: Command end result
[0m02:38:45.165824 [info ] [MainThread]: 
[0m02:38:45.167921 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:38:45.169805 [info ] [MainThread]: 
[0m02:38:45.171506 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m02:38:45.175168 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.8290806, "process_user_time": 8.704366, "process_kernel_time": 1.651805, "process_mem_max_rss": "300224", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m02:38:45.177255 [debug] [MainThread]: Command `dbt run` succeeded at 02:38:45.177013 after 4.83 seconds
[0m02:38:45.179119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c880b4dd250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c88102674d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c880b551150>]}
[0m02:38:45.180992 [debug] [MainThread]: Flushing usage events
[0m02:41:05.802032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c49ff114ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c49fea318d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c49fe617310>]}


============================== 02:41:05.811567 | d2c300dd-2200-428a-a54f-96db9c9d6068 ==============================
[0m02:41:05.811567 [info ] [MainThread]: Running with dbt=1.7.4
[0m02:41:05.813798 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '.', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir .', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m02:41:06.253025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd2c300dd-2200-428a-a54f-96db9c9d6068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c49f4e01650>]}
[0m02:41:06.367003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd2c300dd-2200-428a-a54f-96db9c9d6068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c49fedf23d0>]}
[0m02:41:06.370136 [info ] [MainThread]: Registered adapter: duckdb=1.7.4
[0m02:41:06.391819 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m02:41:06.484774 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:41:06.486799 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:41:06.495140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd2c300dd-2200-428a-a54f-96db9c9d6068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c49f4cfe210>]}
[0m02:41:06.540062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd2c300dd-2200-428a-a54f-96db9c9d6068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c49fe668ad0>]}
[0m02:41:06.541986 [info ] [MainThread]: Found 1 model, 0 sources, 0 exposures, 0 metrics, 394 macros, 0 groups, 0 semantic models
[0m02:41:06.543953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd2c300dd-2200-428a-a54f-96db9c9d6068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c4a01f732d0>]}
[0m02:41:06.547377 [info ] [MainThread]: 
[0m02:41:06.550131 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m02:41:06.553622 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_legal_demo'
[0m02:41:06.572448 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo"
[0m02:41:06.574975 [debug] [ThreadPool]: On list_legal_demo: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"legal_demo"'
    
  
  
[0m02:41:06.576621 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:41:06.611327 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:41:06.614867 [debug] [ThreadPool]: On list_legal_demo: Close
[0m02:41:06.624195 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_legal_demo, now create_legal_demo_main)
[0m02:41:06.626597 [debug] [ThreadPool]: Creating schema "database: "legal_demo"
schema: "main"
"
[0m02:41:06.636351 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m02:41:06.638469 [debug] [ThreadPool]: On create_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "create_legal_demo_main"} */

    
        select type from duckdb_databases()
        where database_name='legal_demo'
        and type='sqlite'
    
  
[0m02:41:06.640899 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:41:06.669992 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:41:06.672987 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m02:41:06.674892 [debug] [ThreadPool]: On create_legal_demo_main: BEGIN
[0m02:41:06.677113 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:41:06.678823 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m02:41:06.680489 [debug] [ThreadPool]: On create_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "create_legal_demo_main"} */

    
    
        create schema if not exists "legal_demo"."main"
    
[0m02:41:06.683538 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:41:06.686441 [debug] [ThreadPool]: On create_legal_demo_main: COMMIT
[0m02:41:06.688297 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m02:41:06.690181 [debug] [ThreadPool]: On create_legal_demo_main: COMMIT
[0m02:41:06.693513 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:41:06.695356 [debug] [ThreadPool]: On create_legal_demo_main: Close
[0m02:41:06.708147 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_legal_demo_main, now list_legal_demo_main)
[0m02:41:06.717015 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo_main"
[0m02:41:06.719193 [debug] [ThreadPool]: On list_legal_demo_main: BEGIN
[0m02:41:06.720786 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:41:06.744743 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:41:06.746601 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo_main"
[0m02:41:06.748249 [debug] [ThreadPool]: On list_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo_main"} */
select
      'legal_demo' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'legal_demo'
  
[0m02:41:06.781987 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:41:06.792534 [debug] [ThreadPool]: On list_legal_demo_main: ROLLBACK
[0m02:41:06.795260 [debug] [ThreadPool]: Failed to rollback 'list_legal_demo_main'
[0m02:41:06.796976 [debug] [ThreadPool]: On list_legal_demo_main: Close
[0m02:41:06.804669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd2c300dd-2200-428a-a54f-96db9c9d6068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c49fe609910>]}
[0m02:41:06.806828 [debug] [MainThread]: Using duckdb connection "master"
[0m02:41:06.808315 [debug] [MainThread]: On master: BEGIN
[0m02:41:06.809554 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:41:06.873142 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m02:41:06.874971 [debug] [MainThread]: On master: COMMIT
[0m02:41:06.876467 [debug] [MainThread]: Using duckdb connection "master"
[0m02:41:06.877928 [debug] [MainThread]: On master: COMMIT
[0m02:41:06.879936 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m02:41:06.881342 [debug] [MainThread]: On master: Close
[0m02:41:06.886255 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:41:06.887992 [info ] [MainThread]: 
[0m02:41:06.900678 [debug] [Thread-1 (]: Began running node model.legal_demo.acris_cases
[0m02:41:06.903029 [info ] [Thread-1 (]: 1 of 1 START sql table model main.acris_clean .................................. [RUN]
[0m02:41:06.905551 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.legal_demo.acris_cases'
[0m02:41:06.907610 [debug] [Thread-1 (]: Began compiling node model.legal_demo.acris_cases
[0m02:41:06.917204 [debug] [Thread-1 (]: Writing injected SQL for node "model.legal_demo.acris_cases"
[0m02:41:06.929495 [debug] [Thread-1 (]: Timing info for model.legal_demo.acris_cases (compile): 02:41:06.909218 => 02:41:06.929030
[0m02:41:06.930992 [debug] [Thread-1 (]: Began executing node model.legal_demo.acris_cases
[0m02:41:06.976265 [debug] [Thread-1 (]: Writing runtime sql for node "model.legal_demo.acris_cases"
[0m02:41:06.991008 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m02:41:06.992959 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: BEGIN
[0m02:41:06.994515 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:41:07.023222 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:41:07.025375 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m02:41:07.026901 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */

  
    
    

    create  table
      "legal_demo"."main"."acris_clean__dbt_tmp"
  
    as (
      --
-- This model loads the already‑downloaded CSV into DuckDB and
-- materializes it as a table named `acris_clean`.  Because the
-- pipeline does not download data, the file must exist under
-- `data/first_500k_acris.csv` prior to running `dbt run`.  The
-- absolute path points at `/opt/airflow/data/first_500k_acris.csv` when
-- executed inside the Airflow containers.  Locally, dbt resolves
-- relative paths against the project root, so this model continues to
-- work outside of Docker.



SELECT *
FROM read_csv_auto('/opt/airflow/data/first_500k_acris.csv', header=True, delim=',')
    );
  
  
[0m02:41:09.434496 [debug] [Thread-1 (]: SQL status: OK in 2.0 seconds
[0m02:41:09.444832 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m02:41:09.447207 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
alter table "legal_demo"."main"."acris_clean" rename to "acris_clean__dbt_backup"
[0m02:41:09.450275 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:41:09.455926 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m02:41:09.458053 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
alter table "legal_demo"."main"."acris_clean__dbt_tmp" rename to "acris_clean"
[0m02:41:09.460692 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:41:09.485560 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: COMMIT
[0m02:41:09.488046 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m02:41:09.489871 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: COMMIT
[0m02:41:09.567358 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:41:09.577578 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m02:41:09.580025 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
drop table if exists "legal_demo"."main"."acris_clean__dbt_backup" cascade
[0m02:41:09.598148 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:41:09.602661 [debug] [Thread-1 (]: Timing info for model.legal_demo.acris_cases (execute): 02:41:06.932137 => 02:41:09.602311
[0m02:41:09.604885 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: Close
[0m02:41:09.678093 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2c300dd-2200-428a-a54f-96db9c9d6068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c49f4d92590>]}
[0m02:41:09.682076 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main.acris_clean ............................. [[32mOK[0m in 2.77s]
[0m02:41:09.685101 [debug] [Thread-1 (]: Finished running node model.legal_demo.acris_cases
[0m02:41:09.691163 [debug] [MainThread]: Using duckdb connection "master"
[0m02:41:09.693203 [debug] [MainThread]: On master: BEGIN
[0m02:41:09.694720 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:41:09.720601 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m02:41:09.722780 [debug] [MainThread]: On master: COMMIT
[0m02:41:09.724542 [debug] [MainThread]: Using duckdb connection "master"
[0m02:41:09.726213 [debug] [MainThread]: On master: COMMIT
[0m02:41:09.728306 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m02:41:09.729842 [debug] [MainThread]: On master: Close
[0m02:41:09.737527 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:41:09.739651 [debug] [MainThread]: Connection 'list_legal_demo_main' was properly closed.
[0m02:41:09.741198 [debug] [MainThread]: Connection 'model.legal_demo.acris_cases' was properly closed.
[0m02:41:09.742602 [info ] [MainThread]: 
[0m02:41:09.744466 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.19 seconds (3.19s).
[0m02:41:09.746866 [debug] [MainThread]: Command end result
[0m02:41:09.790966 [info ] [MainThread]: 
[0m02:41:09.793287 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:41:09.795096 [info ] [MainThread]: 
[0m02:41:09.796921 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m02:41:09.840564 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.1077414, "process_user_time": 7.683434, "process_kernel_time": 1.379285, "process_mem_max_rss": "299284", "process_in_blocks": "1216", "process_out_blocks": "0"}
[0m02:41:09.843786 [debug] [MainThread]: Command `dbt run` succeeded at 02:41:09.843512 after 4.11 seconds
[0m02:41:09.845773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c49fed611d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c4a0341d310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c4a03402690>]}
[0m02:41:09.847822 [debug] [MainThread]: Flushing usage events
[0m02:50:32.448422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x792389762410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x792389762d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7923897212d0>]}


============================== 02:50:32.457191 | 5e3f4b6b-2a93-433c-ab89-7d3c58bc56dc ==============================
[0m02:50:32.457191 [info ] [MainThread]: Running with dbt=1.7.4
[0m02:50:32.459698 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '.', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir .', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:50:32.829564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5e3f4b6b-2a93-433c-ab89-7d3c58bc56dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7923892d7610>]}
[0m02:50:32.938315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5e3f4b6b-2a93-433c-ab89-7d3c58bc56dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7923897de590>]}
[0m02:50:32.941186 [info ] [MainThread]: Registered adapter: duckdb=1.7.4
[0m02:50:32.962317 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m02:50:33.056588 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:50:33.060031 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:50:33.070030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5e3f4b6b-2a93-433c-ab89-7d3c58bc56dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79238903c690>]}
[0m02:50:33.118928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5e3f4b6b-2a93-433c-ab89-7d3c58bc56dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79238974d910>]}
[0m02:50:33.120962 [info ] [MainThread]: Found 1 model, 0 sources, 0 exposures, 0 metrics, 394 macros, 0 groups, 0 semantic models
[0m02:50:33.122644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5e3f4b6b-2a93-433c-ab89-7d3c58bc56dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x792389738950>]}
[0m02:50:33.126002 [info ] [MainThread]: 
[0m02:50:33.128782 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m02:50:33.131999 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_legal_demo'
[0m02:50:33.148402 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo"
[0m02:50:33.150253 [debug] [ThreadPool]: On list_legal_demo: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"legal_demo"'
    
  
  
[0m02:50:33.151850 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:50:33.185945 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:50:33.189619 [debug] [ThreadPool]: On list_legal_demo: Close
[0m02:50:33.200025 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_legal_demo, now create_legal_demo_main)
[0m02:50:33.202182 [debug] [ThreadPool]: Creating schema "database: "legal_demo"
schema: "main"
"
[0m02:50:33.211524 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m02:50:33.213441 [debug] [ThreadPool]: On create_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "create_legal_demo_main"} */

    
        select type from duckdb_databases()
        where database_name='legal_demo'
        and type='sqlite'
    
  
[0m02:50:33.214898 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:50:33.243819 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:50:33.247538 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m02:50:33.249243 [debug] [ThreadPool]: On create_legal_demo_main: BEGIN
[0m02:50:33.251622 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:50:33.253301 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m02:50:33.254813 [debug] [ThreadPool]: On create_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "create_legal_demo_main"} */

    
    
        create schema if not exists "legal_demo"."main"
    
[0m02:50:33.256906 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:50:33.259725 [debug] [ThreadPool]: On create_legal_demo_main: COMMIT
[0m02:50:33.261642 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m02:50:33.263403 [debug] [ThreadPool]: On create_legal_demo_main: COMMIT
[0m02:50:33.266784 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:50:33.268659 [debug] [ThreadPool]: On create_legal_demo_main: Close
[0m02:50:33.284605 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_legal_demo_main, now list_legal_demo_main)
[0m02:50:33.294629 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo_main"
[0m02:50:33.296939 [debug] [ThreadPool]: On list_legal_demo_main: BEGIN
[0m02:50:33.298551 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:50:33.323501 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:50:33.326800 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo_main"
[0m02:50:33.330573 [debug] [ThreadPool]: On list_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo_main"} */
select
      'legal_demo' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'legal_demo'
  
[0m02:50:33.369342 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:50:33.379768 [debug] [ThreadPool]: On list_legal_demo_main: ROLLBACK
[0m02:50:33.382431 [debug] [ThreadPool]: Failed to rollback 'list_legal_demo_main'
[0m02:50:33.384226 [debug] [ThreadPool]: On list_legal_demo_main: Close
[0m02:50:33.391413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5e3f4b6b-2a93-433c-ab89-7d3c58bc56dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79237fe29610>]}
[0m02:50:33.393148 [debug] [MainThread]: Using duckdb connection "master"
[0m02:50:33.394743 [debug] [MainThread]: On master: BEGIN
[0m02:50:33.396456 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:50:33.418677 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m02:50:33.420457 [debug] [MainThread]: On master: COMMIT
[0m02:50:33.421845 [debug] [MainThread]: Using duckdb connection "master"
[0m02:50:33.423277 [debug] [MainThread]: On master: COMMIT
[0m02:50:33.425172 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m02:50:33.426781 [debug] [MainThread]: On master: Close
[0m02:50:33.431861 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:50:33.433914 [info ] [MainThread]: 
[0m02:50:33.447313 [debug] [Thread-1 (]: Began running node model.legal_demo.acris_cases
[0m02:50:33.449301 [info ] [Thread-1 (]: 1 of 1 START sql table model main.acris_clean .................................. [RUN]
[0m02:50:33.451715 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.legal_demo.acris_cases'
[0m02:50:33.453411 [debug] [Thread-1 (]: Began compiling node model.legal_demo.acris_cases
[0m02:50:33.463463 [debug] [Thread-1 (]: Writing injected SQL for node "model.legal_demo.acris_cases"
[0m02:50:33.477950 [debug] [Thread-1 (]: Timing info for model.legal_demo.acris_cases (compile): 02:50:33.455080 => 02:50:33.477279
[0m02:50:33.479936 [debug] [Thread-1 (]: Began executing node model.legal_demo.acris_cases
[0m02:50:33.518741 [debug] [Thread-1 (]: Writing runtime sql for node "model.legal_demo.acris_cases"
[0m02:50:33.534827 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m02:50:33.536778 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: BEGIN
[0m02:50:33.538455 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:50:33.566674 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:50:33.569110 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m02:50:33.570859 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */

  
    
    

    create  table
      "legal_demo"."main"."acris_clean__dbt_tmp"
  
    as (
      --
-- This model loads the already‑downloaded CSV into DuckDB and
-- materializes it as a table named `acris_clean`.  Because the
-- pipeline does not download data, the file must exist under
-- `data/first_500k_acris.csv` prior to running `dbt run`.  The
-- absolute path points at `/opt/airflow/data/first_500k_acris.csv` when
-- executed inside the Airflow containers.  Locally, dbt resolves
-- relative paths against the project root, so this model continues to
-- work outside of Docker.



SELECT *
FROM read_csv_auto('/opt/airflow/data/first_500k_acris.csv', header=True, delim=',')
    );
  
  
[0m02:50:36.117863 [debug] [Thread-1 (]: SQL status: OK in 3.0 seconds
[0m02:50:36.128008 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m02:50:36.129974 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
alter table "legal_demo"."main"."acris_clean" rename to "acris_clean__dbt_backup"
[0m02:50:36.133158 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:50:36.138436 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m02:50:36.139943 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
alter table "legal_demo"."main"."acris_clean__dbt_tmp" rename to "acris_clean"
[0m02:50:36.142109 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:50:36.169044 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: COMMIT
[0m02:50:36.171036 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m02:50:36.172443 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: COMMIT
[0m02:50:36.244039 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:50:36.252698 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m02:50:36.254774 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
drop table if exists "legal_demo"."main"."acris_clean__dbt_backup" cascade
[0m02:50:36.263095 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:50:36.266981 [debug] [Thread-1 (]: Timing info for model.legal_demo.acris_cases (execute): 02:50:33.481424 => 02:50:36.266609
[0m02:50:36.269065 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: Close
[0m02:50:36.336263 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e3f4b6b-2a93-433c-ab89-7d3c58bc56dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79237fd65010>]}
[0m02:50:36.338934 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main.acris_clean ............................. [[32mOK[0m in 2.89s]
[0m02:50:36.341275 [debug] [Thread-1 (]: Finished running node model.legal_demo.acris_cases
[0m02:50:36.346138 [debug] [MainThread]: Using duckdb connection "master"
[0m02:50:36.347933 [debug] [MainThread]: On master: BEGIN
[0m02:50:36.349663 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:50:36.372828 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m02:50:36.374777 [debug] [MainThread]: On master: COMMIT
[0m02:50:36.376557 [debug] [MainThread]: Using duckdb connection "master"
[0m02:50:36.378205 [debug] [MainThread]: On master: COMMIT
[0m02:50:36.380635 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m02:50:36.382307 [debug] [MainThread]: On master: Close
[0m02:50:36.387290 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:50:36.389053 [debug] [MainThread]: Connection 'list_legal_demo_main' was properly closed.
[0m02:50:36.390560 [debug] [MainThread]: Connection 'model.legal_demo.acris_cases' was properly closed.
[0m02:50:36.392362 [info ] [MainThread]: 
[0m02:50:36.394340 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.26 seconds (3.26s).
[0m02:50:36.396496 [debug] [MainThread]: Command end result
[0m02:50:36.435182 [info ] [MainThread]: 
[0m02:50:36.437009 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:50:36.438490 [info ] [MainThread]: 
[0m02:50:36.440048 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m02:50:36.442559 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.0700703, "process_user_time": 7.741142, "process_kernel_time": 1.503878, "process_mem_max_rss": "298384", "process_in_blocks": "280", "process_out_blocks": "0"}
[0m02:50:36.445085 [debug] [MainThread]: Command `dbt run` succeeded at 02:50:36.444848 after 4.07 seconds
[0m02:50:36.447645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x792389be3f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79238de52b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79238dd0c510>]}
[0m02:50:36.449528 [debug] [MainThread]: Flushing usage events
[0m02:53:30.635515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd89b428390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd89b428a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd89fa7b4d0>]}


============================== 02:53:30.645963 | 9d633be7-2c4a-4de3-b4d8-2c7ed6c31a17 ==============================
[0m02:53:30.645963 [info ] [MainThread]: Running with dbt=1.7.4
[0m02:53:30.648283 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '.', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir .', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m02:53:31.089879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9d633be7-2c4a-4de3-b4d8-2c7ed6c31a17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd897abde50>]}
[0m02:53:31.197983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9d633be7-2c4a-4de3-b4d8-2c7ed6c31a17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd89b0747d0>]}
[0m02:53:31.200443 [info ] [MainThread]: Registered adapter: duckdb=1.7.4
[0m02:53:31.221725 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m02:53:31.318721 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:53:31.320148 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:53:31.327146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9d633be7-2c4a-4de3-b4d8-2c7ed6c31a17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd891b7e350>]}
[0m02:53:31.396093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9d633be7-2c4a-4de3-b4d8-2c7ed6c31a17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd897b58050>]}
[0m02:53:31.398997 [info ] [MainThread]: Found 1 model, 0 sources, 0 exposures, 0 metrics, 394 macros, 0 groups, 0 semantic models
[0m02:53:31.401817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d633be7-2c4a-4de3-b4d8-2c7ed6c31a17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd89e5f37d0>]}
[0m02:53:31.407159 [info ] [MainThread]: 
[0m02:53:31.409561 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m02:53:31.412779 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_legal_demo'
[0m02:53:31.428627 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo"
[0m02:53:31.430204 [debug] [ThreadPool]: On list_legal_demo: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"legal_demo"'
    
  
  
[0m02:53:31.431709 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:53:31.471960 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:53:31.480319 [debug] [ThreadPool]: On list_legal_demo: Close
[0m02:53:31.493876 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_legal_demo, now create_legal_demo_main)
[0m02:53:31.496063 [debug] [ThreadPool]: Creating schema "database: "legal_demo"
schema: "main"
"
[0m02:53:31.508699 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m02:53:31.516980 [debug] [ThreadPool]: On create_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "create_legal_demo_main"} */

    
        select type from duckdb_databases()
        where database_name='legal_demo'
        and type='sqlite'
    
  
[0m02:53:31.520140 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:53:31.543300 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:53:31.546565 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m02:53:31.548483 [debug] [ThreadPool]: On create_legal_demo_main: BEGIN
[0m02:53:31.550589 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:53:31.552327 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m02:53:31.554016 [debug] [ThreadPool]: On create_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "create_legal_demo_main"} */

    
    
        create schema if not exists "legal_demo"."main"
    
[0m02:53:31.556346 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:53:31.558467 [debug] [ThreadPool]: On create_legal_demo_main: COMMIT
[0m02:53:31.559832 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m02:53:31.561395 [debug] [ThreadPool]: On create_legal_demo_main: COMMIT
[0m02:53:31.565083 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:53:31.566688 [debug] [ThreadPool]: On create_legal_demo_main: Close
[0m02:53:31.576746 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_legal_demo_main, now list_legal_demo_main)
[0m02:53:31.586910 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo_main"
[0m02:53:31.588619 [debug] [ThreadPool]: On list_legal_demo_main: BEGIN
[0m02:53:31.589882 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:53:31.609322 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:53:31.610870 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo_main"
[0m02:53:31.612215 [debug] [ThreadPool]: On list_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo_main"} */
select
      'legal_demo' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'legal_demo'
  
[0m02:53:31.638828 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:53:31.645449 [debug] [ThreadPool]: On list_legal_demo_main: ROLLBACK
[0m02:53:31.647684 [debug] [ThreadPool]: Failed to rollback 'list_legal_demo_main'
[0m02:53:31.649145 [debug] [ThreadPool]: On list_legal_demo_main: Close
[0m02:53:31.656637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d633be7-2c4a-4de3-b4d8-2c7ed6c31a17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd89afb7690>]}
[0m02:53:31.658688 [debug] [MainThread]: Using duckdb connection "master"
[0m02:53:31.660242 [debug] [MainThread]: On master: BEGIN
[0m02:53:31.661743 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:53:31.683924 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m02:53:31.685854 [debug] [MainThread]: On master: COMMIT
[0m02:53:31.687429 [debug] [MainThread]: Using duckdb connection "master"
[0m02:53:31.688740 [debug] [MainThread]: On master: COMMIT
[0m02:53:31.691028 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m02:53:31.692721 [debug] [MainThread]: On master: Close
[0m02:53:31.697443 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:53:31.699149 [info ] [MainThread]: 
[0m02:53:31.711072 [debug] [Thread-1 (]: Began running node model.legal_demo.acris_cases
[0m02:53:31.713063 [info ] [Thread-1 (]: 1 of 1 START sql table model main.acris_clean .................................. [RUN]
[0m02:53:31.715462 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.legal_demo.acris_cases'
[0m02:53:31.717103 [debug] [Thread-1 (]: Began compiling node model.legal_demo.acris_cases
[0m02:53:31.726778 [debug] [Thread-1 (]: Writing injected SQL for node "model.legal_demo.acris_cases"
[0m02:53:31.738088 [debug] [Thread-1 (]: Timing info for model.legal_demo.acris_cases (compile): 02:53:31.718692 => 02:53:31.737598
[0m02:53:31.739637 [debug] [Thread-1 (]: Began executing node model.legal_demo.acris_cases
[0m02:53:31.779959 [debug] [Thread-1 (]: Writing runtime sql for node "model.legal_demo.acris_cases"
[0m02:53:31.792836 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m02:53:31.794393 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: BEGIN
[0m02:53:31.795771 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:53:31.819778 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:53:31.821527 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m02:53:31.822978 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */

  
    
    

    create  table
      "legal_demo"."main"."acris_clean__dbt_tmp"
  
    as (
      --
-- This model loads the already‑downloaded CSV into DuckDB and
-- materializes it as a table named `acris_clean`.  Because the
-- pipeline does not download data, the file must exist under
-- `data/first_500k_acris.csv` prior to running `dbt run`.  The
-- absolute path points at `/opt/airflow/data/first_500k_acris.csv` when
-- executed inside the Airflow containers.  Locally, dbt resolves
-- relative paths against the project root, so this model continues to
-- work outside of Docker.



SELECT *
FROM read_csv_auto('/opt/airflow/data/first_500k_acris.csv', header=True, delim=',')
    );
  
  
[0m02:53:34.300976 [debug] [Thread-1 (]: SQL status: OK in 2.0 seconds
[0m02:53:34.317254 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m02:53:34.319867 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
alter table "legal_demo"."main"."acris_clean" rename to "acris_clean__dbt_backup"
[0m02:53:34.322690 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:53:34.328078 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m02:53:34.330070 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
alter table "legal_demo"."main"."acris_clean__dbt_tmp" rename to "acris_clean"
[0m02:53:34.332582 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:53:34.358422 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: COMMIT
[0m02:53:34.361007 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m02:53:34.362797 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: COMMIT
[0m02:53:34.433830 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:53:34.444557 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m02:53:34.446535 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
drop table if exists "legal_demo"."main"."acris_clean__dbt_backup" cascade
[0m02:53:34.454945 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:53:34.459156 [debug] [Thread-1 (]: Timing info for model.legal_demo.acris_cases (execute): 02:53:31.740826 => 02:53:34.458697
[0m02:53:34.460941 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: Close
[0m02:53:34.531754 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d633be7-2c4a-4de3-b4d8-2c7ed6c31a17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd89b451c10>]}
[0m02:53:34.534829 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main.acris_clean ............................. [[32mOK[0m in 2.82s]
[0m02:53:34.537498 [debug] [Thread-1 (]: Finished running node model.legal_demo.acris_cases
[0m02:53:34.542757 [debug] [MainThread]: Using duckdb connection "master"
[0m02:53:34.544758 [debug] [MainThread]: On master: BEGIN
[0m02:53:34.546295 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:53:34.570283 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m02:53:34.572112 [debug] [MainThread]: On master: COMMIT
[0m02:53:34.573691 [debug] [MainThread]: Using duckdb connection "master"
[0m02:53:34.575229 [debug] [MainThread]: On master: COMMIT
[0m02:53:34.577028 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m02:53:34.578595 [debug] [MainThread]: On master: Close
[0m02:53:34.583393 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:53:34.585367 [debug] [MainThread]: Connection 'list_legal_demo_main' was properly closed.
[0m02:53:34.586962 [debug] [MainThread]: Connection 'model.legal_demo.acris_cases' was properly closed.
[0m02:53:34.588736 [info ] [MainThread]: 
[0m02:53:34.590375 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.18 seconds (3.18s).
[0m02:53:34.592638 [debug] [MainThread]: Command end result
[0m02:53:34.630596 [info ] [MainThread]: 
[0m02:53:34.632776 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:53:34.634461 [info ] [MainThread]: 
[0m02:53:34.636187 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m02:53:34.639464 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.1230597, "process_user_time": 7.494413, "process_kernel_time": 1.179527, "process_mem_max_rss": "299648", "process_in_blocks": "7240", "process_out_blocks": "0"}
[0m02:53:34.641830 [debug] [MainThread]: Command `dbt run` succeeded at 02:53:34.641558 after 4.13 seconds
[0m02:53:34.643711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd89b105090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd89f8d3550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd89fb4ad10>]}
[0m02:53:34.645248 [debug] [MainThread]: Flushing usage events
[0m02:55:28.980686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71bd3e53bf90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71bd3e90d5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71bd3e5f8750>]}


============================== 02:55:28.989586 | d9712428-6bb6-4170-92c5-df1f4b8737cf ==============================
[0m02:55:28.989586 [info ] [MainThread]: Running with dbt=1.7.4
[0m02:55:28.992076 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '.', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir .', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m02:55:29.355875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd9712428-6bb6-4170-92c5-df1f4b8737cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71bd3461ed10>]}
[0m02:55:29.455666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd9712428-6bb6-4170-92c5-df1f4b8737cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71bd346f1090>]}
[0m02:55:29.459121 [info ] [MainThread]: Registered adapter: duckdb=1.7.4
[0m02:55:29.480152 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m02:55:29.560738 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:55:29.563323 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:55:29.615526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd9712428-6bb6-4170-92c5-df1f4b8737cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71bd34681310>]}
[0m02:55:29.666070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd9712428-6bb6-4170-92c5-df1f4b8737cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71bd346c7850>]}
[0m02:55:29.667744 [info ] [MainThread]: Found 1 model, 0 sources, 0 exposures, 0 metrics, 394 macros, 0 groups, 0 semantic models
[0m02:55:29.669515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd9712428-6bb6-4170-92c5-df1f4b8737cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71bd347f3990>]}
[0m02:55:29.673564 [info ] [MainThread]: 
[0m02:55:29.676238 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m02:55:29.679319 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_legal_demo'
[0m02:55:29.695487 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo"
[0m02:55:29.697586 [debug] [ThreadPool]: On list_legal_demo: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"legal_demo"'
    
  
  
[0m02:55:29.699321 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:55:29.730772 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:55:29.734563 [debug] [ThreadPool]: On list_legal_demo: Close
[0m02:55:29.744352 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_legal_demo, now create_legal_demo_main)
[0m02:55:29.746909 [debug] [ThreadPool]: Creating schema "database: "legal_demo"
schema: "main"
"
[0m02:55:29.755866 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m02:55:29.757680 [debug] [ThreadPool]: On create_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "create_legal_demo_main"} */

    
        select type from duckdb_databases()
        where database_name='legal_demo'
        and type='sqlite'
    
  
[0m02:55:29.760309 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:55:29.787526 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:55:29.790300 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m02:55:29.791924 [debug] [ThreadPool]: On create_legal_demo_main: BEGIN
[0m02:55:29.794239 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:55:29.795650 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m02:55:29.797280 [debug] [ThreadPool]: On create_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "create_legal_demo_main"} */

    
    
        create schema if not exists "legal_demo"."main"
    
[0m02:55:29.799177 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:55:29.801580 [debug] [ThreadPool]: On create_legal_demo_main: COMMIT
[0m02:55:29.803331 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m02:55:29.804849 [debug] [ThreadPool]: On create_legal_demo_main: COMMIT
[0m02:55:29.807829 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:55:29.809409 [debug] [ThreadPool]: On create_legal_demo_main: Close
[0m02:55:29.819470 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_legal_demo_main, now list_legal_demo_main)
[0m02:55:29.827057 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo_main"
[0m02:55:29.828721 [debug] [ThreadPool]: On list_legal_demo_main: BEGIN
[0m02:55:29.830644 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:55:29.852805 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:55:29.854557 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo_main"
[0m02:55:29.855992 [debug] [ThreadPool]: On list_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo_main"} */
select
      'legal_demo' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'legal_demo'
  
[0m02:55:29.883336 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:55:29.890335 [debug] [ThreadPool]: On list_legal_demo_main: ROLLBACK
[0m02:55:29.892492 [debug] [ThreadPool]: Failed to rollback 'list_legal_demo_main'
[0m02:55:29.894157 [debug] [ThreadPool]: On list_legal_demo_main: Close
[0m02:55:29.900998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd9712428-6bb6-4170-92c5-df1f4b8737cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71bd3e547390>]}
[0m02:55:29.902717 [debug] [MainThread]: Using duckdb connection "master"
[0m02:55:29.904062 [debug] [MainThread]: On master: BEGIN
[0m02:55:29.905429 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:55:29.926810 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m02:55:29.928509 [debug] [MainThread]: On master: COMMIT
[0m02:55:29.930043 [debug] [MainThread]: Using duckdb connection "master"
[0m02:55:29.931463 [debug] [MainThread]: On master: COMMIT
[0m02:55:29.933310 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m02:55:29.934814 [debug] [MainThread]: On master: Close
[0m02:55:29.939423 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:55:29.941570 [info ] [MainThread]: 
[0m02:55:29.954255 [debug] [Thread-1 (]: Began running node model.legal_demo.acris_cases
[0m02:55:29.956111 [info ] [Thread-1 (]: 1 of 1 START sql table model main.acris_clean .................................. [RUN]
[0m02:55:29.958658 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.legal_demo.acris_cases'
[0m02:55:29.960141 [debug] [Thread-1 (]: Began compiling node model.legal_demo.acris_cases
[0m02:55:29.969229 [debug] [Thread-1 (]: Writing injected SQL for node "model.legal_demo.acris_cases"
[0m02:55:29.982818 [debug] [Thread-1 (]: Timing info for model.legal_demo.acris_cases (compile): 02:55:29.961266 => 02:55:29.982331
[0m02:55:29.984441 [debug] [Thread-1 (]: Began executing node model.legal_demo.acris_cases
[0m02:55:30.024957 [debug] [Thread-1 (]: Writing runtime sql for node "model.legal_demo.acris_cases"
[0m02:55:30.037815 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m02:55:30.039377 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: BEGIN
[0m02:55:30.040840 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:55:30.069188 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:55:30.071340 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m02:55:30.073418 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */

  
    
    

    create  table
      "legal_demo"."main"."acris_clean__dbt_tmp"
  
    as (
      --
-- This model loads the already‑downloaded CSV into DuckDB and
-- materializes it as a table named `acris_clean`.  Because the
-- pipeline does not download data, the file must exist under
-- `data/first_500k_acris.csv` prior to running `dbt run`.  The
-- absolute path points at `/opt/airflow/data/first_500k_acris.csv` when
-- executed inside the Airflow containers.  Locally, dbt resolves
-- relative paths against the project root, so this model continues to
-- work outside of Docker.



SELECT *
FROM read_csv_auto('/opt/airflow/data/first_500k_acris.csv', header=True, delim=',')
    );
  
  
[0m02:55:32.522688 [debug] [Thread-1 (]: SQL status: OK in 2.0 seconds
[0m02:55:32.531980 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m02:55:32.534016 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
alter table "legal_demo"."main"."acris_clean" rename to "acris_clean__dbt_backup"
[0m02:55:32.536520 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:55:32.541583 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m02:55:32.543554 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
alter table "legal_demo"."main"."acris_clean__dbt_tmp" rename to "acris_clean"
[0m02:55:32.546342 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:55:32.583367 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: COMMIT
[0m02:55:32.585252 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m02:55:32.586907 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: COMMIT
[0m02:55:32.657307 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:55:32.665235 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m02:55:32.667606 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
drop table if exists "legal_demo"."main"."acris_clean__dbt_backup" cascade
[0m02:55:32.676072 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:55:32.679414 [debug] [Thread-1 (]: Timing info for model.legal_demo.acris_cases (execute): 02:55:29.985682 => 02:55:32.679155
[0m02:55:32.681542 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: Close
[0m02:55:32.750289 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9712428-6bb6-4170-92c5-df1f4b8737cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71bd3de79750>]}
[0m02:55:32.752888 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main.acris_clean ............................. [[32mOK[0m in 2.79s]
[0m02:55:32.755340 [debug] [Thread-1 (]: Finished running node model.legal_demo.acris_cases
[0m02:55:32.760483 [debug] [MainThread]: Using duckdb connection "master"
[0m02:55:32.762427 [debug] [MainThread]: On master: BEGIN
[0m02:55:32.764005 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:55:32.785975 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m02:55:32.787909 [debug] [MainThread]: On master: COMMIT
[0m02:55:32.789300 [debug] [MainThread]: Using duckdb connection "master"
[0m02:55:32.790914 [debug] [MainThread]: On master: COMMIT
[0m02:55:32.792612 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m02:55:32.794012 [debug] [MainThread]: On master: Close
[0m02:55:32.798547 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:55:32.800295 [debug] [MainThread]: Connection 'list_legal_demo_main' was properly closed.
[0m02:55:32.801701 [debug] [MainThread]: Connection 'model.legal_demo.acris_cases' was properly closed.
[0m02:55:32.803541 [info ] [MainThread]: 
[0m02:55:32.805326 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.13 seconds (3.13s).
[0m02:55:32.807495 [debug] [MainThread]: Command end result
[0m02:55:32.842463 [info ] [MainThread]: 
[0m02:55:32.844508 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:55:32.846180 [info ] [MainThread]: 
[0m02:55:32.847688 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m02:55:32.850283 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.9410663, "process_user_time": 7.704852, "process_kernel_time": 1.150932, "process_mem_max_rss": "299480", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m02:55:32.852335 [debug] [MainThread]: Command `dbt run` succeeded at 02:55:32.852137 after 3.94 seconds
[0m02:55:32.854348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71bd42ec2250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71bd3e13f750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71bd42cc3290>]}
[0m02:55:32.856527 [debug] [MainThread]: Flushing usage events
[0m03:00:00.176868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e318519b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e318551910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e31882a950>]}


============================== 03:00:00.190194 | d91c8d0c-6e42-430f-ad8e-0c4417d095ae ==============================
[0m03:00:00.190194 [info ] [MainThread]: Running with dbt=1.7.4
[0m03:00:00.193070 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '.', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir .', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m03:00:00.745375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd91c8d0c-6e42-430f-ad8e-0c4417d095ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e31859ccd0>]}
[0m03:00:00.855959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd91c8d0c-6e42-430f-ad8e-0c4417d095ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e31a112cd0>]}
[0m03:00:00.888065 [info ] [MainThread]: Registered adapter: duckdb=1.7.4
[0m03:00:00.916981 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m03:00:01.013074 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:00:01.015892 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:00:01.025321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd91c8d0c-6e42-430f-ad8e-0c4417d095ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e30f2b8a50>]}
[0m03:00:01.077100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd91c8d0c-6e42-430f-ad8e-0c4417d095ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e318588110>]}
[0m03:00:01.079311 [info ] [MainThread]: Found 1 model, 0 sources, 0 exposures, 0 metrics, 394 macros, 0 groups, 0 semantic models
[0m03:00:01.085790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd91c8d0c-6e42-430f-ad8e-0c4417d095ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e30f31dbd0>]}
[0m03:00:01.090073 [info ] [MainThread]: 
[0m03:00:01.096232 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m03:00:01.099451 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_legal_demo'
[0m03:00:01.115942 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo"
[0m03:00:01.118521 [debug] [ThreadPool]: On list_legal_demo: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"legal_demo"'
    
  
  
[0m03:00:01.120355 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:00:01.153929 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:00:01.157911 [debug] [ThreadPool]: On list_legal_demo: Close
[0m03:00:01.167416 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_legal_demo, now create_legal_demo_main)
[0m03:00:01.170012 [debug] [ThreadPool]: Creating schema "database: "legal_demo"
schema: "main"
"
[0m03:00:01.179403 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m03:00:01.181689 [debug] [ThreadPool]: On create_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "create_legal_demo_main"} */

    
        select type from duckdb_databases()
        where database_name='legal_demo'
        and type='sqlite'
    
  
[0m03:00:01.183422 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:00:01.213311 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:00:01.216432 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m03:00:01.218498 [debug] [ThreadPool]: On create_legal_demo_main: BEGIN
[0m03:00:01.221267 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:00:01.223026 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m03:00:01.224564 [debug] [ThreadPool]: On create_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "create_legal_demo_main"} */

    
    
        create schema if not exists "legal_demo"."main"
    
[0m03:00:01.227203 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:00:01.229453 [debug] [ThreadPool]: On create_legal_demo_main: COMMIT
[0m03:00:01.231291 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m03:00:01.232640 [debug] [ThreadPool]: On create_legal_demo_main: COMMIT
[0m03:00:01.235800 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:00:01.237332 [debug] [ThreadPool]: On create_legal_demo_main: Close
[0m03:00:01.247752 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_legal_demo_main, now list_legal_demo_main)
[0m03:00:01.255783 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo_main"
[0m03:00:01.257650 [debug] [ThreadPool]: On list_legal_demo_main: BEGIN
[0m03:00:01.259133 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:00:01.284773 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:00:01.286726 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo_main"
[0m03:00:01.288384 [debug] [ThreadPool]: On list_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo_main"} */
select
      'legal_demo' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'legal_demo'
  
[0m03:00:01.324589 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:00:01.339256 [debug] [ThreadPool]: On list_legal_demo_main: ROLLBACK
[0m03:00:01.343639 [debug] [ThreadPool]: Failed to rollback 'list_legal_demo_main'
[0m03:00:01.345978 [debug] [ThreadPool]: On list_legal_demo_main: Close
[0m03:00:01.354058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd91c8d0c-6e42-430f-ad8e-0c4417d095ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e318cb1d10>]}
[0m03:00:01.356362 [debug] [MainThread]: Using duckdb connection "master"
[0m03:00:01.358030 [debug] [MainThread]: On master: BEGIN
[0m03:00:01.359981 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:00:01.382768 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m03:00:01.384773 [debug] [MainThread]: On master: COMMIT
[0m03:00:01.386950 [debug] [MainThread]: Using duckdb connection "master"
[0m03:00:01.388685 [debug] [MainThread]: On master: COMMIT
[0m03:00:01.391403 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m03:00:01.393276 [debug] [MainThread]: On master: Close
[0m03:00:01.398762 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:00:01.400647 [info ] [MainThread]: 
[0m03:00:01.413898 [debug] [Thread-1 (]: Began running node model.legal_demo.acris_cases
[0m03:00:01.416113 [info ] [Thread-1 (]: 1 of 1 START sql table model main.acris_clean .................................. [RUN]
[0m03:00:01.418355 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.legal_demo.acris_cases'
[0m03:00:01.420041 [debug] [Thread-1 (]: Began compiling node model.legal_demo.acris_cases
[0m03:00:01.430551 [debug] [Thread-1 (]: Writing injected SQL for node "model.legal_demo.acris_cases"
[0m03:00:01.445540 [debug] [Thread-1 (]: Timing info for model.legal_demo.acris_cases (compile): 03:00:01.421376 => 03:00:01.444853
[0m03:00:01.447479 [debug] [Thread-1 (]: Began executing node model.legal_demo.acris_cases
[0m03:00:01.502141 [debug] [Thread-1 (]: Writing runtime sql for node "model.legal_demo.acris_cases"
[0m03:00:01.517832 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:00:01.520444 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: BEGIN
[0m03:00:01.523062 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m03:00:01.569281 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:00:01.575911 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:00:01.578531 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */

  
    
    

    create  table
      "legal_demo"."main"."acris_clean__dbt_tmp"
  
    as (
      --
-- This model loads the already‑downloaded CSV into DuckDB and
-- materializes it as a table named `acris_clean`.  Because the
-- pipeline does not download data, the file must exist under
-- `data/first_500k_acris.csv` prior to running `dbt run`.  The
-- absolute path points at `/opt/airflow/data/first_500k_acris.csv` when
-- executed inside the Airflow containers.  Locally, dbt resolves
-- relative paths against the project root, so this model continues to
-- work outside of Docker.



SELECT *
FROM read_csv_auto('/opt/airflow/data/first_500k_acris.csv', header=True, delim=',')
    );
  
  
[0m03:00:04.159788 [debug] [Thread-1 (]: SQL status: OK in 3.0 seconds
[0m03:00:04.170304 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:00:04.172571 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
alter table "legal_demo"."main"."acris_clean" rename to "acris_clean__dbt_backup"
[0m03:00:04.176397 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:00:04.182902 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:00:04.185255 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
alter table "legal_demo"."main"."acris_clean__dbt_tmp" rename to "acris_clean"
[0m03:00:04.188182 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:00:04.219873 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: COMMIT
[0m03:00:04.222750 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:00:04.224698 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: COMMIT
[0m03:00:04.257507 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:00:04.272410 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:00:04.275006 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
drop table if exists "legal_demo"."main"."acris_clean__dbt_backup" cascade
[0m03:00:04.284680 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:00:04.289030 [debug] [Thread-1 (]: Timing info for model.legal_demo.acris_cases (execute): 03:00:01.449034 => 03:00:04.288691
[0m03:00:04.291278 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: Close
[0m03:00:04.364924 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd91c8d0c-6e42-430f-ad8e-0c4417d095ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e30f3d5b90>]}
[0m03:00:04.367729 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main.acris_clean ............................. [[32mOK[0m in 2.95s]
[0m03:00:04.370140 [debug] [Thread-1 (]: Finished running node model.legal_demo.acris_cases
[0m03:00:04.375046 [debug] [MainThread]: Using duckdb connection "master"
[0m03:00:04.377090 [debug] [MainThread]: On master: BEGIN
[0m03:00:04.378734 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:00:04.403463 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m03:00:04.406151 [debug] [MainThread]: On master: COMMIT
[0m03:00:04.408420 [debug] [MainThread]: Using duckdb connection "master"
[0m03:00:04.410147 [debug] [MainThread]: On master: COMMIT
[0m03:00:04.412179 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m03:00:04.413735 [debug] [MainThread]: On master: Close
[0m03:00:04.420215 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:00:04.422497 [debug] [MainThread]: Connection 'list_legal_demo_main' was properly closed.
[0m03:00:04.424118 [debug] [MainThread]: Connection 'model.legal_demo.acris_cases' was properly closed.
[0m03:00:04.425928 [info ] [MainThread]: 
[0m03:00:04.428153 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.33 seconds (3.33s).
[0m03:00:04.430441 [debug] [MainThread]: Command end result
[0m03:00:04.466072 [info ] [MainThread]: 
[0m03:00:04.468171 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:00:04.470073 [info ] [MainThread]: 
[0m03:00:04.471706 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m03:00:04.502230 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.4490333, "process_user_time": 8.179327, "process_kernel_time": 1.292952, "process_mem_max_rss": "300572", "process_in_blocks": "3816", "process_out_blocks": "0"}
[0m03:00:04.504689 [debug] [MainThread]: Command `dbt run` succeeded at 03:00:04.504447 after 4.45 seconds
[0m03:00:04.506411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e318cc6690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e318519610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e31d2d8510>]}
[0m03:00:04.508372 [debug] [MainThread]: Flushing usage events
[0m03:02:15.899444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54eb844d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54eb417590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54ebf1d410>]}


============================== 03:02:15.908404 | ad36021c-d85e-46e0-ad00-dd4edc7453d1 ==============================
[0m03:02:15.908404 [info ] [MainThread]: Running with dbt=1.7.4
[0m03:02:15.910642 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'profiles_dir': '.', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir .', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m03:02:16.285146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ad36021c-d85e-46e0-ad00-dd4edc7453d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54eb870e90>]}
[0m03:02:16.382482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ad36021c-d85e-46e0-ad00-dd4edc7453d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54e235a950>]}
[0m03:02:16.385166 [info ] [MainThread]: Registered adapter: duckdb=1.7.4
[0m03:02:16.407840 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m03:02:16.483401 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:02:16.485542 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:02:16.493288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ad36021c-d85e-46e0-ad00-dd4edc7453d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54eb9d3f90>]}
[0m03:02:16.542741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ad36021c-d85e-46e0-ad00-dd4edc7453d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54e22e39d0>]}
[0m03:02:16.545945 [info ] [MainThread]: Found 1 model, 0 sources, 0 exposures, 0 metrics, 394 macros, 0 groups, 0 semantic models
[0m03:02:16.547923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ad36021c-d85e-46e0-ad00-dd4edc7453d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54e219d6d0>]}
[0m03:02:16.551533 [info ] [MainThread]: 
[0m03:02:16.554044 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m03:02:16.557307 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_legal_demo'
[0m03:02:16.574948 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo"
[0m03:02:16.577055 [debug] [ThreadPool]: On list_legal_demo: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"legal_demo"'
    
  
  
[0m03:02:16.578850 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:02:16.609710 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:02:16.613286 [debug] [ThreadPool]: On list_legal_demo: Close
[0m03:02:16.621665 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_legal_demo, now create_legal_demo_main)
[0m03:02:16.623772 [debug] [ThreadPool]: Creating schema "database: "legal_demo"
schema: "main"
"
[0m03:02:16.632499 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m03:02:16.634195 [debug] [ThreadPool]: On create_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "create_legal_demo_main"} */

    
        select type from duckdb_databases()
        where database_name='legal_demo'
        and type='sqlite'
    
  
[0m03:02:16.635810 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:02:16.665721 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:02:16.668666 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m03:02:16.670090 [debug] [ThreadPool]: On create_legal_demo_main: BEGIN
[0m03:02:16.672437 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:02:16.674165 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m03:02:16.675858 [debug] [ThreadPool]: On create_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "create_legal_demo_main"} */

    
    
        create schema if not exists "legal_demo"."main"
    
[0m03:02:16.678061 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:02:16.681537 [debug] [ThreadPool]: On create_legal_demo_main: COMMIT
[0m03:02:16.683565 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m03:02:16.685257 [debug] [ThreadPool]: On create_legal_demo_main: COMMIT
[0m03:02:16.688322 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:02:16.690048 [debug] [ThreadPool]: On create_legal_demo_main: Close
[0m03:02:16.701579 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_legal_demo_main, now list_legal_demo_main)
[0m03:02:16.710451 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo_main"
[0m03:02:16.712627 [debug] [ThreadPool]: On list_legal_demo_main: BEGIN
[0m03:02:16.714572 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:02:16.737027 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:02:16.738759 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo_main"
[0m03:02:16.740507 [debug] [ThreadPool]: On list_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo_main"} */
select
      'legal_demo' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'legal_demo'
  
[0m03:02:16.772735 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:02:16.783613 [debug] [ThreadPool]: On list_legal_demo_main: ROLLBACK
[0m03:02:16.786278 [debug] [ThreadPool]: Failed to rollback 'list_legal_demo_main'
[0m03:02:16.787771 [debug] [ThreadPool]: On list_legal_demo_main: Close
[0m03:02:16.795580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ad36021c-d85e-46e0-ad00-dd4edc7453d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54e1ff8b10>]}
[0m03:02:16.797699 [debug] [MainThread]: Using duckdb connection "master"
[0m03:02:16.799255 [debug] [MainThread]: On master: BEGIN
[0m03:02:16.800741 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:02:16.823096 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m03:02:16.825399 [debug] [MainThread]: On master: COMMIT
[0m03:02:16.826896 [debug] [MainThread]: Using duckdb connection "master"
[0m03:02:16.828515 [debug] [MainThread]: On master: COMMIT
[0m03:02:16.830501 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m03:02:16.832146 [debug] [MainThread]: On master: Close
[0m03:02:16.839348 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:02:16.841784 [info ] [MainThread]: 
[0m03:02:16.856733 [debug] [Thread-1 (]: Began running node model.legal_demo.acris_cases
[0m03:02:16.859020 [info ] [Thread-1 (]: 1 of 1 START sql table model main.acris_clean .................................. [RUN]
[0m03:02:16.861389 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.legal_demo.acris_cases'
[0m03:02:16.863136 [debug] [Thread-1 (]: Began compiling node model.legal_demo.acris_cases
[0m03:02:16.873380 [debug] [Thread-1 (]: Writing injected SQL for node "model.legal_demo.acris_cases"
[0m03:02:16.888481 [debug] [Thread-1 (]: Timing info for model.legal_demo.acris_cases (compile): 03:02:16.864654 => 03:02:16.887858
[0m03:02:16.890292 [debug] [Thread-1 (]: Began executing node model.legal_demo.acris_cases
[0m03:02:16.942169 [debug] [Thread-1 (]: Writing runtime sql for node "model.legal_demo.acris_cases"
[0m03:02:16.958255 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:02:16.960826 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: BEGIN
[0m03:02:16.962654 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m03:02:16.989994 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:02:16.992522 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:02:16.994240 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */

  
    
    

    create  table
      "legal_demo"."main"."acris_clean__dbt_tmp"
  
    as (
      --
-- This model loads the already‑downloaded CSV into DuckDB and
-- materializes it as a table named `acris_clean`.  Because the
-- pipeline does not download data, the file must exist under
-- `data/first_500k_acris.csv` prior to running `dbt run`.  The
-- absolute path points at `/opt/airflow/data/first_500k_acris.csv` when
-- executed inside the Airflow containers.  Locally, dbt resolves
-- relative paths against the project root, so this model continues to
-- work outside of Docker.



SELECT *
FROM read_csv_auto('/opt/airflow/data/first_500k_acris.csv', header=True, delim=',')
    );
  
  
[0m03:02:19.498098 [debug] [Thread-1 (]: SQL status: OK in 3.0 seconds
[0m03:02:19.509291 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:02:19.511341 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
alter table "legal_demo"."main"."acris_clean" rename to "acris_clean__dbt_backup"
[0m03:02:19.514674 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:02:19.519901 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:02:19.521957 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
alter table "legal_demo"."main"."acris_clean__dbt_tmp" rename to "acris_clean"
[0m03:02:19.524306 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:02:19.552380 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: COMMIT
[0m03:02:19.554959 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:02:19.556610 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: COMMIT
[0m03:02:19.631473 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:02:19.641886 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:02:19.644791 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
drop table if exists "legal_demo"."main"."acris_clean__dbt_backup" cascade
[0m03:02:19.655496 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:02:19.659983 [debug] [Thread-1 (]: Timing info for model.legal_demo.acris_cases (execute): 03:02:16.891688 => 03:02:19.659665
[0m03:02:19.661836 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: Close
[0m03:02:19.733239 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad36021c-d85e-46e0-ad00-dd4edc7453d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54eb464950>]}
[0m03:02:19.736456 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main.acris_clean ............................. [[32mOK[0m in 2.87s]
[0m03:02:19.738775 [debug] [Thread-1 (]: Finished running node model.legal_demo.acris_cases
[0m03:02:19.744294 [debug] [MainThread]: Using duckdb connection "master"
[0m03:02:19.745799 [debug] [MainThread]: On master: BEGIN
[0m03:02:19.747243 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:02:19.770616 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m03:02:19.772462 [debug] [MainThread]: On master: COMMIT
[0m03:02:19.774221 [debug] [MainThread]: Using duckdb connection "master"
[0m03:02:19.775773 [debug] [MainThread]: On master: COMMIT
[0m03:02:19.777709 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m03:02:19.779230 [debug] [MainThread]: On master: Close
[0m03:02:19.784912 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:02:19.788381 [debug] [MainThread]: Connection 'list_legal_demo_main' was properly closed.
[0m03:02:19.789825 [debug] [MainThread]: Connection 'model.legal_demo.acris_cases' was properly closed.
[0m03:02:19.791423 [info ] [MainThread]: 
[0m03:02:19.793347 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.24 seconds (3.24s).
[0m03:02:19.795286 [debug] [MainThread]: Command end result
[0m03:02:19.835638 [info ] [MainThread]: 
[0m03:02:19.838099 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:02:19.839616 [info ] [MainThread]: 
[0m03:02:19.841260 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m03:02:19.843659 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.0177016, "process_user_time": 7.659815, "process_kernel_time": 1.332141, "process_mem_max_rss": "298860", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m03:02:19.845795 [debug] [MainThread]: Command `dbt run` succeeded at 03:02:19.845576 after 4.02 seconds
[0m03:02:19.847431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54eb3e7e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54eb757590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54efff8dd0>]}
[0m03:02:19.849089 [debug] [MainThread]: Flushing usage events
[0m03:04:47.914157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79a6e6e9e2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79a6e6353690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79a6e662fd10>]}


============================== 03:04:47.923748 | 8ac45ab6-c0db-4340-bff5-6e7cd072859f ==============================
[0m03:04:47.923748 [info ] [MainThread]: Running with dbt=1.7.4
[0m03:04:47.925670 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '.', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir .', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m03:04:48.301890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8ac45ab6-c0db-4340-bff5-6e7cd072859f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79a6e6668450>]}
[0m03:04:48.405609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8ac45ab6-c0db-4340-bff5-6e7cd072859f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79a6dd00e710>]}
[0m03:04:48.408198 [info ] [MainThread]: Registered adapter: duckdb=1.7.4
[0m03:04:48.429937 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m03:04:48.516370 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:04:48.528662 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:04:48.536434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8ac45ab6-c0db-4340-bff5-6e7cd072859f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79a6dcfd4d10>]}
[0m03:04:48.586673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8ac45ab6-c0db-4340-bff5-6e7cd072859f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79a6dd0b41d0>]}
[0m03:04:48.589209 [info ] [MainThread]: Found 1 model, 0 sources, 0 exposures, 0 metrics, 394 macros, 0 groups, 0 semantic models
[0m03:04:48.591206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8ac45ab6-c0db-4340-bff5-6e7cd072859f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79a6dcf65cd0>]}
[0m03:04:48.594782 [info ] [MainThread]: 
[0m03:04:48.597361 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m03:04:48.600309 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_legal_demo'
[0m03:04:48.616544 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo"
[0m03:04:48.619002 [debug] [ThreadPool]: On list_legal_demo: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"legal_demo"'
    
  
  
[0m03:04:48.621034 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:04:48.653628 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:04:48.657206 [debug] [ThreadPool]: On list_legal_demo: Close
[0m03:04:48.666947 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_legal_demo, now create_legal_demo_main)
[0m03:04:48.668916 [debug] [ThreadPool]: Creating schema "database: "legal_demo"
schema: "main"
"
[0m03:04:48.677436 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m03:04:48.679582 [debug] [ThreadPool]: On create_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "create_legal_demo_main"} */

    
        select type from duckdb_databases()
        where database_name='legal_demo'
        and type='sqlite'
    
  
[0m03:04:48.681205 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:04:48.754055 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:04:48.757255 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m03:04:48.759264 [debug] [ThreadPool]: On create_legal_demo_main: BEGIN
[0m03:04:48.761467 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:04:48.762925 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m03:04:48.764373 [debug] [ThreadPool]: On create_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "create_legal_demo_main"} */

    
    
        create schema if not exists "legal_demo"."main"
    
[0m03:04:48.766449 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:04:48.768587 [debug] [ThreadPool]: On create_legal_demo_main: COMMIT
[0m03:04:48.770180 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m03:04:48.771802 [debug] [ThreadPool]: On create_legal_demo_main: COMMIT
[0m03:04:48.775102 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:04:48.776641 [debug] [ThreadPool]: On create_legal_demo_main: Close
[0m03:04:48.786723 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_legal_demo_main, now list_legal_demo_main)
[0m03:04:48.794660 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo_main"
[0m03:04:48.796562 [debug] [ThreadPool]: On list_legal_demo_main: BEGIN
[0m03:04:48.798586 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:04:48.821125 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:04:48.823250 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo_main"
[0m03:04:48.825257 [debug] [ThreadPool]: On list_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo_main"} */
select
      'legal_demo' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'legal_demo'
  
[0m03:04:48.852442 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:04:48.860994 [debug] [ThreadPool]: On list_legal_demo_main: ROLLBACK
[0m03:04:48.863435 [debug] [ThreadPool]: Failed to rollback 'list_legal_demo_main'
[0m03:04:48.865246 [debug] [ThreadPool]: On list_legal_demo_main: Close
[0m03:04:48.872107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8ac45ab6-c0db-4340-bff5-6e7cd072859f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79a6dd0103d0>]}
[0m03:04:48.874023 [debug] [MainThread]: Using duckdb connection "master"
[0m03:04:48.875484 [debug] [MainThread]: On master: BEGIN
[0m03:04:48.876811 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:04:48.900511 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m03:04:48.902440 [debug] [MainThread]: On master: COMMIT
[0m03:04:48.903927 [debug] [MainThread]: Using duckdb connection "master"
[0m03:04:48.905916 [debug] [MainThread]: On master: COMMIT
[0m03:04:48.908937 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m03:04:48.910762 [debug] [MainThread]: On master: Close
[0m03:04:48.918273 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:04:48.920027 [info ] [MainThread]: 
[0m03:04:48.935718 [debug] [Thread-1 (]: Began running node model.legal_demo.acris_cases
[0m03:04:48.938606 [info ] [Thread-1 (]: 1 of 1 START sql table model main.acris_clean .................................. [RUN]
[0m03:04:48.941729 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.legal_demo.acris_cases'
[0m03:04:48.943853 [debug] [Thread-1 (]: Began compiling node model.legal_demo.acris_cases
[0m03:04:48.954874 [debug] [Thread-1 (]: Writing injected SQL for node "model.legal_demo.acris_cases"
[0m03:04:48.970268 [debug] [Thread-1 (]: Timing info for model.legal_demo.acris_cases (compile): 03:04:48.945314 => 03:04:48.969068
[0m03:04:48.973280 [debug] [Thread-1 (]: Began executing node model.legal_demo.acris_cases
[0m03:04:49.032320 [debug] [Thread-1 (]: Writing runtime sql for node "model.legal_demo.acris_cases"
[0m03:04:49.048316 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:04:49.050369 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: BEGIN
[0m03:04:49.052090 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m03:04:49.082842 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:04:49.085228 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:04:49.087326 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */

  
    
    

    create  table
      "legal_demo"."main"."acris_clean__dbt_tmp"
  
    as (
      --
-- This model loads the already‑downloaded CSV into DuckDB and
-- materializes it as a table named `acris_clean`.  Because the
-- pipeline does not download data, the file must exist under
-- `data/first_500k_acris.csv` prior to running `dbt run`.  The
-- absolute path points at `/opt/airflow/data/first_500k_acris.csv` when
-- executed inside the Airflow containers.  Locally, dbt resolves
-- relative paths against the project root, so this model continues to
-- work outside of Docker.



SELECT *
FROM read_csv_auto('/opt/airflow/data/first_500k_acris.csv', header=True, delim=',')
    );
  
  
[0m03:04:51.584621 [debug] [Thread-1 (]: SQL status: OK in 2.0 seconds
[0m03:04:51.593866 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:04:51.595827 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
alter table "legal_demo"."main"."acris_clean" rename to "acris_clean__dbt_backup"
[0m03:04:51.598323 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:04:51.602984 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:04:51.604445 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
alter table "legal_demo"."main"."acris_clean__dbt_tmp" rename to "acris_clean"
[0m03:04:51.606529 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:04:51.633708 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: COMMIT
[0m03:04:51.636435 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:04:51.638264 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: COMMIT
[0m03:04:51.675452 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:04:51.685508 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:04:51.687591 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
drop table if exists "legal_demo"."main"."acris_clean__dbt_backup" cascade
[0m03:04:51.696022 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:04:51.700098 [debug] [Thread-1 (]: Timing info for model.legal_demo.acris_cases (execute): 03:04:48.975919 => 03:04:51.699791
[0m03:04:51.701981 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: Close
[0m03:04:51.785163 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ac45ab6-c0db-4340-bff5-6e7cd072859f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79a6dcedba50>]}
[0m03:04:51.790343 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main.acris_clean ............................. [[32mOK[0m in 2.84s]
[0m03:04:51.794637 [debug] [Thread-1 (]: Finished running node model.legal_demo.acris_cases
[0m03:04:51.800633 [debug] [MainThread]: Using duckdb connection "master"
[0m03:04:51.803135 [debug] [MainThread]: On master: BEGIN
[0m03:04:51.805532 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:04:51.836337 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m03:04:51.837976 [debug] [MainThread]: On master: COMMIT
[0m03:04:51.839263 [debug] [MainThread]: Using duckdb connection "master"
[0m03:04:51.840470 [debug] [MainThread]: On master: COMMIT
[0m03:04:51.842410 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m03:04:51.843735 [debug] [MainThread]: On master: Close
[0m03:04:51.848473 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:04:51.849959 [debug] [MainThread]: Connection 'list_legal_demo_main' was properly closed.
[0m03:04:51.851213 [debug] [MainThread]: Connection 'model.legal_demo.acris_cases' was properly closed.
[0m03:04:51.852533 [info ] [MainThread]: 
[0m03:04:51.853992 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.26 seconds (3.26s).
[0m03:04:51.855653 [debug] [MainThread]: Command end result
[0m03:04:51.906119 [info ] [MainThread]: 
[0m03:04:51.908926 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:04:51.912408 [info ] [MainThread]: 
[0m03:04:51.914994 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m03:04:51.918550 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.0844173, "process_user_time": 7.712994, "process_kernel_time": 1.239875, "process_mem_max_rss": "299036", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m03:04:51.921474 [debug] [MainThread]: Command `dbt run` succeeded at 03:04:51.921065 after 4.09 seconds
[0m03:04:51.925088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79a6e66a6750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79a6eaf50510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79a6eb097190>]}
[0m03:04:51.928436 [debug] [MainThread]: Flushing usage events
[0m03:06:13.664841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71c332eff490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71c332eee950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71c33317ba50>]}


============================== 03:06:13.673857 | 47ee2f94-0f41-485f-b368-5447e28203de ==============================
[0m03:06:13.673857 [info ] [MainThread]: Running with dbt=1.7.4
[0m03:06:13.675678 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir .', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m03:06:14.061069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '47ee2f94-0f41-485f-b368-5447e28203de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71c33330a390>]}
[0m03:06:14.161416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '47ee2f94-0f41-485f-b368-5447e28203de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71c33342d190>]}
[0m03:06:14.164014 [info ] [MainThread]: Registered adapter: duckdb=1.7.4
[0m03:06:14.184628 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m03:06:14.257785 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:06:14.259876 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:06:14.267898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '47ee2f94-0f41-485f-b368-5447e28203de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71c3299bd990>]}
[0m03:06:14.317941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '47ee2f94-0f41-485f-b368-5447e28203de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71c329a38850>]}
[0m03:06:14.320143 [info ] [MainThread]: Found 1 model, 0 sources, 0 exposures, 0 metrics, 394 macros, 0 groups, 0 semantic models
[0m03:06:14.322720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '47ee2f94-0f41-485f-b368-5447e28203de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71c329a3cdd0>]}
[0m03:06:14.326484 [info ] [MainThread]: 
[0m03:06:14.328875 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m03:06:14.332397 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_legal_demo'
[0m03:06:14.359716 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo"
[0m03:06:14.408258 [debug] [ThreadPool]: On list_legal_demo: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"legal_demo"'
    
  
  
[0m03:06:14.410721 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:06:14.448901 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:06:14.454407 [debug] [ThreadPool]: On list_legal_demo: Close
[0m03:06:14.466179 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_legal_demo, now create_legal_demo_main)
[0m03:06:14.468774 [debug] [ThreadPool]: Creating schema "database: "legal_demo"
schema: "main"
"
[0m03:06:14.478238 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m03:06:14.480499 [debug] [ThreadPool]: On create_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "create_legal_demo_main"} */

    
        select type from duckdb_databases()
        where database_name='legal_demo'
        and type='sqlite'
    
  
[0m03:06:14.482409 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:06:14.509104 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:06:14.513078 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m03:06:14.515175 [debug] [ThreadPool]: On create_legal_demo_main: BEGIN
[0m03:06:14.517648 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:06:14.519345 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m03:06:14.521100 [debug] [ThreadPool]: On create_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "create_legal_demo_main"} */

    
    
        create schema if not exists "legal_demo"."main"
    
[0m03:06:14.523987 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:06:14.526317 [debug] [ThreadPool]: On create_legal_demo_main: COMMIT
[0m03:06:14.527992 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m03:06:14.529500 [debug] [ThreadPool]: On create_legal_demo_main: COMMIT
[0m03:06:14.532365 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:06:14.533645 [debug] [ThreadPool]: On create_legal_demo_main: Close
[0m03:06:14.543599 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_legal_demo_main, now list_legal_demo_main)
[0m03:06:14.551064 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo_main"
[0m03:06:14.553110 [debug] [ThreadPool]: On list_legal_demo_main: BEGIN
[0m03:06:14.554811 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:06:14.576561 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:06:14.579867 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo_main"
[0m03:06:14.581751 [debug] [ThreadPool]: On list_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo_main"} */
select
      'legal_demo' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'legal_demo'
  
[0m03:06:14.607617 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:06:14.616075 [debug] [ThreadPool]: On list_legal_demo_main: ROLLBACK
[0m03:06:14.619065 [debug] [ThreadPool]: Failed to rollback 'list_legal_demo_main'
[0m03:06:14.621118 [debug] [ThreadPool]: On list_legal_demo_main: Close
[0m03:06:14.630023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '47ee2f94-0f41-485f-b368-5447e28203de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71c329bb1350>]}
[0m03:06:14.632685 [debug] [MainThread]: Using duckdb connection "master"
[0m03:06:14.634580 [debug] [MainThread]: On master: BEGIN
[0m03:06:14.636824 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:06:14.659223 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m03:06:14.661438 [debug] [MainThread]: On master: COMMIT
[0m03:06:14.663011 [debug] [MainThread]: Using duckdb connection "master"
[0m03:06:14.664410 [debug] [MainThread]: On master: COMMIT
[0m03:06:14.666185 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m03:06:14.668309 [debug] [MainThread]: On master: Close
[0m03:06:14.673848 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:06:14.676028 [info ] [MainThread]: 
[0m03:06:14.688632 [debug] [Thread-1 (]: Began running node model.legal_demo.acris_cases
[0m03:06:14.690712 [info ] [Thread-1 (]: 1 of 1 START sql table model main.acris_clean .................................. [RUN]
[0m03:06:14.693339 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.legal_demo.acris_cases'
[0m03:06:14.695192 [debug] [Thread-1 (]: Began compiling node model.legal_demo.acris_cases
[0m03:06:14.708145 [debug] [Thread-1 (]: Writing injected SQL for node "model.legal_demo.acris_cases"
[0m03:06:14.720926 [debug] [Thread-1 (]: Timing info for model.legal_demo.acris_cases (compile): 03:06:14.696628 => 03:06:14.720263
[0m03:06:14.722868 [debug] [Thread-1 (]: Began executing node model.legal_demo.acris_cases
[0m03:06:14.765865 [debug] [Thread-1 (]: Writing runtime sql for node "model.legal_demo.acris_cases"
[0m03:06:14.782368 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:06:14.784433 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: BEGIN
[0m03:06:14.786099 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m03:06:14.809187 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:06:14.811185 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:06:14.813130 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */

  
    
    

    create  table
      "legal_demo"."main"."acris_clean__dbt_tmp"
  
    as (
      --
-- This model loads the already‑downloaded CSV into DuckDB and
-- materializes it as a table named `acris_clean`.  Because the
-- pipeline does not download data, the file must exist under
-- `data/first_500k_acris.csv` prior to running `dbt run`.  The
-- absolute path points at `/opt/airflow/data/first_500k_acris.csv` when
-- executed inside the Airflow containers.  Locally, dbt resolves
-- relative paths against the project root, so this model continues to
-- work outside of Docker.



SELECT *
FROM read_csv_auto('/opt/airflow/data/first_500k_acris.csv', header=True, delim=',')
    );
  
  
[0m03:06:17.240039 [debug] [Thread-1 (]: SQL status: OK in 2.0 seconds
[0m03:06:17.248703 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:06:17.250486 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
alter table "legal_demo"."main"."acris_clean" rename to "acris_clean__dbt_backup"
[0m03:06:17.252874 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:06:17.257489 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:06:17.259161 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
alter table "legal_demo"."main"."acris_clean__dbt_tmp" rename to "acris_clean"
[0m03:06:17.261281 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:06:17.284844 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: COMMIT
[0m03:06:17.287004 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:06:17.288650 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: COMMIT
[0m03:06:17.360163 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:06:17.369556 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:06:17.371810 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
drop table if exists "legal_demo"."main"."acris_clean__dbt_backup" cascade
[0m03:06:17.380105 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:06:17.382852 [debug] [Thread-1 (]: Timing info for model.legal_demo.acris_cases (execute): 03:06:14.724548 => 03:06:17.382595
[0m03:06:17.384464 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: Close
[0m03:06:17.452093 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47ee2f94-0f41-485f-b368-5447e28203de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71c32992db50>]}
[0m03:06:17.454731 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main.acris_clean ............................. [[32mOK[0m in 2.76s]
[0m03:06:17.457468 [debug] [Thread-1 (]: Finished running node model.legal_demo.acris_cases
[0m03:06:17.462470 [debug] [MainThread]: Using duckdb connection "master"
[0m03:06:17.464037 [debug] [MainThread]: On master: BEGIN
[0m03:06:17.465517 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:06:17.488926 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m03:06:17.490730 [debug] [MainThread]: On master: COMMIT
[0m03:06:17.492246 [debug] [MainThread]: Using duckdb connection "master"
[0m03:06:17.493663 [debug] [MainThread]: On master: COMMIT
[0m03:06:17.495521 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m03:06:17.496961 [debug] [MainThread]: On master: Close
[0m03:06:17.501856 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:06:17.503733 [debug] [MainThread]: Connection 'list_legal_demo_main' was properly closed.
[0m03:06:17.505137 [debug] [MainThread]: Connection 'model.legal_demo.acris_cases' was properly closed.
[0m03:06:17.506578 [info ] [MainThread]: 
[0m03:06:17.508386 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.18 seconds (3.18s).
[0m03:06:17.510165 [debug] [MainThread]: Command end result
[0m03:06:17.546981 [info ] [MainThread]: 
[0m03:06:17.548886 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:06:17.550850 [info ] [MainThread]: 
[0m03:06:17.553186 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m03:06:17.556704 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.9592555, "process_user_time": 7.430261, "process_kernel_time": 1.22561, "process_mem_max_rss": "297152", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m03:06:17.558514 [debug] [MainThread]: Command `dbt run` succeeded at 03:06:17.558310 after 3.96 seconds
[0m03:06:17.560234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71c332eff490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71c337a56b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71c3336c1190>]}
[0m03:06:17.561974 [debug] [MainThread]: Flushing usage events
[0m03:07:53.680659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7586ae1d2c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7586ae1760d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7586ae00fdd0>]}


============================== 03:07:53.689501 | 64743803-cb2d-4c5e-a69e-9a694dd3aa66 ==============================
[0m03:07:53.689501 [info ] [MainThread]: Running with dbt=1.7.4
[0m03:07:53.691468 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '.', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir .', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m03:07:54.094702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '64743803-cb2d-4c5e-a69e-9a694dd3aa66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7586ae1e5ed0>]}
[0m03:07:54.194319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '64743803-cb2d-4c5e-a69e-9a694dd3aa66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7586af6c1850>]}
[0m03:07:54.197458 [info ] [MainThread]: Registered adapter: duckdb=1.7.4
[0m03:07:54.218687 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m03:07:54.299569 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:07:54.301543 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:07:54.309089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '64743803-cb2d-4c5e-a69e-9a694dd3aa66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7586adbf6ed0>]}
[0m03:07:54.356476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '64743803-cb2d-4c5e-a69e-9a694dd3aa66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7586a4a756d0>]}
[0m03:07:54.358417 [info ] [MainThread]: Found 1 model, 0 sources, 0 exposures, 0 metrics, 394 macros, 0 groups, 0 semantic models
[0m03:07:54.360183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '64743803-cb2d-4c5e-a69e-9a694dd3aa66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7586a4a1eb90>]}
[0m03:07:54.363791 [info ] [MainThread]: 
[0m03:07:54.366069 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m03:07:54.369442 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_legal_demo'
[0m03:07:54.385024 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo"
[0m03:07:54.387193 [debug] [ThreadPool]: On list_legal_demo: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"legal_demo"'
    
  
  
[0m03:07:54.388918 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:07:54.422054 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:07:54.425986 [debug] [ThreadPool]: On list_legal_demo: Close
[0m03:07:54.436131 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_legal_demo, now create_legal_demo_main)
[0m03:07:54.438265 [debug] [ThreadPool]: Creating schema "database: "legal_demo"
schema: "main"
"
[0m03:07:54.447278 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m03:07:54.448828 [debug] [ThreadPool]: On create_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "create_legal_demo_main"} */

    
        select type from duckdb_databases()
        where database_name='legal_demo'
        and type='sqlite'
    
  
[0m03:07:54.450635 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:07:54.477841 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:07:54.480606 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m03:07:54.482603 [debug] [ThreadPool]: On create_legal_demo_main: BEGIN
[0m03:07:54.484331 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:07:54.485848 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m03:07:54.487435 [debug] [ThreadPool]: On create_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "create_legal_demo_main"} */

    
    
        create schema if not exists "legal_demo"."main"
    
[0m03:07:54.489436 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:07:54.491678 [debug] [ThreadPool]: On create_legal_demo_main: COMMIT
[0m03:07:54.493382 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m03:07:54.494884 [debug] [ThreadPool]: On create_legal_demo_main: COMMIT
[0m03:07:54.497418 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:07:54.498886 [debug] [ThreadPool]: On create_legal_demo_main: Close
[0m03:07:54.508222 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_legal_demo_main, now list_legal_demo_main)
[0m03:07:54.515821 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo_main"
[0m03:07:54.517655 [debug] [ThreadPool]: On list_legal_demo_main: BEGIN
[0m03:07:54.519368 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:07:54.542271 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:07:54.544095 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo_main"
[0m03:07:54.545710 [debug] [ThreadPool]: On list_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo_main"} */
select
      'legal_demo' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'legal_demo'
  
[0m03:07:54.571991 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:07:54.584447 [debug] [ThreadPool]: On list_legal_demo_main: ROLLBACK
[0m03:07:54.587428 [debug] [ThreadPool]: Failed to rollback 'list_legal_demo_main'
[0m03:07:54.589441 [debug] [ThreadPool]: On list_legal_demo_main: Close
[0m03:07:54.600475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '64743803-cb2d-4c5e-a69e-9a694dd3aa66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7586a4b53d50>]}
[0m03:07:54.602878 [debug] [MainThread]: Using duckdb connection "master"
[0m03:07:54.604536 [debug] [MainThread]: On master: BEGIN
[0m03:07:54.606243 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:07:54.630524 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m03:07:54.632781 [debug] [MainThread]: On master: COMMIT
[0m03:07:54.634592 [debug] [MainThread]: Using duckdb connection "master"
[0m03:07:54.636171 [debug] [MainThread]: On master: COMMIT
[0m03:07:54.638332 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m03:07:54.639944 [debug] [MainThread]: On master: Close
[0m03:07:54.645273 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:07:54.647361 [info ] [MainThread]: 
[0m03:07:54.659857 [debug] [Thread-1 (]: Began running node model.legal_demo.acris_cases
[0m03:07:54.662087 [info ] [Thread-1 (]: 1 of 1 START sql table model main.acris_clean .................................. [RUN]
[0m03:07:54.664381 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.legal_demo.acris_cases'
[0m03:07:54.666219 [debug] [Thread-1 (]: Began compiling node model.legal_demo.acris_cases
[0m03:07:54.675506 [debug] [Thread-1 (]: Writing injected SQL for node "model.legal_demo.acris_cases"
[0m03:07:54.692012 [debug] [Thread-1 (]: Timing info for model.legal_demo.acris_cases (compile): 03:07:54.667901 => 03:07:54.691331
[0m03:07:54.693888 [debug] [Thread-1 (]: Began executing node model.legal_demo.acris_cases
[0m03:07:54.732921 [debug] [Thread-1 (]: Writing runtime sql for node "model.legal_demo.acris_cases"
[0m03:07:54.746409 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:07:54.747902 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: BEGIN
[0m03:07:54.749074 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m03:07:54.772189 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:07:54.774375 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:07:54.776179 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */

  
    
    

    create  table
      "legal_demo"."main"."acris_clean__dbt_tmp"
  
    as (
      --
-- This model loads the already‑downloaded CSV into DuckDB and
-- materializes it as a table named `acris_clean`.  Because the
-- pipeline does not download data, the file must exist under
-- `data/first_500k_acris.csv` prior to running `dbt run`.  The
-- absolute path points at `/opt/airflow/data/first_500k_acris.csv` when
-- executed inside the Airflow containers.  Locally, dbt resolves
-- relative paths against the project root, so this model continues to
-- work outside of Docker.



SELECT *
FROM read_csv_auto('/opt/airflow/data/first_500k_acris.csv', header=True, delim=',')
    );
  
  
[0m03:07:57.196712 [debug] [Thread-1 (]: SQL status: OK in 2.0 seconds
[0m03:07:57.205560 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:07:57.207476 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
alter table "legal_demo"."main"."acris_clean" rename to "acris_clean__dbt_backup"
[0m03:07:57.210193 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:07:57.214885 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:07:57.216953 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
alter table "legal_demo"."main"."acris_clean__dbt_tmp" rename to "acris_clean"
[0m03:07:57.219203 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:07:57.242004 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: COMMIT
[0m03:07:57.244263 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:07:57.246227 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: COMMIT
[0m03:07:57.291867 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:07:57.299965 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:07:57.302129 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
drop table if exists "legal_demo"."main"."acris_clean__dbt_backup" cascade
[0m03:07:57.311501 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:07:57.315650 [debug] [Thread-1 (]: Timing info for model.legal_demo.acris_cases (execute): 03:07:54.695246 => 03:07:57.315294
[0m03:07:57.317499 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: Close
[0m03:07:57.385616 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64743803-cb2d-4c5e-a69e-9a694dd3aa66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7586a48f1110>]}
[0m03:07:57.387873 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main.acris_clean ............................. [[32mOK[0m in 2.72s]
[0m03:07:57.389654 [debug] [Thread-1 (]: Finished running node model.legal_demo.acris_cases
[0m03:07:57.393710 [debug] [MainThread]: Using duckdb connection "master"
[0m03:07:57.395273 [debug] [MainThread]: On master: BEGIN
[0m03:07:57.396649 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:07:57.417298 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m03:07:57.419377 [debug] [MainThread]: On master: COMMIT
[0m03:07:57.420984 [debug] [MainThread]: Using duckdb connection "master"
[0m03:07:57.422594 [debug] [MainThread]: On master: COMMIT
[0m03:07:57.424604 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m03:07:57.426172 [debug] [MainThread]: On master: Close
[0m03:07:57.431273 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:07:57.432803 [debug] [MainThread]: Connection 'list_legal_demo_main' was properly closed.
[0m03:07:57.434326 [debug] [MainThread]: Connection 'model.legal_demo.acris_cases' was properly closed.
[0m03:07:57.436048 [info ] [MainThread]: 
[0m03:07:57.437667 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.07 seconds (3.07s).
[0m03:07:57.439539 [debug] [MainThread]: Command end result
[0m03:07:57.473761 [info ] [MainThread]: 
[0m03:07:57.476153 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:07:57.478281 [info ] [MainThread]: 
[0m03:07:57.479994 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m03:07:57.482800 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.8682299, "process_user_time": 7.448658, "process_kernel_time": 1.290192, "process_mem_max_rss": "297832", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m03:07:57.484966 [debug] [MainThread]: Command `dbt run` succeeded at 03:07:57.484630 after 3.87 seconds
[0m03:07:57.486811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7586adc0e190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7586b2a16bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7586b2aa6c50>]}
[0m03:07:57.488625 [debug] [MainThread]: Flushing usage events
[0m03:09:23.826431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ecd5fae190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ecd5facd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ecd5c8c810>]}


============================== 03:09:23.837725 | b89f52d8-23a5-448d-b172-709310dd0e56 ==============================
[0m03:09:23.837725 [info ] [MainThread]: Running with dbt=1.7.4
[0m03:09:23.839476 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir .', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m03:09:24.330120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b89f52d8-23a5-448d-b172-709310dd0e56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ecd5e15350>]}
[0m03:09:24.437038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b89f52d8-23a5-448d-b172-709310dd0e56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ecd5bd1350>]}
[0m03:09:24.440108 [info ] [MainThread]: Registered adapter: duckdb=1.7.4
[0m03:09:24.462968 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m03:09:24.551635 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:09:24.553719 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:09:24.563589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b89f52d8-23a5-448d-b172-709310dd0e56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76eccc54d2d0>]}
[0m03:09:24.611366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b89f52d8-23a5-448d-b172-709310dd0e56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76eccc692890>]}
[0m03:09:24.614831 [info ] [MainThread]: Found 1 model, 0 sources, 0 exposures, 0 metrics, 394 macros, 0 groups, 0 semantic models
[0m03:09:24.617183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b89f52d8-23a5-448d-b172-709310dd0e56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ecd914f7d0>]}
[0m03:09:24.621097 [info ] [MainThread]: 
[0m03:09:24.623634 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m03:09:24.627348 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_legal_demo'
[0m03:09:24.648517 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo"
[0m03:09:24.650605 [debug] [ThreadPool]: On list_legal_demo: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"legal_demo"'
    
  
  
[0m03:09:24.652422 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:09:24.691482 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:09:24.696183 [debug] [ThreadPool]: On list_legal_demo: Close
[0m03:09:24.706149 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_legal_demo, now create_legal_demo_main)
[0m03:09:24.708517 [debug] [ThreadPool]: Creating schema "database: "legal_demo"
schema: "main"
"
[0m03:09:24.718079 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m03:09:24.720171 [debug] [ThreadPool]: On create_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "create_legal_demo_main"} */

    
        select type from duckdb_databases()
        where database_name='legal_demo'
        and type='sqlite'
    
  
[0m03:09:24.721644 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:09:24.747178 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:09:24.750113 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m03:09:24.752047 [debug] [ThreadPool]: On create_legal_demo_main: BEGIN
[0m03:09:24.754629 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:09:24.756268 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m03:09:24.757632 [debug] [ThreadPool]: On create_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "create_legal_demo_main"} */

    
    
        create schema if not exists "legal_demo"."main"
    
[0m03:09:24.759867 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:09:24.762042 [debug] [ThreadPool]: On create_legal_demo_main: COMMIT
[0m03:09:24.763937 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m03:09:24.765439 [debug] [ThreadPool]: On create_legal_demo_main: COMMIT
[0m03:09:24.768162 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:09:24.769652 [debug] [ThreadPool]: On create_legal_demo_main: Close
[0m03:09:24.780631 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_legal_demo_main, now list_legal_demo_main)
[0m03:09:24.788666 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo_main"
[0m03:09:24.790880 [debug] [ThreadPool]: On list_legal_demo_main: BEGIN
[0m03:09:24.792794 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:09:24.818885 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:09:24.821618 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo_main"
[0m03:09:24.823410 [debug] [ThreadPool]: On list_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo_main"} */
select
      'legal_demo' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'legal_demo'
  
[0m03:09:24.858818 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:09:24.870288 [debug] [ThreadPool]: On list_legal_demo_main: ROLLBACK
[0m03:09:24.872960 [debug] [ThreadPool]: Failed to rollback 'list_legal_demo_main'
[0m03:09:24.874888 [debug] [ThreadPool]: On list_legal_demo_main: Close
[0m03:09:24.882939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b89f52d8-23a5-448d-b172-709310dd0e56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76eccc5b4bd0>]}
[0m03:09:24.885209 [debug] [MainThread]: Using duckdb connection "master"
[0m03:09:24.886662 [debug] [MainThread]: On master: BEGIN
[0m03:09:24.888723 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:09:24.911891 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m03:09:24.913766 [debug] [MainThread]: On master: COMMIT
[0m03:09:24.915414 [debug] [MainThread]: Using duckdb connection "master"
[0m03:09:24.917020 [debug] [MainThread]: On master: COMMIT
[0m03:09:24.918679 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m03:09:24.920233 [debug] [MainThread]: On master: Close
[0m03:09:24.925149 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:09:24.927870 [info ] [MainThread]: 
[0m03:09:24.940791 [debug] [Thread-1 (]: Began running node model.legal_demo.acris_cases
[0m03:09:24.942747 [info ] [Thread-1 (]: 1 of 1 START sql table model main.acris_clean .................................. [RUN]
[0m03:09:24.944974 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.legal_demo.acris_cases'
[0m03:09:24.946402 [debug] [Thread-1 (]: Began compiling node model.legal_demo.acris_cases
[0m03:09:24.955801 [debug] [Thread-1 (]: Writing injected SQL for node "model.legal_demo.acris_cases"
[0m03:09:24.968447 [debug] [Thread-1 (]: Timing info for model.legal_demo.acris_cases (compile): 03:09:24.947452 => 03:09:24.967875
[0m03:09:24.970274 [debug] [Thread-1 (]: Began executing node model.legal_demo.acris_cases
[0m03:09:25.013204 [debug] [Thread-1 (]: Writing runtime sql for node "model.legal_demo.acris_cases"
[0m03:09:25.027787 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:09:25.030052 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: BEGIN
[0m03:09:25.033218 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m03:09:25.060810 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:09:25.062899 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:09:25.064884 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */

  
    
    

    create  table
      "legal_demo"."main"."acris_clean__dbt_tmp"
  
    as (
      --
-- This model loads the already‑downloaded CSV into DuckDB and
-- materializes it as a table named `acris_clean`.  Because the
-- pipeline does not download data, the file must exist under
-- `data/first_500k_acris.csv` prior to running `dbt run`.  The
-- absolute path points at `/opt/airflow/data/first_500k_acris.csv` when
-- executed inside the Airflow containers.  Locally, dbt resolves
-- relative paths against the project root, so this model continues to
-- work outside of Docker.



SELECT *
FROM read_csv_auto('/opt/airflow/data/first_500k_acris.csv', header=True, delim=',')
    );
  
  
[0m03:09:27.683914 [debug] [Thread-1 (]: SQL status: OK in 3.0 seconds
[0m03:09:27.692884 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:09:27.694823 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
alter table "legal_demo"."main"."acris_clean" rename to "acris_clean__dbt_backup"
[0m03:09:27.697524 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:09:27.703545 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:09:27.705411 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
alter table "legal_demo"."main"."acris_clean__dbt_tmp" rename to "acris_clean"
[0m03:09:27.707752 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:09:27.730649 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: COMMIT
[0m03:09:27.732644 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:09:27.734216 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: COMMIT
[0m03:09:27.807666 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:09:27.817359 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:09:27.819223 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
drop table if exists "legal_demo"."main"."acris_clean__dbt_backup" cascade
[0m03:09:27.827663 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:09:27.830893 [debug] [Thread-1 (]: Timing info for model.legal_demo.acris_cases (execute): 03:09:24.971570 => 03:09:27.830623
[0m03:09:27.832785 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: Close
[0m03:09:27.902222 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b89f52d8-23a5-448d-b172-709310dd0e56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76eccc4ac6d0>]}
[0m03:09:27.904583 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main.acris_clean ............................. [[32mOK[0m in 2.96s]
[0m03:09:27.906565 [debug] [Thread-1 (]: Finished running node model.legal_demo.acris_cases
[0m03:09:27.910453 [debug] [MainThread]: Using duckdb connection "master"
[0m03:09:27.912169 [debug] [MainThread]: On master: BEGIN
[0m03:09:27.913922 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:09:27.936417 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m03:09:27.978531 [debug] [MainThread]: On master: COMMIT
[0m03:09:27.980863 [debug] [MainThread]: Using duckdb connection "master"
[0m03:09:27.982720 [debug] [MainThread]: On master: COMMIT
[0m03:09:27.984890 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m03:09:27.986522 [debug] [MainThread]: On master: Close
[0m03:09:27.991703 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:09:27.993585 [debug] [MainThread]: Connection 'list_legal_demo_main' was properly closed.
[0m03:09:27.995185 [debug] [MainThread]: Connection 'model.legal_demo.acris_cases' was properly closed.
[0m03:09:27.996928 [info ] [MainThread]: 
[0m03:09:27.998643 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.37 seconds (3.37s).
[0m03:09:28.000743 [debug] [MainThread]: Command end result
[0m03:09:28.038859 [info ] [MainThread]: 
[0m03:09:28.041959 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:09:28.043930 [info ] [MainThread]: 
[0m03:09:28.045670 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m03:09:28.048149 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.304905, "process_user_time": 8.210107, "process_kernel_time": 1.237968, "process_mem_max_rss": "298744", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m03:09:28.049809 [debug] [MainThread]: Command `dbt run` succeeded at 03:09:28.049616 after 4.31 seconds
[0m03:09:28.051486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ecd64bea90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ecd5e32850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ecd6c39490>]}
[0m03:09:28.053087 [debug] [MainThread]: Flushing usage events
[0m03:10:29.188748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77f8650a6450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77f8653b57d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77f8653b63d0>]}


============================== 03:10:29.197623 | cce07fe8-7f04-4375-8415-ca2c7cbd2c2c ==============================
[0m03:10:29.197623 [info ] [MainThread]: Running with dbt=1.7.4
[0m03:10:29.199576 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '.', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir .', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m03:10:29.563843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cce07fe8-7f04-4375-8415-ca2c7cbd2c2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77f8656b5e10>]}
[0m03:10:29.664623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cce07fe8-7f04-4375-8415-ca2c7cbd2c2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77f861ead650>]}
[0m03:10:29.667302 [info ] [MainThread]: Registered adapter: duckdb=1.7.4
[0m03:10:29.688570 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m03:10:29.781357 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:10:29.783318 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:10:29.792133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cce07fe8-7f04-4375-8415-ca2c7cbd2c2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77f85beb4550>]}
[0m03:10:29.842575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cce07fe8-7f04-4375-8415-ca2c7cbd2c2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77f85bf932d0>]}
[0m03:10:29.844733 [info ] [MainThread]: Found 1 model, 0 sources, 0 exposures, 0 metrics, 394 macros, 0 groups, 0 semantic models
[0m03:10:29.847531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cce07fe8-7f04-4375-8415-ca2c7cbd2c2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77f85bf09890>]}
[0m03:10:29.851678 [info ] [MainThread]: 
[0m03:10:29.854215 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m03:10:29.857372 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_legal_demo'
[0m03:10:29.874564 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo"
[0m03:10:29.876848 [debug] [ThreadPool]: On list_legal_demo: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"legal_demo"'
    
  
  
[0m03:10:29.878640 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:10:29.910656 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:10:29.913983 [debug] [ThreadPool]: On list_legal_demo: Close
[0m03:10:29.922911 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_legal_demo, now create_legal_demo_main)
[0m03:10:29.925203 [debug] [ThreadPool]: Creating schema "database: "legal_demo"
schema: "main"
"
[0m03:10:29.935073 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m03:10:29.937156 [debug] [ThreadPool]: On create_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "create_legal_demo_main"} */

    
        select type from duckdb_databases()
        where database_name='legal_demo'
        and type='sqlite'
    
  
[0m03:10:29.938774 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:10:29.965182 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:10:29.968337 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m03:10:29.970284 [debug] [ThreadPool]: On create_legal_demo_main: BEGIN
[0m03:10:29.972151 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:10:29.973551 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m03:10:29.974984 [debug] [ThreadPool]: On create_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "create_legal_demo_main"} */

    
    
        create schema if not exists "legal_demo"."main"
    
[0m03:10:29.977021 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:10:29.979304 [debug] [ThreadPool]: On create_legal_demo_main: COMMIT
[0m03:10:29.980809 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m03:10:29.982204 [debug] [ThreadPool]: On create_legal_demo_main: COMMIT
[0m03:10:29.985116 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:10:29.986596 [debug] [ThreadPool]: On create_legal_demo_main: Close
[0m03:10:29.996178 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_legal_demo_main, now list_legal_demo_main)
[0m03:10:30.003862 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo_main"
[0m03:10:30.005685 [debug] [ThreadPool]: On list_legal_demo_main: BEGIN
[0m03:10:30.007599 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:10:30.032579 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:10:30.034456 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo_main"
[0m03:10:30.036208 [debug] [ThreadPool]: On list_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo_main"} */
select
      'legal_demo' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'legal_demo'
  
[0m03:10:30.062677 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:10:30.070823 [debug] [ThreadPool]: On list_legal_demo_main: ROLLBACK
[0m03:10:30.073249 [debug] [ThreadPool]: Failed to rollback 'list_legal_demo_main'
[0m03:10:30.074929 [debug] [ThreadPool]: On list_legal_demo_main: Close
[0m03:10:30.082429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cce07fe8-7f04-4375-8415-ca2c7cbd2c2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77f865533d50>]}
[0m03:10:30.084634 [debug] [MainThread]: Using duckdb connection "master"
[0m03:10:30.086269 [debug] [MainThread]: On master: BEGIN
[0m03:10:30.088007 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:10:30.109979 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m03:10:30.111732 [debug] [MainThread]: On master: COMMIT
[0m03:10:30.113241 [debug] [MainThread]: Using duckdb connection "master"
[0m03:10:30.114651 [debug] [MainThread]: On master: COMMIT
[0m03:10:30.116672 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m03:10:30.118162 [debug] [MainThread]: On master: Close
[0m03:10:30.122894 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:10:30.125186 [info ] [MainThread]: 
[0m03:10:30.137539 [debug] [Thread-1 (]: Began running node model.legal_demo.acris_cases
[0m03:10:30.139425 [info ] [Thread-1 (]: 1 of 1 START sql table model main.acris_clean .................................. [RUN]
[0m03:10:30.141536 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.legal_demo.acris_cases'
[0m03:10:30.142960 [debug] [Thread-1 (]: Began compiling node model.legal_demo.acris_cases
[0m03:10:30.153244 [debug] [Thread-1 (]: Writing injected SQL for node "model.legal_demo.acris_cases"
[0m03:10:30.165961 [debug] [Thread-1 (]: Timing info for model.legal_demo.acris_cases (compile): 03:10:30.144488 => 03:10:30.165589
[0m03:10:30.167423 [debug] [Thread-1 (]: Began executing node model.legal_demo.acris_cases
[0m03:10:30.206109 [debug] [Thread-1 (]: Writing runtime sql for node "model.legal_demo.acris_cases"
[0m03:10:30.219868 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:10:30.221915 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: BEGIN
[0m03:10:30.223621 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m03:10:30.249612 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:10:30.251492 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:10:30.253326 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */

  
    
    

    create  table
      "legal_demo"."main"."acris_clean__dbt_tmp"
  
    as (
      --
-- This model loads the already‑downloaded CSV into DuckDB and
-- materializes it as a table named `acris_clean`.  Because the
-- pipeline does not download data, the file must exist under
-- `data/first_500k_acris.csv` prior to running `dbt run`.  The
-- absolute path points at `/opt/airflow/data/first_500k_acris.csv` when
-- executed inside the Airflow containers.  Locally, dbt resolves
-- relative paths against the project root, so this model continues to
-- work outside of Docker.



SELECT *
FROM read_csv_auto('/opt/airflow/data/first_500k_acris.csv', header=True, delim=',')
    );
  
  
[0m03:10:32.622473 [debug] [Thread-1 (]: SQL status: OK in 2.0 seconds
[0m03:10:32.628906 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:10:32.630175 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
alter table "legal_demo"."main"."acris_clean" rename to "acris_clean__dbt_backup"
[0m03:10:32.632486 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:10:32.636484 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:10:32.637699 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
alter table "legal_demo"."main"."acris_clean__dbt_tmp" rename to "acris_clean"
[0m03:10:32.639477 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:10:32.656895 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: COMMIT
[0m03:10:32.658461 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:10:32.659611 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: COMMIT
[0m03:10:32.676217 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:10:32.681773 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:10:32.683076 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
drop table if exists "legal_demo"."main"."acris_clean__dbt_backup" cascade
[0m03:10:32.689414 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:10:32.691890 [debug] [Thread-1 (]: Timing info for model.legal_demo.acris_cases (execute): 03:10:30.168864 => 03:10:32.691686
[0m03:10:32.693020 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: Close
[0m03:10:32.741589 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cce07fe8-7f04-4375-8415-ca2c7cbd2c2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77f85bd986d0>]}
[0m03:10:32.743469 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main.acris_clean ............................. [[32mOK[0m in 2.60s]
[0m03:10:32.744862 [debug] [Thread-1 (]: Finished running node model.legal_demo.acris_cases
[0m03:10:32.747810 [debug] [MainThread]: Using duckdb connection "master"
[0m03:10:32.748997 [debug] [MainThread]: On master: BEGIN
[0m03:10:32.750007 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:10:32.764412 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m03:10:32.765594 [debug] [MainThread]: On master: COMMIT
[0m03:10:32.766430 [debug] [MainThread]: Using duckdb connection "master"
[0m03:10:32.767290 [debug] [MainThread]: On master: COMMIT
[0m03:10:32.768522 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m03:10:32.769697 [debug] [MainThread]: On master: Close
[0m03:10:32.773089 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:10:32.773982 [debug] [MainThread]: Connection 'list_legal_demo_main' was properly closed.
[0m03:10:32.774796 [debug] [MainThread]: Connection 'model.legal_demo.acris_cases' was properly closed.
[0m03:10:32.775704 [info ] [MainThread]: 
[0m03:10:32.776677 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.92 seconds (2.92s).
[0m03:10:32.777810 [debug] [MainThread]: Command end result
[0m03:10:32.801250 [info ] [MainThread]: 
[0m03:10:32.802702 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:10:32.803896 [info ] [MainThread]: 
[0m03:10:32.804970 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m03:10:32.806583 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.6853566, "process_user_time": 7.295967, "process_kernel_time": 1.270601, "process_mem_max_rss": "300584", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m03:10:32.807868 [debug] [MainThread]: Command `dbt run` succeeded at 03:10:32.807722 after 3.69 seconds
[0m03:10:32.808884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77f865c09890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77f869e30210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77f86583f0d0>]}
[0m03:10:32.809853 [debug] [MainThread]: Flushing usage events
[0m03:11:21.694488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e3417d9acd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e341710f110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e341711df90>]}


============================== 03:11:21.703551 | 800319f0-7dab-40c5-939e-600aa463835b ==============================
[0m03:11:21.703551 [info ] [MainThread]: Running with dbt=1.7.4
[0m03:11:21.705826 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir .', 'send_anonymous_usage_stats': 'True'}
[0m03:11:22.162054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '800319f0-7dab-40c5-939e-600aa463835b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e34173ed690>]}
[0m03:11:22.310504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '800319f0-7dab-40c5-939e-600aa463835b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e341722b490>]}
[0m03:11:22.313397 [info ] [MainThread]: Registered adapter: duckdb=1.7.4
[0m03:11:22.334356 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m03:11:22.417901 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:11:22.420123 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:11:22.427456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '800319f0-7dab-40c5-939e-600aa463835b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e340dea92d0>]}
[0m03:11:22.480591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '800319f0-7dab-40c5-939e-600aa463835b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e341715ec90>]}
[0m03:11:22.482743 [info ] [MainThread]: Found 1 model, 0 sources, 0 exposures, 0 metrics, 394 macros, 0 groups, 0 semantic models
[0m03:11:22.484817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '800319f0-7dab-40c5-939e-600aa463835b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e340df4c990>]}
[0m03:11:22.488507 [info ] [MainThread]: 
[0m03:11:22.491339 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m03:11:22.494781 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_legal_demo'
[0m03:11:22.510707 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo"
[0m03:11:22.512734 [debug] [ThreadPool]: On list_legal_demo: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"legal_demo"'
    
  
  
[0m03:11:22.514656 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:11:22.548779 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:11:22.552422 [debug] [ThreadPool]: On list_legal_demo: Close
[0m03:11:22.561770 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_legal_demo, now create_legal_demo_main)
[0m03:11:22.564414 [debug] [ThreadPool]: Creating schema "database: "legal_demo"
schema: "main"
"
[0m03:11:22.573578 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m03:11:22.575797 [debug] [ThreadPool]: On create_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "create_legal_demo_main"} */

    
        select type from duckdb_databases()
        where database_name='legal_demo'
        and type='sqlite'
    
  
[0m03:11:22.577540 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:11:22.608426 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:11:22.611510 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m03:11:22.613098 [debug] [ThreadPool]: On create_legal_demo_main: BEGIN
[0m03:11:22.615318 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:11:22.616763 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m03:11:22.618300 [debug] [ThreadPool]: On create_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "create_legal_demo_main"} */

    
    
        create schema if not exists "legal_demo"."main"
    
[0m03:11:22.621860 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:11:22.624634 [debug] [ThreadPool]: On create_legal_demo_main: COMMIT
[0m03:11:22.626156 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m03:11:22.627570 [debug] [ThreadPool]: On create_legal_demo_main: COMMIT
[0m03:11:22.630505 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:11:22.632167 [debug] [ThreadPool]: On create_legal_demo_main: Close
[0m03:11:22.642641 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_legal_demo_main, now list_legal_demo_main)
[0m03:11:22.650291 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo_main"
[0m03:11:22.652663 [debug] [ThreadPool]: On list_legal_demo_main: BEGIN
[0m03:11:22.654356 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:11:22.676977 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:11:22.678708 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo_main"
[0m03:11:22.680162 [debug] [ThreadPool]: On list_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo_main"} */
select
      'legal_demo' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'legal_demo'
  
[0m03:11:22.708094 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:11:22.715490 [debug] [ThreadPool]: On list_legal_demo_main: ROLLBACK
[0m03:11:22.718135 [debug] [ThreadPool]: Failed to rollback 'list_legal_demo_main'
[0m03:11:22.719972 [debug] [ThreadPool]: On list_legal_demo_main: Close
[0m03:11:22.727804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '800319f0-7dab-40c5-939e-600aa463835b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e341715e850>]}
[0m03:11:22.729832 [debug] [MainThread]: Using duckdb connection "master"
[0m03:11:22.731322 [debug] [MainThread]: On master: BEGIN
[0m03:11:22.732716 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:11:22.754770 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m03:11:22.756534 [debug] [MainThread]: On master: COMMIT
[0m03:11:22.757933 [debug] [MainThread]: Using duckdb connection "master"
[0m03:11:22.759401 [debug] [MainThread]: On master: COMMIT
[0m03:11:22.761313 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m03:11:22.762827 [debug] [MainThread]: On master: Close
[0m03:11:22.770451 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:11:22.772669 [info ] [MainThread]: 
[0m03:11:22.785345 [debug] [Thread-1 (]: Began running node model.legal_demo.acris_cases
[0m03:11:22.787683 [info ] [Thread-1 (]: 1 of 1 START sql table model main.acris_clean .................................. [RUN]
[0m03:11:22.789934 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.legal_demo.acris_cases'
[0m03:11:22.791424 [debug] [Thread-1 (]: Began compiling node model.legal_demo.acris_cases
[0m03:11:22.801211 [debug] [Thread-1 (]: Writing injected SQL for node "model.legal_demo.acris_cases"
[0m03:11:22.813790 [debug] [Thread-1 (]: Timing info for model.legal_demo.acris_cases (compile): 03:11:22.792696 => 03:11:22.813335
[0m03:11:22.815435 [debug] [Thread-1 (]: Began executing node model.legal_demo.acris_cases
[0m03:11:22.856018 [debug] [Thread-1 (]: Writing runtime sql for node "model.legal_demo.acris_cases"
[0m03:11:22.870185 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:11:22.872118 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: BEGIN
[0m03:11:22.873656 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m03:11:22.896461 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:11:22.898356 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:11:22.900158 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */

  
    
    

    create  table
      "legal_demo"."main"."acris_clean__dbt_tmp"
  
    as (
      --
-- This model loads the already‑downloaded CSV into DuckDB and
-- materializes it as a table named `acris_clean`.  Because the
-- pipeline does not download data, the file must exist under
-- `data/first_500k_acris.csv` prior to running `dbt run`.  The
-- absolute path points at `/opt/airflow/data/first_500k_acris.csv` when
-- executed inside the Airflow containers.  Locally, dbt resolves
-- relative paths against the project root, so this model continues to
-- work outside of Docker.



SELECT *
FROM read_csv_auto('/opt/airflow/data/first_500k_acris.csv', header=True, delim=',')
    );
  
  
[0m03:11:25.369994 [debug] [Thread-1 (]: SQL status: OK in 2.0 seconds
[0m03:11:25.379363 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:11:25.381473 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
alter table "legal_demo"."main"."acris_clean" rename to "acris_clean__dbt_backup"
[0m03:11:25.384173 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:11:25.389344 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:11:25.391487 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
alter table "legal_demo"."main"."acris_clean__dbt_tmp" rename to "acris_clean"
[0m03:11:25.393878 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:11:25.417993 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: COMMIT
[0m03:11:25.420585 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:11:25.422706 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: COMMIT
[0m03:11:25.443769 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:11:25.451927 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:11:25.457811 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
drop table if exists "legal_demo"."main"."acris_clean__dbt_backup" cascade
[0m03:11:25.466938 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:11:25.470250 [debug] [Thread-1 (]: Timing info for model.legal_demo.acris_cases (execute): 03:11:22.816688 => 03:11:25.469987
[0m03:11:25.472177 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: Close
[0m03:11:25.544298 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '800319f0-7dab-40c5-939e-600aa463835b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e340dfaa010>]}
[0m03:11:25.547611 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main.acris_clean ............................. [[32mOK[0m in 2.75s]
[0m03:11:25.550044 [debug] [Thread-1 (]: Finished running node model.legal_demo.acris_cases
[0m03:11:25.554938 [debug] [MainThread]: Using duckdb connection "master"
[0m03:11:25.556652 [debug] [MainThread]: On master: BEGIN
[0m03:11:25.558388 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:11:25.581315 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m03:11:25.583315 [debug] [MainThread]: On master: COMMIT
[0m03:11:25.585017 [debug] [MainThread]: Using duckdb connection "master"
[0m03:11:25.586800 [debug] [MainThread]: On master: COMMIT
[0m03:11:25.588825 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m03:11:25.590581 [debug] [MainThread]: On master: Close
[0m03:11:25.595051 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:11:25.597220 [debug] [MainThread]: Connection 'list_legal_demo_main' was properly closed.
[0m03:11:25.599026 [debug] [MainThread]: Connection 'model.legal_demo.acris_cases' was properly closed.
[0m03:11:25.600904 [info ] [MainThread]: 
[0m03:11:25.602910 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.11 seconds (3.11s).
[0m03:11:25.605049 [debug] [MainThread]: Command end result
[0m03:11:25.642534 [info ] [MainThread]: 
[0m03:11:25.644370 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:11:25.646114 [info ] [MainThread]: 
[0m03:11:25.648012 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m03:11:25.650756 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.02502, "process_user_time": 7.575416, "process_kernel_time": 1.280634, "process_mem_max_rss": "298052", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m03:11:25.652851 [debug] [MainThread]: Command `dbt run` succeeded at 03:11:25.652643 after 4.03 seconds
[0m03:11:25.654609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e3417100dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e341750f550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e341bd0b550>]}
[0m03:11:25.656512 [debug] [MainThread]: Flushing usage events
[0m03:12:06.402236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7787a46ef510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7787a49f4610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7787a4a57790>]}


============================== 03:12:06.410936 | 22ad80c6-2921-4dbf-8fec-82d39717753f ==============================
[0m03:12:06.410936 [info ] [MainThread]: Running with dbt=1.7.4
[0m03:12:06.412938 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '.', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir .', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m03:12:06.776347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '22ad80c6-2921-4dbf-8fec-82d39717753f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7787a4b70150>]}
[0m03:12:06.875932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '22ad80c6-2921-4dbf-8fec-82d39717753f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7787a48ad190>]}
[0m03:12:06.878580 [info ] [MainThread]: Registered adapter: duckdb=1.7.4
[0m03:12:06.898588 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m03:12:06.984318 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:12:06.986244 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:12:06.997057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '22ad80c6-2921-4dbf-8fec-82d39717753f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77879b4ece50>]}
[0m03:12:07.048980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '22ad80c6-2921-4dbf-8fec-82d39717753f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77879b5f31d0>]}
[0m03:12:07.050987 [info ] [MainThread]: Found 1 model, 0 sources, 0 exposures, 0 metrics, 394 macros, 0 groups, 0 semantic models
[0m03:12:07.052729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '22ad80c6-2921-4dbf-8fec-82d39717753f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77879b581a90>]}
[0m03:12:07.056183 [info ] [MainThread]: 
[0m03:12:07.058614 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m03:12:07.061675 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_legal_demo'
[0m03:12:07.077708 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo"
[0m03:12:07.080187 [debug] [ThreadPool]: On list_legal_demo: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"legal_demo"'
    
  
  
[0m03:12:07.081819 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:12:07.114396 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:12:07.117935 [debug] [ThreadPool]: On list_legal_demo: Close
[0m03:12:07.128352 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_legal_demo, now create_legal_demo_main)
[0m03:12:07.130411 [debug] [ThreadPool]: Creating schema "database: "legal_demo"
schema: "main"
"
[0m03:12:07.139419 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m03:12:07.141825 [debug] [ThreadPool]: On create_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "create_legal_demo_main"} */

    
        select type from duckdb_databases()
        where database_name='legal_demo'
        and type='sqlite'
    
  
[0m03:12:07.143726 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:12:07.170489 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:12:07.173456 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m03:12:07.175200 [debug] [ThreadPool]: On create_legal_demo_main: BEGIN
[0m03:12:07.177435 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:12:07.178772 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m03:12:07.180165 [debug] [ThreadPool]: On create_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "create_legal_demo_main"} */

    
    
        create schema if not exists "legal_demo"."main"
    
[0m03:12:07.182093 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:12:07.184218 [debug] [ThreadPool]: On create_legal_demo_main: COMMIT
[0m03:12:07.185834 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m03:12:07.187337 [debug] [ThreadPool]: On create_legal_demo_main: COMMIT
[0m03:12:07.189981 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:12:07.191753 [debug] [ThreadPool]: On create_legal_demo_main: Close
[0m03:12:07.201474 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_legal_demo_main, now list_legal_demo_main)
[0m03:12:07.209264 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo_main"
[0m03:12:07.211418 [debug] [ThreadPool]: On list_legal_demo_main: BEGIN
[0m03:12:07.212945 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:12:07.237547 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:12:07.239759 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo_main"
[0m03:12:07.241671 [debug] [ThreadPool]: On list_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo_main"} */
select
      'legal_demo' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'legal_demo'
  
[0m03:12:07.269948 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:12:07.277712 [debug] [ThreadPool]: On list_legal_demo_main: ROLLBACK
[0m03:12:07.280283 [debug] [ThreadPool]: Failed to rollback 'list_legal_demo_main'
[0m03:12:07.282071 [debug] [ThreadPool]: On list_legal_demo_main: Close
[0m03:12:07.288847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '22ad80c6-2921-4dbf-8fec-82d39717753f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77879b409b10>]}
[0m03:12:07.290643 [debug] [MainThread]: Using duckdb connection "master"
[0m03:12:07.292287 [debug] [MainThread]: On master: BEGIN
[0m03:12:07.293711 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:12:07.314866 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m03:12:07.316932 [debug] [MainThread]: On master: COMMIT
[0m03:12:07.318402 [debug] [MainThread]: Using duckdb connection "master"
[0m03:12:07.319873 [debug] [MainThread]: On master: COMMIT
[0m03:12:07.321762 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m03:12:07.323140 [debug] [MainThread]: On master: Close
[0m03:12:07.328231 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:12:07.330018 [info ] [MainThread]: 
[0m03:12:07.342227 [debug] [Thread-1 (]: Began running node model.legal_demo.acris_cases
[0m03:12:07.344206 [info ] [Thread-1 (]: 1 of 1 START sql table model main.acris_clean .................................. [RUN]
[0m03:12:07.346409 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.legal_demo.acris_cases'
[0m03:12:07.347964 [debug] [Thread-1 (]: Began compiling node model.legal_demo.acris_cases
[0m03:12:07.357495 [debug] [Thread-1 (]: Writing injected SQL for node "model.legal_demo.acris_cases"
[0m03:12:07.370669 [debug] [Thread-1 (]: Timing info for model.legal_demo.acris_cases (compile): 03:12:07.349268 => 03:12:07.370288
[0m03:12:07.372135 [debug] [Thread-1 (]: Began executing node model.legal_demo.acris_cases
[0m03:12:07.411197 [debug] [Thread-1 (]: Writing runtime sql for node "model.legal_demo.acris_cases"
[0m03:12:07.424702 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:12:07.469992 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: BEGIN
[0m03:12:07.472004 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m03:12:07.498134 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:12:07.500246 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:12:07.503121 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */

  
    
    

    create  table
      "legal_demo"."main"."acris_clean__dbt_tmp"
  
    as (
      --
-- This model loads the already‑downloaded CSV into DuckDB and
-- materializes it as a table named `acris_clean`.  Because the
-- pipeline does not download data, the file must exist under
-- `data/first_500k_acris.csv` prior to running `dbt run`.  The
-- absolute path points at `/opt/airflow/data/first_500k_acris.csv` when
-- executed inside the Airflow containers.  Locally, dbt resolves
-- relative paths against the project root, so this model continues to
-- work outside of Docker.



SELECT *
FROM read_csv_auto('/opt/airflow/data/first_500k_acris.csv', header=True, delim=',')
    );
  
  
[0m03:12:09.895073 [debug] [Thread-1 (]: SQL status: OK in 2.0 seconds
[0m03:12:09.904729 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:12:09.908643 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
alter table "legal_demo"."main"."acris_clean" rename to "acris_clean__dbt_backup"
[0m03:12:09.911527 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:12:09.917660 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:12:09.919803 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
alter table "legal_demo"."main"."acris_clean__dbt_tmp" rename to "acris_clean"
[0m03:12:09.922402 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:12:09.949047 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: COMMIT
[0m03:12:09.951489 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:12:09.953164 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: COMMIT
[0m03:12:10.027638 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:12:10.038535 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:12:10.040821 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
drop table if exists "legal_demo"."main"."acris_clean__dbt_backup" cascade
[0m03:12:10.049058 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:12:10.052501 [debug] [Thread-1 (]: Timing info for model.legal_demo.acris_cases (execute): 03:12:07.373367 => 03:12:10.052142
[0m03:12:10.054595 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: Close
[0m03:12:10.118299 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22ad80c6-2921-4dbf-8fec-82d39717753f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77879b3b43d0>]}
[0m03:12:10.121003 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main.acris_clean ............................. [[32mOK[0m in 2.77s]
[0m03:12:10.122928 [debug] [Thread-1 (]: Finished running node model.legal_demo.acris_cases
[0m03:12:10.127136 [debug] [MainThread]: Using duckdb connection "master"
[0m03:12:10.128811 [debug] [MainThread]: On master: BEGIN
[0m03:12:10.130142 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:12:10.152231 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m03:12:10.183387 [debug] [MainThread]: On master: COMMIT
[0m03:12:10.185218 [debug] [MainThread]: Using duckdb connection "master"
[0m03:12:10.186702 [debug] [MainThread]: On master: COMMIT
[0m03:12:10.188930 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m03:12:10.190368 [debug] [MainThread]: On master: Close
[0m03:12:10.195159 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:12:10.197169 [debug] [MainThread]: Connection 'list_legal_demo_main' was properly closed.
[0m03:12:10.198736 [debug] [MainThread]: Connection 'model.legal_demo.acris_cases' was properly closed.
[0m03:12:10.200439 [info ] [MainThread]: 
[0m03:12:10.202357 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.14 seconds (3.14s).
[0m03:12:10.204434 [debug] [MainThread]: Command end result
[0m03:12:10.238393 [info ] [MainThread]: 
[0m03:12:10.240294 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:12:10.242007 [info ] [MainThread]: 
[0m03:12:10.243819 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m03:12:10.246354 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.912995, "process_user_time": 7.288336, "process_kernel_time": 1.239017, "process_mem_max_rss": "300656", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m03:12:10.248611 [debug] [MainThread]: Command `dbt run` succeeded at 03:12:10.248405 after 3.92 seconds
[0m03:12:10.250174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7787a4b2aa10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7787a4e34ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7787a4f85150>]}
[0m03:12:10.251985 [debug] [MainThread]: Flushing usage events
[0m03:20:37.709847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777b53e7a190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777b53b89010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777b53b89810>]}


============================== 03:20:37.719192 | bb117e2f-8a85-48bb-a35e-5f7ab28ee22a ==============================
[0m03:20:37.719192 [info ] [MainThread]: Running with dbt=1.7.4
[0m03:20:37.721018 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '.', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir .', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m03:20:38.096995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bb117e2f-8a85-48bb-a35e-5f7ab28ee22a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777b5456ce90>]}
[0m03:20:38.194786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bb117e2f-8a85-48bb-a35e-5f7ab28ee22a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777b545456d0>]}
[0m03:20:38.198033 [info ] [MainThread]: Registered adapter: duckdb=1.7.4
[0m03:20:38.218620 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m03:20:38.308451 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:20:38.311606 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:20:38.322886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bb117e2f-8a85-48bb-a35e-5f7ab28ee22a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777b4a4e48d0>]}
[0m03:20:38.379674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bb117e2f-8a85-48bb-a35e-5f7ab28ee22a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777b4a593250>]}
[0m03:20:38.382232 [info ] [MainThread]: Found 1 model, 0 sources, 0 exposures, 0 metrics, 394 macros, 0 groups, 0 semantic models
[0m03:20:38.384653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bb117e2f-8a85-48bb-a35e-5f7ab28ee22a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777b5374dd90>]}
[0m03:20:38.388517 [info ] [MainThread]: 
[0m03:20:38.391383 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m03:20:38.394817 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_legal_demo'
[0m03:20:38.411645 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo"
[0m03:20:38.413667 [debug] [ThreadPool]: On list_legal_demo: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"legal_demo"'
    
  
  
[0m03:20:38.415525 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:20:38.452364 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:20:38.456295 [debug] [ThreadPool]: On list_legal_demo: Close
[0m03:20:38.466049 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_legal_demo, now create_legal_demo_main)
[0m03:20:38.468227 [debug] [ThreadPool]: Creating schema "database: "legal_demo"
schema: "main"
"
[0m03:20:38.478306 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m03:20:38.480583 [debug] [ThreadPool]: On create_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "create_legal_demo_main"} */

    
        select type from duckdb_databases()
        where database_name='legal_demo'
        and type='sqlite'
    
  
[0m03:20:38.482564 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:20:38.510648 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:20:38.514055 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m03:20:38.516195 [debug] [ThreadPool]: On create_legal_demo_main: BEGIN
[0m03:20:38.518479 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:20:38.520254 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m03:20:38.522429 [debug] [ThreadPool]: On create_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "create_legal_demo_main"} */

    
    
        create schema if not exists "legal_demo"."main"
    
[0m03:20:38.525021 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:20:38.528463 [debug] [ThreadPool]: On create_legal_demo_main: COMMIT
[0m03:20:38.530279 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m03:20:38.533809 [debug] [ThreadPool]: On create_legal_demo_main: COMMIT
[0m03:20:38.537596 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:20:38.539444 [debug] [ThreadPool]: On create_legal_demo_main: Close
[0m03:20:38.550459 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_legal_demo_main, now list_legal_demo_main)
[0m03:20:38.558500 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo_main"
[0m03:20:38.560661 [debug] [ThreadPool]: On list_legal_demo_main: BEGIN
[0m03:20:38.562631 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:20:38.586871 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:20:38.588801 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo_main"
[0m03:20:38.590496 [debug] [ThreadPool]: On list_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo_main"} */
select
      'legal_demo' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'legal_demo'
  
[0m03:20:38.618217 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:20:38.627452 [debug] [ThreadPool]: On list_legal_demo_main: ROLLBACK
[0m03:20:38.629992 [debug] [ThreadPool]: Failed to rollback 'list_legal_demo_main'
[0m03:20:38.631794 [debug] [ThreadPool]: On list_legal_demo_main: Close
[0m03:20:38.639355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bb117e2f-8a85-48bb-a35e-5f7ab28ee22a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777b53b6dd10>]}
[0m03:20:38.641239 [debug] [MainThread]: Using duckdb connection "master"
[0m03:20:38.642869 [debug] [MainThread]: On master: BEGIN
[0m03:20:38.644654 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:20:38.668778 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m03:20:38.670840 [debug] [MainThread]: On master: COMMIT
[0m03:20:38.672393 [debug] [MainThread]: Using duckdb connection "master"
[0m03:20:38.673789 [debug] [MainThread]: On master: COMMIT
[0m03:20:38.675815 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m03:20:38.677645 [debug] [MainThread]: On master: Close
[0m03:20:38.682655 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:20:38.684391 [info ] [MainThread]: 
[0m03:20:38.696947 [debug] [Thread-1 (]: Began running node model.legal_demo.acris_cases
[0m03:20:38.699382 [info ] [Thread-1 (]: 1 of 1 START sql table model main.acris_clean .................................. [RUN]
[0m03:20:38.702281 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.legal_demo.acris_cases'
[0m03:20:38.703827 [debug] [Thread-1 (]: Began compiling node model.legal_demo.acris_cases
[0m03:20:38.716109 [debug] [Thread-1 (]: Writing injected SQL for node "model.legal_demo.acris_cases"
[0m03:20:38.729798 [debug] [Thread-1 (]: Timing info for model.legal_demo.acris_cases (compile): 03:20:38.705222 => 03:20:38.729255
[0m03:20:38.731513 [debug] [Thread-1 (]: Began executing node model.legal_demo.acris_cases
[0m03:20:38.771687 [debug] [Thread-1 (]: Writing runtime sql for node "model.legal_demo.acris_cases"
[0m03:20:38.785634 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:20:38.787293 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: BEGIN
[0m03:20:38.788673 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m03:20:38.812387 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:20:38.814260 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:20:38.815749 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */

  
    
    

    create  table
      "legal_demo"."main"."acris_clean__dbt_tmp"
  
    as (
      --
-- This model loads the already‑downloaded CSV into DuckDB and
-- materializes it as a table named `acris_clean`.  Because the
-- pipeline does not download data, the file must exist under
-- `data/first_500k_acris.csv` prior to running `dbt run`.  The
-- absolute path points at `/opt/airflow/data/first_500k_acris.csv` when
-- executed inside the Airflow containers.  Locally, dbt resolves
-- relative paths against the project root, so this model continues to
-- work outside of Docker.



SELECT *
FROM read_csv_auto('/opt/airflow/data/first_500k_acris.csv', header=True, delim=',')
    );
  
  
[0m03:20:41.381341 [debug] [Thread-1 (]: SQL status: OK in 3.0 seconds
[0m03:20:41.390009 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:20:41.391803 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
alter table "legal_demo"."main"."acris_clean" rename to "acris_clean__dbt_backup"
[0m03:20:41.394021 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:20:41.398655 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:20:41.400569 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
alter table "legal_demo"."main"."acris_clean__dbt_tmp" rename to "acris_clean"
[0m03:20:41.402828 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:20:41.427159 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: COMMIT
[0m03:20:41.429155 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:20:41.430974 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: COMMIT
[0m03:20:41.499470 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:20:41.507977 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:20:41.510229 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
drop table if exists "legal_demo"."main"."acris_clean__dbt_backup" cascade
[0m03:20:41.518403 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:20:41.521401 [debug] [Thread-1 (]: Timing info for model.legal_demo.acris_cases (execute): 03:20:38.732809 => 03:20:41.521138
[0m03:20:41.523213 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: Close
[0m03:20:41.597051 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb117e2f-8a85-48bb-a35e-5f7ab28ee22a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777b53b6dd50>]}
[0m03:20:41.599554 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main.acris_clean ............................. [[32mOK[0m in 2.90s]
[0m03:20:41.601624 [debug] [Thread-1 (]: Finished running node model.legal_demo.acris_cases
[0m03:20:41.606351 [debug] [MainThread]: Using duckdb connection "master"
[0m03:20:41.607893 [debug] [MainThread]: On master: BEGIN
[0m03:20:41.609387 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:20:41.631833 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m03:20:41.633500 [debug] [MainThread]: On master: COMMIT
[0m03:20:41.635136 [debug] [MainThread]: Using duckdb connection "master"
[0m03:20:41.636563 [debug] [MainThread]: On master: COMMIT
[0m03:20:41.638570 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m03:20:41.640036 [debug] [MainThread]: On master: Close
[0m03:20:41.646287 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:20:41.647927 [debug] [MainThread]: Connection 'list_legal_demo_main' was properly closed.
[0m03:20:41.649331 [debug] [MainThread]: Connection 'model.legal_demo.acris_cases' was properly closed.
[0m03:20:41.650908 [info ] [MainThread]: 
[0m03:20:41.652595 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.26 seconds (3.26s).
[0m03:20:41.654848 [debug] [MainThread]: Command end result
[0m03:20:41.694470 [info ] [MainThread]: 
[0m03:20:41.696621 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:20:41.698652 [info ] [MainThread]: 
[0m03:20:41.700350 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m03:20:41.703436 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.059766, "process_user_time": 7.196494, "process_kernel_time": 1.649362, "process_mem_max_rss": "298140", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m03:20:41.705657 [debug] [MainThread]: Command `dbt run` succeeded at 03:20:41.705386 after 4.06 seconds
[0m03:20:41.708236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777b53bb6450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777b53a98a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777b5853f450>]}
[0m03:20:41.710191 [debug] [MainThread]: Flushing usage events
[0m03:21:33.742096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ceb9b2d290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ceb9ae5190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72cebc01acd0>]}


============================== 03:21:33.751942 | 13015413-6512-425d-8ad0-6b4915229689 ==============================
[0m03:21:33.751942 [info ] [MainThread]: Running with dbt=1.7.4
[0m03:21:33.754477 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '.', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir .', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m03:21:34.142296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '13015413-6512-425d-8ad0-6b4915229689', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ceb9e0ba10>]}
[0m03:21:34.242972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '13015413-6512-425d-8ad0-6b4915229689', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ceb96ffed0>]}
[0m03:21:34.245629 [info ] [MainThread]: Registered adapter: duckdb=1.7.4
[0m03:21:34.267381 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m03:21:34.351778 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:21:34.353787 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:21:34.361737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '13015413-6512-425d-8ad0-6b4915229689', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ceb04f0fd0>]}
[0m03:21:34.411621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '13015413-6512-425d-8ad0-6b4915229689', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ceb9727250>]}
[0m03:21:34.413851 [info ] [MainThread]: Found 1 model, 0 sources, 0 exposures, 0 metrics, 394 macros, 0 groups, 0 semantic models
[0m03:21:34.415764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '13015413-6512-425d-8ad0-6b4915229689', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ceb0555450>]}
[0m03:21:34.419214 [info ] [MainThread]: 
[0m03:21:34.422030 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m03:21:34.425209 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_legal_demo'
[0m03:21:34.442418 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo"
[0m03:21:34.445087 [debug] [ThreadPool]: On list_legal_demo: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"legal_demo"'
    
  
  
[0m03:21:34.446968 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:21:34.479476 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:21:34.482880 [debug] [ThreadPool]: On list_legal_demo: Close
[0m03:21:34.537697 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_legal_demo, now create_legal_demo_main)
[0m03:21:34.539892 [debug] [ThreadPool]: Creating schema "database: "legal_demo"
schema: "main"
"
[0m03:21:34.548840 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m03:21:34.550929 [debug] [ThreadPool]: On create_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "create_legal_demo_main"} */

    
        select type from duckdb_databases()
        where database_name='legal_demo'
        and type='sqlite'
    
  
[0m03:21:34.552668 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:21:34.629420 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:21:34.633484 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m03:21:34.635805 [debug] [ThreadPool]: On create_legal_demo_main: BEGIN
[0m03:21:34.639114 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:21:34.642419 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m03:21:34.645719 [debug] [ThreadPool]: On create_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "create_legal_demo_main"} */

    
    
        create schema if not exists "legal_demo"."main"
    
[0m03:21:34.649044 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:21:34.652804 [debug] [ThreadPool]: On create_legal_demo_main: COMMIT
[0m03:21:34.654814 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m03:21:34.656643 [debug] [ThreadPool]: On create_legal_demo_main: COMMIT
[0m03:21:34.660739 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:21:34.667096 [debug] [ThreadPool]: On create_legal_demo_main: Close
[0m03:21:34.677323 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_legal_demo_main, now list_legal_demo_main)
[0m03:21:34.685590 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo_main"
[0m03:21:34.687957 [debug] [ThreadPool]: On list_legal_demo_main: BEGIN
[0m03:21:34.689543 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:21:34.761881 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:21:34.764086 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo_main"
[0m03:21:34.765904 [debug] [ThreadPool]: On list_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo_main"} */
select
      'legal_demo' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'legal_demo'
  
[0m03:21:34.792820 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:21:34.800285 [debug] [ThreadPool]: On list_legal_demo_main: ROLLBACK
[0m03:21:34.803166 [debug] [ThreadPool]: Failed to rollback 'list_legal_demo_main'
[0m03:21:34.805051 [debug] [ThreadPool]: On list_legal_demo_main: Close
[0m03:21:34.811722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '13015413-6512-425d-8ad0-6b4915229689', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ceb0534b10>]}
[0m03:21:34.813892 [debug] [MainThread]: Using duckdb connection "master"
[0m03:21:34.815567 [debug] [MainThread]: On master: BEGIN
[0m03:21:34.816982 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:21:34.838941 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m03:21:34.840884 [debug] [MainThread]: On master: COMMIT
[0m03:21:34.842655 [debug] [MainThread]: Using duckdb connection "master"
[0m03:21:34.844184 [debug] [MainThread]: On master: COMMIT
[0m03:21:34.846109 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m03:21:34.847724 [debug] [MainThread]: On master: Close
[0m03:21:34.852521 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:21:34.854520 [info ] [MainThread]: 
[0m03:21:34.867438 [debug] [Thread-1 (]: Began running node model.legal_demo.acris_cases
[0m03:21:34.869461 [info ] [Thread-1 (]: 1 of 1 START sql table model main.acris_clean .................................. [RUN]
[0m03:21:34.872152 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.legal_demo.acris_cases'
[0m03:21:34.873614 [debug] [Thread-1 (]: Began compiling node model.legal_demo.acris_cases
[0m03:21:34.884012 [debug] [Thread-1 (]: Writing injected SQL for node "model.legal_demo.acris_cases"
[0m03:21:34.899068 [debug] [Thread-1 (]: Timing info for model.legal_demo.acris_cases (compile): 03:21:34.875092 => 03:21:34.898574
[0m03:21:34.900989 [debug] [Thread-1 (]: Began executing node model.legal_demo.acris_cases
[0m03:21:34.944661 [debug] [Thread-1 (]: Writing runtime sql for node "model.legal_demo.acris_cases"
[0m03:21:34.956451 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:21:34.958134 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: BEGIN
[0m03:21:34.959428 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m03:21:34.983869 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:21:34.986322 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:21:34.988623 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */

  
    
    

    create  table
      "legal_demo"."main"."acris_clean__dbt_tmp"
  
    as (
      --
-- This model loads the already‑downloaded CSV into DuckDB and
-- materializes it as a table named `acris_clean`.  Because the
-- pipeline does not download data, the file must exist under
-- `data/first_500k_acris.csv` prior to running `dbt run`.  The
-- absolute path points at `/opt/airflow/data/first_500k_acris.csv` when
-- executed inside the Airflow containers.  Locally, dbt resolves
-- relative paths against the project root, so this model continues to
-- work outside of Docker.



SELECT *
FROM read_csv_auto('/opt/airflow/data/first_500k_acris.csv', header=True, delim=',')
    );
  
  
[0m03:21:37.524644 [debug] [Thread-1 (]: SQL status: OK in 3.0 seconds
[0m03:21:37.536996 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:21:37.539012 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
alter table "legal_demo"."main"."acris_clean" rename to "acris_clean__dbt_backup"
[0m03:21:37.541299 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:21:37.546360 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:21:37.548524 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
alter table "legal_demo"."main"."acris_clean__dbt_tmp" rename to "acris_clean"
[0m03:21:37.550839 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:21:37.574463 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: COMMIT
[0m03:21:37.576898 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:21:37.578739 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: COMMIT
[0m03:21:37.646791 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:21:37.654464 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:21:37.656780 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
drop table if exists "legal_demo"."main"."acris_clean__dbt_backup" cascade
[0m03:21:37.664254 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:21:37.667526 [debug] [Thread-1 (]: Timing info for model.legal_demo.acris_cases (execute): 03:21:34.902527 => 03:21:37.667040
[0m03:21:37.669524 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: Close
[0m03:21:37.734963 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13015413-6512-425d-8ad0-6b4915229689', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ceb043b590>]}
[0m03:21:37.737959 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main.acris_clean ............................. [[32mOK[0m in 2.86s]
[0m03:21:37.740843 [debug] [Thread-1 (]: Finished running node model.legal_demo.acris_cases
[0m03:21:37.746255 [debug] [MainThread]: Using duckdb connection "master"
[0m03:21:37.748081 [debug] [MainThread]: On master: BEGIN
[0m03:21:37.749478 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:21:37.770265 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m03:21:37.772073 [debug] [MainThread]: On master: COMMIT
[0m03:21:37.773709 [debug] [MainThread]: Using duckdb connection "master"
[0m03:21:37.775294 [debug] [MainThread]: On master: COMMIT
[0m03:21:37.777195 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m03:21:37.778625 [debug] [MainThread]: On master: Close
[0m03:21:37.782933 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:21:37.784571 [debug] [MainThread]: Connection 'list_legal_demo_main' was properly closed.
[0m03:21:37.786251 [debug] [MainThread]: Connection 'model.legal_demo.acris_cases' was properly closed.
[0m03:21:37.787923 [info ] [MainThread]: 
[0m03:21:37.789788 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.37 seconds (3.37s).
[0m03:21:37.791899 [debug] [MainThread]: Command end result
[0m03:21:37.828551 [info ] [MainThread]: 
[0m03:21:37.830610 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:21:37.832494 [info ] [MainThread]: 
[0m03:21:37.834630 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m03:21:37.837601 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.169427, "process_user_time": 7.535725, "process_kernel_time": 1.44095, "process_mem_max_rss": "295872", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m03:21:37.840208 [debug] [MainThread]: Command `dbt run` succeeded at 03:21:37.839931 after 4.17 seconds
[0m03:21:37.841873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ceb9dfc750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ceb9b15f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72cebe56ab50>]}
[0m03:21:37.843681 [debug] [MainThread]: Flushing usage events
[0m03:22:19.943674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb96c94050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb96c75dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb96c60250>]}


============================== 03:22:19.953019 | ee673898-a532-4c81-b163-fa1d346c2532 ==============================
[0m03:22:19.953019 [info ] [MainThread]: Running with dbt=1.7.4
[0m03:22:19.955020 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '.', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir .', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m03:22:20.347946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ee673898-a532-4c81-b163-fa1d346c2532', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb96c57fd0>]}
[0m03:22:20.449146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ee673898-a532-4c81-b163-fa1d346c2532', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb9659ba90>]}
[0m03:22:20.451859 [info ] [MainThread]: Registered adapter: duckdb=1.7.4
[0m03:22:20.471818 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m03:22:20.554436 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:22:20.556673 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:22:20.565277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ee673898-a532-4c81-b163-fa1d346c2532', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb8d2dbdd0>]}
[0m03:22:20.617862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ee673898-a532-4c81-b163-fa1d346c2532', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb8d3d4710>]}
[0m03:22:20.620135 [info ] [MainThread]: Found 1 model, 0 sources, 0 exposures, 0 metrics, 394 macros, 0 groups, 0 semantic models
[0m03:22:20.621986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ee673898-a532-4c81-b163-fa1d346c2532', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb96804410>]}
[0m03:22:20.625685 [info ] [MainThread]: 
[0m03:22:20.628620 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m03:22:20.631941 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_legal_demo'
[0m03:22:20.647686 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo"
[0m03:22:20.649831 [debug] [ThreadPool]: On list_legal_demo: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"legal_demo"'
    
  
  
[0m03:22:20.651751 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:22:20.704554 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:22:20.709133 [debug] [ThreadPool]: On list_legal_demo: Close
[0m03:22:20.724766 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_legal_demo, now create_legal_demo_main)
[0m03:22:20.728597 [debug] [ThreadPool]: Creating schema "database: "legal_demo"
schema: "main"
"
[0m03:22:20.747501 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m03:22:20.750132 [debug] [ThreadPool]: On create_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "create_legal_demo_main"} */

    
        select type from duckdb_databases()
        where database_name='legal_demo'
        and type='sqlite'
    
  
[0m03:22:20.753272 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:22:20.786807 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:22:20.790637 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m03:22:20.792937 [debug] [ThreadPool]: On create_legal_demo_main: BEGIN
[0m03:22:20.794999 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:22:20.799670 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m03:22:20.801747 [debug] [ThreadPool]: On create_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "create_legal_demo_main"} */

    
    
        create schema if not exists "legal_demo"."main"
    
[0m03:22:20.804421 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:22:20.807584 [debug] [ThreadPool]: On create_legal_demo_main: COMMIT
[0m03:22:20.809755 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m03:22:20.811652 [debug] [ThreadPool]: On create_legal_demo_main: COMMIT
[0m03:22:20.817272 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:22:20.819326 [debug] [ThreadPool]: On create_legal_demo_main: Close
[0m03:22:20.830892 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_legal_demo_main, now list_legal_demo_main)
[0m03:22:20.886416 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo_main"
[0m03:22:20.888765 [debug] [ThreadPool]: On list_legal_demo_main: BEGIN
[0m03:22:20.891282 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:22:20.918585 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:22:20.920480 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo_main"
[0m03:22:20.922945 [debug] [ThreadPool]: On list_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo_main"} */
select
      'legal_demo' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'legal_demo'
  
[0m03:22:20.950380 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:22:20.959816 [debug] [ThreadPool]: On list_legal_demo_main: ROLLBACK
[0m03:22:20.963753 [debug] [ThreadPool]: Failed to rollback 'list_legal_demo_main'
[0m03:22:20.965399 [debug] [ThreadPool]: On list_legal_demo_main: Close
[0m03:22:20.974883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ee673898-a532-4c81-b163-fa1d346c2532', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb933b5450>]}
[0m03:22:20.977918 [debug] [MainThread]: Using duckdb connection "master"
[0m03:22:20.980893 [debug] [MainThread]: On master: BEGIN
[0m03:22:20.982977 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:22:21.007580 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m03:22:21.009900 [debug] [MainThread]: On master: COMMIT
[0m03:22:21.011496 [debug] [MainThread]: Using duckdb connection "master"
[0m03:22:21.013131 [debug] [MainThread]: On master: COMMIT
[0m03:22:21.015130 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m03:22:21.016522 [debug] [MainThread]: On master: Close
[0m03:22:21.021507 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:22:21.023313 [info ] [MainThread]: 
[0m03:22:21.035895 [debug] [Thread-1 (]: Began running node model.legal_demo.acris_cases
[0m03:22:21.038030 [info ] [Thread-1 (]: 1 of 1 START sql table model main.acris_clean .................................. [RUN]
[0m03:22:21.040974 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.legal_demo.acris_cases'
[0m03:22:21.042572 [debug] [Thread-1 (]: Began compiling node model.legal_demo.acris_cases
[0m03:22:21.053687 [debug] [Thread-1 (]: Writing injected SQL for node "model.legal_demo.acris_cases"
[0m03:22:21.065428 [debug] [Thread-1 (]: Timing info for model.legal_demo.acris_cases (compile): 03:22:21.044010 => 03:22:21.064925
[0m03:22:21.066906 [debug] [Thread-1 (]: Began executing node model.legal_demo.acris_cases
[0m03:22:21.104875 [debug] [Thread-1 (]: Writing runtime sql for node "model.legal_demo.acris_cases"
[0m03:22:21.118260 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:22:21.119786 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: BEGIN
[0m03:22:21.121102 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m03:22:21.145508 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:22:21.147488 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:22:21.149090 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */

  
    
    

    create  table
      "legal_demo"."main"."acris_clean__dbt_tmp"
  
    as (
      --
-- This model loads the already‑downloaded CSV into DuckDB and
-- materializes it as a table named `acris_clean`.  Because the
-- pipeline does not download data, the file must exist under
-- `data/first_500k_acris.csv` prior to running `dbt run`.  The
-- absolute path points at `/opt/airflow/data/first_500k_acris.csv` when
-- executed inside the Airflow containers.  Locally, dbt resolves
-- relative paths against the project root, so this model continues to
-- work outside of Docker.



SELECT *
FROM read_csv_auto('/opt/airflow/data/first_500k_acris.csv', header=True, delim=',')
    );
  
  
[0m03:22:23.689507 [debug] [Thread-1 (]: SQL status: OK in 3.0 seconds
[0m03:22:23.698342 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:22:23.700610 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
alter table "legal_demo"."main"."acris_clean" rename to "acris_clean__dbt_backup"
[0m03:22:23.702901 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:22:23.707743 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:22:23.709776 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
alter table "legal_demo"."main"."acris_clean__dbt_tmp" rename to "acris_clean"
[0m03:22:23.711783 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:22:23.736231 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: COMMIT
[0m03:22:23.738500 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:22:23.740582 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: COMMIT
[0m03:22:23.805137 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:22:23.814585 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:22:23.818458 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
drop table if exists "legal_demo"."main"."acris_clean__dbt_backup" cascade
[0m03:22:23.828697 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:22:23.832754 [debug] [Thread-1 (]: Timing info for model.legal_demo.acris_cases (execute): 03:22:21.068266 => 03:22:23.832326
[0m03:22:23.834516 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: Close
[0m03:22:23.908983 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee673898-a532-4c81-b163-fa1d346c2532', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb9772b310>]}
[0m03:22:23.911876 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main.acris_clean ............................. [[32mOK[0m in 2.87s]
[0m03:22:23.914561 [debug] [Thread-1 (]: Finished running node model.legal_demo.acris_cases
[0m03:22:23.922716 [debug] [MainThread]: Using duckdb connection "master"
[0m03:22:23.925929 [debug] [MainThread]: On master: BEGIN
[0m03:22:23.927441 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:22:23.955198 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m03:22:23.957260 [debug] [MainThread]: On master: COMMIT
[0m03:22:23.958908 [debug] [MainThread]: Using duckdb connection "master"
[0m03:22:23.961225 [debug] [MainThread]: On master: COMMIT
[0m03:22:23.963475 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m03:22:23.965294 [debug] [MainThread]: On master: Close
[0m03:22:23.970594 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:22:23.972164 [debug] [MainThread]: Connection 'list_legal_demo_main' was properly closed.
[0m03:22:23.973710 [debug] [MainThread]: Connection 'model.legal_demo.acris_cases' was properly closed.
[0m03:22:23.975338 [info ] [MainThread]: 
[0m03:22:23.977155 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.35 seconds (3.35s).
[0m03:22:23.979020 [debug] [MainThread]: Command end result
[0m03:22:24.018797 [info ] [MainThread]: 
[0m03:22:24.021148 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:22:24.023190 [info ] [MainThread]: 
[0m03:22:24.025293 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m03:22:24.028145 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.15283, "process_user_time": 7.643404, "process_kernel_time": 1.414409, "process_mem_max_rss": "301244", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m03:22:24.030463 [debug] [MainThread]: Command `dbt run` succeeded at 03:22:24.030238 after 4.16 seconds
[0m03:22:24.032093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb96a9e490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb96c55550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb9686b990>]}
[0m03:22:24.034176 [debug] [MainThread]: Flushing usage events
[0m03:23:03.664903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7841f4953a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7841f55f2e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7841f4903d50>]}


============================== 03:23:03.677392 | 248fb23b-1c52-44ea-a61e-465f472e40ab ==============================
[0m03:23:03.677392 [info ] [MainThread]: Running with dbt=1.7.4
[0m03:23:03.679799 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir .', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m03:23:04.064532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '248fb23b-1c52-44ea-a61e-465f472e40ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7841f464a6d0>]}
[0m03:23:04.173893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '248fb23b-1c52-44ea-a61e-465f472e40ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7841f4bdbb10>]}
[0m03:23:04.176516 [info ] [MainThread]: Registered adapter: duckdb=1.7.4
[0m03:23:04.199216 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m03:23:04.285621 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:23:04.287886 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:23:04.296556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '248fb23b-1c52-44ea-a61e-465f472e40ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7841eadfc7d0>]}
[0m03:23:04.344261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '248fb23b-1c52-44ea-a61e-465f472e40ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7841eb0f3ad0>]}
[0m03:23:04.346105 [info ] [MainThread]: Found 1 model, 0 sources, 0 exposures, 0 metrics, 394 macros, 0 groups, 0 semantic models
[0m03:23:04.348083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '248fb23b-1c52-44ea-a61e-465f472e40ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7841eb086ed0>]}
[0m03:23:04.351627 [info ] [MainThread]: 
[0m03:23:04.354459 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m03:23:04.357374 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_legal_demo'
[0m03:23:04.372915 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo"
[0m03:23:04.375199 [debug] [ThreadPool]: On list_legal_demo: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"legal_demo"'
    
  
  
[0m03:23:04.377012 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:23:04.413030 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:23:04.416643 [debug] [ThreadPool]: On list_legal_demo: Close
[0m03:23:04.426140 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_legal_demo, now create_legal_demo_main)
[0m03:23:04.428685 [debug] [ThreadPool]: Creating schema "database: "legal_demo"
schema: "main"
"
[0m03:23:04.437917 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m03:23:04.440232 [debug] [ThreadPool]: On create_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "create_legal_demo_main"} */

    
        select type from duckdb_databases()
        where database_name='legal_demo'
        and type='sqlite'
    
  
[0m03:23:04.441800 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:23:04.470946 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:23:04.497037 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m03:23:04.500561 [debug] [ThreadPool]: On create_legal_demo_main: BEGIN
[0m03:23:04.503274 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:23:04.506118 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m03:23:04.508179 [debug] [ThreadPool]: On create_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "create_legal_demo_main"} */

    
    
        create schema if not exists "legal_demo"."main"
    
[0m03:23:04.510013 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:23:04.512871 [debug] [ThreadPool]: On create_legal_demo_main: COMMIT
[0m03:23:04.514663 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m03:23:04.516461 [debug] [ThreadPool]: On create_legal_demo_main: COMMIT
[0m03:23:04.520223 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:23:04.522012 [debug] [ThreadPool]: On create_legal_demo_main: Close
[0m03:23:04.533244 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_legal_demo_main, now list_legal_demo_main)
[0m03:23:04.541842 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo_main"
[0m03:23:04.544218 [debug] [ThreadPool]: On list_legal_demo_main: BEGIN
[0m03:23:04.545954 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:23:04.569808 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:23:04.571529 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo_main"
[0m03:23:04.573301 [debug] [ThreadPool]: On list_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo_main"} */
select
      'legal_demo' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'legal_demo'
  
[0m03:23:04.600158 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:23:04.609437 [debug] [ThreadPool]: On list_legal_demo_main: ROLLBACK
[0m03:23:04.611813 [debug] [ThreadPool]: Failed to rollback 'list_legal_demo_main'
[0m03:23:04.613389 [debug] [ThreadPool]: On list_legal_demo_main: Close
[0m03:23:04.621379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '248fb23b-1c52-44ea-a61e-465f472e40ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7841f42687d0>]}
[0m03:23:04.623493 [debug] [MainThread]: Using duckdb connection "master"
[0m03:23:04.625063 [debug] [MainThread]: On master: BEGIN
[0m03:23:04.626481 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:23:04.649292 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m03:23:04.651011 [debug] [MainThread]: On master: COMMIT
[0m03:23:04.652600 [debug] [MainThread]: Using duckdb connection "master"
[0m03:23:04.654005 [debug] [MainThread]: On master: COMMIT
[0m03:23:04.655984 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m03:23:04.657645 [debug] [MainThread]: On master: Close
[0m03:23:04.662841 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:23:04.664920 [info ] [MainThread]: 
[0m03:23:04.678764 [debug] [Thread-1 (]: Began running node model.legal_demo.acris_cases
[0m03:23:04.680838 [info ] [Thread-1 (]: 1 of 1 START sql table model main.acris_clean .................................. [RUN]
[0m03:23:04.683180 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.legal_demo.acris_cases'
[0m03:23:04.684793 [debug] [Thread-1 (]: Began compiling node model.legal_demo.acris_cases
[0m03:23:04.707380 [debug] [Thread-1 (]: Writing injected SQL for node "model.legal_demo.acris_cases"
[0m03:23:04.724573 [debug] [Thread-1 (]: Timing info for model.legal_demo.acris_cases (compile): 03:23:04.686328 => 03:23:04.723958
[0m03:23:04.726200 [debug] [Thread-1 (]: Began executing node model.legal_demo.acris_cases
[0m03:23:04.765379 [debug] [Thread-1 (]: Writing runtime sql for node "model.legal_demo.acris_cases"
[0m03:23:04.778838 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:23:04.780439 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: BEGIN
[0m03:23:04.781840 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m03:23:04.804522 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:23:04.806333 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:23:04.807784 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */

  
    
    

    create  table
      "legal_demo"."main"."acris_clean__dbt_tmp"
  
    as (
      --
-- This model loads the already‑downloaded CSV into DuckDB and
-- materializes it as a table named `acris_clean`.  Because the
-- pipeline does not download data, the file must exist under
-- `data/first_500k_acris.csv` prior to running `dbt run`.  The
-- absolute path points at `/opt/airflow/data/first_500k_acris.csv` when
-- executed inside the Airflow containers.  Locally, dbt resolves
-- relative paths against the project root, so this model continues to
-- work outside of Docker.



SELECT *
FROM read_csv_auto('/opt/airflow/data/first_500k_acris.csv', header=True, delim=',')
    );
  
  
[0m03:23:07.326893 [debug] [Thread-1 (]: SQL status: OK in 3.0 seconds
[0m03:23:07.337888 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:23:07.339649 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
alter table "legal_demo"."main"."acris_clean" rename to "acris_clean__dbt_backup"
[0m03:23:07.342505 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:23:07.347269 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:23:07.349331 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
alter table "legal_demo"."main"."acris_clean__dbt_tmp" rename to "acris_clean"
[0m03:23:07.351477 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:23:07.375250 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: COMMIT
[0m03:23:07.377412 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:23:07.379342 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: COMMIT
[0m03:23:07.445578 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:23:07.455273 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:23:07.457712 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
drop table if exists "legal_demo"."main"."acris_clean__dbt_backup" cascade
[0m03:23:07.466395 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:23:07.470074 [debug] [Thread-1 (]: Timing info for model.legal_demo.acris_cases (execute): 03:23:04.727333 => 03:23:07.469625
[0m03:23:07.471901 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: Close
[0m03:23:07.540626 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '248fb23b-1c52-44ea-a61e-465f472e40ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7841f4272f90>]}
[0m03:23:07.543124 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main.acris_clean ............................. [[32mOK[0m in 2.86s]
[0m03:23:07.546221 [debug] [Thread-1 (]: Finished running node model.legal_demo.acris_cases
[0m03:23:07.551210 [debug] [MainThread]: Using duckdb connection "master"
[0m03:23:07.553045 [debug] [MainThread]: On master: BEGIN
[0m03:23:07.554460 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:23:07.575800 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m03:23:07.577806 [debug] [MainThread]: On master: COMMIT
[0m03:23:07.579161 [debug] [MainThread]: Using duckdb connection "master"
[0m03:23:07.581672 [debug] [MainThread]: On master: COMMIT
[0m03:23:07.583558 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m03:23:07.585244 [debug] [MainThread]: On master: Close
[0m03:23:07.589953 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:23:07.591590 [debug] [MainThread]: Connection 'list_legal_demo_main' was properly closed.
[0m03:23:07.593582 [debug] [MainThread]: Connection 'model.legal_demo.acris_cases' was properly closed.
[0m03:23:07.595256 [info ] [MainThread]: 
[0m03:23:07.597155 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.24 seconds (3.24s).
[0m03:23:07.599257 [debug] [MainThread]: Command end result
[0m03:23:07.633949 [info ] [MainThread]: 
[0m03:23:07.635998 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:23:07.637665 [info ] [MainThread]: 
[0m03:23:07.639292 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m03:23:07.642032 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.048859, "process_user_time": 7.460798, "process_kernel_time": 1.262843, "process_mem_max_rss": "298588", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m03:23:07.643958 [debug] [MainThread]: Command `dbt run` succeeded at 03:23:07.643749 after 4.05 seconds
[0m03:23:07.645739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7841f4548710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7841f4976a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7841f455ef10>]}
[0m03:23:07.647386 [debug] [MainThread]: Flushing usage events
[0m03:27:03.740632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c44d27b1290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c44d26e5610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c44d2969c90>]}


============================== 03:27:03.750685 | 7cd5f3bf-1785-4eb4-8d2f-c73dcfb81d69 ==============================
[0m03:27:03.750685 [info ] [MainThread]: Running with dbt=1.7.4
[0m03:27:03.752722 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m03:27:04.267847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7cd5f3bf-1785-4eb4-8d2f-c73dcfb81d69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c44d236c590>]}
[0m03:27:04.390785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7cd5f3bf-1785-4eb4-8d2f-c73dcfb81d69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c44d26fc7d0>]}
[0m03:27:04.412327 [info ] [MainThread]: Registered adapter: duckdb=1.7.4
[0m03:27:04.440708 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m03:27:04.542324 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:27:04.544108 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:27:04.554304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7cd5f3bf-1785-4eb4-8d2f-c73dcfb81d69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c44c91c4990>]}
[0m03:27:04.607367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7cd5f3bf-1785-4eb4-8d2f-c73dcfb81d69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c44c914b8d0>]}
[0m03:27:04.609793 [info ] [MainThread]: Found 1 model, 0 sources, 0 exposures, 0 metrics, 394 macros, 0 groups, 0 semantic models
[0m03:27:04.611880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7cd5f3bf-1785-4eb4-8d2f-c73dcfb81d69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c44c921fd90>]}
[0m03:27:04.616031 [info ] [MainThread]: 
[0m03:27:04.619108 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m03:27:04.622415 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_legal_demo'
[0m03:27:04.640733 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo"
[0m03:27:04.643185 [debug] [ThreadPool]: On list_legal_demo: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"legal_demo"'
    
  
  
[0m03:27:04.644747 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:27:04.679537 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:27:04.683647 [debug] [ThreadPool]: On list_legal_demo: Close
[0m03:27:04.693574 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_legal_demo, now create_legal_demo_main)
[0m03:27:04.695677 [debug] [ThreadPool]: Creating schema "database: "legal_demo"
schema: "main"
"
[0m03:27:04.708064 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m03:27:04.710519 [debug] [ThreadPool]: On create_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "create_legal_demo_main"} */

    
        select type from duckdb_databases()
        where database_name='legal_demo'
        and type='sqlite'
    
  
[0m03:27:04.712271 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:27:04.740612 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:27:04.743742 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m03:27:04.745749 [debug] [ThreadPool]: On create_legal_demo_main: BEGIN
[0m03:27:04.748329 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:27:04.750036 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m03:27:04.751617 [debug] [ThreadPool]: On create_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "create_legal_demo_main"} */

    
    
        create schema if not exists "legal_demo"."main"
    
[0m03:27:04.754309 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:27:04.757365 [debug] [ThreadPool]: On create_legal_demo_main: COMMIT
[0m03:27:04.759076 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m03:27:04.760529 [debug] [ThreadPool]: On create_legal_demo_main: COMMIT
[0m03:27:04.763618 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:27:04.765208 [debug] [ThreadPool]: On create_legal_demo_main: Close
[0m03:27:04.775633 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_legal_demo_main, now list_legal_demo_main)
[0m03:27:04.784282 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo_main"
[0m03:27:04.786453 [debug] [ThreadPool]: On list_legal_demo_main: BEGIN
[0m03:27:04.788117 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:27:04.811323 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:27:04.813130 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo_main"
[0m03:27:04.814881 [debug] [ThreadPool]: On list_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo_main"} */
select
      'legal_demo' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'legal_demo'
  
[0m03:27:04.847674 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:27:04.854840 [debug] [ThreadPool]: On list_legal_demo_main: ROLLBACK
[0m03:27:04.857412 [debug] [ThreadPool]: Failed to rollback 'list_legal_demo_main'
[0m03:27:04.858942 [debug] [ThreadPool]: On list_legal_demo_main: Close
[0m03:27:04.865192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7cd5f3bf-1785-4eb4-8d2f-c73dcfb81d69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c44c914a150>]}
[0m03:27:04.867199 [debug] [MainThread]: Using duckdb connection "master"
[0m03:27:04.868791 [debug] [MainThread]: On master: BEGIN
[0m03:27:04.870452 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:27:04.893941 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m03:27:04.895779 [debug] [MainThread]: On master: COMMIT
[0m03:27:04.897218 [debug] [MainThread]: Using duckdb connection "master"
[0m03:27:04.898727 [debug] [MainThread]: On master: COMMIT
[0m03:27:04.900843 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m03:27:04.902477 [debug] [MainThread]: On master: Close
[0m03:27:04.907733 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:27:04.909991 [info ] [MainThread]: 
[0m03:27:04.922696 [debug] [Thread-1 (]: Began running node model.legal_demo.acris_cases
[0m03:27:04.924945 [info ] [Thread-1 (]: 1 of 1 START sql table model main.acris_clean .................................. [RUN]
[0m03:27:04.927298 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.legal_demo.acris_cases'
[0m03:27:04.929107 [debug] [Thread-1 (]: Began compiling node model.legal_demo.acris_cases
[0m03:27:04.943617 [debug] [Thread-1 (]: Writing injected SQL for node "model.legal_demo.acris_cases"
[0m03:27:04.967128 [debug] [Thread-1 (]: Timing info for model.legal_demo.acris_cases (compile): 03:27:04.930638 => 03:27:04.966551
[0m03:27:04.969285 [debug] [Thread-1 (]: Began executing node model.legal_demo.acris_cases
[0m03:27:05.007191 [debug] [Thread-1 (]: Writing runtime sql for node "model.legal_demo.acris_cases"
[0m03:27:05.020806 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:27:05.022268 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: BEGIN
[0m03:27:05.023867 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m03:27:05.044826 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:27:05.046912 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:27:05.048704 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */

  
    
    

    create  table
      "legal_demo"."main"."acris_clean__dbt_tmp"
  
    as (
      --
-- This model loads the already‑downloaded CSV into DuckDB and
-- materializes it as a table named `acris_clean`.  Because the
-- pipeline does not download data, the file must exist under
-- `data/first_500k_acris.csv` prior to running `dbt run`.  The
-- absolute path points at `/opt/airflow/data/first_500k_acris.csv` when
-- executed inside the Airflow containers.  Locally, dbt resolves
-- relative paths against the project root, so this model continues to
-- work outside of Docker.



SELECT *
FROM read_csv_auto('/opt/airflow/data/first_500k_acris.csv', header=True, delim=',')
    );
  
  
[0m03:27:07.528007 [debug] [Thread-1 (]: SQL status: OK in 2.0 seconds
[0m03:27:07.536685 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:27:07.538446 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
alter table "legal_demo"."main"."acris_clean" rename to "acris_clean__dbt_backup"
[0m03:27:07.540740 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:27:07.545461 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:27:07.547141 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
alter table "legal_demo"."main"."acris_clean__dbt_tmp" rename to "acris_clean"
[0m03:27:07.549466 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:27:07.574035 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: COMMIT
[0m03:27:07.575857 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:27:07.577488 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: COMMIT
[0m03:27:07.648587 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:27:07.657956 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:27:07.660345 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
drop table if exists "legal_demo"."main"."acris_clean__dbt_backup" cascade
[0m03:27:07.669298 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:27:07.672492 [debug] [Thread-1 (]: Timing info for model.legal_demo.acris_cases (execute): 03:27:04.970546 => 03:27:07.672230
[0m03:27:07.674500 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: Close
[0m03:27:07.740791 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7cd5f3bf-1785-4eb4-8d2f-c73dcfb81d69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c44c90b5050>]}
[0m03:27:07.743434 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main.acris_clean ............................. [[32mOK[0m in 2.81s]
[0m03:27:07.745590 [debug] [Thread-1 (]: Finished running node model.legal_demo.acris_cases
[0m03:27:07.750547 [debug] [MainThread]: Using duckdb connection "master"
[0m03:27:07.752258 [debug] [MainThread]: On master: BEGIN
[0m03:27:07.753908 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:27:07.776157 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m03:27:07.778204 [debug] [MainThread]: On master: COMMIT
[0m03:27:07.779631 [debug] [MainThread]: Using duckdb connection "master"
[0m03:27:07.781140 [debug] [MainThread]: On master: COMMIT
[0m03:27:07.783088 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m03:27:07.784626 [debug] [MainThread]: On master: Close
[0m03:27:07.791150 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:27:07.792750 [debug] [MainThread]: Connection 'list_legal_demo_main' was properly closed.
[0m03:27:07.794233 [debug] [MainThread]: Connection 'model.legal_demo.acris_cases' was properly closed.
[0m03:27:07.795696 [info ] [MainThread]: 
[0m03:27:07.797447 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.18 seconds (3.18s).
[0m03:27:07.799533 [debug] [MainThread]: Command end result
[0m03:27:07.840640 [info ] [MainThread]: 
[0m03:27:07.842902 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:27:07.844877 [info ] [MainThread]: 
[0m03:27:07.846696 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m03:27:07.849692 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.186232, "process_user_time": 7.850251, "process_kernel_time": 1.292935, "process_mem_max_rss": "297604", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m03:27:07.852459 [debug] [MainThread]: Command `dbt run` succeeded at 03:27:07.852139 after 4.19 seconds
[0m03:27:07.854522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c44d26424d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c44d71aaad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c44d70f0510>]}
[0m03:27:07.856356 [debug] [MainThread]: Flushing usage events
[0m03:28:14.980734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x729fa8fa4e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x729fa93b9010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x729fa9aa1410>]}


============================== 03:28:14.989330 | b6706560-88ec-466b-964f-1b5e2672b2bc ==============================
[0m03:28:14.989330 [info ] [MainThread]: Running with dbt=1.7.4
[0m03:28:14.991480 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m03:28:15.358883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b6706560-88ec-466b-964f-1b5e2672b2bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x729f9ffb9b50>]}
[0m03:28:15.457769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b6706560-88ec-466b-964f-1b5e2672b2bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x729faacbdfd0>]}
[0m03:28:15.460596 [info ] [MainThread]: Registered adapter: duckdb=1.7.4
[0m03:28:15.496297 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m03:28:15.596253 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:28:15.598131 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:28:15.605665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b6706560-88ec-466b-964f-1b5e2672b2bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x729fa96cf7d0>]}
[0m03:28:15.655283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b6706560-88ec-466b-964f-1b5e2672b2bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x729f9fee3ad0>]}
[0m03:28:15.657534 [info ] [MainThread]: Found 1 model, 0 sources, 0 exposures, 0 metrics, 394 macros, 0 groups, 0 semantic models
[0m03:28:15.659685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6706560-88ec-466b-964f-1b5e2672b2bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x729fac8ff190>]}
[0m03:28:15.662858 [info ] [MainThread]: 
[0m03:28:15.665695 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m03:28:15.669356 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_legal_demo'
[0m03:28:15.685521 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo"
[0m03:28:15.687781 [debug] [ThreadPool]: On list_legal_demo: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"legal_demo"'
    
  
  
[0m03:28:15.689806 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:28:15.723430 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:28:15.727643 [debug] [ThreadPool]: On list_legal_demo: Close
[0m03:28:15.738794 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_legal_demo, now create_legal_demo_main)
[0m03:28:15.741624 [debug] [ThreadPool]: Creating schema "database: "legal_demo"
schema: "main"
"
[0m03:28:15.750650 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m03:28:15.752750 [debug] [ThreadPool]: On create_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "create_legal_demo_main"} */

    
        select type from duckdb_databases()
        where database_name='legal_demo'
        and type='sqlite'
    
  
[0m03:28:15.754600 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:28:15.784590 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:28:15.787520 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m03:28:15.789305 [debug] [ThreadPool]: On create_legal_demo_main: BEGIN
[0m03:28:15.791507 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:28:15.794224 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m03:28:15.795872 [debug] [ThreadPool]: On create_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "create_legal_demo_main"} */

    
    
        create schema if not exists "legal_demo"."main"
    
[0m03:28:15.800001 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:28:15.802878 [debug] [ThreadPool]: On create_legal_demo_main: COMMIT
[0m03:28:15.804835 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m03:28:15.806630 [debug] [ThreadPool]: On create_legal_demo_main: COMMIT
[0m03:28:15.809653 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:28:15.811098 [debug] [ThreadPool]: On create_legal_demo_main: Close
[0m03:28:15.823420 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_legal_demo_main, now list_legal_demo_main)
[0m03:28:15.831582 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo_main"
[0m03:28:15.833697 [debug] [ThreadPool]: On list_legal_demo_main: BEGIN
[0m03:28:15.835324 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:28:15.856964 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:28:15.858866 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo_main"
[0m03:28:15.860507 [debug] [ThreadPool]: On list_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo_main"} */
select
      'legal_demo' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'legal_demo'
  
[0m03:28:15.887509 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:28:15.895705 [debug] [ThreadPool]: On list_legal_demo_main: ROLLBACK
[0m03:28:15.898567 [debug] [ThreadPool]: Failed to rollback 'list_legal_demo_main'
[0m03:28:15.900531 [debug] [ThreadPool]: On list_legal_demo_main: Close
[0m03:28:15.909348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6706560-88ec-466b-964f-1b5e2672b2bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x729fa8fbda90>]}
[0m03:28:15.911608 [debug] [MainThread]: Using duckdb connection "master"
[0m03:28:15.913576 [debug] [MainThread]: On master: BEGIN
[0m03:28:15.915438 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:28:15.942617 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m03:28:15.945030 [debug] [MainThread]: On master: COMMIT
[0m03:28:15.947009 [debug] [MainThread]: Using duckdb connection "master"
[0m03:28:15.949048 [debug] [MainThread]: On master: COMMIT
[0m03:28:15.951468 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m03:28:15.953680 [debug] [MainThread]: On master: Close
[0m03:28:15.960235 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:28:15.963166 [info ] [MainThread]: 
[0m03:28:15.975922 [debug] [Thread-1 (]: Began running node model.legal_demo.acris_cases
[0m03:28:15.978267 [info ] [Thread-1 (]: 1 of 1 START sql table model main.acris_clean .................................. [RUN]
[0m03:28:15.980755 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.legal_demo.acris_cases'
[0m03:28:15.982988 [debug] [Thread-1 (]: Began compiling node model.legal_demo.acris_cases
[0m03:28:15.992412 [debug] [Thread-1 (]: Writing injected SQL for node "model.legal_demo.acris_cases"
[0m03:28:16.009190 [debug] [Thread-1 (]: Timing info for model.legal_demo.acris_cases (compile): 03:28:15.984722 => 03:28:16.008658
[0m03:28:16.011446 [debug] [Thread-1 (]: Began executing node model.legal_demo.acris_cases
[0m03:28:16.048653 [debug] [Thread-1 (]: Writing runtime sql for node "model.legal_demo.acris_cases"
[0m03:28:16.065171 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:28:16.067324 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: BEGIN
[0m03:28:16.069288 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m03:28:16.097946 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:28:16.100042 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:28:16.101879 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */

  
    
    

    create  table
      "legal_demo"."main"."acris_clean__dbt_tmp"
  
    as (
      --
-- This model loads the already‑downloaded CSV into DuckDB and
-- materializes it as a table named `acris_clean`.  Because the
-- pipeline does not download data, the file must exist under
-- `data/first_500k_acris.csv` prior to running `dbt run`.  The
-- absolute path points at `/opt/airflow/data/first_500k_acris.csv` when
-- executed inside the Airflow containers.  Locally, dbt resolves
-- relative paths against the project root, so this model continues to
-- work outside of Docker.



SELECT *
FROM read_csv_auto('/opt/airflow/data/first_500k_acris.csv', header=True, delim=',')
    );
  
  
[0m03:28:18.605278 [debug] [Thread-1 (]: SQL status: OK in 3.0 seconds
[0m03:28:18.613997 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:28:18.616209 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
alter table "legal_demo"."main"."acris_clean" rename to "acris_clean__dbt_backup"
[0m03:28:18.618563 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:28:18.623358 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:28:18.625438 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
alter table "legal_demo"."main"."acris_clean__dbt_tmp" rename to "acris_clean"
[0m03:28:18.627719 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:28:18.658904 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: COMMIT
[0m03:28:18.661132 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:28:18.663018 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: COMMIT
[0m03:28:18.722857 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:28:18.732400 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:28:18.734383 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
drop table if exists "legal_demo"."main"."acris_clean__dbt_backup" cascade
[0m03:28:18.742368 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:28:18.745546 [debug] [Thread-1 (]: Timing info for model.legal_demo.acris_cases (execute): 03:28:16.013152 => 03:28:18.745281
[0m03:28:18.747500 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: Close
[0m03:28:18.814965 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6706560-88ec-466b-964f-1b5e2672b2bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x729f9fcef290>]}
[0m03:28:18.817855 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main.acris_clean ............................. [[32mOK[0m in 2.83s]
[0m03:28:18.820360 [debug] [Thread-1 (]: Finished running node model.legal_demo.acris_cases
[0m03:28:18.824183 [debug] [MainThread]: Using duckdb connection "master"
[0m03:28:18.825905 [debug] [MainThread]: On master: BEGIN
[0m03:28:18.827409 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:28:18.850713 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m03:28:18.852640 [debug] [MainThread]: On master: COMMIT
[0m03:28:18.854263 [debug] [MainThread]: Using duckdb connection "master"
[0m03:28:18.855756 [debug] [MainThread]: On master: COMMIT
[0m03:28:18.857948 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m03:28:18.859580 [debug] [MainThread]: On master: Close
[0m03:28:18.864123 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:28:18.865870 [debug] [MainThread]: Connection 'list_legal_demo_main' was properly closed.
[0m03:28:18.867254 [debug] [MainThread]: Connection 'model.legal_demo.acris_cases' was properly closed.
[0m03:28:18.868687 [info ] [MainThread]: 
[0m03:28:18.870366 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.20 seconds (3.20s).
[0m03:28:18.872167 [debug] [MainThread]: Command end result
[0m03:28:18.908650 [info ] [MainThread]: 
[0m03:28:18.910836 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:28:18.912551 [info ] [MainThread]: 
[0m03:28:18.914374 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m03:28:18.916711 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.0234313, "process_user_time": 7.243245, "process_kernel_time": 1.426943, "process_mem_max_rss": "300220", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m03:28:18.918656 [debug] [MainThread]: Command `dbt run` succeeded at 03:28:18.918459 after 4.03 seconds
[0m03:28:18.920311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x729fa96eda90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x729fa93b9750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x729fa9277850>]}
[0m03:28:18.922004 [debug] [MainThread]: Flushing usage events
[0m03:32:45.987228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f90708d950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f906f34490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f906f36810>]}


============================== 03:32:45.997871 | 8fbed638-951d-4f58-81f1-ddaf364acdc4 ==============================
[0m03:32:45.997871 [info ] [MainThread]: Running with dbt=1.7.4
[0m03:32:46.000760 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m03:32:46.391004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8fbed638-951d-4f58-81f1-ddaf364acdc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f906f053d0>]}
[0m03:32:46.500305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8fbed638-951d-4f58-81f1-ddaf364acdc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f906abadd0>]}
[0m03:32:46.503055 [info ] [MainThread]: Registered adapter: duckdb=1.7.4
[0m03:32:46.525341 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m03:32:46.645705 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:32:46.647800 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:32:46.656842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8fbed638-951d-4f58-81f1-ddaf364acdc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f8fd8e5750>]}
[0m03:32:46.710663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8fbed638-951d-4f58-81f1-ddaf364acdc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f8fd9c7a10>]}
[0m03:32:46.712788 [info ] [MainThread]: Found 1 model, 0 sources, 0 exposures, 0 metrics, 394 macros, 0 groups, 0 semantic models
[0m03:32:46.715430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8fbed638-951d-4f58-81f1-ddaf364acdc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f90a44f9d0>]}
[0m03:32:46.719520 [info ] [MainThread]: 
[0m03:32:46.721955 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m03:32:46.725138 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_legal_demo'
[0m03:32:46.741938 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo"
[0m03:32:46.744064 [debug] [ThreadPool]: On list_legal_demo: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"legal_demo"'
    
  
  
[0m03:32:46.745821 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:32:46.778763 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:32:46.782526 [debug] [ThreadPool]: On list_legal_demo: Close
[0m03:32:46.791911 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_legal_demo, now create_legal_demo_main)
[0m03:32:46.794611 [debug] [ThreadPool]: Creating schema "database: "legal_demo"
schema: "main"
"
[0m03:32:46.803874 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m03:32:46.806496 [debug] [ThreadPool]: On create_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "create_legal_demo_main"} */

    
        select type from duckdb_databases()
        where database_name='legal_demo'
        and type='sqlite'
    
  
[0m03:32:46.809571 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:32:46.844674 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:32:46.847811 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m03:32:46.849494 [debug] [ThreadPool]: On create_legal_demo_main: BEGIN
[0m03:32:46.851636 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:32:46.853328 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m03:32:46.854986 [debug] [ThreadPool]: On create_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "create_legal_demo_main"} */

    
    
        create schema if not exists "legal_demo"."main"
    
[0m03:32:46.857827 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:32:46.860401 [debug] [ThreadPool]: On create_legal_demo_main: COMMIT
[0m03:32:46.862003 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m03:32:46.863710 [debug] [ThreadPool]: On create_legal_demo_main: COMMIT
[0m03:32:46.866776 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:32:46.868341 [debug] [ThreadPool]: On create_legal_demo_main: Close
[0m03:32:46.878789 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_legal_demo_main, now list_legal_demo_main)
[0m03:32:46.886563 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo_main"
[0m03:32:46.888695 [debug] [ThreadPool]: On list_legal_demo_main: BEGIN
[0m03:32:46.890385 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:32:46.915157 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:32:46.916884 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo_main"
[0m03:32:46.918338 [debug] [ThreadPool]: On list_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo_main"} */
select
      'legal_demo' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'legal_demo'
  
[0m03:32:46.955545 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:32:46.963358 [debug] [ThreadPool]: On list_legal_demo_main: ROLLBACK
[0m03:32:46.966350 [debug] [ThreadPool]: Failed to rollback 'list_legal_demo_main'
[0m03:32:46.968145 [debug] [ThreadPool]: On list_legal_demo_main: Close
[0m03:32:46.975910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8fbed638-951d-4f58-81f1-ddaf364acdc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f8fd8a2490>]}
[0m03:32:46.977762 [debug] [MainThread]: Using duckdb connection "master"
[0m03:32:46.979293 [debug] [MainThread]: On master: BEGIN
[0m03:32:46.980852 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:32:47.004491 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m03:32:47.006715 [debug] [MainThread]: On master: COMMIT
[0m03:32:47.008437 [debug] [MainThread]: Using duckdb connection "master"
[0m03:32:47.010151 [debug] [MainThread]: On master: COMMIT
[0m03:32:47.012576 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m03:32:47.015029 [debug] [MainThread]: On master: Close
[0m03:32:47.020951 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:32:47.023049 [info ] [MainThread]: 
[0m03:32:47.036612 [debug] [Thread-1 (]: Began running node model.legal_demo.acris_cases
[0m03:32:47.038896 [info ] [Thread-1 (]: 1 of 1 START sql table model main.acris_clean .................................. [RUN]
[0m03:32:47.041217 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.legal_demo.acris_cases'
[0m03:32:47.043029 [debug] [Thread-1 (]: Began compiling node model.legal_demo.acris_cases
[0m03:32:47.053015 [debug] [Thread-1 (]: Writing injected SQL for node "model.legal_demo.acris_cases"
[0m03:32:47.066540 [debug] [Thread-1 (]: Timing info for model.legal_demo.acris_cases (compile): 03:32:47.044393 => 03:32:47.065900
[0m03:32:47.068267 [debug] [Thread-1 (]: Began executing node model.legal_demo.acris_cases
[0m03:32:47.106141 [debug] [Thread-1 (]: Writing runtime sql for node "model.legal_demo.acris_cases"
[0m03:32:47.119644 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:32:47.121199 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: BEGIN
[0m03:32:47.122791 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m03:32:47.143606 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:32:47.145415 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:32:47.146859 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */

  
    
    

    create  table
      "legal_demo"."main"."acris_clean__dbt_tmp"
  
    as (
      --
-- This model loads the already‑downloaded CSV into DuckDB and
-- materializes it as a table named `acris_clean`.  Because the
-- pipeline does not download data, the file must exist under
-- `data/first_500k_acris.csv` prior to running `dbt run`.  The
-- absolute path points at `/opt/airflow/data/first_500k_acris.csv` when
-- executed inside the Airflow containers.  Locally, dbt resolves
-- relative paths against the project root, so this model continues to
-- work outside of Docker.



SELECT *
FROM read_csv_auto('/opt/airflow/data/first_500k_acris.csv', header=True, delim=',')
    );
  
  
[0m03:32:49.690022 [debug] [Thread-1 (]: SQL status: OK in 3.0 seconds
[0m03:32:49.701450 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:32:49.703725 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
alter table "legal_demo"."main"."acris_clean" rename to "acris_clean__dbt_backup"
[0m03:32:49.707241 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:32:49.712905 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:32:49.715087 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
alter table "legal_demo"."main"."acris_clean__dbt_tmp" rename to "acris_clean"
[0m03:32:49.717889 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:32:49.744447 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: COMMIT
[0m03:32:49.746993 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:32:49.748831 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: COMMIT
[0m03:32:49.827708 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:32:49.837332 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:32:49.839574 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
drop table if exists "legal_demo"."main"."acris_clean__dbt_backup" cascade
[0m03:32:49.848404 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:32:49.852111 [debug] [Thread-1 (]: Timing info for model.legal_demo.acris_cases (execute): 03:32:47.069664 => 03:32:49.851775
[0m03:32:49.853623 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: Close
[0m03:32:49.930057 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8fbed638-951d-4f58-81f1-ddaf364acdc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f8fd61c9d0>]}
[0m03:32:49.933383 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main.acris_clean ............................. [[32mOK[0m in 2.89s]
[0m03:32:49.935946 [debug] [Thread-1 (]: Finished running node model.legal_demo.acris_cases
[0m03:32:49.941530 [debug] [MainThread]: Using duckdb connection "master"
[0m03:32:49.943164 [debug] [MainThread]: On master: BEGIN
[0m03:32:49.944800 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:32:49.970611 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m03:32:49.973289 [debug] [MainThread]: On master: COMMIT
[0m03:32:49.974985 [debug] [MainThread]: Using duckdb connection "master"
[0m03:32:49.976782 [debug] [MainThread]: On master: COMMIT
[0m03:32:49.978835 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m03:32:49.980408 [debug] [MainThread]: On master: Close
[0m03:32:49.986190 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:32:49.988208 [debug] [MainThread]: Connection 'list_legal_demo_main' was properly closed.
[0m03:32:49.989734 [debug] [MainThread]: Connection 'model.legal_demo.acris_cases' was properly closed.
[0m03:32:49.991505 [info ] [MainThread]: 
[0m03:32:49.993246 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.27 seconds (3.27s).
[0m03:32:49.995087 [debug] [MainThread]: Command end result
[0m03:32:50.034259 [info ] [MainThread]: 
[0m03:32:50.036593 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:32:50.038149 [info ] [MainThread]: 
[0m03:32:50.039771 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m03:32:50.042860 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.127644, "process_user_time": 8.029516, "process_kernel_time": 1.392587, "process_mem_max_rss": "298956", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m03:32:50.045463 [debug] [MainThread]: Command `dbt run` succeeded at 03:32:50.045188 after 4.13 seconds
[0m03:32:50.047261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f9070b5a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f906dbf390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f90b87c490>]}
[0m03:32:50.049312 [debug] [MainThread]: Flushing usage events
[0m03:33:41.470090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736f64250ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736f66c52d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736f642524d0>]}


============================== 03:33:41.478529 | dab735aa-1688-4a2d-873a-0748a657c99f ==============================
[0m03:33:41.478529 [info ] [MainThread]: Running with dbt=1.7.4
[0m03:33:41.480388 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m03:33:41.841868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dab735aa-1688-4a2d-873a-0748a657c99f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736f63b570d0>]}
[0m03:33:41.941097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dab735aa-1688-4a2d-873a-0748a657c99f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736f63ea8750>]}
[0m03:33:41.943370 [info ] [MainThread]: Registered adapter: duckdb=1.7.4
[0m03:33:41.962378 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m03:33:42.032210 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:33:42.034263 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:33:42.041604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dab735aa-1688-4a2d-873a-0748a657c99f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736f5a8c8150>]}
[0m03:33:42.082124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dab735aa-1688-4a2d-873a-0748a657c99f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736f6093a050>]}
[0m03:33:42.084613 [info ] [MainThread]: Found 1 model, 0 sources, 0 exposures, 0 metrics, 394 macros, 0 groups, 0 semantic models
[0m03:33:42.086713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dab735aa-1688-4a2d-873a-0748a657c99f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736f5a860d10>]}
[0m03:33:42.089849 [info ] [MainThread]: 
[0m03:33:42.092321 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m03:33:42.094863 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_legal_demo'
[0m03:33:42.110411 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo"
[0m03:33:42.112433 [debug] [ThreadPool]: On list_legal_demo: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"legal_demo"'
    
  
  
[0m03:33:42.114091 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:33:42.146220 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:33:42.149737 [debug] [ThreadPool]: On list_legal_demo: Close
[0m03:33:42.158687 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_legal_demo, now create_legal_demo_main)
[0m03:33:42.160646 [debug] [ThreadPool]: Creating schema "database: "legal_demo"
schema: "main"
"
[0m03:33:42.169136 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m03:33:42.170801 [debug] [ThreadPool]: On create_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "create_legal_demo_main"} */

    
        select type from duckdb_databases()
        where database_name='legal_demo'
        and type='sqlite'
    
  
[0m03:33:42.172305 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:33:42.195641 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:33:42.198377 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m03:33:42.199731 [debug] [ThreadPool]: On create_legal_demo_main: BEGIN
[0m03:33:42.201852 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:33:42.203079 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m03:33:42.204283 [debug] [ThreadPool]: On create_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "create_legal_demo_main"} */

    
    
        create schema if not exists "legal_demo"."main"
    
[0m03:33:42.206137 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:33:42.208034 [debug] [ThreadPool]: On create_legal_demo_main: COMMIT
[0m03:33:42.209381 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m03:33:42.210588 [debug] [ThreadPool]: On create_legal_demo_main: COMMIT
[0m03:33:42.213193 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:33:42.214454 [debug] [ThreadPool]: On create_legal_demo_main: Close
[0m03:33:42.222813 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_legal_demo_main, now list_legal_demo_main)
[0m03:33:42.230499 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo_main"
[0m03:33:42.232469 [debug] [ThreadPool]: On list_legal_demo_main: BEGIN
[0m03:33:42.234033 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:33:42.255276 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:33:42.256909 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo_main"
[0m03:33:42.258494 [debug] [ThreadPool]: On list_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo_main"} */
select
      'legal_demo' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'legal_demo'
  
[0m03:33:42.284683 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:33:42.291921 [debug] [ThreadPool]: On list_legal_demo_main: ROLLBACK
[0m03:33:42.294445 [debug] [ThreadPool]: Failed to rollback 'list_legal_demo_main'
[0m03:33:42.296173 [debug] [ThreadPool]: On list_legal_demo_main: Close
[0m03:33:42.302640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dab735aa-1688-4a2d-873a-0748a657c99f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736f60938d10>]}
[0m03:33:42.304454 [debug] [MainThread]: Using duckdb connection "master"
[0m03:33:42.305910 [debug] [MainThread]: On master: BEGIN
[0m03:33:42.307244 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:33:42.328528 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m03:33:42.330257 [debug] [MainThread]: On master: COMMIT
[0m03:33:42.331755 [debug] [MainThread]: Using duckdb connection "master"
[0m03:33:42.333325 [debug] [MainThread]: On master: COMMIT
[0m03:33:42.335372 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m03:33:42.336789 [debug] [MainThread]: On master: Close
[0m03:33:42.343608 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:33:42.346074 [info ] [MainThread]: 
[0m03:33:42.359752 [debug] [Thread-1 (]: Began running node model.legal_demo.acris_cases
[0m03:33:42.362224 [info ] [Thread-1 (]: 1 of 1 START sql table model main.acris_clean .................................. [RUN]
[0m03:33:42.364917 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.legal_demo.acris_cases'
[0m03:33:42.366784 [debug] [Thread-1 (]: Began compiling node model.legal_demo.acris_cases
[0m03:33:42.379117 [debug] [Thread-1 (]: Writing injected SQL for node "model.legal_demo.acris_cases"
[0m03:33:42.392900 [debug] [Thread-1 (]: Timing info for model.legal_demo.acris_cases (compile): 03:33:42.368872 => 03:33:42.392357
[0m03:33:42.394736 [debug] [Thread-1 (]: Began executing node model.legal_demo.acris_cases
[0m03:33:42.436046 [debug] [Thread-1 (]: Writing runtime sql for node "model.legal_demo.acris_cases"
[0m03:33:42.450355 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:33:42.452644 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: BEGIN
[0m03:33:42.454143 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m03:33:42.477146 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:33:42.478885 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:33:42.480472 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */

  
    
    

    create  table
      "legal_demo"."main"."acris_clean__dbt_tmp"
  
    as (
      --
-- This model loads the already‑downloaded CSV into DuckDB and
-- materializes it as a table named `acris_clean`.  Because the
-- pipeline does not download data, the file must exist under
-- `data/first_500k_acris.csv` prior to running `dbt run`.  The
-- absolute path points at `/opt/airflow/data/first_500k_acris.csv` when
-- executed inside the Airflow containers.  Locally, dbt resolves
-- relative paths against the project root, so this model continues to
-- work outside of Docker.



SELECT *
FROM read_csv_auto('/opt/airflow/data/first_500k_acris.csv', header=True, delim=',')
    );
  
  
[0m03:33:44.961839 [debug] [Thread-1 (]: SQL status: OK in 2.0 seconds
[0m03:33:44.970632 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:33:44.972909 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
alter table "legal_demo"."main"."acris_clean" rename to "acris_clean__dbt_backup"
[0m03:33:44.975403 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:33:44.980439 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:33:44.982177 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
alter table "legal_demo"."main"."acris_clean__dbt_tmp" rename to "acris_clean"
[0m03:33:44.984361 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:33:45.006755 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: COMMIT
[0m03:33:45.008915 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:33:45.010677 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: COMMIT
[0m03:33:45.083402 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:33:45.091310 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:33:45.093845 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
drop table if exists "legal_demo"."main"."acris_clean__dbt_backup" cascade
[0m03:33:45.101670 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:33:45.104811 [debug] [Thread-1 (]: Timing info for model.legal_demo.acris_cases (execute): 03:33:42.396239 => 03:33:45.104514
[0m03:33:45.106689 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: Close
[0m03:33:45.172072 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dab735aa-1688-4a2d-873a-0748a657c99f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736f63b59090>]}
[0m03:33:45.175077 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main.acris_clean ............................. [[32mOK[0m in 2.81s]
[0m03:33:45.177284 [debug] [Thread-1 (]: Finished running node model.legal_demo.acris_cases
[0m03:33:45.181749 [debug] [MainThread]: Using duckdb connection "master"
[0m03:33:45.187276 [debug] [MainThread]: On master: BEGIN
[0m03:33:45.191544 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:33:45.220520 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m03:33:45.222404 [debug] [MainThread]: On master: COMMIT
[0m03:33:45.224180 [debug] [MainThread]: Using duckdb connection "master"
[0m03:33:45.225685 [debug] [MainThread]: On master: COMMIT
[0m03:33:45.227679 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m03:33:45.229485 [debug] [MainThread]: On master: Close
[0m03:33:45.234673 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:33:45.236653 [debug] [MainThread]: Connection 'list_legal_demo_main' was properly closed.
[0m03:33:45.238057 [debug] [MainThread]: Connection 'model.legal_demo.acris_cases' was properly closed.
[0m03:33:45.239411 [info ] [MainThread]: 
[0m03:33:45.241027 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.15 seconds (3.15s).
[0m03:33:45.242908 [debug] [MainThread]: Command end result
[0m03:33:45.280373 [info ] [MainThread]: 
[0m03:33:45.282412 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:33:45.284108 [info ] [MainThread]: 
[0m03:33:45.285724 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m03:33:45.288129 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.8853538, "process_user_time": 7.460488, "process_kernel_time": 1.288228, "process_mem_max_rss": "297404", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m03:33:45.289967 [debug] [MainThread]: Command `dbt run` succeeded at 03:33:45.289776 after 3.89 seconds
[0m03:33:45.292131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736f64634c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736f63f2d290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736f68932a50>]}
[0m03:33:45.293901 [debug] [MainThread]: Flushing usage events
[0m03:36:02.620871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c03e95ae90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c03ec2ba90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c03ec344d0>]}


============================== 03:36:02.630529 | bdafd015-4512-4f5c-89cd-ed0a4c0bd549 ==============================
[0m03:36:02.630529 [info ] [MainThread]: Running with dbt=1.7.4
[0m03:36:02.632675 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt', 'send_anonymous_usage_stats': 'True'}
[0m03:36:03.133895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bdafd015-4512-4f5c-89cd-ed0a4c0bd549', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c03f71f690>]}
[0m03:36:03.321039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bdafd015-4512-4f5c-89cd-ed0a4c0bd549', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c03f71f690>]}
[0m03:36:03.324675 [info ] [MainThread]: Registered adapter: duckdb=1.7.4
[0m03:36:03.346180 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m03:36:03.421225 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:36:03.422778 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:36:03.430905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bdafd015-4512-4f5c-89cd-ed0a4c0bd549', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c0350e8610>]}
[0m03:36:03.480631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bdafd015-4512-4f5c-89cd-ed0a4c0bd549', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c03513dbd0>]}
[0m03:36:03.482471 [info ] [MainThread]: Found 1 model, 0 sources, 0 exposures, 0 metrics, 394 macros, 0 groups, 0 semantic models
[0m03:36:03.484673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bdafd015-4512-4f5c-89cd-ed0a4c0bd549', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c03edb28d0>]}
[0m03:36:03.488086 [info ] [MainThread]: 
[0m03:36:03.490675 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m03:36:03.493331 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_legal_demo'
[0m03:36:03.509895 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo"
[0m03:36:03.512496 [debug] [ThreadPool]: On list_legal_demo: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"legal_demo"'
    
  
  
[0m03:36:03.514356 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:36:03.549039 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:36:03.553179 [debug] [ThreadPool]: On list_legal_demo: Close
[0m03:36:03.562698 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_legal_demo, now create_legal_demo_main)
[0m03:36:03.564832 [debug] [ThreadPool]: Creating schema "database: "legal_demo"
schema: "main"
"
[0m03:36:03.574163 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m03:36:03.576056 [debug] [ThreadPool]: On create_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "create_legal_demo_main"} */

    
        select type from duckdb_databases()
        where database_name='legal_demo'
        and type='sqlite'
    
  
[0m03:36:03.577854 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:36:03.606656 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:36:03.609521 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m03:36:03.611414 [debug] [ThreadPool]: On create_legal_demo_main: BEGIN
[0m03:36:03.615625 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:36:03.617212 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m03:36:03.618859 [debug] [ThreadPool]: On create_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "create_legal_demo_main"} */

    
    
        create schema if not exists "legal_demo"."main"
    
[0m03:36:03.621259 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:36:03.623486 [debug] [ThreadPool]: On create_legal_demo_main: COMMIT
[0m03:36:03.625066 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m03:36:03.626478 [debug] [ThreadPool]: On create_legal_demo_main: COMMIT
[0m03:36:03.628865 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:36:03.630302 [debug] [ThreadPool]: On create_legal_demo_main: Close
[0m03:36:03.640307 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_legal_demo_main, now list_legal_demo_main)
[0m03:36:03.648834 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo_main"
[0m03:36:03.650824 [debug] [ThreadPool]: On list_legal_demo_main: BEGIN
[0m03:36:03.652171 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:36:03.674791 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:36:03.676568 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo_main"
[0m03:36:03.678027 [debug] [ThreadPool]: On list_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo_main"} */
select
      'legal_demo' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'legal_demo'
  
[0m03:36:03.707656 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:36:03.715310 [debug] [ThreadPool]: On list_legal_demo_main: ROLLBACK
[0m03:36:03.717768 [debug] [ThreadPool]: Failed to rollback 'list_legal_demo_main'
[0m03:36:03.719405 [debug] [ThreadPool]: On list_legal_demo_main: Close
[0m03:36:03.726135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bdafd015-4512-4f5c-89cd-ed0a4c0bd549', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c03b7dbc50>]}
[0m03:36:03.727816 [debug] [MainThread]: Using duckdb connection "master"
[0m03:36:03.729536 [debug] [MainThread]: On master: BEGIN
[0m03:36:03.730990 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:36:03.752971 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m03:36:03.754800 [debug] [MainThread]: On master: COMMIT
[0m03:36:03.756174 [debug] [MainThread]: Using duckdb connection "master"
[0m03:36:03.757632 [debug] [MainThread]: On master: COMMIT
[0m03:36:03.759631 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m03:36:03.761024 [debug] [MainThread]: On master: Close
[0m03:36:03.765983 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:36:03.767941 [info ] [MainThread]: 
[0m03:36:03.780974 [debug] [Thread-1 (]: Began running node model.legal_demo.acris_cases
[0m03:36:03.782922 [info ] [Thread-1 (]: 1 of 1 START sql table model main.acris_clean .................................. [RUN]
[0m03:36:03.785376 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.legal_demo.acris_cases'
[0m03:36:03.786855 [debug] [Thread-1 (]: Began compiling node model.legal_demo.acris_cases
[0m03:36:03.796354 [debug] [Thread-1 (]: Writing injected SQL for node "model.legal_demo.acris_cases"
[0m03:36:03.808307 [debug] [Thread-1 (]: Timing info for model.legal_demo.acris_cases (compile): 03:36:03.788122 => 03:36:03.807803
[0m03:36:03.809857 [debug] [Thread-1 (]: Began executing node model.legal_demo.acris_cases
[0m03:36:03.851493 [debug] [Thread-1 (]: Writing runtime sql for node "model.legal_demo.acris_cases"
[0m03:36:03.863661 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:36:03.865293 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: BEGIN
[0m03:36:03.866709 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m03:36:03.890754 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:36:03.892566 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:36:03.894097 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */

  
    
    

    create  table
      "legal_demo"."main"."acris_clean__dbt_tmp"
  
    as (
      --
-- This model loads the already‑downloaded CSV into DuckDB and
-- materializes it as a table named `acris_clean`.  Because the
-- pipeline does not download data, the file must exist under
-- `data/first_500k_acris.csv` prior to running `dbt run`.  The
-- absolute path points at `/opt/airflow/data/first_500k_acris.csv` when
-- executed inside the Airflow containers.  Locally, dbt resolves
-- relative paths against the project root, so this model continues to
-- work outside of Docker.



SELECT *
FROM read_csv_auto('/opt/airflow/data/first_500k_acris.csv', header=True, delim=',')
    );
  
  
[0m03:36:06.350033 [debug] [Thread-1 (]: SQL status: OK in 2.0 seconds
[0m03:36:06.359468 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:36:06.361408 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
alter table "legal_demo"."main"."acris_clean" rename to "acris_clean__dbt_backup"
[0m03:36:06.365062 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:36:06.369725 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:36:06.372113 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
alter table "legal_demo"."main"."acris_clean__dbt_tmp" rename to "acris_clean"
[0m03:36:06.374133 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:36:06.399785 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: COMMIT
[0m03:36:06.402406 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:36:06.404496 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: COMMIT
[0m03:36:06.479081 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:36:06.489081 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:36:06.491420 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
drop table if exists "legal_demo"."main"."acris_clean__dbt_backup" cascade
[0m03:36:06.500656 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:36:06.504760 [debug] [Thread-1 (]: Timing info for model.legal_demo.acris_cases (execute): 03:36:03.810900 => 03:36:06.504459
[0m03:36:06.506576 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: Close
[0m03:36:06.581968 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bdafd015-4512-4f5c-89cd-ed0a4c0bd549', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c0351c6050>]}
[0m03:36:06.584647 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main.acris_clean ............................. [[32mOK[0m in 2.80s]
[0m03:36:06.586779 [debug] [Thread-1 (]: Finished running node model.legal_demo.acris_cases
[0m03:36:06.592534 [debug] [MainThread]: Using duckdb connection "master"
[0m03:36:06.594370 [debug] [MainThread]: On master: BEGIN
[0m03:36:06.596046 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:36:06.634026 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m03:36:06.636511 [debug] [MainThread]: On master: COMMIT
[0m03:36:06.638452 [debug] [MainThread]: Using duckdb connection "master"
[0m03:36:06.640443 [debug] [MainThread]: On master: COMMIT
[0m03:36:06.643385 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m03:36:06.645135 [debug] [MainThread]: On master: Close
[0m03:36:06.652504 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:36:06.654963 [debug] [MainThread]: Connection 'list_legal_demo_main' was properly closed.
[0m03:36:06.656351 [debug] [MainThread]: Connection 'model.legal_demo.acris_cases' was properly closed.
[0m03:36:06.657781 [info ] [MainThread]: 
[0m03:36:06.659288 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.17 seconds (3.17s).
[0m03:36:06.661187 [debug] [MainThread]: Command end result
[0m03:36:06.699281 [info ] [MainThread]: 
[0m03:36:06.701694 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:36:06.704518 [info ] [MainThread]: 
[0m03:36:06.707259 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m03:36:06.711200 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.168426, "process_user_time": 7.912684, "process_kernel_time": 1.382915, "process_mem_max_rss": "298792", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m03:36:06.715230 [debug] [MainThread]: Command `dbt run` succeeded at 03:36:06.714803 after 4.17 seconds
[0m03:36:06.717677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c03ef36d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c03ef5b110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c04378b510>]}
[0m03:36:06.719378 [debug] [MainThread]: Flushing usage events
[0m03:36:49.859239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e93c4b63cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e93c4871e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e93c4871d50>]}


============================== 03:36:49.870809 | 8194c78e-fcc1-49ea-ae91-7016e98687ea ==============================
[0m03:36:49.870809 [info ] [MainThread]: Running with dbt=1.7.4
[0m03:36:49.872918 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m03:36:50.318812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8194c78e-fcc1-49ea-ae91-7016e98687ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e93c4b3fdd0>]}
[0m03:36:50.423471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8194c78e-fcc1-49ea-ae91-7016e98687ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e93c4790d10>]}
[0m03:36:50.425922 [info ] [MainThread]: Registered adapter: duckdb=1.7.4
[0m03:36:50.449486 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m03:36:50.531563 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:36:50.533288 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:36:50.540527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8194c78e-fcc1-49ea-ae91-7016e98687ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e93c4843a10>]}
[0m03:36:50.592033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8194c78e-fcc1-49ea-ae91-7016e98687ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e93bb2d4c90>]}
[0m03:36:50.595508 [info ] [MainThread]: Found 1 model, 0 sources, 0 exposures, 0 metrics, 394 macros, 0 groups, 0 semantic models
[0m03:36:50.597148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8194c78e-fcc1-49ea-ae91-7016e98687ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e93c4843210>]}
[0m03:36:50.600178 [info ] [MainThread]: 
[0m03:36:50.602468 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m03:36:50.605421 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_legal_demo'
[0m03:36:50.626153 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo"
[0m03:36:50.628320 [debug] [ThreadPool]: On list_legal_demo: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"legal_demo"'
    
  
  
[0m03:36:50.630145 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:36:50.662680 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:36:50.666180 [debug] [ThreadPool]: On list_legal_demo: Close
[0m03:36:50.676406 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_legal_demo, now create_legal_demo_main)
[0m03:36:50.678698 [debug] [ThreadPool]: Creating schema "database: "legal_demo"
schema: "main"
"
[0m03:36:50.687366 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m03:36:50.689150 [debug] [ThreadPool]: On create_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "create_legal_demo_main"} */

    
        select type from duckdb_databases()
        where database_name='legal_demo'
        and type='sqlite'
    
  
[0m03:36:50.690624 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:36:50.716868 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:36:50.719731 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m03:36:50.721484 [debug] [ThreadPool]: On create_legal_demo_main: BEGIN
[0m03:36:50.723542 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:36:50.725143 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m03:36:50.726681 [debug] [ThreadPool]: On create_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "create_legal_demo_main"} */

    
    
        create schema if not exists "legal_demo"."main"
    
[0m03:36:50.729009 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:36:50.731557 [debug] [ThreadPool]: On create_legal_demo_main: COMMIT
[0m03:36:50.733176 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m03:36:50.734476 [debug] [ThreadPool]: On create_legal_demo_main: COMMIT
[0m03:36:50.737203 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:36:50.738656 [debug] [ThreadPool]: On create_legal_demo_main: Close
[0m03:36:50.749556 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_legal_demo_main, now list_legal_demo_main)
[0m03:36:50.757054 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo_main"
[0m03:36:50.758531 [debug] [ThreadPool]: On list_legal_demo_main: BEGIN
[0m03:36:50.760001 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:36:50.786008 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:36:50.787728 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo_main"
[0m03:36:50.789248 [debug] [ThreadPool]: On list_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo_main"} */
select
      'legal_demo' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'legal_demo'
  
[0m03:36:50.817028 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:36:50.824243 [debug] [ThreadPool]: On list_legal_demo_main: ROLLBACK
[0m03:36:50.826912 [debug] [ThreadPool]: Failed to rollback 'list_legal_demo_main'
[0m03:36:50.828447 [debug] [ThreadPool]: On list_legal_demo_main: Close
[0m03:36:50.835175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8194c78e-fcc1-49ea-ae91-7016e98687ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e93c43e9850>]}
[0m03:36:50.837014 [debug] [MainThread]: Using duckdb connection "master"
[0m03:36:50.838417 [debug] [MainThread]: On master: BEGIN
[0m03:36:50.839854 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:36:50.873587 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m03:36:50.875351 [debug] [MainThread]: On master: COMMIT
[0m03:36:50.877488 [debug] [MainThread]: Using duckdb connection "master"
[0m03:36:50.879046 [debug] [MainThread]: On master: COMMIT
[0m03:36:50.881337 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m03:36:50.883089 [debug] [MainThread]: On master: Close
[0m03:36:50.888356 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:36:50.890214 [info ] [MainThread]: 
[0m03:36:50.904042 [debug] [Thread-1 (]: Began running node model.legal_demo.acris_cases
[0m03:36:50.906211 [info ] [Thread-1 (]: 1 of 1 START sql table model main.acris_clean .................................. [RUN]
[0m03:36:50.908633 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.legal_demo.acris_cases'
[0m03:36:50.910181 [debug] [Thread-1 (]: Began compiling node model.legal_demo.acris_cases
[0m03:36:50.921665 [debug] [Thread-1 (]: Writing injected SQL for node "model.legal_demo.acris_cases"
[0m03:36:50.935565 [debug] [Thread-1 (]: Timing info for model.legal_demo.acris_cases (compile): 03:36:50.911508 => 03:36:50.935059
[0m03:36:50.937599 [debug] [Thread-1 (]: Began executing node model.legal_demo.acris_cases
[0m03:36:50.990073 [debug] [Thread-1 (]: Writing runtime sql for node "model.legal_demo.acris_cases"
[0m03:36:51.004158 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:36:51.005880 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: BEGIN
[0m03:36:51.007416 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m03:36:51.039218 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:36:51.041553 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:36:51.043469 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */

  
    
    

    create  table
      "legal_demo"."main"."acris_clean__dbt_tmp"
  
    as (
      --
-- This model loads the already‑downloaded CSV into DuckDB and
-- materializes it as a table named `acris_clean`.  Because the
-- pipeline does not download data, the file must exist under
-- `data/first_500k_acris.csv` prior to running `dbt run`.  The
-- absolute path points at `/opt/airflow/data/first_500k_acris.csv` when
-- executed inside the Airflow containers.  Locally, dbt resolves
-- relative paths against the project root, so this model continues to
-- work outside of Docker.



SELECT *
FROM read_csv_auto('/opt/airflow/data/first_500k_acris.csv', header=True, delim=',')
    );
  
  
[0m03:36:53.565085 [debug] [Thread-1 (]: SQL status: OK in 3.0 seconds
[0m03:36:53.573948 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:36:53.575771 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
alter table "legal_demo"."main"."acris_clean" rename to "acris_clean__dbt_backup"
[0m03:36:53.577938 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:36:53.582499 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:36:53.584593 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
alter table "legal_demo"."main"."acris_clean__dbt_tmp" rename to "acris_clean"
[0m03:36:53.586801 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:36:53.609639 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: COMMIT
[0m03:36:53.611841 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:36:53.613663 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: COMMIT
[0m03:36:53.682870 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:36:53.690959 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:36:53.693217 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
drop table if exists "legal_demo"."main"."acris_clean__dbt_backup" cascade
[0m03:36:53.700906 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:36:53.703768 [debug] [Thread-1 (]: Timing info for model.legal_demo.acris_cases (execute): 03:36:50.939073 => 03:36:53.703512
[0m03:36:53.705548 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: Close
[0m03:36:53.771154 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8194c78e-fcc1-49ea-ae91-7016e98687ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e93c4467310>]}
[0m03:36:53.773653 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main.acris_clean ............................. [[32mOK[0m in 2.86s]
[0m03:36:53.775946 [debug] [Thread-1 (]: Finished running node model.legal_demo.acris_cases
[0m03:36:53.781675 [debug] [MainThread]: Using duckdb connection "master"
[0m03:36:53.783267 [debug] [MainThread]: On master: BEGIN
[0m03:36:53.784952 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:36:53.805535 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m03:36:53.807252 [debug] [MainThread]: On master: COMMIT
[0m03:36:53.808803 [debug] [MainThread]: Using duckdb connection "master"
[0m03:36:53.810189 [debug] [MainThread]: On master: COMMIT
[0m03:36:53.811982 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m03:36:53.813677 [debug] [MainThread]: On master: Close
[0m03:36:53.818270 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:36:53.820270 [debug] [MainThread]: Connection 'list_legal_demo_main' was properly closed.
[0m03:36:53.821751 [debug] [MainThread]: Connection 'model.legal_demo.acris_cases' was properly closed.
[0m03:36:53.823263 [info ] [MainThread]: 
[0m03:36:53.824911 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.22 seconds (3.22s).
[0m03:36:53.826807 [debug] [MainThread]: Command end result
[0m03:36:53.861671 [info ] [MainThread]: 
[0m03:36:53.863911 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:36:53.865656 [info ] [MainThread]: 
[0m03:36:53.867209 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m03:36:53.869658 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.0913396, "process_user_time": 7.405602, "process_kernel_time": 1.378342, "process_mem_max_rss": "299364", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m03:36:53.872050 [debug] [MainThread]: Command `dbt run` succeeded at 03:36:53.871755 after 4.09 seconds
[0m03:36:53.873907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e93c4841fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e93c442e3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e93c9130490>]}
[0m03:36:53.875500 [debug] [MainThread]: Flushing usage events
[0m03:40:12.818144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbac4d15890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbac6297ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbac4c3ddd0>]}


============================== 03:40:12.828969 | 95ca1201-27a3-4b24-b570-dd49af901c62 ==============================
[0m03:40:12.828969 [info ] [MainThread]: Running with dbt=1.7.4
[0m03:40:12.831451 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m03:40:13.356246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '95ca1201-27a3-4b24-b570-dd49af901c62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbac4eaf4d0>]}
[0m03:40:13.532642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '95ca1201-27a3-4b24-b570-dd49af901c62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbac1681e10>]}
[0m03:40:13.536197 [info ] [MainThread]: Registered adapter: duckdb=1.7.4
[0m03:40:13.564046 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m03:40:13.645872 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:40:13.648051 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:40:13.656672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '95ca1201-27a3-4b24-b570-dd49af901c62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbac1683710>]}
[0m03:40:13.711764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '95ca1201-27a3-4b24-b570-dd49af901c62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbabb7e6090>]}
[0m03:40:13.714756 [info ] [MainThread]: Found 1 model, 0 sources, 0 exposures, 0 metrics, 394 macros, 0 groups, 0 semantic models
[0m03:40:13.717725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '95ca1201-27a3-4b24-b570-dd49af901c62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbac4917350>]}
[0m03:40:13.722066 [info ] [MainThread]: 
[0m03:40:13.725166 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m03:40:13.728571 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_legal_demo'
[0m03:40:13.747366 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo"
[0m03:40:13.749228 [debug] [ThreadPool]: On list_legal_demo: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"legal_demo"'
    
  
  
[0m03:40:13.750554 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:40:13.783527 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:40:13.788395 [debug] [ThreadPool]: On list_legal_demo: Close
[0m03:40:13.798526 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_legal_demo, now create_legal_demo_main)
[0m03:40:13.801158 [debug] [ThreadPool]: Creating schema "database: "legal_demo"
schema: "main"
"
[0m03:40:13.811461 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m03:40:13.813504 [debug] [ThreadPool]: On create_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "create_legal_demo_main"} */

    
        select type from duckdb_databases()
        where database_name='legal_demo'
        and type='sqlite'
    
  
[0m03:40:13.815669 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:40:13.843671 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:40:13.847228 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m03:40:13.849360 [debug] [ThreadPool]: On create_legal_demo_main: BEGIN
[0m03:40:13.852139 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:40:13.854516 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m03:40:13.856640 [debug] [ThreadPool]: On create_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "create_legal_demo_main"} */

    
    
        create schema if not exists "legal_demo"."main"
    
[0m03:40:13.859297 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:40:13.861898 [debug] [ThreadPool]: On create_legal_demo_main: COMMIT
[0m03:40:13.863666 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m03:40:13.865357 [debug] [ThreadPool]: On create_legal_demo_main: COMMIT
[0m03:40:13.868545 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:40:13.870348 [debug] [ThreadPool]: On create_legal_demo_main: Close
[0m03:40:13.880800 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_legal_demo_main, now list_legal_demo_main)
[0m03:40:13.890577 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo_main"
[0m03:40:13.892656 [debug] [ThreadPool]: On list_legal_demo_main: BEGIN
[0m03:40:13.894319 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:40:13.920169 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:40:13.922025 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo_main"
[0m03:40:13.923750 [debug] [ThreadPool]: On list_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo_main"} */
select
      'legal_demo' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'legal_demo'
  
[0m03:40:13.956156 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:40:13.964591 [debug] [ThreadPool]: On list_legal_demo_main: ROLLBACK
[0m03:40:13.967017 [debug] [ThreadPool]: Failed to rollback 'list_legal_demo_main'
[0m03:40:13.968654 [debug] [ThreadPool]: On list_legal_demo_main: Close
[0m03:40:13.976953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '95ca1201-27a3-4b24-b570-dd49af901c62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbac4eaf4d0>]}
[0m03:40:13.978699 [debug] [MainThread]: Using duckdb connection "master"
[0m03:40:13.980222 [debug] [MainThread]: On master: BEGIN
[0m03:40:13.981533 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:40:14.005197 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m03:40:14.007140 [debug] [MainThread]: On master: COMMIT
[0m03:40:14.008679 [debug] [MainThread]: Using duckdb connection "master"
[0m03:40:14.010085 [debug] [MainThread]: On master: COMMIT
[0m03:40:14.012428 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m03:40:14.014236 [debug] [MainThread]: On master: Close
[0m03:40:14.020534 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:40:14.022512 [info ] [MainThread]: 
[0m03:40:14.036229 [debug] [Thread-1 (]: Began running node model.legal_demo.acris_cases
[0m03:40:14.038469 [info ] [Thread-1 (]: 1 of 1 START sql table model main.acris_clean .................................. [RUN]
[0m03:40:14.041114 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.legal_demo.acris_cases'
[0m03:40:14.042742 [debug] [Thread-1 (]: Began compiling node model.legal_demo.acris_cases
[0m03:40:14.058107 [debug] [Thread-1 (]: Writing injected SQL for node "model.legal_demo.acris_cases"
[0m03:40:14.073104 [debug] [Thread-1 (]: Timing info for model.legal_demo.acris_cases (compile): 03:40:14.044287 => 03:40:14.072411
[0m03:40:14.075022 [debug] [Thread-1 (]: Began executing node model.legal_demo.acris_cases
[0m03:40:14.120791 [debug] [Thread-1 (]: Writing runtime sql for node "model.legal_demo.acris_cases"
[0m03:40:14.132393 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:40:14.133897 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: BEGIN
[0m03:40:14.135261 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m03:40:14.161785 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:40:14.163919 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:40:14.165564 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */

  
    
    

    create  table
      "legal_demo"."main"."acris_clean__dbt_tmp"
  
    as (
      --
-- This model loads the already‑downloaded CSV into DuckDB and
-- materializes it as a table named `acris_clean`.  Because the
-- pipeline does not download data, the file must exist under
-- `data/first_500k_acris.csv` prior to running `dbt run`.  The
-- absolute path points at `/opt/airflow/data/first_500k_acris.csv` when
-- executed inside the Airflow containers.  Locally, dbt resolves
-- relative paths against the project root, so this model continues to
-- work outside of Docker.



SELECT *
FROM read_csv_auto('/opt/airflow/data/first_500k_acris.csv', header=True, delim=',')
    );
  
  
[0m03:40:16.666705 [debug] [Thread-1 (]: SQL status: OK in 2.0 seconds
[0m03:40:16.678858 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:40:16.681650 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
alter table "legal_demo"."main"."acris_clean" rename to "acris_clean__dbt_backup"
[0m03:40:16.684694 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:40:16.691334 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:40:16.693278 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
alter table "legal_demo"."main"."acris_clean__dbt_tmp" rename to "acris_clean"
[0m03:40:16.695570 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:40:16.723563 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: COMMIT
[0m03:40:16.726749 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:40:16.728684 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: COMMIT
[0m03:40:16.756748 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:40:16.766613 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:40:16.768842 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
drop table if exists "legal_demo"."main"."acris_clean__dbt_backup" cascade
[0m03:40:16.777705 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:40:16.781543 [debug] [Thread-1 (]: Timing info for model.legal_demo.acris_cases (execute): 03:40:14.076315 => 03:40:16.781175
[0m03:40:16.783701 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: Close
[0m03:40:16.856347 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95ca1201-27a3-4b24-b570-dd49af901c62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbabb6863d0>]}
[0m03:40:16.859886 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main.acris_clean ............................. [[32mOK[0m in 2.82s]
[0m03:40:16.861913 [debug] [Thread-1 (]: Finished running node model.legal_demo.acris_cases
[0m03:40:16.866725 [debug] [MainThread]: Using duckdb connection "master"
[0m03:40:16.868557 [debug] [MainThread]: On master: BEGIN
[0m03:40:16.870051 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:40:16.896179 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m03:40:16.898331 [debug] [MainThread]: On master: COMMIT
[0m03:40:16.900046 [debug] [MainThread]: Using duckdb connection "master"
[0m03:40:16.901658 [debug] [MainThread]: On master: COMMIT
[0m03:40:16.903844 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m03:40:16.905296 [debug] [MainThread]: On master: Close
[0m03:40:16.912089 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:40:16.913919 [debug] [MainThread]: Connection 'list_legal_demo_main' was properly closed.
[0m03:40:16.915619 [debug] [MainThread]: Connection 'model.legal_demo.acris_cases' was properly closed.
[0m03:40:16.917042 [info ] [MainThread]: 
[0m03:40:16.918634 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.19 seconds (3.19s).
[0m03:40:16.920650 [debug] [MainThread]: Command end result
[0m03:40:16.963265 [info ] [MainThread]: 
[0m03:40:16.965661 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:40:16.967800 [info ] [MainThread]: 
[0m03:40:16.969807 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m03:40:16.972856 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.2352133, "process_user_time": 7.640409, "process_kernel_time": 1.408388, "process_mem_max_rss": "299648", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m03:40:16.975699 [debug] [MainThread]: Command `dbt run` succeeded at 03:40:16.975343 after 4.24 seconds
[0m03:40:16.977601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbac48b9210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbac9504dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbac96c7550>]}
[0m03:40:16.979714 [debug] [MainThread]: Flushing usage events
[0m03:41:08.780104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78b25e76d9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78b25ed393d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78b25e77f590>]}


============================== 03:41:08.789871 | 40b49fbb-37aa-4e97-9149-1cc9f9df4d4e ==============================
[0m03:41:08.789871 [info ] [MainThread]: Running with dbt=1.7.4
[0m03:41:08.792246 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m03:41:09.168124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '40b49fbb-37aa-4e97-9149-1cc9f9df4d4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78b25e7c5410>]}
[0m03:41:09.272509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '40b49fbb-37aa-4e97-9149-1cc9f9df4d4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78b25eaed210>]}
[0m03:41:09.275381 [info ] [MainThread]: Registered adapter: duckdb=1.7.4
[0m03:41:09.296549 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m03:41:09.386536 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:41:09.388921 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:41:09.396466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '40b49fbb-37aa-4e97-9149-1cc9f9df4d4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78b25559d9d0>]}
[0m03:41:09.444390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '40b49fbb-37aa-4e97-9149-1cc9f9df4d4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78b25ebcac50>]}
[0m03:41:09.446521 [info ] [MainThread]: Found 1 model, 0 sources, 0 exposures, 0 metrics, 394 macros, 0 groups, 0 semantic models
[0m03:41:09.448564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '40b49fbb-37aa-4e97-9149-1cc9f9df4d4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78b25e7c0b50>]}
[0m03:41:09.452142 [info ] [MainThread]: 
[0m03:41:09.454555 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m03:41:09.457631 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_legal_demo'
[0m03:41:09.473048 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo"
[0m03:41:09.475410 [debug] [ThreadPool]: On list_legal_demo: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"legal_demo"'
    
  
  
[0m03:41:09.477118 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:41:09.509842 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:41:09.513378 [debug] [ThreadPool]: On list_legal_demo: Close
[0m03:41:09.524847 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_legal_demo, now create_legal_demo_main)
[0m03:41:09.562802 [debug] [ThreadPool]: Creating schema "database: "legal_demo"
schema: "main"
"
[0m03:41:09.572000 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m03:41:09.573865 [debug] [ThreadPool]: On create_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "create_legal_demo_main"} */

    
        select type from duckdb_databases()
        where database_name='legal_demo'
        and type='sqlite'
    
  
[0m03:41:09.575686 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:41:09.604597 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:41:09.607435 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m03:41:09.609026 [debug] [ThreadPool]: On create_legal_demo_main: BEGIN
[0m03:41:09.611174 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:41:09.613282 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m03:41:09.615252 [debug] [ThreadPool]: On create_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "create_legal_demo_main"} */

    
    
        create schema if not exists "legal_demo"."main"
    
[0m03:41:09.617304 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:41:09.619617 [debug] [ThreadPool]: On create_legal_demo_main: COMMIT
[0m03:41:09.621159 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m03:41:09.622614 [debug] [ThreadPool]: On create_legal_demo_main: COMMIT
[0m03:41:09.625131 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:41:09.626886 [debug] [ThreadPool]: On create_legal_demo_main: Close
[0m03:41:09.637236 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_legal_demo_main, now list_legal_demo_main)
[0m03:41:09.644880 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo_main"
[0m03:41:09.646663 [debug] [ThreadPool]: On list_legal_demo_main: BEGIN
[0m03:41:09.648269 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:41:09.671106 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:41:09.673334 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo_main"
[0m03:41:09.674947 [debug] [ThreadPool]: On list_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo_main"} */
select
      'legal_demo' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'legal_demo'
  
[0m03:41:09.704459 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:41:09.713956 [debug] [ThreadPool]: On list_legal_demo_main: ROLLBACK
[0m03:41:09.716263 [debug] [ThreadPool]: Failed to rollback 'list_legal_demo_main'
[0m03:41:09.717644 [debug] [ThreadPool]: On list_legal_demo_main: Close
[0m03:41:09.725156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '40b49fbb-37aa-4e97-9149-1cc9f9df4d4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78b25e87f310>]}
[0m03:41:09.726951 [debug] [MainThread]: Using duckdb connection "master"
[0m03:41:09.728538 [debug] [MainThread]: On master: BEGIN
[0m03:41:09.729919 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:41:09.749234 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m03:41:09.751589 [debug] [MainThread]: On master: COMMIT
[0m03:41:09.753168 [debug] [MainThread]: Using duckdb connection "master"
[0m03:41:09.754585 [debug] [MainThread]: On master: COMMIT
[0m03:41:09.756424 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m03:41:09.757774 [debug] [MainThread]: On master: Close
[0m03:41:09.762565 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:41:09.764592 [info ] [MainThread]: 
[0m03:41:09.777469 [debug] [Thread-1 (]: Began running node model.legal_demo.acris_cases
[0m03:41:09.779639 [info ] [Thread-1 (]: 1 of 1 START sql table model main.acris_clean .................................. [RUN]
[0m03:41:09.781793 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.legal_demo.acris_cases'
[0m03:41:09.783767 [debug] [Thread-1 (]: Began compiling node model.legal_demo.acris_cases
[0m03:41:09.793763 [debug] [Thread-1 (]: Writing injected SQL for node "model.legal_demo.acris_cases"
[0m03:41:09.806117 [debug] [Thread-1 (]: Timing info for model.legal_demo.acris_cases (compile): 03:41:09.785421 => 03:41:09.805635
[0m03:41:09.808015 [debug] [Thread-1 (]: Began executing node model.legal_demo.acris_cases
[0m03:41:09.847419 [debug] [Thread-1 (]: Writing runtime sql for node "model.legal_demo.acris_cases"
[0m03:41:09.860793 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:41:09.862651 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: BEGIN
[0m03:41:09.864524 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m03:41:09.892876 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:41:09.895079 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:41:09.898216 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */

  
    
    

    create  table
      "legal_demo"."main"."acris_clean__dbt_tmp"
  
    as (
      --
-- This model loads the already‑downloaded CSV into DuckDB and
-- materializes it as a table named `acris_clean`.  Because the
-- pipeline does not download data, the file must exist under
-- `data/first_500k_acris.csv` prior to running `dbt run`.  The
-- absolute path points at `/opt/airflow/data/first_500k_acris.csv` when
-- executed inside the Airflow containers.  Locally, dbt resolves
-- relative paths against the project root, so this model continues to
-- work outside of Docker.



SELECT *
FROM read_csv_auto('/opt/airflow/data/first_500k_acris.csv', header=True, delim=',')
    );
  
  
[0m03:41:12.400419 [debug] [Thread-1 (]: SQL status: OK in 2.0 seconds
[0m03:41:12.409496 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:41:12.411613 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
alter table "legal_demo"."main"."acris_clean" rename to "acris_clean__dbt_backup"
[0m03:41:12.414608 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:41:12.419165 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:41:12.421168 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
alter table "legal_demo"."main"."acris_clean__dbt_tmp" rename to "acris_clean"
[0m03:41:12.423094 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:41:12.446404 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: COMMIT
[0m03:41:12.448410 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:41:12.450234 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: COMMIT
[0m03:41:12.517535 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:41:12.525001 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:41:12.526863 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
drop table if exists "legal_demo"."main"."acris_clean__dbt_backup" cascade
[0m03:41:12.534707 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:41:12.537566 [debug] [Thread-1 (]: Timing info for model.legal_demo.acris_cases (execute): 03:41:09.809151 => 03:41:12.537302
[0m03:41:12.539419 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: Close
[0m03:41:12.602937 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40b49fbb-37aa-4e97-9149-1cc9f9df4d4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78b2554e76d0>]}
[0m03:41:12.605613 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main.acris_clean ............................. [[32mOK[0m in 2.82s]
[0m03:41:12.607880 [debug] [Thread-1 (]: Finished running node model.legal_demo.acris_cases
[0m03:41:12.612376 [debug] [MainThread]: Using duckdb connection "master"
[0m03:41:12.614061 [debug] [MainThread]: On master: BEGIN
[0m03:41:12.616049 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:41:12.637331 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m03:41:12.638964 [debug] [MainThread]: On master: COMMIT
[0m03:41:12.640430 [debug] [MainThread]: Using duckdb connection "master"
[0m03:41:12.641901 [debug] [MainThread]: On master: COMMIT
[0m03:41:12.643753 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m03:41:12.645278 [debug] [MainThread]: On master: Close
[0m03:41:12.650074 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:41:12.651773 [debug] [MainThread]: Connection 'list_legal_demo_main' was properly closed.
[0m03:41:12.653094 [debug] [MainThread]: Connection 'model.legal_demo.acris_cases' was properly closed.
[0m03:41:12.654495 [info ] [MainThread]: 
[0m03:41:12.656187 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.20 seconds (3.20s).
[0m03:41:12.658162 [debug] [MainThread]: Command end result
[0m03:41:12.691421 [info ] [MainThread]: 
[0m03:41:12.693420 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:41:12.695157 [info ] [MainThread]: 
[0m03:41:12.696949 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m03:41:12.700587 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.0042458, "process_user_time": 7.226376, "process_kernel_time": 1.443684, "process_mem_max_rss": "300504", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m03:41:12.702767 [debug] [MainThread]: Command `dbt run` succeeded at 03:41:12.702460 after 4.01 seconds
[0m03:41:12.704822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78b25ed393d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78b25e755290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78b263622c50>]}
[0m03:41:12.706517 [debug] [MainThread]: Flushing usage events
[0m03:41:51.740967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7abb046dcd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7abb049aa510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7abb04acb090>]}


============================== 03:41:51.750341 | 78962e76-d5b3-4f9d-bb69-06515d0606fe ==============================
[0m03:41:51.750341 [info ] [MainThread]: Running with dbt=1.7.4
[0m03:41:51.752527 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt', 'send_anonymous_usage_stats': 'True'}
[0m03:41:52.135334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '78962e76-d5b3-4f9d-bb69-06515d0606fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7abb04b02e90>]}
[0m03:41:52.240714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '78962e76-d5b3-4f9d-bb69-06515d0606fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7abafb510410>]}
[0m03:41:52.243268 [info ] [MainThread]: Registered adapter: duckdb=1.7.4
[0m03:41:52.263449 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m03:41:52.357628 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:41:52.359978 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:41:52.368711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '78962e76-d5b3-4f9d-bb69-06515d0606fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7abafb4c8490>]}
[0m03:41:52.425813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '78962e76-d5b3-4f9d-bb69-06515d0606fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7abafb5a7d10>]}
[0m03:41:52.427666 [info ] [MainThread]: Found 1 model, 0 sources, 0 exposures, 0 metrics, 394 macros, 0 groups, 0 semantic models
[0m03:41:52.429419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '78962e76-d5b3-4f9d-bb69-06515d0606fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7abb046f7550>]}
[0m03:41:52.432564 [info ] [MainThread]: 
[0m03:41:52.435018 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m03:41:52.438575 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_legal_demo'
[0m03:41:52.455356 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo"
[0m03:41:52.457774 [debug] [ThreadPool]: On list_legal_demo: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"legal_demo"'
    
  
  
[0m03:41:52.459491 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:41:52.495404 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:41:52.499166 [debug] [ThreadPool]: On list_legal_demo: Close
[0m03:41:52.510024 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_legal_demo, now create_legal_demo_main)
[0m03:41:52.512095 [debug] [ThreadPool]: Creating schema "database: "legal_demo"
schema: "main"
"
[0m03:41:52.521241 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m03:41:52.523238 [debug] [ThreadPool]: On create_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "create_legal_demo_main"} */

    
        select type from duckdb_databases()
        where database_name='legal_demo'
        and type='sqlite'
    
  
[0m03:41:52.524947 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:41:52.554776 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:41:52.558504 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m03:41:52.560430 [debug] [ThreadPool]: On create_legal_demo_main: BEGIN
[0m03:41:52.563183 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:41:52.565043 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m03:41:52.566646 [debug] [ThreadPool]: On create_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "create_legal_demo_main"} */

    
    
        create schema if not exists "legal_demo"."main"
    
[0m03:41:52.569443 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:41:52.571894 [debug] [ThreadPool]: On create_legal_demo_main: COMMIT
[0m03:41:52.573785 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m03:41:52.575478 [debug] [ThreadPool]: On create_legal_demo_main: COMMIT
[0m03:41:52.578927 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:41:52.580459 [debug] [ThreadPool]: On create_legal_demo_main: Close
[0m03:41:52.591034 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_legal_demo_main, now list_legal_demo_main)
[0m03:41:52.599834 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo_main"
[0m03:41:52.601741 [debug] [ThreadPool]: On list_legal_demo_main: BEGIN
[0m03:41:52.603271 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:41:52.628766 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:41:52.630890 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo_main"
[0m03:41:52.632419 [debug] [ThreadPool]: On list_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo_main"} */
select
      'legal_demo' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'legal_demo'
  
[0m03:41:52.661109 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:41:52.668616 [debug] [ThreadPool]: On list_legal_demo_main: ROLLBACK
[0m03:41:52.671111 [debug] [ThreadPool]: Failed to rollback 'list_legal_demo_main'
[0m03:41:52.672864 [debug] [ThreadPool]: On list_legal_demo_main: Close
[0m03:41:52.680415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '78962e76-d5b3-4f9d-bb69-06515d0606fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7abb0471d8d0>]}
[0m03:41:52.682329 [debug] [MainThread]: Using duckdb connection "master"
[0m03:41:52.683829 [debug] [MainThread]: On master: BEGIN
[0m03:41:52.685453 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:41:52.708288 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m03:41:52.710217 [debug] [MainThread]: On master: COMMIT
[0m03:41:52.711578 [debug] [MainThread]: Using duckdb connection "master"
[0m03:41:52.713013 [debug] [MainThread]: On master: COMMIT
[0m03:41:52.715112 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m03:41:52.716590 [debug] [MainThread]: On master: Close
[0m03:41:52.721679 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:41:52.723663 [info ] [MainThread]: 
[0m03:41:52.736172 [debug] [Thread-1 (]: Began running node model.legal_demo.acris_cases
[0m03:41:52.738644 [info ] [Thread-1 (]: 1 of 1 START sql table model main.acris_clean .................................. [RUN]
[0m03:41:52.740910 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.legal_demo.acris_cases'
[0m03:41:52.742627 [debug] [Thread-1 (]: Began compiling node model.legal_demo.acris_cases
[0m03:41:52.751455 [debug] [Thread-1 (]: Writing injected SQL for node "model.legal_demo.acris_cases"
[0m03:41:52.766209 [debug] [Thread-1 (]: Timing info for model.legal_demo.acris_cases (compile): 03:41:52.743883 => 03:41:52.765728
[0m03:41:52.768090 [debug] [Thread-1 (]: Began executing node model.legal_demo.acris_cases
[0m03:41:52.806436 [debug] [Thread-1 (]: Writing runtime sql for node "model.legal_demo.acris_cases"
[0m03:41:52.819671 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:41:52.821901 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: BEGIN
[0m03:41:52.823542 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m03:41:52.847355 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:41:52.849378 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:41:52.850928 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */

  
    
    

    create  table
      "legal_demo"."main"."acris_clean__dbt_tmp"
  
    as (
      --
-- This model loads the already‑downloaded CSV into DuckDB and
-- materializes it as a table named `acris_clean`.  Because the
-- pipeline does not download data, the file must exist under
-- `data/first_500k_acris.csv` prior to running `dbt run`.  The
-- absolute path points at `/opt/airflow/data/first_500k_acris.csv` when
-- executed inside the Airflow containers.  Locally, dbt resolves
-- relative paths against the project root, so this model continues to
-- work outside of Docker.



SELECT *
FROM read_csv_auto('/opt/airflow/data/first_500k_acris.csv', header=True, delim=',')
    );
  
  
[0m03:41:55.413380 [debug] [Thread-1 (]: SQL status: OK in 3.0 seconds
[0m03:41:55.424222 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:41:55.426437 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
alter table "legal_demo"."main"."acris_clean" rename to "acris_clean__dbt_backup"
[0m03:41:55.429914 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:41:55.435737 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:41:55.438014 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
alter table "legal_demo"."main"."acris_clean__dbt_tmp" rename to "acris_clean"
[0m03:41:55.440804 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:41:55.466653 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: COMMIT
[0m03:41:55.469399 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:41:55.471176 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: COMMIT
[0m03:41:55.556584 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:41:55.567176 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:41:55.569664 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
drop table if exists "legal_demo"."main"."acris_clean__dbt_backup" cascade
[0m03:41:55.578170 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:41:55.582167 [debug] [Thread-1 (]: Timing info for model.legal_demo.acris_cases (execute): 03:41:52.769631 => 03:41:55.581861
[0m03:41:55.584042 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: Close
[0m03:41:55.659420 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78962e76-d5b3-4f9d-bb69-06515d0606fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7abafb3be6d0>]}
[0m03:41:55.662333 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main.acris_clean ............................. [[32mOK[0m in 2.92s]
[0m03:41:55.664517 [debug] [Thread-1 (]: Finished running node model.legal_demo.acris_cases
[0m03:41:55.670082 [debug] [MainThread]: Using duckdb connection "master"
[0m03:41:55.671843 [debug] [MainThread]: On master: BEGIN
[0m03:41:55.673471 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:41:55.698526 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m03:41:55.701168 [debug] [MainThread]: On master: COMMIT
[0m03:41:55.702920 [debug] [MainThread]: Using duckdb connection "master"
[0m03:41:55.704346 [debug] [MainThread]: On master: COMMIT
[0m03:41:55.706328 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m03:41:55.707866 [debug] [MainThread]: On master: Close
[0m03:41:55.713854 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:41:55.715645 [debug] [MainThread]: Connection 'list_legal_demo_main' was properly closed.
[0m03:41:55.717061 [debug] [MainThread]: Connection 'model.legal_demo.acris_cases' was properly closed.
[0m03:41:55.718595 [info ] [MainThread]: 
[0m03:41:55.720255 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.28 seconds (3.28s).
[0m03:41:55.722251 [debug] [MainThread]: Command end result
[0m03:41:55.763451 [info ] [MainThread]: 
[0m03:41:55.766112 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:41:55.767862 [info ] [MainThread]: 
[0m03:41:55.769515 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m03:41:55.772096 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.101944, "process_user_time": 7.568694, "process_kernel_time": 1.415611, "process_mem_max_rss": "298320", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m03:41:55.774309 [debug] [MainThread]: Command `dbt run` succeeded at 03:41:55.774071 after 4.10 seconds
[0m03:41:55.776167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7abb05ae73d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7abb046e9410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7abb09458510>]}
[0m03:41:55.778270 [debug] [MainThread]: Flushing usage events
[0m03:42:38.631383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c6a3049d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c6a31dca50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c6a3083590>]}


============================== 03:42:38.640706 | 7df44fb7-1f4e-4690-9131-cacc707ca360 ==============================
[0m03:42:38.640706 [info ] [MainThread]: Running with dbt=1.7.4
[0m03:42:38.642633 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m03:42:39.017265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7df44fb7-1f4e-4690-9131-cacc707ca360', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c699975350>]}
[0m03:42:39.119743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7df44fb7-1f4e-4690-9131-cacc707ca360', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c699711650>]}
[0m03:42:39.122854 [info ] [MainThread]: Registered adapter: duckdb=1.7.4
[0m03:42:39.143403 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m03:42:39.221317 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:42:39.223414 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:42:39.232759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7df44fb7-1f4e-4690-9131-cacc707ca360', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c699987c90>]}
[0m03:42:39.278306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7df44fb7-1f4e-4690-9131-cacc707ca360', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c6998e2ad0>]}
[0m03:42:39.280275 [info ] [MainThread]: Found 1 model, 0 sources, 0 exposures, 0 metrics, 394 macros, 0 groups, 0 semantic models
[0m03:42:39.282424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7df44fb7-1f4e-4690-9131-cacc707ca360', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c699851e10>]}
[0m03:42:39.285879 [info ] [MainThread]: 
[0m03:42:39.287984 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m03:42:39.290717 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_legal_demo'
[0m03:42:39.306141 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo"
[0m03:42:39.307917 [debug] [ThreadPool]: On list_legal_demo: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"legal_demo"'
    
  
  
[0m03:42:39.309572 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:42:39.341579 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:42:39.345056 [debug] [ThreadPool]: On list_legal_demo: Close
[0m03:42:39.354820 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_legal_demo, now create_legal_demo_main)
[0m03:42:39.356817 [debug] [ThreadPool]: Creating schema "database: "legal_demo"
schema: "main"
"
[0m03:42:39.368010 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m03:42:39.369702 [debug] [ThreadPool]: On create_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "create_legal_demo_main"} */

    
        select type from duckdb_databases()
        where database_name='legal_demo'
        and type='sqlite'
    
  
[0m03:42:39.371048 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:42:39.396791 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:42:39.400421 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m03:42:39.401890 [debug] [ThreadPool]: On create_legal_demo_main: BEGIN
[0m03:42:39.403982 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:42:39.405392 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m03:42:39.406823 [debug] [ThreadPool]: On create_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "create_legal_demo_main"} */

    
    
        create schema if not exists "legal_demo"."main"
    
[0m03:42:39.408969 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:42:39.410942 [debug] [ThreadPool]: On create_legal_demo_main: COMMIT
[0m03:42:39.412358 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m03:42:39.413707 [debug] [ThreadPool]: On create_legal_demo_main: COMMIT
[0m03:42:39.416820 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:42:39.418393 [debug] [ThreadPool]: On create_legal_demo_main: Close
[0m03:42:39.427680 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_legal_demo_main, now list_legal_demo_main)
[0m03:42:39.435358 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo_main"
[0m03:42:39.437193 [debug] [ThreadPool]: On list_legal_demo_main: BEGIN
[0m03:42:39.438682 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:42:39.460178 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:42:39.461773 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo_main"
[0m03:42:39.463428 [debug] [ThreadPool]: On list_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo_main"} */
select
      'legal_demo' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'legal_demo'
  
[0m03:42:39.491315 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:42:39.499393 [debug] [ThreadPool]: On list_legal_demo_main: ROLLBACK
[0m03:42:39.542271 [debug] [ThreadPool]: Failed to rollback 'list_legal_demo_main'
[0m03:42:39.544128 [debug] [ThreadPool]: On list_legal_demo_main: Close
[0m03:42:39.550880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7df44fb7-1f4e-4690-9131-cacc707ca360', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c6999da610>]}
[0m03:42:39.552555 [debug] [MainThread]: Using duckdb connection "master"
[0m03:42:39.554057 [debug] [MainThread]: On master: BEGIN
[0m03:42:39.555381 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:42:39.576897 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m03:42:39.578680 [debug] [MainThread]: On master: COMMIT
[0m03:42:39.580108 [debug] [MainThread]: Using duckdb connection "master"
[0m03:42:39.581523 [debug] [MainThread]: On master: COMMIT
[0m03:42:39.583552 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m03:42:39.584998 [debug] [MainThread]: On master: Close
[0m03:42:39.590035 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:42:39.591766 [info ] [MainThread]: 
[0m03:42:39.604181 [debug] [Thread-1 (]: Began running node model.legal_demo.acris_cases
[0m03:42:39.606177 [info ] [Thread-1 (]: 1 of 1 START sql table model main.acris_clean .................................. [RUN]
[0m03:42:39.608198 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.legal_demo.acris_cases'
[0m03:42:39.609784 [debug] [Thread-1 (]: Began compiling node model.legal_demo.acris_cases
[0m03:42:39.618609 [debug] [Thread-1 (]: Writing injected SQL for node "model.legal_demo.acris_cases"
[0m03:42:39.632045 [debug] [Thread-1 (]: Timing info for model.legal_demo.acris_cases (compile): 03:42:39.611122 => 03:42:39.631634
[0m03:42:39.633708 [debug] [Thread-1 (]: Began executing node model.legal_demo.acris_cases
[0m03:42:39.677042 [debug] [Thread-1 (]: Writing runtime sql for node "model.legal_demo.acris_cases"
[0m03:42:39.690667 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:42:39.692402 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: BEGIN
[0m03:42:39.693870 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m03:42:39.720077 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:42:39.722418 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:42:39.724526 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */

  
    
    

    create  table
      "legal_demo"."main"."acris_clean__dbt_tmp"
  
    as (
      --
-- This model loads the already‑downloaded CSV into DuckDB and
-- materializes it as a table named `acris_clean`.  Because the
-- pipeline does not download data, the file must exist under
-- `data/first_500k_acris.csv` prior to running `dbt run`.  The
-- absolute path points at `/opt/airflow/data/first_500k_acris.csv` when
-- executed inside the Airflow containers.  Locally, dbt resolves
-- relative paths against the project root, so this model continues to
-- work outside of Docker.



SELECT *
FROM read_csv_auto('/opt/airflow/data/first_500k_acris.csv', header=True, delim=',')
    );
  
  
[0m03:42:42.174407 [debug] [Thread-1 (]: SQL status: OK in 2.0 seconds
[0m03:42:42.183459 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:42:42.185493 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
alter table "legal_demo"."main"."acris_clean" rename to "acris_clean__dbt_backup"
[0m03:42:42.187768 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:42:42.192498 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:42:42.194111 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
alter table "legal_demo"."main"."acris_clean__dbt_tmp" rename to "acris_clean"
[0m03:42:42.196170 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:42:42.218733 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: COMMIT
[0m03:42:42.253968 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:42:42.256208 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: COMMIT
[0m03:42:42.275099 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:42:42.282900 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:42:42.285108 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
drop table if exists "legal_demo"."main"."acris_clean__dbt_backup" cascade
[0m03:42:42.293366 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:42:42.296646 [debug] [Thread-1 (]: Timing info for model.legal_demo.acris_cases (execute): 03:42:39.635048 => 03:42:42.296393
[0m03:42:42.298608 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: Close
[0m03:42:42.363516 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7df44fb7-1f4e-4690-9131-cacc707ca360', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c699985e50>]}
[0m03:42:42.366297 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main.acris_clean ............................. [[32mOK[0m in 2.76s]
[0m03:42:42.368437 [debug] [Thread-1 (]: Finished running node model.legal_demo.acris_cases
[0m03:42:42.372551 [debug] [MainThread]: Using duckdb connection "master"
[0m03:42:42.374302 [debug] [MainThread]: On master: BEGIN
[0m03:42:42.375734 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:42:42.398441 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m03:42:42.400401 [debug] [MainThread]: On master: COMMIT
[0m03:42:42.402126 [debug] [MainThread]: Using duckdb connection "master"
[0m03:42:42.403871 [debug] [MainThread]: On master: COMMIT
[0m03:42:42.406180 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m03:42:42.408408 [debug] [MainThread]: On master: Close
[0m03:42:42.414372 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:42:42.416177 [debug] [MainThread]: Connection 'list_legal_demo_main' was properly closed.
[0m03:42:42.418212 [debug] [MainThread]: Connection 'model.legal_demo.acris_cases' was properly closed.
[0m03:42:42.419966 [info ] [MainThread]: 
[0m03:42:42.421724 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.13 seconds (3.13s).
[0m03:42:42.424045 [debug] [MainThread]: Command end result
[0m03:42:42.459174 [info ] [MainThread]: 
[0m03:42:42.461539 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:42:42.463324 [info ] [MainThread]: 
[0m03:42:42.465284 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m03:42:42.467989 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.9146938, "process_user_time": 7.43829, "process_kernel_time": 1.327113, "process_mem_max_rss": "297952", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m03:42:42.470062 [debug] [MainThread]: Command `dbt run` succeeded at 03:42:42.469855 after 3.92 seconds
[0m03:42:42.471611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c6a7b16250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c6a31de110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c6a31ab610>]}
[0m03:42:42.473412 [debug] [MainThread]: Flushing usage events
[0m03:43:54.869322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7641392f6590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x764139718ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7641391d6dd0>]}


============================== 03:43:54.880936 | 7dcd2e9f-d9ad-4606-ae50-94d24cc0283d ==============================
[0m03:43:54.880936 [info ] [MainThread]: Running with dbt=1.7.4
[0m03:43:54.883143 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m03:43:55.350037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7dcd2e9f-d9ad-4606-ae50-94d24cc0283d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x764138e93090>]}
[0m03:43:55.472976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7dcd2e9f-d9ad-4606-ae50-94d24cc0283d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x764139869e90>]}
[0m03:43:55.475610 [info ] [MainThread]: Registered adapter: duckdb=1.7.4
[0m03:43:55.499655 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m03:43:55.605262 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:43:55.654229 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:43:55.662134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7dcd2e9f-d9ad-4606-ae50-94d24cc0283d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7641392d9d10>]}
[0m03:43:55.711355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7dcd2e9f-d9ad-4606-ae50-94d24cc0283d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76412fdddd90>]}
[0m03:43:55.713154 [info ] [MainThread]: Found 1 model, 0 sources, 0 exposures, 0 metrics, 394 macros, 0 groups, 0 semantic models
[0m03:43:55.714909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7dcd2e9f-d9ad-4606-ae50-94d24cc0283d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7641395d7550>]}
[0m03:43:55.718630 [info ] [MainThread]: 
[0m03:43:55.721334 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m03:43:55.725219 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_legal_demo'
[0m03:43:55.742627 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo"
[0m03:43:55.745066 [debug] [ThreadPool]: On list_legal_demo: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"legal_demo"'
    
  
  
[0m03:43:55.746564 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:43:55.778869 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:43:55.782921 [debug] [ThreadPool]: On list_legal_demo: Close
[0m03:43:55.798373 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_legal_demo, now create_legal_demo_main)
[0m03:43:55.801454 [debug] [ThreadPool]: Creating schema "database: "legal_demo"
schema: "main"
"
[0m03:43:55.813813 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m03:43:55.815886 [debug] [ThreadPool]: On create_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "create_legal_demo_main"} */

    
        select type from duckdb_databases()
        where database_name='legal_demo'
        and type='sqlite'
    
  
[0m03:43:55.817536 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:43:55.865528 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:43:55.870121 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m03:43:55.872099 [debug] [ThreadPool]: On create_legal_demo_main: BEGIN
[0m03:43:55.874709 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:43:55.876512 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m03:43:55.878085 [debug] [ThreadPool]: On create_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "create_legal_demo_main"} */

    
    
        create schema if not exists "legal_demo"."main"
    
[0m03:43:55.880466 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:43:55.883017 [debug] [ThreadPool]: On create_legal_demo_main: COMMIT
[0m03:43:55.884707 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m03:43:55.886169 [debug] [ThreadPool]: On create_legal_demo_main: COMMIT
[0m03:43:55.890880 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:43:55.892515 [debug] [ThreadPool]: On create_legal_demo_main: Close
[0m03:43:55.902938 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_legal_demo_main, now list_legal_demo_main)
[0m03:43:55.922087 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo_main"
[0m03:43:55.923857 [debug] [ThreadPool]: On list_legal_demo_main: BEGIN
[0m03:43:55.925538 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:43:55.945835 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:43:55.947665 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo_main"
[0m03:43:55.949471 [debug] [ThreadPool]: On list_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo_main"} */
select
      'legal_demo' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'legal_demo'
  
[0m03:43:55.981245 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:43:55.990433 [debug] [ThreadPool]: On list_legal_demo_main: ROLLBACK
[0m03:43:55.993201 [debug] [ThreadPool]: Failed to rollback 'list_legal_demo_main'
[0m03:43:55.994990 [debug] [ThreadPool]: On list_legal_demo_main: Close
[0m03:43:56.003466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7dcd2e9f-d9ad-4606-ae50-94d24cc0283d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76412fb04150>]}
[0m03:43:56.005595 [debug] [MainThread]: Using duckdb connection "master"
[0m03:43:56.007257 [debug] [MainThread]: On master: BEGIN
[0m03:43:56.008735 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:43:56.031068 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m03:43:56.033124 [debug] [MainThread]: On master: COMMIT
[0m03:43:56.034702 [debug] [MainThread]: Using duckdb connection "master"
[0m03:43:56.036054 [debug] [MainThread]: On master: COMMIT
[0m03:43:56.038274 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m03:43:56.039817 [debug] [MainThread]: On master: Close
[0m03:43:56.044603 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:43:56.046698 [info ] [MainThread]: 
[0m03:43:56.061371 [debug] [Thread-1 (]: Began running node model.legal_demo.acris_cases
[0m03:43:56.063663 [info ] [Thread-1 (]: 1 of 1 START sql table model main.acris_clean .................................. [RUN]
[0m03:43:56.066230 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.legal_demo.acris_cases'
[0m03:43:56.067811 [debug] [Thread-1 (]: Began compiling node model.legal_demo.acris_cases
[0m03:43:56.079124 [debug] [Thread-1 (]: Writing injected SQL for node "model.legal_demo.acris_cases"
[0m03:43:56.092855 [debug] [Thread-1 (]: Timing info for model.legal_demo.acris_cases (compile): 03:43:56.069080 => 03:43:56.092268
[0m03:43:56.094831 [debug] [Thread-1 (]: Began executing node model.legal_demo.acris_cases
[0m03:43:56.150697 [debug] [Thread-1 (]: Writing runtime sql for node "model.legal_demo.acris_cases"
[0m03:43:56.162280 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:43:56.163875 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: BEGIN
[0m03:43:56.165330 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m03:43:56.188836 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:43:56.190916 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:43:56.192546 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */

  
    
    

    create  table
      "legal_demo"."main"."acris_clean__dbt_tmp"
  
    as (
      --
-- This model loads the already‑downloaded CSV into DuckDB and
-- materializes it as a table named `acris_clean`.  Because the
-- pipeline does not download data, the file must exist under
-- `data/first_500k_acris.csv` prior to running `dbt run`.  The
-- absolute path points at `/opt/airflow/data/first_500k_acris.csv` when
-- executed inside the Airflow containers.  Locally, dbt resolves
-- relative paths against the project root, so this model continues to
-- work outside of Docker.



SELECT *
FROM read_csv_auto('/opt/airflow/data/first_500k_acris.csv', header=True, delim=',')
    );
  
  
[0m03:43:58.647989 [debug] [Thread-1 (]: SQL status: OK in 2.0 seconds
[0m03:43:58.657087 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:43:58.659335 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
alter table "legal_demo"."main"."acris_clean" rename to "acris_clean__dbt_backup"
[0m03:43:58.661933 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:43:58.667156 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:43:58.669272 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
alter table "legal_demo"."main"."acris_clean__dbt_tmp" rename to "acris_clean"
[0m03:43:58.671460 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:43:58.697266 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: COMMIT
[0m03:43:58.699616 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:43:58.701837 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: COMMIT
[0m03:43:58.769155 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:43:58.776927 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:43:58.779266 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
drop table if exists "legal_demo"."main"."acris_clean__dbt_backup" cascade
[0m03:43:58.788065 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:43:58.791307 [debug] [Thread-1 (]: Timing info for model.legal_demo.acris_cases (execute): 03:43:56.096272 => 03:43:58.791043
[0m03:43:58.793479 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: Close
[0m03:43:58.863332 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7dcd2e9f-d9ad-4606-ae50-94d24cc0283d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76412fd8b750>]}
[0m03:43:58.866212 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main.acris_clean ............................. [[32mOK[0m in 2.80s]
[0m03:43:58.868559 [debug] [Thread-1 (]: Finished running node model.legal_demo.acris_cases
[0m03:43:58.872628 [debug] [MainThread]: Using duckdb connection "master"
[0m03:43:58.874242 [debug] [MainThread]: On master: BEGIN
[0m03:43:58.875593 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:43:58.897441 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m03:43:58.899130 [debug] [MainThread]: On master: COMMIT
[0m03:43:58.900529 [debug] [MainThread]: Using duckdb connection "master"
[0m03:43:58.901896 [debug] [MainThread]: On master: COMMIT
[0m03:43:58.904057 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m03:43:58.905634 [debug] [MainThread]: On master: Close
[0m03:43:58.910295 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:43:58.912041 [debug] [MainThread]: Connection 'list_legal_demo_main' was properly closed.
[0m03:43:58.913469 [debug] [MainThread]: Connection 'model.legal_demo.acris_cases' was properly closed.
[0m03:43:58.915048 [info ] [MainThread]: 
[0m03:43:58.916617 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.19 seconds (3.19s).
[0m03:43:58.918501 [debug] [MainThread]: Command end result
[0m03:43:58.952538 [info ] [MainThread]: 
[0m03:43:58.954661 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:43:58.956460 [info ] [MainThread]: 
[0m03:43:58.958209 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m03:43:58.960556 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.2144747, "process_user_time": 7.827067, "process_kernel_time": 1.311888, "process_mem_max_rss": "300816", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m03:43:58.962270 [debug] [MainThread]: Command `dbt run` succeeded at 03:43:58.962065 after 4.22 seconds
[0m03:43:58.963822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7641392ec850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76413dc96810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76413db04dd0>]}
[0m03:43:58.965646 [debug] [MainThread]: Flushing usage events
[0m03:45:24.878058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a20fa92c610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a20fa7b6350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a20faaa8fd0>]}


============================== 03:45:24.887450 | 21cab71b-2382-4239-8bae-1a95fd7d1c76 ==============================
[0m03:45:24.887450 [info ] [MainThread]: Running with dbt=1.7.4
[0m03:45:24.889435 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m03:45:25.258022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '21cab71b-2382-4239-8bae-1a95fd7d1c76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a20fa4bf990>]}
[0m03:45:25.362871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '21cab71b-2382-4239-8bae-1a95fd7d1c76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a20fa5e6d90>]}
[0m03:45:25.365357 [info ] [MainThread]: Registered adapter: duckdb=1.7.4
[0m03:45:25.385601 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m03:45:25.469890 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:45:25.472036 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:45:25.479438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '21cab71b-2382-4239-8bae-1a95fd7d1c76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a20f12d8550>]}
[0m03:45:25.526427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '21cab71b-2382-4239-8bae-1a95fd7d1c76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a20fa53a290>]}
[0m03:45:25.528889 [info ] [MainThread]: Found 1 model, 0 sources, 0 exposures, 0 metrics, 394 macros, 0 groups, 0 semantic models
[0m03:45:25.533086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '21cab71b-2382-4239-8bae-1a95fd7d1c76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a20f12d8bd0>]}
[0m03:45:25.536632 [info ] [MainThread]: 
[0m03:45:25.538910 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m03:45:25.542187 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_legal_demo'
[0m03:45:25.558577 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo"
[0m03:45:25.560653 [debug] [ThreadPool]: On list_legal_demo: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"legal_demo"'
    
  
  
[0m03:45:25.562265 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:45:25.596865 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:45:25.600440 [debug] [ThreadPool]: On list_legal_demo: Close
[0m03:45:25.609208 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_legal_demo, now create_legal_demo_main)
[0m03:45:25.611283 [debug] [ThreadPool]: Creating schema "database: "legal_demo"
schema: "main"
"
[0m03:45:25.634174 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m03:45:25.636538 [debug] [ThreadPool]: On create_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "create_legal_demo_main"} */

    
        select type from duckdb_databases()
        where database_name='legal_demo'
        and type='sqlite'
    
  
[0m03:45:25.637882 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:45:25.663332 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:45:25.666414 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m03:45:25.667954 [debug] [ThreadPool]: On create_legal_demo_main: BEGIN
[0m03:45:25.669927 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:45:25.671811 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m03:45:25.673226 [debug] [ThreadPool]: On create_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "create_legal_demo_main"} */

    
    
        create schema if not exists "legal_demo"."main"
    
[0m03:45:25.675484 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:45:25.677866 [debug] [ThreadPool]: On create_legal_demo_main: COMMIT
[0m03:45:25.679527 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m03:45:25.681203 [debug] [ThreadPool]: On create_legal_demo_main: COMMIT
[0m03:45:25.683756 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:45:25.685347 [debug] [ThreadPool]: On create_legal_demo_main: Close
[0m03:45:25.695956 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_legal_demo_main, now list_legal_demo_main)
[0m03:45:25.703678 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo_main"
[0m03:45:25.705930 [debug] [ThreadPool]: On list_legal_demo_main: BEGIN
[0m03:45:25.707738 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:45:25.729305 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:45:25.731732 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo_main"
[0m03:45:25.733319 [debug] [ThreadPool]: On list_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo_main"} */
select
      'legal_demo' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'legal_demo'
  
[0m03:45:25.762148 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:45:25.770857 [debug] [ThreadPool]: On list_legal_demo_main: ROLLBACK
[0m03:45:25.773397 [debug] [ThreadPool]: Failed to rollback 'list_legal_demo_main'
[0m03:45:25.775012 [debug] [ThreadPool]: On list_legal_demo_main: Close
[0m03:45:25.781845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '21cab71b-2382-4239-8bae-1a95fd7d1c76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a20fa539ad0>]}
[0m03:45:25.784014 [debug] [MainThread]: Using duckdb connection "master"
[0m03:45:25.785510 [debug] [MainThread]: On master: BEGIN
[0m03:45:25.787106 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:45:25.808564 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m03:45:25.810251 [debug] [MainThread]: On master: COMMIT
[0m03:45:25.811422 [debug] [MainThread]: Using duckdb connection "master"
[0m03:45:25.813250 [debug] [MainThread]: On master: COMMIT
[0m03:45:25.815063 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m03:45:25.816461 [debug] [MainThread]: On master: Close
[0m03:45:25.820780 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:45:25.822555 [info ] [MainThread]: 
[0m03:45:25.835050 [debug] [Thread-1 (]: Began running node model.legal_demo.acris_cases
[0m03:45:25.872120 [info ] [Thread-1 (]: 1 of 1 START sql table model main.acris_clean .................................. [RUN]
[0m03:45:25.874600 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.legal_demo.acris_cases'
[0m03:45:25.876269 [debug] [Thread-1 (]: Began compiling node model.legal_demo.acris_cases
[0m03:45:25.885155 [debug] [Thread-1 (]: Writing injected SQL for node "model.legal_demo.acris_cases"
[0m03:45:25.899456 [debug] [Thread-1 (]: Timing info for model.legal_demo.acris_cases (compile): 03:45:25.877863 => 03:45:25.898997
[0m03:45:25.901145 [debug] [Thread-1 (]: Began executing node model.legal_demo.acris_cases
[0m03:45:25.939376 [debug] [Thread-1 (]: Writing runtime sql for node "model.legal_demo.acris_cases"
[0m03:45:25.954215 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:45:25.955976 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: BEGIN
[0m03:45:25.957406 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m03:45:25.980304 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:45:25.981985 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:45:25.983618 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */

  
    
    

    create  table
      "legal_demo"."main"."acris_clean__dbt_tmp"
  
    as (
      --
-- This model loads the already‑downloaded CSV into DuckDB and
-- materializes it as a table named `acris_clean`.  Because the
-- pipeline does not download data, the file must exist under
-- `data/first_500k_acris.csv` prior to running `dbt run`.  The
-- absolute path points at `/opt/airflow/data/first_500k_acris.csv` when
-- executed inside the Airflow containers.  Locally, dbt resolves
-- relative paths against the project root, so this model continues to
-- work outside of Docker.



SELECT *
FROM read_csv_auto('/opt/airflow/data/first_500k_acris.csv', header=True, delim=',')
    );
  
  
[0m03:45:28.487688 [debug] [Thread-1 (]: SQL status: OK in 3.0 seconds
[0m03:45:28.497026 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:45:28.498911 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
alter table "legal_demo"."main"."acris_clean" rename to "acris_clean__dbt_backup"
[0m03:45:28.501285 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:45:28.505979 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:45:28.508031 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
alter table "legal_demo"."main"."acris_clean__dbt_tmp" rename to "acris_clean"
[0m03:45:28.510281 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:45:28.534907 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: COMMIT
[0m03:45:28.537005 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:45:28.538705 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: COMMIT
[0m03:45:28.599920 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:45:28.607736 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:45:28.609847 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
drop table if exists "legal_demo"."main"."acris_clean__dbt_backup" cascade
[0m03:45:28.618518 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:45:28.621488 [debug] [Thread-1 (]: Timing info for model.legal_demo.acris_cases (execute): 03:45:25.902581 => 03:45:28.621176
[0m03:45:28.623194 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: Close
[0m03:45:28.686148 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21cab71b-2382-4239-8bae-1a95fd7d1c76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a20f11c8390>]}
[0m03:45:28.688697 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main.acris_clean ............................. [[32mOK[0m in 2.81s]
[0m03:45:28.690569 [debug] [Thread-1 (]: Finished running node model.legal_demo.acris_cases
[0m03:45:28.695314 [debug] [MainThread]: Using duckdb connection "master"
[0m03:45:28.696955 [debug] [MainThread]: On master: BEGIN
[0m03:45:28.698488 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:45:28.721375 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m03:45:28.723420 [debug] [MainThread]: On master: COMMIT
[0m03:45:28.724990 [debug] [MainThread]: Using duckdb connection "master"
[0m03:45:28.726287 [debug] [MainThread]: On master: COMMIT
[0m03:45:28.728319 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m03:45:28.729956 [debug] [MainThread]: On master: Close
[0m03:45:28.734912 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:45:28.736690 [debug] [MainThread]: Connection 'list_legal_demo_main' was properly closed.
[0m03:45:28.738157 [debug] [MainThread]: Connection 'model.legal_demo.acris_cases' was properly closed.
[0m03:45:28.739707 [info ] [MainThread]: 
[0m03:45:28.741249 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.20 seconds (3.20s).
[0m03:45:28.743080 [debug] [MainThread]: Command end result
[0m03:45:28.778181 [info ] [MainThread]: 
[0m03:45:28.781255 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:45:28.783150 [info ] [MainThread]: 
[0m03:45:28.785134 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m03:45:28.787311 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.9858558, "process_user_time": 7.358831, "process_kernel_time": 1.367499, "process_mem_max_rss": "297564", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m03:45:28.789193 [debug] [MainThread]: Command `dbt run` succeeded at 03:45:28.789003 after 3.99 seconds
[0m03:45:28.790879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a20fa4cbb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a20ff2487d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a20ff274490>]}
[0m03:45:28.792503 [debug] [MainThread]: Flushing usage events
[0m03:59:27.764248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74efc2df8e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74efc31b0f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74efc2a73fd0>]}


============================== 03:59:27.773950 | c9dccbbd-06bf-4473-be8d-dc32c2e3d5c3 ==============================
[0m03:59:27.773950 [info ] [MainThread]: Running with dbt=1.7.4
[0m03:59:27.776291 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m03:59:28.153671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c9dccbbd-06bf-4473-be8d-dc32c2e3d5c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74efc2683650>]}
[0m03:59:28.256676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c9dccbbd-06bf-4473-be8d-dc32c2e3d5c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74efc2dd0e50>]}
[0m03:59:28.259422 [info ] [MainThread]: Registered adapter: duckdb=1.7.4
[0m03:59:28.280782 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m03:59:28.403560 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:59:28.405870 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:59:28.413883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c9dccbbd-06bf-4473-be8d-dc32c2e3d5c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74efbf531190>]}
[0m03:59:28.462358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c9dccbbd-06bf-4473-be8d-dc32c2e3d5c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74efb8fa3d90>]}
[0m03:59:28.464250 [info ] [MainThread]: Found 1 model, 0 sources, 0 exposures, 0 metrics, 394 macros, 0 groups, 0 semantic models
[0m03:59:28.466173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c9dccbbd-06bf-4473-be8d-dc32c2e3d5c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74efb8f3dd10>]}
[0m03:59:28.469473 [info ] [MainThread]: 
[0m03:59:28.471698 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m03:59:28.474802 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_legal_demo'
[0m03:59:28.490893 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo"
[0m03:59:28.493187 [debug] [ThreadPool]: On list_legal_demo: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"legal_demo"'
    
  
  
[0m03:59:28.494996 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:59:28.529927 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:59:28.534373 [debug] [ThreadPool]: On list_legal_demo: Close
[0m03:59:28.545731 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_legal_demo, now create_legal_demo_main)
[0m03:59:28.550464 [debug] [ThreadPool]: Creating schema "database: "legal_demo"
schema: "main"
"
[0m03:59:28.560717 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m03:59:28.562810 [debug] [ThreadPool]: On create_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "create_legal_demo_main"} */

    
        select type from duckdb_databases()
        where database_name='legal_demo'
        and type='sqlite'
    
  
[0m03:59:28.564134 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:59:28.597449 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:59:28.601838 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m03:59:28.603792 [debug] [ThreadPool]: On create_legal_demo_main: BEGIN
[0m03:59:28.608988 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:59:28.611754 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m03:59:28.613850 [debug] [ThreadPool]: On create_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "create_legal_demo_main"} */

    
    
        create schema if not exists "legal_demo"."main"
    
[0m03:59:28.616738 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:59:28.619566 [debug] [ThreadPool]: On create_legal_demo_main: COMMIT
[0m03:59:28.622445 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m03:59:28.624064 [debug] [ThreadPool]: On create_legal_demo_main: COMMIT
[0m03:59:28.627364 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:59:28.630042 [debug] [ThreadPool]: On create_legal_demo_main: Close
[0m03:59:28.642155 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_legal_demo_main, now list_legal_demo_main)
[0m03:59:28.651127 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo_main"
[0m03:59:28.653814 [debug] [ThreadPool]: On list_legal_demo_main: BEGIN
[0m03:59:28.655573 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:59:28.683346 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:59:28.685745 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo_main"
[0m03:59:28.687421 [debug] [ThreadPool]: On list_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo_main"} */
select
      'legal_demo' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'legal_demo'
  
[0m03:59:28.718757 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:59:28.728190 [debug] [ThreadPool]: On list_legal_demo_main: ROLLBACK
[0m03:59:28.731090 [debug] [ThreadPool]: Failed to rollback 'list_legal_demo_main'
[0m03:59:28.733151 [debug] [ThreadPool]: On list_legal_demo_main: Close
[0m03:59:28.741798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c9dccbbd-06bf-4473-be8d-dc32c2e3d5c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74efb8fb41d0>]}
[0m03:59:28.744234 [debug] [MainThread]: Using duckdb connection "master"
[0m03:59:28.746121 [debug] [MainThread]: On master: BEGIN
[0m03:59:28.747595 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:59:28.774570 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m03:59:28.776821 [debug] [MainThread]: On master: COMMIT
[0m03:59:28.779098 [debug] [MainThread]: Using duckdb connection "master"
[0m03:59:28.780898 [debug] [MainThread]: On master: COMMIT
[0m03:59:28.783697 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m03:59:28.785434 [debug] [MainThread]: On master: Close
[0m03:59:28.791863 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:59:28.793992 [info ] [MainThread]: 
[0m03:59:28.809356 [debug] [Thread-1 (]: Began running node model.legal_demo.acris_cases
[0m03:59:28.812339 [info ] [Thread-1 (]: 1 of 1 START sql table model main.acris_clean .................................. [RUN]
[0m03:59:28.815011 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.legal_demo.acris_cases'
[0m03:59:28.817139 [debug] [Thread-1 (]: Began compiling node model.legal_demo.acris_cases
[0m03:59:28.829454 [debug] [Thread-1 (]: Writing injected SQL for node "model.legal_demo.acris_cases"
[0m03:59:28.845929 [debug] [Thread-1 (]: Timing info for model.legal_demo.acris_cases (compile): 03:59:28.818922 => 03:59:28.844912
[0m03:59:28.848090 [debug] [Thread-1 (]: Began executing node model.legal_demo.acris_cases
[0m03:59:28.888955 [debug] [Thread-1 (]: Writing runtime sql for node "model.legal_demo.acris_cases"
[0m03:59:28.904592 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:59:28.906711 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: BEGIN
[0m03:59:28.908589 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m03:59:28.935749 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:59:28.937828 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:59:28.939439 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */

  
    
    

    create  table
      "legal_demo"."main"."acris_clean__dbt_tmp"
  
    as (
      --
-- This model loads the already‑downloaded CSV into DuckDB and
-- materializes it as a table named `acris_clean`.  Because the
-- pipeline does not download data, the file must exist under
-- `data/first_500k_acris.csv` prior to running `dbt run`.  The
-- absolute path points at `/opt/airflow/data/first_500k_acris.csv` when
-- executed inside the Airflow containers.  Locally, dbt resolves
-- relative paths against the project root, so this model continues to
-- work outside of Docker.



SELECT *
FROM read_csv_auto('/opt/airflow/data/first_500k_acris.csv', header=True, delim=',')
    );
  
  
[0m03:59:31.567091 [debug] [Thread-1 (]: SQL status: OK in 3.0 seconds
[0m03:59:31.578166 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:59:31.580676 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
alter table "legal_demo"."main"."acris_clean" rename to "acris_clean__dbt_backup"
[0m03:59:31.583991 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:59:31.590717 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:59:31.592896 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
alter table "legal_demo"."main"."acris_clean__dbt_tmp" rename to "acris_clean"
[0m03:59:31.595676 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:59:31.626258 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: COMMIT
[0m03:59:31.629146 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:59:31.631165 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: COMMIT
[0m03:59:31.704676 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:59:31.714372 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:59:31.716849 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
drop table if exists "legal_demo"."main"."acris_clean__dbt_backup" cascade
[0m03:59:31.726518 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:59:31.730546 [debug] [Thread-1 (]: Timing info for model.legal_demo.acris_cases (execute): 03:59:28.850377 => 03:59:31.730247
[0m03:59:31.732344 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: Close
[0m03:59:31.801025 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c9dccbbd-06bf-4473-be8d-dc32c2e3d5c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74efb8de4050>]}
[0m03:59:31.804206 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main.acris_clean ............................. [[32mOK[0m in 2.99s]
[0m03:59:31.806838 [debug] [Thread-1 (]: Finished running node model.legal_demo.acris_cases
[0m03:59:31.813765 [debug] [MainThread]: Using duckdb connection "master"
[0m03:59:31.815847 [debug] [MainThread]: On master: BEGIN
[0m03:59:31.817471 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:59:31.842369 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m03:59:31.844994 [debug] [MainThread]: On master: COMMIT
[0m03:59:31.847008 [debug] [MainThread]: Using duckdb connection "master"
[0m03:59:31.848893 [debug] [MainThread]: On master: COMMIT
[0m03:59:31.851403 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m03:59:31.853535 [debug] [MainThread]: On master: Close
[0m03:59:31.859759 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:59:31.862021 [debug] [MainThread]: Connection 'list_legal_demo_main' was properly closed.
[0m03:59:31.863602 [debug] [MainThread]: Connection 'model.legal_demo.acris_cases' was properly closed.
[0m03:59:31.865371 [info ] [MainThread]: 
[0m03:59:31.867153 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.39 seconds (3.39s).
[0m03:59:31.869305 [debug] [MainThread]: Command end result
[0m03:59:31.907281 [info ] [MainThread]: 
[0m03:59:31.909687 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:59:31.911723 [info ] [MainThread]: 
[0m03:59:31.913737 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m03:59:31.916851 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.223375, "process_user_time": 7.45019, "process_kernel_time": 1.549607, "process_mem_max_rss": "296336", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m03:59:31.918885 [debug] [MainThread]: Command `dbt run` succeeded at 03:59:31.918602 after 4.23 seconds
[0m03:59:31.920730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74efc2aafc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74efc2c19e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74efc73a9990>]}
[0m03:59:31.922647 [debug] [MainThread]: Flushing usage events
[0m04:00:31.883867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784aeb0d3c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784aeb84c610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784aeb818fd0>]}


============================== 04:00:31.893040 | 2e264681-1033-450c-a948-645567611562 ==============================
[0m04:00:31.893040 [info ] [MainThread]: Running with dbt=1.7.4
[0m04:00:31.895113 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m04:00:32.288099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2e264681-1033-450c-a948-645567611562', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784aeb839690>]}
[0m04:00:32.398467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2e264681-1033-450c-a948-645567611562', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784aeb1d42d0>]}
[0m04:00:32.401101 [info ] [MainThread]: Registered adapter: duckdb=1.7.4
[0m04:00:32.421830 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m04:00:32.509535 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:00:32.511605 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:00:32.519117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2e264681-1033-450c-a948-645567611562', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784ae1ea52d0>]}
[0m04:00:32.567370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2e264681-1033-450c-a948-645567611562', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784aeb839250>]}
[0m04:00:32.569069 [info ] [MainThread]: Found 1 model, 0 sources, 0 exposures, 0 metrics, 394 macros, 0 groups, 0 semantic models
[0m04:00:32.570884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2e264681-1033-450c-a948-645567611562', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784aee9ef8d0>]}
[0m04:00:32.574402 [info ] [MainThread]: 
[0m04:00:32.576946 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m04:00:32.579795 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_legal_demo'
[0m04:00:32.594966 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo"
[0m04:00:32.597020 [debug] [ThreadPool]: On list_legal_demo: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"legal_demo"'
    
  
  
[0m04:00:32.598598 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:00:32.630772 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m04:00:32.634179 [debug] [ThreadPool]: On list_legal_demo: Close
[0m04:00:32.643674 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_legal_demo, now create_legal_demo_main)
[0m04:00:32.646117 [debug] [ThreadPool]: Creating schema "database: "legal_demo"
schema: "main"
"
[0m04:00:32.655276 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m04:00:32.657193 [debug] [ThreadPool]: On create_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "create_legal_demo_main"} */

    
        select type from duckdb_databases()
        where database_name='legal_demo'
        and type='sqlite'
    
  
[0m04:00:32.658939 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:00:32.689581 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m04:00:32.692491 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m04:00:32.694372 [debug] [ThreadPool]: On create_legal_demo_main: BEGIN
[0m04:00:32.696700 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m04:00:32.698268 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m04:00:32.699913 [debug] [ThreadPool]: On create_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "create_legal_demo_main"} */

    
    
        create schema if not exists "legal_demo"."main"
    
[0m04:00:32.702089 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m04:00:32.704031 [debug] [ThreadPool]: On create_legal_demo_main: COMMIT
[0m04:00:32.705670 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m04:00:32.707216 [debug] [ThreadPool]: On create_legal_demo_main: COMMIT
[0m04:00:32.710293 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m04:00:32.711867 [debug] [ThreadPool]: On create_legal_demo_main: Close
[0m04:00:32.722109 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_legal_demo_main, now list_legal_demo_main)
[0m04:00:32.729571 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo_main"
[0m04:00:32.731225 [debug] [ThreadPool]: On list_legal_demo_main: BEGIN
[0m04:00:32.732930 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:00:32.755422 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m04:00:32.756984 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo_main"
[0m04:00:32.758626 [debug] [ThreadPool]: On list_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo_main"} */
select
      'legal_demo' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'legal_demo'
  
[0m04:00:32.784639 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m04:00:32.791550 [debug] [ThreadPool]: On list_legal_demo_main: ROLLBACK
[0m04:00:32.794115 [debug] [ThreadPool]: Failed to rollback 'list_legal_demo_main'
[0m04:00:32.795784 [debug] [ThreadPool]: On list_legal_demo_main: Close
[0m04:00:32.802394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2e264681-1033-450c-a948-645567611562', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784aeb1d42d0>]}
[0m04:00:32.804096 [debug] [MainThread]: Using duckdb connection "master"
[0m04:00:32.805587 [debug] [MainThread]: On master: BEGIN
[0m04:00:32.806856 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:00:32.835165 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m04:00:32.836950 [debug] [MainThread]: On master: COMMIT
[0m04:00:32.838398 [debug] [MainThread]: Using duckdb connection "master"
[0m04:00:32.839804 [debug] [MainThread]: On master: COMMIT
[0m04:00:32.841632 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m04:00:32.843032 [debug] [MainThread]: On master: Close
[0m04:00:32.847899 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:00:32.849873 [info ] [MainThread]: 
[0m04:00:32.863935 [debug] [Thread-1 (]: Began running node model.legal_demo.acris_cases
[0m04:00:32.865965 [info ] [Thread-1 (]: 1 of 1 START sql table model main.acris_clean .................................. [RUN]
[0m04:00:32.868107 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.legal_demo.acris_cases'
[0m04:00:32.869864 [debug] [Thread-1 (]: Began compiling node model.legal_demo.acris_cases
[0m04:00:32.883287 [debug] [Thread-1 (]: Writing injected SQL for node "model.legal_demo.acris_cases"
[0m04:00:32.904236 [debug] [Thread-1 (]: Timing info for model.legal_demo.acris_cases (compile): 04:00:32.871575 => 04:00:32.903714
[0m04:00:32.910057 [debug] [Thread-1 (]: Began executing node model.legal_demo.acris_cases
[0m04:00:32.961945 [debug] [Thread-1 (]: Writing runtime sql for node "model.legal_demo.acris_cases"
[0m04:00:32.973907 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m04:00:32.975624 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: BEGIN
[0m04:00:32.977252 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m04:00:33.001258 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m04:00:33.003271 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m04:00:33.005324 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */

  
    
    

    create  table
      "legal_demo"."main"."acris_clean__dbt_tmp"
  
    as (
      --
-- This model loads the already‑downloaded CSV into DuckDB and
-- materializes it as a table named `acris_clean`.  Because the
-- pipeline does not download data, the file must exist under
-- `data/first_500k_acris.csv` prior to running `dbt run`.  The
-- absolute path points at `/opt/airflow/data/first_500k_acris.csv` when
-- executed inside the Airflow containers.  Locally, dbt resolves
-- relative paths against the project root, so this model continues to
-- work outside of Docker.



SELECT *
FROM read_csv_auto('/opt/airflow/data/first_500k_acris.csv', header=True, delim=',')
    );
  
  
[0m04:00:35.519455 [debug] [Thread-1 (]: SQL status: OK in 3.0 seconds
[0m04:00:35.528749 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m04:00:35.531102 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
alter table "legal_demo"."main"."acris_clean" rename to "acris_clean__dbt_backup"
[0m04:00:35.534118 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m04:00:35.538728 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m04:00:35.540676 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
alter table "legal_demo"."main"."acris_clean__dbt_tmp" rename to "acris_clean"
[0m04:00:35.542742 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m04:00:35.566610 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: COMMIT
[0m04:00:35.569188 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m04:00:35.571283 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: COMMIT
[0m04:00:35.640169 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m04:00:35.647926 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m04:00:35.649774 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
drop table if exists "legal_demo"."main"."acris_clean__dbt_backup" cascade
[0m04:00:35.657792 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m04:00:35.660806 [debug] [Thread-1 (]: Timing info for model.legal_demo.acris_cases (execute): 04:00:32.911735 => 04:00:35.660437
[0m04:00:35.662841 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: Close
[0m04:00:35.733352 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e264681-1033-450c-a948-645567611562', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784ae1fa3a90>]}
[0m04:00:35.736337 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main.acris_clean ............................. [[32mOK[0m in 2.87s]
[0m04:00:35.738671 [debug] [Thread-1 (]: Finished running node model.legal_demo.acris_cases
[0m04:00:35.743110 [debug] [MainThread]: Using duckdb connection "master"
[0m04:00:35.744972 [debug] [MainThread]: On master: BEGIN
[0m04:00:35.746662 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m04:00:35.768701 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m04:00:35.770223 [debug] [MainThread]: On master: COMMIT
[0m04:00:35.771656 [debug] [MainThread]: Using duckdb connection "master"
[0m04:00:35.772994 [debug] [MainThread]: On master: COMMIT
[0m04:00:35.774823 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m04:00:35.776267 [debug] [MainThread]: On master: Close
[0m04:00:35.781442 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:00:35.783198 [debug] [MainThread]: Connection 'list_legal_demo_main' was properly closed.
[0m04:00:35.784562 [debug] [MainThread]: Connection 'model.legal_demo.acris_cases' was properly closed.
[0m04:00:35.785947 [info ] [MainThread]: 
[0m04:00:35.787589 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.21 seconds (3.21s).
[0m04:00:35.789422 [debug] [MainThread]: Command end result
[0m04:00:35.825166 [info ] [MainThread]: 
[0m04:00:35.827393 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:00:35.829454 [info ] [MainThread]: 
[0m04:00:35.831382 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m04:00:35.834199 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.0227923, "process_user_time": 7.471073, "process_kernel_time": 1.348554, "process_mem_max_rss": "299596", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m04:00:35.836441 [debug] [MainThread]: Command `dbt run` succeeded at 04:00:35.836127 after 4.03 seconds
[0m04:00:35.838334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784aeb540590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784aeb4cbc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784aeff46d10>]}
[0m04:00:35.840184 [debug] [MainThread]: Flushing usage events
[0m04:10:37.066439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a20d238d750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a20d1bc57d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a20d238e750>]}


============================== 04:10:37.122916 | 1d6d4906-48c3-4ec4-b9b5-0a2a274a1975 ==============================
[0m04:10:37.122916 [info ] [MainThread]: Running with dbt=1.7.4
[0m04:10:37.125412 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt', 'send_anonymous_usage_stats': 'True'}
[0m04:10:37.653395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1d6d4906-48c3-4ec4-b9b5-0a2a274a1975', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a20c8b5f410>]}
[0m04:10:37.754416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1d6d4906-48c3-4ec4-b9b5-0a2a274a1975', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a20c8a5b010>]}
[0m04:10:37.757228 [info ] [MainThread]: Registered adapter: duckdb=1.7.4
[0m04:10:37.782017 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m04:10:37.874960 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m04:10:37.877200 [debug] [MainThread]: Partial parsing: updated file: legal_demo://models/acris_cases.sql
[0m04:10:38.069068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1d6d4906-48c3-4ec4-b9b5-0a2a274a1975', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a20c895aad0>]}
[0m04:10:38.122971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1d6d4906-48c3-4ec4-b9b5-0a2a274a1975', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a20c88b17d0>]}
[0m04:10:38.125102 [info ] [MainThread]: Found 1 model, 0 sources, 0 exposures, 0 metrics, 394 macros, 0 groups, 0 semantic models
[0m04:10:38.126977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1d6d4906-48c3-4ec4-b9b5-0a2a274a1975', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a20c8802f10>]}
[0m04:10:38.130126 [info ] [MainThread]: 
[0m04:10:38.132570 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m04:10:38.136083 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_legal_demo'
[0m04:10:38.151748 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo"
[0m04:10:38.153739 [debug] [ThreadPool]: On list_legal_demo: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"legal_demo"'
    
  
  
[0m04:10:38.155589 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:10:38.203142 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m04:10:38.206968 [debug] [ThreadPool]: On list_legal_demo: Close
[0m04:10:38.216883 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_legal_demo, now create_legal_demo_main)
[0m04:10:38.219302 [debug] [ThreadPool]: Creating schema "database: "legal_demo"
schema: "main"
"
[0m04:10:38.228021 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m04:10:38.230218 [debug] [ThreadPool]: On create_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "create_legal_demo_main"} */

    
        select type from duckdb_databases()
        where database_name='legal_demo'
        and type='sqlite'
    
  
[0m04:10:38.232061 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:10:38.263341 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m04:10:38.266702 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m04:10:38.268644 [debug] [ThreadPool]: On create_legal_demo_main: BEGIN
[0m04:10:38.270871 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m04:10:38.272527 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m04:10:38.274337 [debug] [ThreadPool]: On create_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "create_legal_demo_main"} */

    
    
        create schema if not exists "legal_demo"."main"
    
[0m04:10:38.277204 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m04:10:38.279493 [debug] [ThreadPool]: On create_legal_demo_main: COMMIT
[0m04:10:38.281587 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m04:10:38.283125 [debug] [ThreadPool]: On create_legal_demo_main: COMMIT
[0m04:10:38.286109 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m04:10:38.287808 [debug] [ThreadPool]: On create_legal_demo_main: Close
[0m04:10:38.299253 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_legal_demo_main, now list_legal_demo_main)
[0m04:10:38.306968 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo_main"
[0m04:10:38.308990 [debug] [ThreadPool]: On list_legal_demo_main: BEGIN
[0m04:10:38.310621 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:10:38.332841 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m04:10:38.334841 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo_main"
[0m04:10:38.336484 [debug] [ThreadPool]: On list_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo_main"} */
select
      'legal_demo' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'legal_demo'
  
[0m04:10:38.367647 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m04:10:38.375924 [debug] [ThreadPool]: On list_legal_demo_main: ROLLBACK
[0m04:10:38.378709 [debug] [ThreadPool]: Failed to rollback 'list_legal_demo_main'
[0m04:10:38.380463 [debug] [ThreadPool]: On list_legal_demo_main: Close
[0m04:10:38.387009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1d6d4906-48c3-4ec4-b9b5-0a2a274a1975', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a20c887d950>]}
[0m04:10:38.388775 [debug] [MainThread]: Using duckdb connection "master"
[0m04:10:38.390205 [debug] [MainThread]: On master: BEGIN
[0m04:10:38.391729 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:10:38.415951 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m04:10:38.417644 [debug] [MainThread]: On master: COMMIT
[0m04:10:38.419126 [debug] [MainThread]: Using duckdb connection "master"
[0m04:10:38.420505 [debug] [MainThread]: On master: COMMIT
[0m04:10:38.422764 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m04:10:38.424518 [debug] [MainThread]: On master: Close
[0m04:10:38.429544 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:10:38.431638 [info ] [MainThread]: 
[0m04:10:38.444817 [debug] [Thread-1 (]: Began running node model.legal_demo.acris_cases
[0m04:10:38.446835 [info ] [Thread-1 (]: 1 of 1 START sql table model main.acris_clean .................................. [RUN]
[0m04:10:38.449130 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.legal_demo.acris_cases'
[0m04:10:38.450708 [debug] [Thread-1 (]: Began compiling node model.legal_demo.acris_cases
[0m04:10:38.461226 [debug] [Thread-1 (]: Writing injected SQL for node "model.legal_demo.acris_cases"
[0m04:10:38.475165 [debug] [Thread-1 (]: Timing info for model.legal_demo.acris_cases (compile): 04:10:38.451986 => 04:10:38.474731
[0m04:10:38.476875 [debug] [Thread-1 (]: Began executing node model.legal_demo.acris_cases
[0m04:10:38.517234 [debug] [Thread-1 (]: Writing runtime sql for node "model.legal_demo.acris_cases"
[0m04:10:38.531068 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m04:10:38.532731 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: BEGIN
[0m04:10:38.534307 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m04:10:38.560754 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m04:10:38.562598 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m04:10:38.564103 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */

  
    
    

    create  table
      "legal_demo"."main"."acris_clean__dbt_tmp"
  
    as (
      

SELECT *
FROM read_csv_auto('/opt/airflow/data/first_500k_acris.csv', header=True, delim=',')
    );
  
  
[0m04:10:41.463055 [debug] [Thread-1 (]: SQL status: OK in 3.0 seconds
[0m04:10:41.471939 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m04:10:41.474154 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
alter table "legal_demo"."main"."acris_clean" rename to "acris_clean__dbt_backup"
[0m04:10:41.477093 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m04:10:41.482045 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m04:10:41.483920 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
alter table "legal_demo"."main"."acris_clean__dbt_tmp" rename to "acris_clean"
[0m04:10:41.486320 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m04:10:41.512800 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: COMMIT
[0m04:10:41.514619 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m04:10:41.516051 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: COMMIT
[0m04:10:41.550152 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m04:10:41.558291 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m04:10:41.560375 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
drop table if exists "legal_demo"."main"."acris_clean__dbt_backup" cascade
[0m04:10:41.569442 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m04:10:41.572651 [debug] [Thread-1 (]: Timing info for model.legal_demo.acris_cases (execute): 04:10:38.478252 => 04:10:41.572390
[0m04:10:41.574824 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: Close
[0m04:10:41.643833 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d6d4906-48c3-4ec4-b9b5-0a2a274a1975', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a20c88534d0>]}
[0m04:10:41.647006 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main.acris_clean ............................. [[32mOK[0m in 3.19s]
[0m04:10:41.649548 [debug] [Thread-1 (]: Finished running node model.legal_demo.acris_cases
[0m04:10:41.654026 [debug] [MainThread]: Using duckdb connection "master"
[0m04:10:41.655879 [debug] [MainThread]: On master: BEGIN
[0m04:10:41.657665 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m04:10:41.682675 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m04:10:41.684287 [debug] [MainThread]: On master: COMMIT
[0m04:10:41.685836 [debug] [MainThread]: Using duckdb connection "master"
[0m04:10:41.687336 [debug] [MainThread]: On master: COMMIT
[0m04:10:41.689249 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m04:10:41.691151 [debug] [MainThread]: On master: Close
[0m04:10:41.697406 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:10:41.699430 [debug] [MainThread]: Connection 'list_legal_demo_main' was properly closed.
[0m04:10:41.700847 [debug] [MainThread]: Connection 'model.legal_demo.acris_cases' was properly closed.
[0m04:10:41.702705 [info ] [MainThread]: 
[0m04:10:41.704593 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.57 seconds (3.57s).
[0m04:10:41.706766 [debug] [MainThread]: Command end result
[0m04:10:41.739273 [info ] [MainThread]: 
[0m04:10:41.741013 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:10:41.742584 [info ] [MainThread]: 
[0m04:10:41.744332 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m04:10:41.746634 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.755123, "process_user_time": 6.425853, "process_kernel_time": 1.685073, "process_mem_max_rss": "302864", "process_in_blocks": "7320", "process_out_blocks": "8384"}
[0m04:10:41.748574 [debug] [MainThread]: Command `dbt run` succeeded at 04:10:41.748312 after 4.76 seconds
[0m04:10:41.750147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a20d239da90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a20d68eb390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a20d1fee410>]}
[0m04:10:41.751784 [debug] [MainThread]: Flushing usage events
[0m03:43:56.162211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781cc3b072d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781cc3b216d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781cc3e01d50>]}


============================== 03:43:56.172098 | e0b3651f-7c97-40f4-8009-d965fa65edec ==============================
[0m03:43:56.172098 [info ] [MainThread]: Running with dbt=1.7.4
[0m03:43:56.174334 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m03:43:56.735600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e0b3651f-7c97-40f4-8009-d965fa65edec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781cc050d950>]}
[0m03:43:56.849502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e0b3651f-7c97-40f4-8009-d965fa65edec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781cc3e0d950>]}
[0m03:43:56.900960 [info ] [MainThread]: Registered adapter: duckdb=1.7.4
[0m03:43:56.928074 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m03:43:57.197515 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:43:57.199958 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:43:57.207561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e0b3651f-7c97-40f4-8009-d965fa65edec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781cba4c0810>]}
[0m03:43:57.316212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e0b3651f-7c97-40f4-8009-d965fa65edec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781cba4513d0>]}
[0m03:43:57.318354 [info ] [MainThread]: Found 1 model, 0 sources, 0 exposures, 0 metrics, 394 macros, 0 groups, 0 semantic models
[0m03:43:57.320353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e0b3651f-7c97-40f4-8009-d965fa65edec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781cc3724ed0>]}
[0m03:43:57.324136 [info ] [MainThread]: 
[0m03:43:57.326914 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m03:43:57.329747 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_legal_demo'
[0m03:43:57.345306 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo"
[0m03:43:57.347587 [debug] [ThreadPool]: On list_legal_demo: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"legal_demo"'
    
  
  
[0m03:43:57.349247 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:43:57.468613 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:43:57.472381 [debug] [ThreadPool]: On list_legal_demo: Close
[0m03:43:57.483476 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_legal_demo, now create_legal_demo_main)
[0m03:43:57.485637 [debug] [ThreadPool]: Creating schema "database: "legal_demo"
schema: "main"
"
[0m03:43:57.494008 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m03:43:57.495823 [debug] [ThreadPool]: On create_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "create_legal_demo_main"} */

    
        select type from duckdb_databases()
        where database_name='legal_demo'
        and type='sqlite'
    
  
[0m03:43:57.497367 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:43:57.571286 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:43:57.574677 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m03:43:57.576709 [debug] [ThreadPool]: On create_legal_demo_main: BEGIN
[0m03:43:57.578470 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:43:57.579818 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m03:43:57.581138 [debug] [ThreadPool]: On create_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "create_legal_demo_main"} */

    
    
        create schema if not exists "legal_demo"."main"
    
[0m03:43:57.583649 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:43:57.585695 [debug] [ThreadPool]: On create_legal_demo_main: COMMIT
[0m03:43:57.587048 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m03:43:57.588358 [debug] [ThreadPool]: On create_legal_demo_main: COMMIT
[0m03:43:57.590742 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:43:57.592151 [debug] [ThreadPool]: On create_legal_demo_main: Close
[0m03:43:57.601558 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_legal_demo_main, now list_legal_demo_main)
[0m03:43:57.609269 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo_main"
[0m03:43:57.611402 [debug] [ThreadPool]: On list_legal_demo_main: BEGIN
[0m03:43:57.612995 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:43:57.632667 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:43:57.634401 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo_main"
[0m03:43:57.635935 [debug] [ThreadPool]: On list_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo_main"} */
select
      'legal_demo' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'legal_demo'
  
[0m03:43:57.723863 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:43:57.735599 [debug] [ThreadPool]: On list_legal_demo_main: ROLLBACK
[0m03:43:57.739247 [debug] [ThreadPool]: Failed to rollback 'list_legal_demo_main'
[0m03:43:57.741260 [debug] [ThreadPool]: On list_legal_demo_main: Close
[0m03:43:57.749592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e0b3651f-7c97-40f4-8009-d965fa65edec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781cc3df00d0>]}
[0m03:43:57.751993 [debug] [MainThread]: Using duckdb connection "master"
[0m03:43:57.753641 [debug] [MainThread]: On master: BEGIN
[0m03:43:57.755117 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:43:57.781421 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m03:43:57.783612 [debug] [MainThread]: On master: COMMIT
[0m03:43:57.785258 [debug] [MainThread]: Using duckdb connection "master"
[0m03:43:57.786859 [debug] [MainThread]: On master: COMMIT
[0m03:43:57.788978 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m03:43:57.790433 [debug] [MainThread]: On master: Close
[0m03:43:57.795363 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:43:57.797114 [info ] [MainThread]: 
[0m03:43:57.810139 [debug] [Thread-1 (]: Began running node model.legal_demo.acris_cases
[0m03:43:57.812772 [info ] [Thread-1 (]: 1 of 1 START sql table model main.acris_clean .................................. [RUN]
[0m03:43:57.815124 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.legal_demo.acris_cases'
[0m03:43:57.816666 [debug] [Thread-1 (]: Began compiling node model.legal_demo.acris_cases
[0m03:43:57.826266 [debug] [Thread-1 (]: Writing injected SQL for node "model.legal_demo.acris_cases"
[0m03:43:57.896136 [debug] [Thread-1 (]: Timing info for model.legal_demo.acris_cases (compile): 03:43:57.818285 => 03:43:57.895643
[0m03:43:57.898051 [debug] [Thread-1 (]: Began executing node model.legal_demo.acris_cases
[0m03:43:57.940381 [debug] [Thread-1 (]: Writing runtime sql for node "model.legal_demo.acris_cases"
[0m03:43:57.971369 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:43:57.973003 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: BEGIN
[0m03:43:57.974523 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m03:43:58.000545 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:43:58.002494 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:43:58.004048 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */

  
    
    

    create  table
      "legal_demo"."main"."acris_clean__dbt_tmp"
  
    as (
      

SELECT *
FROM read_csv_auto('/opt/airflow/data/first_500k_acris.csv', header=True, delim=',')
    );
  
  
[0m03:44:00.711905 [debug] [Thread-1 (]: SQL status: OK in 3.0 seconds
[0m03:44:00.722171 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:44:00.724182 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
alter table "legal_demo"."main"."acris_clean" rename to "acris_clean__dbt_backup"
[0m03:44:00.727166 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:44:00.732572 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:44:00.734430 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
alter table "legal_demo"."main"."acris_clean__dbt_tmp" rename to "acris_clean"
[0m03:44:00.737105 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:44:00.766267 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: COMMIT
[0m03:44:00.768888 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:44:00.772038 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: COMMIT
[0m03:44:00.826215 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:44:00.834873 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:44:00.836937 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
drop table if exists "legal_demo"."main"."acris_clean__dbt_backup" cascade
[0m03:44:00.845433 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:44:00.848923 [debug] [Thread-1 (]: Timing info for model.legal_demo.acris_cases (execute): 03:43:57.899388 => 03:44:00.848623
[0m03:44:00.851381 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: Close
[0m03:44:00.917086 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0b3651f-7c97-40f4-8009-d965fa65edec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781cba5b0690>]}
[0m03:44:00.920258 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main.acris_clean ............................. [[32mOK[0m in 3.10s]
[0m03:44:00.922809 [debug] [Thread-1 (]: Finished running node model.legal_demo.acris_cases
[0m03:44:00.927823 [debug] [MainThread]: Using duckdb connection "master"
[0m03:44:00.929784 [debug] [MainThread]: On master: BEGIN
[0m03:44:00.931394 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:44:00.953956 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m03:44:00.955912 [debug] [MainThread]: On master: COMMIT
[0m03:44:00.957584 [debug] [MainThread]: Using duckdb connection "master"
[0m03:44:00.959018 [debug] [MainThread]: On master: COMMIT
[0m03:44:00.960559 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m03:44:00.962079 [debug] [MainThread]: On master: Close
[0m03:44:00.967027 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:44:00.968709 [debug] [MainThread]: Connection 'list_legal_demo_main' was properly closed.
[0m03:44:00.970180 [debug] [MainThread]: Connection 'model.legal_demo.acris_cases' was properly closed.
[0m03:44:00.971709 [info ] [MainThread]: 
[0m03:44:00.973563 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.65 seconds (3.65s).
[0m03:44:00.975560 [debug] [MainThread]: Command end result
[0m03:44:01.075814 [info ] [MainThread]: 
[0m03:44:01.077912 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:44:01.079853 [info ] [MainThread]: 
[0m03:44:01.081493 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m03:44:01.084090 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.1444716, "process_user_time": 7.58816, "process_kernel_time": 1.611431, "process_mem_max_rss": "298112", "process_in_blocks": "50576", "process_out_blocks": "0"}
[0m03:44:01.086232 [debug] [MainThread]: Command `dbt run` succeeded at 03:44:01.086031 after 5.15 seconds
[0m03:44:01.088275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781cc36c9c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781cc3e40190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781cc85254d0>]}
[0m03:44:01.090462 [debug] [MainThread]: Flushing usage events
[0m03:52:56.140256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70726ce79850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70726d110090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70726d14a150>]}


============================== 03:52:56.149972 | 3a9088f8-c095-4b3f-b9ef-9bd7743dd772 ==============================
[0m03:52:56.149972 [info ] [MainThread]: Running with dbt=1.7.4
[0m03:52:56.151975 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m03:52:56.549443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3a9088f8-c095-4b3f-b9ef-9bd7743dd772', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70726cb83510>]}
[0m03:52:56.707176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3a9088f8-c095-4b3f-b9ef-9bd7743dd772', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70726cc0f310>]}
[0m03:52:56.710314 [info ] [MainThread]: Registered adapter: duckdb=1.7.4
[0m03:52:56.733705 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m03:52:56.832623 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:52:56.834950 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:52:56.843047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3a9088f8-c095-4b3f-b9ef-9bd7743dd772', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70726cf99e50>]}
[0m03:52:56.891404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3a9088f8-c095-4b3f-b9ef-9bd7743dd772', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707263861750>]}
[0m03:52:56.893498 [info ] [MainThread]: Found 1 model, 0 sources, 0 exposures, 0 metrics, 394 macros, 0 groups, 0 semantic models
[0m03:52:56.895340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3a9088f8-c095-4b3f-b9ef-9bd7743dd772', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70726cf8a5d0>]}
[0m03:52:56.899051 [info ] [MainThread]: 
[0m03:52:56.901904 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m03:52:56.904998 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_legal_demo'
[0m03:52:56.925288 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo"
[0m03:52:56.927943 [debug] [ThreadPool]: On list_legal_demo: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"legal_demo"'
    
  
  
[0m03:52:56.929740 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:52:56.967641 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:52:56.972631 [debug] [ThreadPool]: On list_legal_demo: Close
[0m03:52:56.982317 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_legal_demo, now create_legal_demo_main)
[0m03:52:56.984560 [debug] [ThreadPool]: Creating schema "database: "legal_demo"
schema: "main"
"
[0m03:52:56.994302 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m03:52:56.997122 [debug] [ThreadPool]: On create_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "create_legal_demo_main"} */

    
        select type from duckdb_databases()
        where database_name='legal_demo'
        and type='sqlite'
    
  
[0m03:52:56.999132 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:52:57.025058 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:52:57.027795 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m03:52:57.029956 [debug] [ThreadPool]: On create_legal_demo_main: BEGIN
[0m03:52:57.032676 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:52:57.034515 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m03:52:57.035984 [debug] [ThreadPool]: On create_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "create_legal_demo_main"} */

    
    
        create schema if not exists "legal_demo"."main"
    
[0m03:52:57.038322 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:52:57.040476 [debug] [ThreadPool]: On create_legal_demo_main: COMMIT
[0m03:52:57.041954 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m03:52:57.043391 [debug] [ThreadPool]: On create_legal_demo_main: COMMIT
[0m03:52:57.046401 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:52:57.048432 [debug] [ThreadPool]: On create_legal_demo_main: Close
[0m03:52:57.058995 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_legal_demo_main, now list_legal_demo_main)
[0m03:52:57.068455 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo_main"
[0m03:52:57.070580 [debug] [ThreadPool]: On list_legal_demo_main: BEGIN
[0m03:52:57.072456 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:52:57.092898 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:52:57.095113 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo_main"
[0m03:52:57.096597 [debug] [ThreadPool]: On list_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo_main"} */
select
      'legal_demo' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'legal_demo'
  
[0m03:52:57.128005 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:52:57.138359 [debug] [ThreadPool]: On list_legal_demo_main: ROLLBACK
[0m03:52:57.140523 [debug] [ThreadPool]: Failed to rollback 'list_legal_demo_main'
[0m03:52:57.141808 [debug] [ThreadPool]: On list_legal_demo_main: Close
[0m03:52:57.148832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3a9088f8-c095-4b3f-b9ef-9bd7743dd772', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70726cb97b90>]}
[0m03:52:57.150954 [debug] [MainThread]: Using duckdb connection "master"
[0m03:52:57.152442 [debug] [MainThread]: On master: BEGIN
[0m03:52:57.153867 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:52:57.178962 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m03:52:57.181408 [debug] [MainThread]: On master: COMMIT
[0m03:52:57.183918 [debug] [MainThread]: Using duckdb connection "master"
[0m03:52:57.185638 [debug] [MainThread]: On master: COMMIT
[0m03:52:57.188635 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m03:52:57.190453 [debug] [MainThread]: On master: Close
[0m03:52:57.199367 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:52:57.201603 [info ] [MainThread]: 
[0m03:52:57.217357 [debug] [Thread-1 (]: Began running node model.legal_demo.acris_cases
[0m03:52:57.219820 [info ] [Thread-1 (]: 1 of 1 START sql table model main.acris_clean .................................. [RUN]
[0m03:52:57.222530 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.legal_demo.acris_cases'
[0m03:52:57.224366 [debug] [Thread-1 (]: Began compiling node model.legal_demo.acris_cases
[0m03:52:57.235087 [debug] [Thread-1 (]: Writing injected SQL for node "model.legal_demo.acris_cases"
[0m03:52:57.249435 [debug] [Thread-1 (]: Timing info for model.legal_demo.acris_cases (compile): 03:52:57.225698 => 03:52:57.248728
[0m03:52:57.251448 [debug] [Thread-1 (]: Began executing node model.legal_demo.acris_cases
[0m03:52:57.293878 [debug] [Thread-1 (]: Writing runtime sql for node "model.legal_demo.acris_cases"
[0m03:52:57.307769 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:52:57.309582 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: BEGIN
[0m03:52:57.311081 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m03:52:57.335426 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:52:57.337271 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:52:57.338801 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */

  
    
    

    create  table
      "legal_demo"."main"."acris_clean__dbt_tmp"
  
    as (
      

SELECT *
FROM read_csv_auto('/opt/airflow/data/first_500k_acris.csv', header=True, delim=',')
    );
  
  
[0m03:53:00.102001 [debug] [Thread-1 (]: SQL status: OK in 3.0 seconds
[0m03:53:00.111437 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:53:00.113574 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
alter table "legal_demo"."main"."acris_clean" rename to "acris_clean__dbt_backup"
[0m03:53:00.115976 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:53:00.121005 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:53:00.123462 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
alter table "legal_demo"."main"."acris_clean__dbt_tmp" rename to "acris_clean"
[0m03:53:00.126009 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:53:00.148378 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: COMMIT
[0m03:53:00.150670 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:53:00.152553 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: COMMIT
[0m03:53:00.227762 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:53:00.236402 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:53:00.238473 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
drop table if exists "legal_demo"."main"."acris_clean__dbt_backup" cascade
[0m03:53:00.246416 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:53:00.249811 [debug] [Thread-1 (]: Timing info for model.legal_demo.acris_cases (execute): 03:52:57.252896 => 03:53:00.249477
[0m03:53:00.251747 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: Close
[0m03:53:00.313251 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3a9088f8-c095-4b3f-b9ef-9bd7743dd772', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7072637d0b90>]}
[0m03:53:00.315997 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main.acris_clean ............................. [[32mOK[0m in 3.09s]
[0m03:53:00.318046 [debug] [Thread-1 (]: Finished running node model.legal_demo.acris_cases
[0m03:53:00.321724 [debug] [MainThread]: Using duckdb connection "master"
[0m03:53:00.323094 [debug] [MainThread]: On master: BEGIN
[0m03:53:00.324438 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:53:00.345494 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m03:53:00.347221 [debug] [MainThread]: On master: COMMIT
[0m03:53:00.348701 [debug] [MainThread]: Using duckdb connection "master"
[0m03:53:00.350225 [debug] [MainThread]: On master: COMMIT
[0m03:53:00.352075 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m03:53:00.353460 [debug] [MainThread]: On master: Close
[0m03:53:00.358268 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:53:00.359919 [debug] [MainThread]: Connection 'list_legal_demo_main' was properly closed.
[0m03:53:00.361469 [debug] [MainThread]: Connection 'model.legal_demo.acris_cases' was properly closed.
[0m03:53:00.362998 [info ] [MainThread]: 
[0m03:53:00.364483 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.46 seconds (3.46s).
[0m03:53:00.366466 [debug] [MainThread]: Command end result
[0m03:53:00.400226 [info ] [MainThread]: 
[0m03:53:00.402209 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:53:00.403934 [info ] [MainThread]: 
[0m03:53:00.405689 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m03:53:00.408156 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.332629, "process_user_time": 6.007731, "process_kernel_time": 1.170389, "process_mem_max_rss": "284248", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m03:53:00.409960 [debug] [MainThread]: Command `dbt run` succeeded at 03:53:00.409764 after 4.33 seconds
[0m03:53:00.411500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7072717874d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7072718b81d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70726cf632d0>]}
[0m03:53:00.413050 [debug] [MainThread]: Flushing usage events
[0m04:09:50.216171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77982af73590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77982af73690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77982b6b45d0>]}


============================== 04:09:50.225302 | 5ad78ce9-6325-40ab-9770-0e7cd758d1c7 ==============================
[0m04:09:50.225302 [info ] [MainThread]: Running with dbt=1.7.4
[0m04:09:50.227517 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m04:09:50.603501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5ad78ce9-6325-40ab-9770-0e7cd758d1c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77982b3b3950>]}
[0m04:09:50.704682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5ad78ce9-6325-40ab-9770-0e7cd758d1c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77982b393050>]}
[0m04:09:50.707506 [info ] [MainThread]: Registered adapter: duckdb=1.7.4
[0m04:09:50.728577 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m04:09:50.814267 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:09:50.816430 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:09:50.825744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5ad78ce9-6325-40ab-9770-0e7cd758d1c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x779821dc80d0>]}
[0m04:09:50.887562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5ad78ce9-6325-40ab-9770-0e7cd758d1c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x779821f9d710>]}
[0m04:09:50.889227 [info ] [MainThread]: Found 1 model, 0 sources, 0 exposures, 0 metrics, 394 macros, 0 groups, 0 semantic models
[0m04:09:50.891202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5ad78ce9-6325-40ab-9770-0e7cd758d1c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x779821fd2e90>]}
[0m04:09:50.895672 [info ] [MainThread]: 
[0m04:09:50.898158 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m04:09:50.901839 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_legal_demo'
[0m04:09:50.918972 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo"
[0m04:09:50.921234 [debug] [ThreadPool]: On list_legal_demo: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"legal_demo"'
    
  
  
[0m04:09:50.923176 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:09:50.956212 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m04:09:50.959738 [debug] [ThreadPool]: On list_legal_demo: Close
[0m04:09:50.969175 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_legal_demo, now create_legal_demo_main)
[0m04:09:50.971745 [debug] [ThreadPool]: Creating schema "database: "legal_demo"
schema: "main"
"
[0m04:09:50.980688 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m04:09:50.982819 [debug] [ThreadPool]: On create_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "create_legal_demo_main"} */

    
        select type from duckdb_databases()
        where database_name='legal_demo'
        and type='sqlite'
    
  
[0m04:09:50.984517 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:09:51.011369 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m04:09:51.014129 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m04:09:51.015818 [debug] [ThreadPool]: On create_legal_demo_main: BEGIN
[0m04:09:51.017586 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m04:09:51.019187 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m04:09:51.020573 [debug] [ThreadPool]: On create_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "create_legal_demo_main"} */

    
    
        create schema if not exists "legal_demo"."main"
    
[0m04:09:51.022729 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m04:09:51.024854 [debug] [ThreadPool]: On create_legal_demo_main: COMMIT
[0m04:09:51.026295 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m04:09:51.028160 [debug] [ThreadPool]: On create_legal_demo_main: COMMIT
[0m04:09:51.030526 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m04:09:51.032029 [debug] [ThreadPool]: On create_legal_demo_main: Close
[0m04:09:51.041818 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_legal_demo_main, now list_legal_demo_main)
[0m04:09:51.049275 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo_main"
[0m04:09:51.051154 [debug] [ThreadPool]: On list_legal_demo_main: BEGIN
[0m04:09:51.052725 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:09:51.128402 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m04:09:51.130439 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo_main"
[0m04:09:51.132045 [debug] [ThreadPool]: On list_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo_main"} */
select
      'legal_demo' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'legal_demo'
  
[0m04:09:51.162934 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m04:09:51.171638 [debug] [ThreadPool]: On list_legal_demo_main: ROLLBACK
[0m04:09:51.174279 [debug] [ThreadPool]: Failed to rollback 'list_legal_demo_main'
[0m04:09:51.176299 [debug] [ThreadPool]: On list_legal_demo_main: Close
[0m04:09:51.183469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5ad78ce9-6325-40ab-9770-0e7cd758d1c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77982b316390>]}
[0m04:09:51.185349 [debug] [MainThread]: Using duckdb connection "master"
[0m04:09:51.187858 [debug] [MainThread]: On master: BEGIN
[0m04:09:51.189369 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:09:51.210934 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m04:09:51.212646 [debug] [MainThread]: On master: COMMIT
[0m04:09:51.213955 [debug] [MainThread]: Using duckdb connection "master"
[0m04:09:51.215427 [debug] [MainThread]: On master: COMMIT
[0m04:09:51.217363 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m04:09:51.218878 [debug] [MainThread]: On master: Close
[0m04:09:51.223679 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:09:51.225341 [info ] [MainThread]: 
[0m04:09:51.237454 [debug] [Thread-1 (]: Began running node model.legal_demo.acris_cases
[0m04:09:51.239884 [info ] [Thread-1 (]: 1 of 1 START sql table model main.acris_clean .................................. [RUN]
[0m04:09:51.242059 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.legal_demo.acris_cases'
[0m04:09:51.243684 [debug] [Thread-1 (]: Began compiling node model.legal_demo.acris_cases
[0m04:09:51.252596 [debug] [Thread-1 (]: Writing injected SQL for node "model.legal_demo.acris_cases"
[0m04:09:51.266897 [debug] [Thread-1 (]: Timing info for model.legal_demo.acris_cases (compile): 04:09:51.244909 => 04:09:51.266253
[0m04:09:51.268764 [debug] [Thread-1 (]: Began executing node model.legal_demo.acris_cases
[0m04:09:51.308446 [debug] [Thread-1 (]: Writing runtime sql for node "model.legal_demo.acris_cases"
[0m04:09:51.321117 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m04:09:51.322732 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: BEGIN
[0m04:09:51.324079 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m04:09:51.348366 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m04:09:51.350432 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m04:09:51.352009 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */

  
    
    

    create  table
      "legal_demo"."main"."acris_clean__dbt_tmp"
  
    as (
      

SELECT *
FROM read_csv_auto('/opt/airflow/data/first_500k_acris.csv', header=True, delim=',')
    );
  
  
[0m04:09:53.751382 [debug] [Thread-1 (]: SQL status: OK in 2.0 seconds
[0m04:09:53.761242 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m04:09:53.763801 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
alter table "legal_demo"."main"."acris_clean" rename to "acris_clean__dbt_backup"
[0m04:09:53.767646 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m04:09:53.773015 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m04:09:53.776117 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
alter table "legal_demo"."main"."acris_clean__dbt_tmp" rename to "acris_clean"
[0m04:09:53.778644 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m04:09:53.803703 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: COMMIT
[0m04:09:53.805732 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m04:09:53.807441 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: COMMIT
[0m04:09:53.869867 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m04:09:53.877571 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m04:09:53.879794 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
drop table if exists "legal_demo"."main"."acris_clean__dbt_backup" cascade
[0m04:09:53.887238 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m04:09:53.890697 [debug] [Thread-1 (]: Timing info for model.legal_demo.acris_cases (execute): 04:09:51.270110 => 04:09:53.890400
[0m04:09:53.892434 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: Close
[0m04:09:53.960316 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5ad78ce9-6325-40ab-9770-0e7cd758d1c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x779821afc510>]}
[0m04:09:53.963017 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main.acris_clean ............................. [[32mOK[0m in 2.72s]
[0m04:09:53.964907 [debug] [Thread-1 (]: Finished running node model.legal_demo.acris_cases
[0m04:09:53.968891 [debug] [MainThread]: Using duckdb connection "master"
[0m04:09:53.970428 [debug] [MainThread]: On master: BEGIN
[0m04:09:53.972120 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m04:09:53.992328 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m04:09:53.993786 [debug] [MainThread]: On master: COMMIT
[0m04:09:53.995073 [debug] [MainThread]: Using duckdb connection "master"
[0m04:09:53.996260 [debug] [MainThread]: On master: COMMIT
[0m04:09:53.997879 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m04:09:53.999063 [debug] [MainThread]: On master: Close
[0m04:09:54.003488 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:09:54.004918 [debug] [MainThread]: Connection 'list_legal_demo_main' was properly closed.
[0m04:09:54.006121 [debug] [MainThread]: Connection 'model.legal_demo.acris_cases' was properly closed.
[0m04:09:54.007498 [info ] [MainThread]: 
[0m04:09:54.009031 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.11 seconds (3.11s).
[0m04:09:54.010893 [debug] [MainThread]: Command end result
[0m04:09:54.044296 [info ] [MainThread]: 
[0m04:09:54.046261 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:09:54.047958 [info ] [MainThread]: 
[0m04:09:54.049654 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m04:09:54.052488 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.9091399, "process_user_time": 7.463838, "process_kernel_time": 1.34719, "process_mem_max_rss": "299372", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m04:09:54.054903 [debug] [MainThread]: Command `dbt run` succeeded at 04:09:54.054688 after 3.91 seconds
[0m04:09:54.056350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77982fd05850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77982fe4f190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77982b25c6d0>]}
[0m04:09:54.058254 [debug] [MainThread]: Flushing usage events
[0m05:01:31.231701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7acec3583610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7acec3d61150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7acec359e790>]}


============================== 05:01:31.288808 | 49e0a9ca-be22-4dd8-a49c-ce04bfb08e01 ==============================
[0m05:01:31.288808 [info ] [MainThread]: Running with dbt=1.7.4
[0m05:01:31.291592 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt', 'send_anonymous_usage_stats': 'True'}
[0m05:01:31.682909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '49e0a9ca-be22-4dd8-a49c-ce04bfb08e01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7acec329fe10>]}
[0m05:01:31.805589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '49e0a9ca-be22-4dd8-a49c-ce04bfb08e01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7acec35d8c10>]}
[0m05:01:31.808423 [info ] [MainThread]: Registered adapter: duckdb=1.7.4
[0m05:01:31.836746 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m05:01:31.976791 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:01:31.979064 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:01:31.986743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '49e0a9ca-be22-4dd8-a49c-ce04bfb08e01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aceb9fe8ed0>]}
[0m05:01:32.033422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '49e0a9ca-be22-4dd8-a49c-ce04bfb08e01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7acec3d60e90>]}
[0m05:01:32.036074 [info ] [MainThread]: Found 1 model, 0 sources, 0 exposures, 0 metrics, 394 macros, 0 groups, 0 semantic models
[0m05:01:32.037732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '49e0a9ca-be22-4dd8-a49c-ce04bfb08e01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aceba03f8d0>]}
[0m05:01:32.041455 [info ] [MainThread]: 
[0m05:01:32.043774 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m05:01:32.046550 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_legal_demo'
[0m05:01:32.062998 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo"
[0m05:01:32.065409 [debug] [ThreadPool]: On list_legal_demo: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"legal_demo"'
    
  
  
[0m05:01:32.067212 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:01:32.129329 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m05:01:32.134033 [debug] [ThreadPool]: On list_legal_demo: Close
[0m05:01:32.143739 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_legal_demo, now create_legal_demo_main)
[0m05:01:32.146570 [debug] [ThreadPool]: Creating schema "database: "legal_demo"
schema: "main"
"
[0m05:01:32.155603 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m05:01:32.157967 [debug] [ThreadPool]: On create_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "create_legal_demo_main"} */

    
        select type from duckdb_databases()
        where database_name='legal_demo'
        and type='sqlite'
    
  
[0m05:01:32.159757 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:01:32.189467 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m05:01:32.192368 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m05:01:32.194358 [debug] [ThreadPool]: On create_legal_demo_main: BEGIN
[0m05:01:32.196888 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m05:01:32.198970 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m05:01:32.200727 [debug] [ThreadPool]: On create_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "create_legal_demo_main"} */

    
    
        create schema if not exists "legal_demo"."main"
    
[0m05:01:32.203975 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m05:01:32.206597 [debug] [ThreadPool]: On create_legal_demo_main: COMMIT
[0m05:01:32.208592 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m05:01:32.210161 [debug] [ThreadPool]: On create_legal_demo_main: COMMIT
[0m05:01:32.214064 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m05:01:32.215996 [debug] [ThreadPool]: On create_legal_demo_main: Close
[0m05:01:32.226730 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_legal_demo_main, now list_legal_demo_main)
[0m05:01:32.234603 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo_main"
[0m05:01:32.236705 [debug] [ThreadPool]: On list_legal_demo_main: BEGIN
[0m05:01:32.238425 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:01:32.263662 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m05:01:32.265715 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo_main"
[0m05:01:32.267410 [debug] [ThreadPool]: On list_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo_main"} */
select
      'legal_demo' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'legal_demo'
  
[0m05:01:32.302647 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m05:01:32.311290 [debug] [ThreadPool]: On list_legal_demo_main: ROLLBACK
[0m05:01:32.314100 [debug] [ThreadPool]: Failed to rollback 'list_legal_demo_main'
[0m05:01:32.316120 [debug] [ThreadPool]: On list_legal_demo_main: Close
[0m05:01:32.325225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '49e0a9ca-be22-4dd8-a49c-ce04bfb08e01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7acec4070ed0>]}
[0m05:01:32.327215 [debug] [MainThread]: Using duckdb connection "master"
[0m05:01:32.328924 [debug] [MainThread]: On master: BEGIN
[0m05:01:32.330547 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:01:32.353221 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m05:01:32.355202 [debug] [MainThread]: On master: COMMIT
[0m05:01:32.356792 [debug] [MainThread]: Using duckdb connection "master"
[0m05:01:32.358614 [debug] [MainThread]: On master: COMMIT
[0m05:01:32.360658 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m05:01:32.362378 [debug] [MainThread]: On master: Close
[0m05:01:32.367262 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m05:01:32.369244 [info ] [MainThread]: 
[0m05:01:32.381893 [debug] [Thread-1 (]: Began running node model.legal_demo.acris_cases
[0m05:01:32.383914 [info ] [Thread-1 (]: 1 of 1 START sql table model main.acris_clean .................................. [RUN]
[0m05:01:32.386456 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.legal_demo.acris_cases'
[0m05:01:32.388120 [debug] [Thread-1 (]: Began compiling node model.legal_demo.acris_cases
[0m05:01:32.397209 [debug] [Thread-1 (]: Writing injected SQL for node "model.legal_demo.acris_cases"
[0m05:01:32.410816 [debug] [Thread-1 (]: Timing info for model.legal_demo.acris_cases (compile): 05:01:32.389425 => 05:01:32.410421
[0m05:01:32.412820 [debug] [Thread-1 (]: Began executing node model.legal_demo.acris_cases
[0m05:01:32.453390 [debug] [Thread-1 (]: Writing runtime sql for node "model.legal_demo.acris_cases"
[0m05:01:32.467237 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m05:01:32.469185 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: BEGIN
[0m05:01:32.470613 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m05:01:32.495983 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m05:01:32.497770 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m05:01:32.499358 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */

  
    
    

    create  table
      "legal_demo"."main"."acris_clean__dbt_tmp"
  
    as (
      

SELECT *
FROM read_csv_auto('/opt/airflow/data/first_500k_acris.csv', header=True, delim=',')
    );
  
  
[0m05:01:35.420480 [debug] [Thread-1 (]: SQL status: OK in 3.0 seconds
[0m05:01:35.430587 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m05:01:35.432989 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
alter table "legal_demo"."main"."acris_clean" rename to "acris_clean__dbt_backup"
[0m05:01:35.436733 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m05:01:35.444503 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m05:01:35.447096 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
alter table "legal_demo"."main"."acris_clean__dbt_tmp" rename to "acris_clean"
[0m05:01:35.451012 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m05:01:35.477674 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: COMMIT
[0m05:01:35.480163 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m05:01:35.481994 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: COMMIT
[0m05:01:35.512691 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m05:01:35.521754 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m05:01:35.524106 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
drop table if exists "legal_demo"."main"."acris_clean__dbt_backup" cascade
[0m05:01:35.533698 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m05:01:35.537461 [debug] [Thread-1 (]: Timing info for model.legal_demo.acris_cases (execute): 05:01:32.414150 => 05:01:35.537010
[0m05:01:35.539360 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: Close
[0m05:01:35.604243 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49e0a9ca-be22-4dd8-a49c-ce04bfb08e01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aceb9e8d390>]}
[0m05:01:35.607097 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main.acris_clean ............................. [[32mOK[0m in 3.22s]
[0m05:01:35.609050 [debug] [Thread-1 (]: Finished running node model.legal_demo.acris_cases
[0m05:01:35.614104 [debug] [MainThread]: Using duckdb connection "master"
[0m05:01:35.615520 [debug] [MainThread]: On master: BEGIN
[0m05:01:35.617068 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:01:35.639127 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m05:01:35.641206 [debug] [MainThread]: On master: COMMIT
[0m05:01:35.642768 [debug] [MainThread]: Using duckdb connection "master"
[0m05:01:35.644431 [debug] [MainThread]: On master: COMMIT
[0m05:01:35.646375 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m05:01:35.647826 [debug] [MainThread]: On master: Close
[0m05:01:35.653026 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:01:35.655251 [debug] [MainThread]: Connection 'list_legal_demo_main' was properly closed.
[0m05:01:35.656820 [debug] [MainThread]: Connection 'model.legal_demo.acris_cases' was properly closed.
[0m05:01:35.658537 [info ] [MainThread]: 
[0m05:01:35.660153 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.62 seconds (3.62s).
[0m05:01:35.661922 [debug] [MainThread]: Command end result
[0m05:01:35.696184 [info ] [MainThread]: 
[0m05:01:35.699144 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:01:35.701789 [info ] [MainThread]: 
[0m05:01:35.703548 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m05:01:35.705906 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.546729, "process_user_time": 7.708171, "process_kernel_time": 1.584145, "process_mem_max_rss": "297536", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m05:01:35.707805 [debug] [MainThread]: Command `dbt run` succeeded at 05:01:35.707480 after 4.55 seconds
[0m05:01:35.709409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7acec3533390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7acec322fdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7acec8112c50>]}
[0m05:01:35.710846 [debug] [MainThread]: Flushing usage events
[0m05:54:13.632760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a5398c61850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a5398c9d5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a539882c4d0>]}


============================== 05:54:13.643210 | 2a227933-b418-46a0-a2ed-f72c0f379193 ==============================
[0m05:54:13.643210 [info ] [MainThread]: Running with dbt=1.7.4
[0m05:54:13.645153 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m05:54:14.042051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2a227933-b418-46a0-a2ed-f72c0f379193', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a5398f7fbd0>]}
[0m05:54:14.154850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2a227933-b418-46a0-a2ed-f72c0f379193', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a5399677310>]}
[0m05:54:14.157492 [info ] [MainThread]: Registered adapter: duckdb=1.7.4
[0m05:54:14.182368 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m05:54:14.267969 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:54:14.270457 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:54:14.278438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2a227933-b418-46a0-a2ed-f72c0f379193', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a538f5818d0>]}
[0m05:54:14.322715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2a227933-b418-46a0-a2ed-f72c0f379193', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a538f6a5dd0>]}
[0m05:54:14.324627 [info ] [MainThread]: Found 1 model, 0 sources, 0 exposures, 0 metrics, 394 macros, 0 groups, 0 semantic models
[0m05:54:14.326303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2a227933-b418-46a0-a2ed-f72c0f379193', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a5398879190>]}
[0m05:54:14.329811 [info ] [MainThread]: 
[0m05:54:14.332285 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m05:54:14.335303 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_legal_demo'
[0m05:54:14.351815 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo"
[0m05:54:14.354136 [debug] [ThreadPool]: On list_legal_demo: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"legal_demo"'
    
  
  
[0m05:54:14.356270 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:54:14.393477 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m05:54:14.397160 [debug] [ThreadPool]: On list_legal_demo: Close
[0m05:54:14.406198 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_legal_demo, now create_legal_demo_main)
[0m05:54:14.408174 [debug] [ThreadPool]: Creating schema "database: "legal_demo"
schema: "main"
"
[0m05:54:14.416821 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m05:54:14.418968 [debug] [ThreadPool]: On create_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "create_legal_demo_main"} */

    
        select type from duckdb_databases()
        where database_name='legal_demo'
        and type='sqlite'
    
  
[0m05:54:14.420762 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:54:14.446902 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m05:54:14.449675 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m05:54:14.451432 [debug] [ThreadPool]: On create_legal_demo_main: BEGIN
[0m05:54:14.453360 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m05:54:14.455415 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m05:54:14.456818 [debug] [ThreadPool]: On create_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "create_legal_demo_main"} */

    
    
        create schema if not exists "legal_demo"."main"
    
[0m05:54:14.459096 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m05:54:14.461426 [debug] [ThreadPool]: On create_legal_demo_main: COMMIT
[0m05:54:14.462832 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m05:54:14.464157 [debug] [ThreadPool]: On create_legal_demo_main: COMMIT
[0m05:54:14.466589 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m05:54:14.468764 [debug] [ThreadPool]: On create_legal_demo_main: Close
[0m05:54:14.478259 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_legal_demo_main, now list_legal_demo_main)
[0m05:54:14.485747 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo_main"
[0m05:54:14.487843 [debug] [ThreadPool]: On list_legal_demo_main: BEGIN
[0m05:54:14.489507 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:54:14.512099 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m05:54:14.513846 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo_main"
[0m05:54:14.515348 [debug] [ThreadPool]: On list_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo_main"} */
select
      'legal_demo' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'legal_demo'
  
[0m05:54:14.542057 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m05:54:14.549725 [debug] [ThreadPool]: On list_legal_demo_main: ROLLBACK
[0m05:54:14.552605 [debug] [ThreadPool]: Failed to rollback 'list_legal_demo_main'
[0m05:54:14.554413 [debug] [ThreadPool]: On list_legal_demo_main: Close
[0m05:54:14.561031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2a227933-b418-46a0-a2ed-f72c0f379193', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a5398856fd0>]}
[0m05:54:14.562677 [debug] [MainThread]: Using duckdb connection "master"
[0m05:54:14.564012 [debug] [MainThread]: On master: BEGIN
[0m05:54:14.565145 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:54:14.585834 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m05:54:14.587520 [debug] [MainThread]: On master: COMMIT
[0m05:54:14.588932 [debug] [MainThread]: Using duckdb connection "master"
[0m05:54:14.590664 [debug] [MainThread]: On master: COMMIT
[0m05:54:14.592575 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m05:54:14.594177 [debug] [MainThread]: On master: Close
[0m05:54:14.598707 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m05:54:14.600487 [info ] [MainThread]: 
[0m05:54:14.612998 [debug] [Thread-1 (]: Began running node model.legal_demo.acris_cases
[0m05:54:14.615042 [info ] [Thread-1 (]: 1 of 1 START sql table model main.acris_clean .................................. [RUN]
[0m05:54:14.617414 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.legal_demo.acris_cases'
[0m05:54:14.618960 [debug] [Thread-1 (]: Began compiling node model.legal_demo.acris_cases
[0m05:54:14.628969 [debug] [Thread-1 (]: Writing injected SQL for node "model.legal_demo.acris_cases"
[0m05:54:14.641252 [debug] [Thread-1 (]: Timing info for model.legal_demo.acris_cases (compile): 05:54:14.620274 => 05:54:14.640713
[0m05:54:14.643063 [debug] [Thread-1 (]: Began executing node model.legal_demo.acris_cases
[0m05:54:14.684444 [debug] [Thread-1 (]: Writing runtime sql for node "model.legal_demo.acris_cases"
[0m05:54:14.699362 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m05:54:14.701277 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: BEGIN
[0m05:54:14.703341 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m05:54:14.732559 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m05:54:14.734468 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m05:54:14.736074 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */

  
    
    

    create  table
      "legal_demo"."main"."acris_clean__dbt_tmp"
  
    as (
      

SELECT *
FROM read_csv_auto('/opt/airflow/data/first_500k_acris.csv', header=True, delim=',')
    );
  
  
[0m05:54:17.205347 [debug] [Thread-1 (]: SQL status: OK in 2.0 seconds
[0m05:54:17.214510 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m05:54:17.216731 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
alter table "legal_demo"."main"."acris_clean" rename to "acris_clean__dbt_backup"
[0m05:54:17.219116 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m05:54:17.223906 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m05:54:17.225579 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
alter table "legal_demo"."main"."acris_clean__dbt_tmp" rename to "acris_clean"
[0m05:54:17.227697 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m05:54:17.250180 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: COMMIT
[0m05:54:17.252486 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m05:54:17.254248 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: COMMIT
[0m05:54:17.324318 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m05:54:17.335500 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m05:54:17.337308 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
drop table if exists "legal_demo"."main"."acris_clean__dbt_backup" cascade
[0m05:54:17.347445 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m05:54:17.350711 [debug] [Thread-1 (]: Timing info for model.legal_demo.acris_cases (execute): 05:54:14.644588 => 05:54:17.350299
[0m05:54:17.352815 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: Close
[0m05:54:17.417879 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2a227933-b418-46a0-a2ed-f72c0f379193', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a538f4bd950>]}
[0m05:54:17.420875 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main.acris_clean ............................. [[32mOK[0m in 2.80s]
[0m05:54:17.423108 [debug] [Thread-1 (]: Finished running node model.legal_demo.acris_cases
[0m05:54:17.427588 [debug] [MainThread]: Using duckdb connection "master"
[0m05:54:17.429429 [debug] [MainThread]: On master: BEGIN
[0m05:54:17.430860 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:54:17.452549 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m05:54:17.454239 [debug] [MainThread]: On master: COMMIT
[0m05:54:17.455720 [debug] [MainThread]: Using duckdb connection "master"
[0m05:54:17.457061 [debug] [MainThread]: On master: COMMIT
[0m05:54:17.458623 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m05:54:17.460435 [debug] [MainThread]: On master: Close
[0m05:54:17.464954 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:54:17.466459 [debug] [MainThread]: Connection 'list_legal_demo_main' was properly closed.
[0m05:54:17.467882 [debug] [MainThread]: Connection 'model.legal_demo.acris_cases' was properly closed.
[0m05:54:17.469352 [info ] [MainThread]: 
[0m05:54:17.470856 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.14 seconds (3.14s).
[0m05:54:17.472848 [debug] [MainThread]: Command end result
[0m05:54:17.507121 [info ] [MainThread]: 
[0m05:54:17.509373 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:54:17.511168 [info ] [MainThread]: 
[0m05:54:17.512927 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m05:54:17.515333 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.9531672, "process_user_time": 7.276204, "process_kernel_time": 1.448, "process_mem_max_rss": "299056", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m05:54:17.517332 [debug] [MainThread]: Command `dbt run` succeeded at 05:54:17.517105 after 3.96 seconds
[0m05:54:17.519044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a5398b0a450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a539d62f410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a5398868050>]}
[0m05:54:17.520741 [debug] [MainThread]: Flushing usage events
[0m06:01:12.938276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c600ee00fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c600ee00090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c600f40bc50>]}


============================== 06:01:12.950504 | 053c8db4-682f-42b6-a884-5dacf81f1c93 ==============================
[0m06:01:12.950504 [info ] [MainThread]: Running with dbt=1.7.4
[0m06:01:12.953134 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt', 'send_anonymous_usage_stats': 'True'}
[0m06:01:13.372555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '053c8db4-682f-42b6-a884-5dacf81f1c93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c6005da3d10>]}
[0m06:01:13.474665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '053c8db4-682f-42b6-a884-5dacf81f1c93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c601032aad0>]}
[0m06:01:13.477589 [info ] [MainThread]: Registered adapter: duckdb=1.7.4
[0m06:01:13.500378 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m06:01:13.654813 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:01:13.656715 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:01:13.667213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '053c8db4-682f-42b6-a884-5dacf81f1c93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c6005b6a7d0>]}
[0m06:01:13.709684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '053c8db4-682f-42b6-a884-5dacf81f1c93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c6005c34250>]}
[0m06:01:13.711609 [info ] [MainThread]: Found 1 model, 0 sources, 0 exposures, 0 metrics, 394 macros, 0 groups, 0 semantic models
[0m06:01:13.713384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '053c8db4-682f-42b6-a884-5dacf81f1c93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c6005d32250>]}
[0m06:01:13.717592 [info ] [MainThread]: 
[0m06:01:13.719807 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:01:13.722611 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_legal_demo'
[0m06:01:13.738337 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo"
[0m06:01:13.741094 [debug] [ThreadPool]: On list_legal_demo: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"legal_demo"'
    
  
  
[0m06:01:13.742745 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:01:13.777379 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:01:13.781377 [debug] [ThreadPool]: On list_legal_demo: Close
[0m06:01:13.792465 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_legal_demo, now create_legal_demo_main)
[0m06:01:13.794258 [debug] [ThreadPool]: Creating schema "database: "legal_demo"
schema: "main"
"
[0m06:01:13.802818 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m06:01:13.805228 [debug] [ThreadPool]: On create_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "create_legal_demo_main"} */

    
        select type from duckdb_databases()
        where database_name='legal_demo'
        and type='sqlite'
    
  
[0m06:01:13.807128 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:01:13.831610 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:01:13.834275 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m06:01:13.836315 [debug] [ThreadPool]: On create_legal_demo_main: BEGIN
[0m06:01:13.839774 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:01:13.841023 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m06:01:13.842734 [debug] [ThreadPool]: On create_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "create_legal_demo_main"} */

    
    
        create schema if not exists "legal_demo"."main"
    
[0m06:01:13.844771 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:01:13.847084 [debug] [ThreadPool]: On create_legal_demo_main: COMMIT
[0m06:01:13.848928 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m06:01:13.850752 [debug] [ThreadPool]: On create_legal_demo_main: COMMIT
[0m06:01:13.854201 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:01:13.855784 [debug] [ThreadPool]: On create_legal_demo_main: Close
[0m06:01:13.865883 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_legal_demo_main, now list_legal_demo_main)
[0m06:01:13.873239 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo_main"
[0m06:01:13.875637 [debug] [ThreadPool]: On list_legal_demo_main: BEGIN
[0m06:01:13.877145 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:01:13.898768 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:01:13.900750 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo_main"
[0m06:01:13.902275 [debug] [ThreadPool]: On list_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo_main"} */
select
      'legal_demo' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'legal_demo'
  
[0m06:01:13.928914 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:01:13.936757 [debug] [ThreadPool]: On list_legal_demo_main: ROLLBACK
[0m06:01:13.939080 [debug] [ThreadPool]: Failed to rollback 'list_legal_demo_main'
[0m06:01:13.940844 [debug] [ThreadPool]: On list_legal_demo_main: Close
[0m06:01:13.948743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '053c8db4-682f-42b6-a884-5dacf81f1c93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c600ee365d0>]}
[0m06:01:13.950667 [debug] [MainThread]: Using duckdb connection "master"
[0m06:01:13.952471 [debug] [MainThread]: On master: BEGIN
[0m06:01:13.953678 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:01:13.977470 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:01:13.979417 [debug] [MainThread]: On master: COMMIT
[0m06:01:13.980906 [debug] [MainThread]: Using duckdb connection "master"
[0m06:01:13.982383 [debug] [MainThread]: On master: COMMIT
[0m06:01:13.984368 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:01:13.985799 [debug] [MainThread]: On master: Close
[0m06:01:13.990679 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:01:13.993072 [info ] [MainThread]: 
[0m06:01:14.008957 [debug] [Thread-1 (]: Began running node model.legal_demo.acris_cases
[0m06:01:14.011698 [info ] [Thread-1 (]: 1 of 1 START sql table model main.acris_clean .................................. [RUN]
[0m06:01:14.015816 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.legal_demo.acris_cases'
[0m06:01:14.017886 [debug] [Thread-1 (]: Began compiling node model.legal_demo.acris_cases
[0m06:01:14.036782 [debug] [Thread-1 (]: Writing injected SQL for node "model.legal_demo.acris_cases"
[0m06:01:14.051722 [debug] [Thread-1 (]: Timing info for model.legal_demo.acris_cases (compile): 06:01:14.019834 => 06:01:14.051189
[0m06:01:14.053815 [debug] [Thread-1 (]: Began executing node model.legal_demo.acris_cases
[0m06:01:14.099676 [debug] [Thread-1 (]: Writing runtime sql for node "model.legal_demo.acris_cases"
[0m06:01:14.113473 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m06:01:14.115997 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: BEGIN
[0m06:01:14.117782 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:01:14.144893 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:01:14.146668 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m06:01:14.148311 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */

  
    
    

    create  table
      "legal_demo"."main"."acris_clean__dbt_tmp"
  
    as (
      

SELECT *
FROM read_csv_auto('/opt/airflow/data/first_500k_acris.csv', header=True, delim=',')
    );
  
  
[0m06:01:17.363377 [debug] [Thread-1 (]: SQL status: OK in 3.0 seconds
[0m06:01:17.373068 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m06:01:17.375270 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
alter table "legal_demo"."main"."acris_clean" rename to "acris_clean__dbt_backup"
[0m06:01:17.377780 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:01:17.384581 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m06:01:17.386206 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
alter table "legal_demo"."main"."acris_clean__dbt_tmp" rename to "acris_clean"
[0m06:01:17.388916 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:01:17.412791 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: COMMIT
[0m06:01:17.415270 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m06:01:17.417014 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: COMMIT
[0m06:01:17.491583 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:01:17.500128 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m06:01:17.502738 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
drop table if exists "legal_demo"."main"."acris_clean__dbt_backup" cascade
[0m06:01:17.511521 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:01:17.515181 [debug] [Thread-1 (]: Timing info for model.legal_demo.acris_cases (execute): 06:01:14.056079 => 06:01:17.514819
[0m06:01:17.517190 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: Close
[0m06:01:17.582158 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '053c8db4-682f-42b6-a884-5dacf81f1c93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c6005a9a990>]}
[0m06:01:17.585248 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main.acris_clean ............................. [[32mOK[0m in 3.57s]
[0m06:01:17.587759 [debug] [Thread-1 (]: Finished running node model.legal_demo.acris_cases
[0m06:01:17.592900 [debug] [MainThread]: Using duckdb connection "master"
[0m06:01:17.594990 [debug] [MainThread]: On master: BEGIN
[0m06:01:17.596709 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:01:17.657803 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:01:17.660132 [debug] [MainThread]: On master: COMMIT
[0m06:01:17.661757 [debug] [MainThread]: Using duckdb connection "master"
[0m06:01:17.663425 [debug] [MainThread]: On master: COMMIT
[0m06:01:17.665556 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:01:17.667192 [debug] [MainThread]: On master: Close
[0m06:01:17.671834 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:01:17.673654 [debug] [MainThread]: Connection 'list_legal_demo_main' was properly closed.
[0m06:01:17.675275 [debug] [MainThread]: Connection 'model.legal_demo.acris_cases' was properly closed.
[0m06:01:17.677029 [info ] [MainThread]: 
[0m06:01:17.678897 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.96 seconds (3.96s).
[0m06:01:17.681469 [debug] [MainThread]: Command end result
[0m06:01:17.718178 [info ] [MainThread]: 
[0m06:01:17.720187 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:01:17.722687 [info ] [MainThread]: 
[0m06:01:17.724975 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m06:01:17.728818 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.8763905, "process_user_time": 8.434704, "process_kernel_time": 1.737963, "process_mem_max_rss": "299180", "process_in_blocks": "4000", "process_out_blocks": "8384"}
[0m06:01:17.731766 [debug] [MainThread]: Command `dbt run` succeeded at 06:01:17.731493 after 4.88 seconds
[0m06:01:17.733564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c600ee2f7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c600f5cef90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c6013d2e810>]}
[0m06:01:17.735250 [debug] [MainThread]: Flushing usage events
[0m17:06:49.221758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709645f73290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709645bec290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709645aa9250>]}


============================== 17:06:49.233229 | f5e92799-d007-484a-ad70-421e342beb60 ==============================
[0m17:06:49.233229 [info ] [MainThread]: Running with dbt=1.7.4
[0m17:06:49.235168 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:06:49.685934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f5e92799-d007-484a-ad70-421e342beb60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7096428a40d0>]}
[0m17:06:49.793661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f5e92799-d007-484a-ad70-421e342beb60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709645b83410>]}
[0m17:06:49.796543 [info ] [MainThread]: Registered adapter: duckdb=1.7.4
[0m17:06:49.817589 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m17:06:50.033264 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:06:50.036085 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:06:50.049073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f5e92799-d007-484a-ad70-421e342beb60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70963c87a7d0>]}
[0m17:06:50.211223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f5e92799-d007-484a-ad70-421e342beb60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709645b08110>]}
[0m17:06:50.212980 [info ] [MainThread]: Found 1 model, 0 sources, 0 exposures, 0 metrics, 394 macros, 0 groups, 0 semantic models
[0m17:06:50.214748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f5e92799-d007-484a-ad70-421e342beb60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709649569350>]}
[0m17:06:50.217863 [info ] [MainThread]: 
[0m17:06:50.220400 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:06:50.223179 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_legal_demo'
[0m17:06:50.237772 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo"
[0m17:06:50.240295 [debug] [ThreadPool]: On list_legal_demo: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"legal_demo"'
    
  
  
[0m17:06:50.242069 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:06:50.372604 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:06:50.377184 [debug] [ThreadPool]: On list_legal_demo: Close
[0m17:06:50.389165 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_legal_demo, now create_legal_demo_main)
[0m17:06:50.391960 [debug] [ThreadPool]: Creating schema "database: "legal_demo"
schema: "main"
"
[0m17:06:50.401964 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m17:06:50.404238 [debug] [ThreadPool]: On create_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "create_legal_demo_main"} */

    
        select type from duckdb_databases()
        where database_name='legal_demo'
        and type='sqlite'
    
  
[0m17:06:50.405959 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:06:50.438106 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:06:50.442651 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m17:06:50.444882 [debug] [ThreadPool]: On create_legal_demo_main: BEGIN
[0m17:06:50.447615 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:06:50.449478 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m17:06:50.451441 [debug] [ThreadPool]: On create_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "create_legal_demo_main"} */

    
    
        create schema if not exists "legal_demo"."main"
    
[0m17:06:50.504280 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:06:50.507938 [debug] [ThreadPool]: On create_legal_demo_main: COMMIT
[0m17:06:50.509991 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m17:06:50.511909 [debug] [ThreadPool]: On create_legal_demo_main: COMMIT
[0m17:06:50.515620 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:06:50.517809 [debug] [ThreadPool]: On create_legal_demo_main: Close
[0m17:06:50.530202 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_legal_demo_main, now list_legal_demo_main)
[0m17:06:50.538970 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo_main"
[0m17:06:50.541707 [debug] [ThreadPool]: On list_legal_demo_main: BEGIN
[0m17:06:50.543738 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:06:50.570914 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:06:50.573384 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo_main"
[0m17:06:50.574974 [debug] [ThreadPool]: On list_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo_main"} */
select
      'legal_demo' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'legal_demo'
  
[0m17:06:50.670370 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:06:50.681374 [debug] [ThreadPool]: On list_legal_demo_main: ROLLBACK
[0m17:06:50.684708 [debug] [ThreadPool]: Failed to rollback 'list_legal_demo_main'
[0m17:06:50.686685 [debug] [ThreadPool]: On list_legal_demo_main: Close
[0m17:06:50.695799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f5e92799-d007-484a-ad70-421e342beb60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70963c87a490>]}
[0m17:06:50.698064 [debug] [MainThread]: Using duckdb connection "master"
[0m17:06:50.699982 [debug] [MainThread]: On master: BEGIN
[0m17:06:50.702150 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:06:50.727731 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:06:50.730090 [debug] [MainThread]: On master: COMMIT
[0m17:06:50.732053 [debug] [MainThread]: Using duckdb connection "master"
[0m17:06:50.734098 [debug] [MainThread]: On master: COMMIT
[0m17:06:50.736310 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:06:50.737937 [debug] [MainThread]: On master: Close
[0m17:06:50.743416 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:06:50.745319 [info ] [MainThread]: 
[0m17:06:50.759862 [debug] [Thread-1 (]: Began running node model.legal_demo.acris_cases
[0m17:06:50.762285 [info ] [Thread-1 (]: 1 of 1 START sql table model main.acris_clean .................................. [RUN]
[0m17:06:50.764744 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.legal_demo.acris_cases'
[0m17:06:50.766901 [debug] [Thread-1 (]: Began compiling node model.legal_demo.acris_cases
[0m17:06:50.777295 [debug] [Thread-1 (]: Writing injected SQL for node "model.legal_demo.acris_cases"
[0m17:06:50.858314 [debug] [Thread-1 (]: Timing info for model.legal_demo.acris_cases (compile): 17:06:50.768384 => 17:06:50.857539
[0m17:06:50.860720 [debug] [Thread-1 (]: Began executing node model.legal_demo.acris_cases
[0m17:06:50.900516 [debug] [Thread-1 (]: Writing runtime sql for node "model.legal_demo.acris_cases"
[0m17:06:50.981143 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m17:06:50.983452 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: BEGIN
[0m17:06:50.985259 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:06:51.015316 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:06:51.017623 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m17:06:51.019532 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */

  
    
    

    create  table
      "legal_demo"."main"."acris_clean__dbt_tmp"
  
    as (
      

SELECT *
FROM read_csv_auto('/opt/airflow/data/first_500k_acris.csv', header=True, delim=',')
    );
  
  
[0m17:06:54.367737 [debug] [Thread-1 (]: SQL status: OK in 3.0 seconds
[0m17:06:54.378601 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m17:06:54.381301 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
alter table "legal_demo"."main"."acris_clean" rename to "acris_clean__dbt_backup"
[0m17:06:54.385949 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:06:54.394163 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m17:06:54.396479 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
alter table "legal_demo"."main"."acris_clean__dbt_tmp" rename to "acris_clean"
[0m17:06:54.398726 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:06:54.422242 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: COMMIT
[0m17:06:54.424633 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m17:06:54.426445 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: COMMIT
[0m17:06:54.504830 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:06:54.513618 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m17:06:54.515704 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
drop table if exists "legal_demo"."main"."acris_clean__dbt_backup" cascade
[0m17:06:54.525674 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:06:54.529622 [debug] [Thread-1 (]: Timing info for model.legal_demo.acris_cases (execute): 17:06:50.862248 => 17:06:54.529291
[0m17:06:54.531484 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: Close
[0m17:06:54.608411 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f5e92799-d007-484a-ad70-421e342beb60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70963c7752d0>]}
[0m17:06:54.611578 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main.acris_clean ............................. [[32mOK[0m in 3.84s]
[0m17:06:54.661607 [debug] [Thread-1 (]: Finished running node model.legal_demo.acris_cases
[0m17:06:54.668218 [debug] [MainThread]: Using duckdb connection "master"
[0m17:06:54.670100 [debug] [MainThread]: On master: BEGIN
[0m17:06:54.671833 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:06:54.700029 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:06:54.702329 [debug] [MainThread]: On master: COMMIT
[0m17:06:54.704173 [debug] [MainThread]: Using duckdb connection "master"
[0m17:06:54.706513 [debug] [MainThread]: On master: COMMIT
[0m17:06:54.708792 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:06:54.710254 [debug] [MainThread]: On master: Close
[0m17:06:54.714993 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:06:54.716648 [debug] [MainThread]: Connection 'list_legal_demo_main' was properly closed.
[0m17:06:54.718281 [debug] [MainThread]: Connection 'model.legal_demo.acris_cases' was properly closed.
[0m17:06:54.719832 [info ] [MainThread]: 
[0m17:06:54.721690 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.50 seconds (4.50s).
[0m17:06:54.723647 [debug] [MainThread]: Command end result
[0m17:06:54.822624 [info ] [MainThread]: 
[0m17:06:54.824555 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:06:54.826116 [info ] [MainThread]: 
[0m17:06:54.827753 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:06:54.830271 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.849966, "process_user_time": 9.55081, "process_kernel_time": 2.003278, "process_mem_max_rss": "297668", "process_out_blocks": "8384", "process_in_blocks": "0"}
[0m17:06:54.832393 [debug] [MainThread]: Command `dbt run` succeeded at 17:06:54.832188 after 5.85 seconds
[0m17:06:54.833998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709645aaac50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70964aaa7290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70964aa16bd0>]}
[0m17:06:54.835706 [debug] [MainThread]: Flushing usage events
[0m17:08:07.373853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74372a6af590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74372add7c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74372aaddad0>]}


============================== 17:08:07.384051 | b6b76012-93ae-47ea-9eb1-8201085cf268 ==============================
[0m17:08:07.384051 [info ] [MainThread]: Running with dbt=1.7.4
[0m17:08:07.386184 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:08:07.784308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b6b76012-93ae-47ea-9eb1-8201085cf268', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74372a7179d0>]}
[0m17:08:07.889238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b6b76012-93ae-47ea-9eb1-8201085cf268', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74372a6b8750>]}
[0m17:08:07.892438 [info ] [MainThread]: Registered adapter: duckdb=1.7.4
[0m17:08:07.914745 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m17:08:08.005357 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:08:08.008033 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:08:08.016327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b6b76012-93ae-47ea-9eb1-8201085cf268', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74372a67b3d0>]}
[0m17:08:08.066124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b6b76012-93ae-47ea-9eb1-8201085cf268', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74372a70a550>]}
[0m17:08:08.068189 [info ] [MainThread]: Found 1 model, 0 sources, 0 exposures, 0 metrics, 394 macros, 0 groups, 0 semantic models
[0m17:08:08.070091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6b76012-93ae-47ea-9eb1-8201085cf268', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74372a6fa450>]}
[0m17:08:08.073664 [info ] [MainThread]: 
[0m17:08:08.076541 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:08:08.080068 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_legal_demo'
[0m17:08:08.096831 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo"
[0m17:08:08.098743 [debug] [ThreadPool]: On list_legal_demo: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"legal_demo"'
    
  
  
[0m17:08:08.100188 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:08:08.167109 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:08:08.170949 [debug] [ThreadPool]: On list_legal_demo: Close
[0m17:08:08.181603 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_legal_demo, now create_legal_demo_main)
[0m17:08:08.184106 [debug] [ThreadPool]: Creating schema "database: "legal_demo"
schema: "main"
"
[0m17:08:08.193366 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m17:08:08.195210 [debug] [ThreadPool]: On create_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "create_legal_demo_main"} */

    
        select type from duckdb_databases()
        where database_name='legal_demo'
        and type='sqlite'
    
  
[0m17:08:08.196933 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:08:08.241502 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:08:08.244918 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m17:08:08.246637 [debug] [ThreadPool]: On create_legal_demo_main: BEGIN
[0m17:08:08.248584 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:08:08.250403 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m17:08:08.252077 [debug] [ThreadPool]: On create_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "create_legal_demo_main"} */

    
    
        create schema if not exists "legal_demo"."main"
    
[0m17:08:08.255099 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:08:08.257888 [debug] [ThreadPool]: On create_legal_demo_main: COMMIT
[0m17:08:08.259444 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m17:08:08.261114 [debug] [ThreadPool]: On create_legal_demo_main: COMMIT
[0m17:08:08.264930 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:08:08.267203 [debug] [ThreadPool]: On create_legal_demo_main: Close
[0m17:08:08.279268 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_legal_demo_main, now list_legal_demo_main)
[0m17:08:08.288544 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo_main"
[0m17:08:08.290293 [debug] [ThreadPool]: On list_legal_demo_main: BEGIN
[0m17:08:08.292050 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:08:08.316413 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:08:08.318157 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo_main"
[0m17:08:08.319623 [debug] [ThreadPool]: On list_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo_main"} */
select
      'legal_demo' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'legal_demo'
  
[0m17:08:08.349675 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:08:08.357905 [debug] [ThreadPool]: On list_legal_demo_main: ROLLBACK
[0m17:08:08.360496 [debug] [ThreadPool]: Failed to rollback 'list_legal_demo_main'
[0m17:08:08.362194 [debug] [ThreadPool]: On list_legal_demo_main: Close
[0m17:08:08.369303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6b76012-93ae-47ea-9eb1-8201085cf268', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7437274e7550>]}
[0m17:08:08.371168 [debug] [MainThread]: Using duckdb connection "master"
[0m17:08:08.372639 [debug] [MainThread]: On master: BEGIN
[0m17:08:08.374006 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:08:08.443400 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:08:08.445369 [debug] [MainThread]: On master: COMMIT
[0m17:08:08.447017 [debug] [MainThread]: Using duckdb connection "master"
[0m17:08:08.448315 [debug] [MainThread]: On master: COMMIT
[0m17:08:08.450088 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:08:08.451933 [debug] [MainThread]: On master: Close
[0m17:08:08.457005 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:08:08.458573 [info ] [MainThread]: 
[0m17:08:08.471248 [debug] [Thread-1 (]: Began running node model.legal_demo.acris_cases
[0m17:08:08.473110 [info ] [Thread-1 (]: 1 of 1 START sql table model main.acris_clean .................................. [RUN]
[0m17:08:08.475299 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.legal_demo.acris_cases'
[0m17:08:08.477063 [debug] [Thread-1 (]: Began compiling node model.legal_demo.acris_cases
[0m17:08:08.486171 [debug] [Thread-1 (]: Writing injected SQL for node "model.legal_demo.acris_cases"
[0m17:08:08.500720 [debug] [Thread-1 (]: Timing info for model.legal_demo.acris_cases (compile): 17:08:08.478614 => 17:08:08.500257
[0m17:08:08.502888 [debug] [Thread-1 (]: Began executing node model.legal_demo.acris_cases
[0m17:08:08.540751 [debug] [Thread-1 (]: Writing runtime sql for node "model.legal_demo.acris_cases"
[0m17:08:08.556435 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m17:08:08.557960 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: BEGIN
[0m17:08:08.559540 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:08:08.607692 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:08:08.609670 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m17:08:08.611629 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */

  
    
    

    create  table
      "legal_demo"."main"."acris_clean__dbt_tmp"
  
    as (
      

SELECT *
FROM read_csv_auto('/opt/airflow/data/first_500k_acris.csv', header=True, delim=',')
    );
  
  
[0m17:08:11.525285 [debug] [Thread-1 (]: SQL status: OK in 3.0 seconds
[0m17:08:11.535891 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m17:08:11.537628 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
alter table "legal_demo"."main"."acris_clean" rename to "acris_clean__dbt_backup"
[0m17:08:11.540020 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:08:11.546727 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m17:08:11.548946 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
alter table "legal_demo"."main"."acris_clean__dbt_tmp" rename to "acris_clean"
[0m17:08:11.551193 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:08:11.577152 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: COMMIT
[0m17:08:11.579355 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m17:08:11.581402 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: COMMIT
[0m17:08:11.658175 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:08:11.670618 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m17:08:11.672545 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
drop table if exists "legal_demo"."main"."acris_clean__dbt_backup" cascade
[0m17:08:11.680827 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:08:11.684510 [debug] [Thread-1 (]: Timing info for model.legal_demo.acris_cases (execute): 17:08:08.504466 => 17:08:11.684140
[0m17:08:11.687783 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: Close
[0m17:08:11.754249 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6b76012-93ae-47ea-9eb1-8201085cf268', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x743721350a50>]}
[0m17:08:11.756426 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main.acris_clean ............................. [[32mOK[0m in 3.28s]
[0m17:08:11.758267 [debug] [Thread-1 (]: Finished running node model.legal_demo.acris_cases
[0m17:08:11.762976 [debug] [MainThread]: Using duckdb connection "master"
[0m17:08:11.764724 [debug] [MainThread]: On master: BEGIN
[0m17:08:11.766113 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:08:11.836821 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:08:11.838711 [debug] [MainThread]: On master: COMMIT
[0m17:08:11.839996 [debug] [MainThread]: Using duckdb connection "master"
[0m17:08:11.841249 [debug] [MainThread]: On master: COMMIT
[0m17:08:11.842957 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:08:11.844934 [debug] [MainThread]: On master: Close
[0m17:08:11.849529 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:08:11.851390 [debug] [MainThread]: Connection 'list_legal_demo_main' was properly closed.
[0m17:08:11.852866 [debug] [MainThread]: Connection 'model.legal_demo.acris_cases' was properly closed.
[0m17:08:11.854452 [info ] [MainThread]: 
[0m17:08:11.855991 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.78 seconds (3.78s).
[0m17:08:11.857717 [debug] [MainThread]: Command end result
[0m17:08:11.890862 [info ] [MainThread]: 
[0m17:08:11.892733 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:08:11.895054 [info ] [MainThread]: 
[0m17:08:11.896740 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:08:11.898979 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.595916, "process_user_time": 8.204504, "process_kernel_time": 1.52821, "process_mem_max_rss": "297968", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:08:11.900800 [debug] [MainThread]: Command `dbt run` succeeded at 17:08:11.900533 after 4.60 seconds
[0m17:08:11.902413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74372b1b1390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74372acaf6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74372f4c6b90>]}
[0m17:08:11.903959 [debug] [MainThread]: Flushing usage events
[0m17:09:38.451773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7365979b7050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736598255250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7365979f5ad0>]}


============================== 17:09:38.462989 | 949f1b3c-6e55-4c08-9c1f-18ea5a2bb9d2 ==============================
[0m17:09:38.462989 [info ] [MainThread]: Running with dbt=1.7.4
[0m17:09:38.465163 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:09:38.946414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '949f1b3c-6e55-4c08-9c1f-18ea5a2bb9d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736597fae2d0>]}
[0m17:09:39.061927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '949f1b3c-6e55-4c08-9c1f-18ea5a2bb9d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7365981c2690>]}
[0m17:09:39.064636 [info ] [MainThread]: Registered adapter: duckdb=1.7.4
[0m17:09:39.086655 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m17:09:39.179369 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:09:39.181931 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:09:39.190713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '949f1b3c-6e55-4c08-9c1f-18ea5a2bb9d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73658e7c4990>]}
[0m17:09:39.245418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '949f1b3c-6e55-4c08-9c1f-18ea5a2bb9d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736598132550>]}
[0m17:09:39.247409 [info ] [MainThread]: Found 1 model, 0 sources, 0 exposures, 0 metrics, 394 macros, 0 groups, 0 semantic models
[0m17:09:39.249346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '949f1b3c-6e55-4c08-9c1f-18ea5a2bb9d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73659b36b8d0>]}
[0m17:09:39.253788 [info ] [MainThread]: 
[0m17:09:39.256584 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:09:39.259692 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_legal_demo'
[0m17:09:39.279149 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo"
[0m17:09:39.280944 [debug] [ThreadPool]: On list_legal_demo: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"legal_demo"'
    
  
  
[0m17:09:39.282265 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:09:39.319848 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:09:39.323836 [debug] [ThreadPool]: On list_legal_demo: Close
[0m17:09:39.333887 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_legal_demo, now create_legal_demo_main)
[0m17:09:39.336530 [debug] [ThreadPool]: Creating schema "database: "legal_demo"
schema: "main"
"
[0m17:09:39.347528 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m17:09:39.349940 [debug] [ThreadPool]: On create_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "create_legal_demo_main"} */

    
        select type from duckdb_databases()
        where database_name='legal_demo'
        and type='sqlite'
    
  
[0m17:09:39.351927 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:09:39.380532 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:09:39.384729 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m17:09:39.386330 [debug] [ThreadPool]: On create_legal_demo_main: BEGIN
[0m17:09:39.388692 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:09:39.390241 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m17:09:39.391746 [debug] [ThreadPool]: On create_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "create_legal_demo_main"} */

    
    
        create schema if not exists "legal_demo"."main"
    
[0m17:09:39.394271 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:09:39.396608 [debug] [ThreadPool]: On create_legal_demo_main: COMMIT
[0m17:09:39.398185 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m17:09:39.399915 [debug] [ThreadPool]: On create_legal_demo_main: COMMIT
[0m17:09:39.403087 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:09:39.404705 [debug] [ThreadPool]: On create_legal_demo_main: Close
[0m17:09:39.417087 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_legal_demo_main, now list_legal_demo_main)
[0m17:09:39.427393 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo_main"
[0m17:09:39.429228 [debug] [ThreadPool]: On list_legal_demo_main: BEGIN
[0m17:09:39.430877 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:09:39.505716 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:09:39.507862 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo_main"
[0m17:09:39.509626 [debug] [ThreadPool]: On list_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo_main"} */
select
      'legal_demo' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'legal_demo'
  
[0m17:09:39.541025 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:09:39.552822 [debug] [ThreadPool]: On list_legal_demo_main: ROLLBACK
[0m17:09:39.556149 [debug] [ThreadPool]: Failed to rollback 'list_legal_demo_main'
[0m17:09:39.557749 [debug] [ThreadPool]: On list_legal_demo_main: Close
[0m17:09:39.566604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '949f1b3c-6e55-4c08-9c1f-18ea5a2bb9d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73658e81ad90>]}
[0m17:09:39.568941 [debug] [MainThread]: Using duckdb connection "master"
[0m17:09:39.570466 [debug] [MainThread]: On master: BEGIN
[0m17:09:39.571973 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:09:39.601098 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:09:39.603013 [debug] [MainThread]: On master: COMMIT
[0m17:09:39.604844 [debug] [MainThread]: Using duckdb connection "master"
[0m17:09:39.606473 [debug] [MainThread]: On master: COMMIT
[0m17:09:39.608858 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:09:39.610673 [debug] [MainThread]: On master: Close
[0m17:09:39.618010 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:09:39.619880 [info ] [MainThread]: 
[0m17:09:39.637123 [debug] [Thread-1 (]: Began running node model.legal_demo.acris_cases
[0m17:09:39.639616 [info ] [Thread-1 (]: 1 of 1 START sql table model main.acris_clean .................................. [RUN]
[0m17:09:39.642647 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.legal_demo.acris_cases'
[0m17:09:39.644480 [debug] [Thread-1 (]: Began compiling node model.legal_demo.acris_cases
[0m17:09:39.657194 [debug] [Thread-1 (]: Writing injected SQL for node "model.legal_demo.acris_cases"
[0m17:09:39.669054 [debug] [Thread-1 (]: Timing info for model.legal_demo.acris_cases (compile): 17:09:39.645806 => 17:09:39.668537
[0m17:09:39.670784 [debug] [Thread-1 (]: Began executing node model.legal_demo.acris_cases
[0m17:09:39.714748 [debug] [Thread-1 (]: Writing runtime sql for node "model.legal_demo.acris_cases"
[0m17:09:39.728815 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m17:09:39.730535 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: BEGIN
[0m17:09:39.732295 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:09:39.757621 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:09:39.759432 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m17:09:39.761000 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */

  
    
    

    create  table
      "legal_demo"."main"."acris_clean__dbt_tmp"
  
    as (
      

SELECT *
FROM read_csv_auto('/opt/airflow/data/first_500k_acris.csv', header=True, delim=',')
    );
  
  
[0m17:09:42.246899 [debug] [Thread-1 (]: SQL status: OK in 2.0 seconds
[0m17:09:42.271253 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m17:09:42.273107 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
alter table "legal_demo"."main"."acris_clean" rename to "acris_clean__dbt_backup"
[0m17:09:42.276370 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:09:42.282141 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m17:09:42.283661 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
alter table "legal_demo"."main"."acris_clean__dbt_tmp" rename to "acris_clean"
[0m17:09:42.286400 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:09:42.316245 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: COMMIT
[0m17:09:42.317997 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m17:09:42.319648 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: COMMIT
[0m17:09:42.335503 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:09:42.343348 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m17:09:42.345306 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
drop table if exists "legal_demo"."main"."acris_clean__dbt_backup" cascade
[0m17:09:42.356783 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:09:42.360618 [debug] [Thread-1 (]: Timing info for model.legal_demo.acris_cases (execute): 17:09:39.672379 => 17:09:42.360305
[0m17:09:42.362619 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: Close
[0m17:09:42.429925 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '949f1b3c-6e55-4c08-9c1f-18ea5a2bb9d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73658e8d3d10>]}
[0m17:09:42.433170 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main.acris_clean ............................. [[32mOK[0m in 2.79s]
[0m17:09:42.435483 [debug] [Thread-1 (]: Finished running node model.legal_demo.acris_cases
[0m17:09:42.445167 [debug] [MainThread]: Using duckdb connection "master"
[0m17:09:42.447258 [debug] [MainThread]: On master: BEGIN
[0m17:09:42.448896 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:09:42.477331 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:09:42.479490 [debug] [MainThread]: On master: COMMIT
[0m17:09:42.480984 [debug] [MainThread]: Using duckdb connection "master"
[0m17:09:42.482278 [debug] [MainThread]: On master: COMMIT
[0m17:09:42.484337 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:09:42.485803 [debug] [MainThread]: On master: Close
[0m17:09:42.490590 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:09:42.492400 [debug] [MainThread]: Connection 'list_legal_demo_main' was properly closed.
[0m17:09:42.493900 [debug] [MainThread]: Connection 'model.legal_demo.acris_cases' was properly closed.
[0m17:09:42.495674 [info ] [MainThread]: 
[0m17:09:42.497369 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.24 seconds (3.24s).
[0m17:09:42.499593 [debug] [MainThread]: Command end result
[0m17:09:42.540391 [info ] [MainThread]: 
[0m17:09:42.542536 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:09:42.544287 [info ] [MainThread]: 
[0m17:09:42.545943 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:09:42.548929 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.1704597, "process_user_time": 7.97448, "process_kernel_time": 1.345093, "process_mem_max_rss": "301292", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:09:42.551294 [debug] [MainThread]: Command `dbt run` succeeded at 17:09:42.551100 after 4.17 seconds
[0m17:09:42.553324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73659c7f1bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73659c7f1b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736598113190>]}
[0m17:09:42.554872 [debug] [MainThread]: Flushing usage events
[0m17:58:47.510781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72793c854290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72793c49be50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72793c0af850>]}


============================== 17:58:47.520523 | 0c6e853e-b267-42be-a3e9-321b8776a5c9 ==============================
[0m17:58:47.520523 [info ] [MainThread]: Running with dbt=1.7.4
[0m17:58:47.522368 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:58:47.928708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0c6e853e-b267-42be-a3e9-321b8776a5c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72793c0e4610>]}
[0m17:58:48.033795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0c6e853e-b267-42be-a3e9-321b8776a5c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72793c0b4590>]}
[0m17:58:48.037125 [info ] [MainThread]: Registered adapter: duckdb=1.7.4
[0m17:58:48.061141 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m17:58:48.169301 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:58:48.171409 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:58:48.179129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0c6e853e-b267-42be-a3e9-321b8776a5c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727932847390>]}
[0m17:58:48.227240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0c6e853e-b267-42be-a3e9-321b8776a5c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727932970d10>]}
[0m17:58:48.229362 [info ] [MainThread]: Found 1 model, 0 sources, 0 exposures, 0 metrics, 394 macros, 0 groups, 0 semantic models
[0m17:58:48.231438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0c6e853e-b267-42be-a3e9-321b8776a5c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7279329363d0>]}
[0m17:58:48.234662 [info ] [MainThread]: 
[0m17:58:48.237184 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:58:48.239930 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_legal_demo'
[0m17:58:48.256014 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo"
[0m17:58:48.258100 [debug] [ThreadPool]: On list_legal_demo: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"legal_demo"'
    
  
  
[0m17:58:48.259813 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:58:48.313085 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:58:48.316738 [debug] [ThreadPool]: On list_legal_demo: Close
[0m17:58:48.326625 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_legal_demo, now create_legal_demo_main)
[0m17:58:48.328638 [debug] [ThreadPool]: Creating schema "database: "legal_demo"
schema: "main"
"
[0m17:58:48.337294 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m17:58:48.339432 [debug] [ThreadPool]: On create_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "create_legal_demo_main"} */

    
        select type from duckdb_databases()
        where database_name='legal_demo'
        and type='sqlite'
    
  
[0m17:58:48.341220 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:58:48.370512 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:58:48.373958 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m17:58:48.375751 [debug] [ThreadPool]: On create_legal_demo_main: BEGIN
[0m17:58:48.378018 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:58:48.379746 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m17:58:48.381111 [debug] [ThreadPool]: On create_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "create_legal_demo_main"} */

    
    
        create schema if not exists "legal_demo"."main"
    
[0m17:58:48.384187 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:58:48.386352 [debug] [ThreadPool]: On create_legal_demo_main: COMMIT
[0m17:58:48.387885 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m17:58:48.389541 [debug] [ThreadPool]: On create_legal_demo_main: COMMIT
[0m17:58:48.392652 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:58:48.394059 [debug] [ThreadPool]: On create_legal_demo_main: Close
[0m17:58:48.404275 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_legal_demo_main, now list_legal_demo_main)
[0m17:58:48.412460 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo_main"
[0m17:58:48.414365 [debug] [ThreadPool]: On list_legal_demo_main: BEGIN
[0m17:58:48.416020 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:58:48.439431 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:58:48.441326 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo_main"
[0m17:58:48.442864 [debug] [ThreadPool]: On list_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo_main"} */
select
      'legal_demo' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'legal_demo'
  
[0m17:58:48.479856 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:58:48.489123 [debug] [ThreadPool]: On list_legal_demo_main: ROLLBACK
[0m17:58:48.491943 [debug] [ThreadPool]: Failed to rollback 'list_legal_demo_main'
[0m17:58:48.493436 [debug] [ThreadPool]: On list_legal_demo_main: Close
[0m17:58:48.501294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0c6e853e-b267-42be-a3e9-321b8776a5c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727932886390>]}
[0m17:58:48.503056 [debug] [MainThread]: Using duckdb connection "master"
[0m17:58:48.504627 [debug] [MainThread]: On master: BEGIN
[0m17:58:48.506078 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:58:48.528210 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:58:48.530268 [debug] [MainThread]: On master: COMMIT
[0m17:58:48.531720 [debug] [MainThread]: Using duckdb connection "master"
[0m17:58:48.533476 [debug] [MainThread]: On master: COMMIT
[0m17:58:48.535498 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:58:48.536959 [debug] [MainThread]: On master: Close
[0m17:58:48.542651 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:58:48.544701 [info ] [MainThread]: 
[0m17:58:48.556670 [debug] [Thread-1 (]: Began running node model.legal_demo.acris_cases
[0m17:58:48.558421 [info ] [Thread-1 (]: 1 of 1 START sql table model main.acris_clean .................................. [RUN]
[0m17:58:48.560650 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.legal_demo.acris_cases'
[0m17:58:48.562158 [debug] [Thread-1 (]: Began compiling node model.legal_demo.acris_cases
[0m17:58:48.570980 [debug] [Thread-1 (]: Writing injected SQL for node "model.legal_demo.acris_cases"
[0m17:58:48.584885 [debug] [Thread-1 (]: Timing info for model.legal_demo.acris_cases (compile): 17:58:48.563573 => 17:58:48.584340
[0m17:58:48.586630 [debug] [Thread-1 (]: Began executing node model.legal_demo.acris_cases
[0m17:58:48.633123 [debug] [Thread-1 (]: Writing runtime sql for node "model.legal_demo.acris_cases"
[0m17:58:48.647390 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m17:58:48.649459 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: BEGIN
[0m17:58:48.651389 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:58:48.677245 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:58:48.680740 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m17:58:48.682648 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */

  
    
    

    create  table
      "legal_demo"."main"."acris_clean__dbt_tmp"
  
    as (
      

SELECT *
FROM read_csv_auto('/opt/airflow/data/first_500k_acris.csv', header=True, delim=',')
    );
  
  
[0m17:58:51.694737 [debug] [Thread-1 (]: SQL status: OK in 3.0 seconds
[0m17:58:51.705087 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m17:58:51.707620 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
alter table "legal_demo"."main"."acris_clean" rename to "acris_clean__dbt_backup"
[0m17:58:51.711786 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:58:51.719041 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m17:58:51.721237 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
alter table "legal_demo"."main"."acris_clean__dbt_tmp" rename to "acris_clean"
[0m17:58:51.723808 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:58:51.746767 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: COMMIT
[0m17:58:51.749169 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m17:58:51.751003 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: COMMIT
[0m17:58:51.833153 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:58:51.842316 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m17:58:51.844683 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
drop table if exists "legal_demo"."main"."acris_clean__dbt_backup" cascade
[0m17:58:51.854733 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:58:51.858338 [debug] [Thread-1 (]: Timing info for model.legal_demo.acris_cases (execute): 17:58:48.588286 => 17:58:51.857999
[0m17:58:51.860476 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: Close
[0m17:58:51.933337 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c6e853e-b267-42be-a3e9-321b8776a5c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72793278eb90>]}
[0m17:58:51.936238 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main.acris_clean ............................. [[32mOK[0m in 3.37s]
[0m17:58:51.938382 [debug] [Thread-1 (]: Finished running node model.legal_demo.acris_cases
[0m17:58:51.942620 [debug] [MainThread]: Using duckdb connection "master"
[0m17:58:51.944153 [debug] [MainThread]: On master: BEGIN
[0m17:58:51.945505 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:58:51.970446 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:58:51.972370 [debug] [MainThread]: On master: COMMIT
[0m17:58:51.973810 [debug] [MainThread]: Using duckdb connection "master"
[0m17:58:51.975267 [debug] [MainThread]: On master: COMMIT
[0m17:58:51.977117 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:58:51.978528 [debug] [MainThread]: On master: Close
[0m17:58:51.986330 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:58:51.988550 [debug] [MainThread]: Connection 'list_legal_demo_main' was properly closed.
[0m17:58:51.990137 [debug] [MainThread]: Connection 'model.legal_demo.acris_cases' was properly closed.
[0m17:58:51.991810 [info ] [MainThread]: 
[0m17:58:51.993554 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.76 seconds (3.76s).
[0m17:58:51.995904 [debug] [MainThread]: Command end result
[0m17:58:52.037973 [info ] [MainThread]: 
[0m17:58:52.040252 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:58:52.042194 [info ] [MainThread]: 
[0m17:58:52.044635 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:58:52.047576 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.6138616, "process_user_time": 8.497501, "process_kernel_time": 1.769813, "process_mem_max_rss": "297724", "process_out_blocks": "8384", "process_in_blocks": "0"}
[0m17:58:52.049760 [debug] [MainThread]: Command `dbt run` succeeded at 17:58:52.049548 after 4.62 seconds
[0m17:58:52.051598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72793c520f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72793cd02050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727940ff5850>]}
[0m17:58:52.053285 [debug] [MainThread]: Flushing usage events
[0m17:59:49.677069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c9886623c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c9886661e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c9885f2b290>]}


============================== 17:59:49.686216 | 8e29e82d-bb91-4db3-80cf-5c92aa42687b ==============================
[0m17:59:49.686216 [info ] [MainThread]: Running with dbt=1.7.4
[0m17:59:49.688225 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:59:50.070904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8e29e82d-bb91-4db3-80cf-5c92aa42687b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c9886662310>]}
[0m17:59:50.169794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8e29e82d-bb91-4db3-80cf-5c92aa42687b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c9886d513d0>]}
[0m17:59:50.172777 [info ] [MainThread]: Registered adapter: duckdb=1.7.4
[0m17:59:50.195526 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m17:59:50.274353 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:59:50.276696 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:59:50.284495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8e29e82d-bb91-4db3-80cf-5c92aa42687b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c987cce8990>]}
[0m17:59:50.331899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8e29e82d-bb91-4db3-80cf-5c92aa42687b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c987cdc5010>]}
[0m17:59:50.333882 [info ] [MainThread]: Found 1 model, 0 sources, 0 exposures, 0 metrics, 394 macros, 0 groups, 0 semantic models
[0m17:59:50.335850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8e29e82d-bb91-4db3-80cf-5c92aa42687b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c9886392e10>]}
[0m17:59:50.339422 [info ] [MainThread]: 
[0m17:59:50.341846 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:59:50.345093 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_legal_demo'
[0m17:59:50.361665 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo"
[0m17:59:50.363742 [debug] [ThreadPool]: On list_legal_demo: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"legal_demo"'
    
  
  
[0m17:59:50.365356 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:59:50.399138 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:59:50.403012 [debug] [ThreadPool]: On list_legal_demo: Close
[0m17:59:50.411805 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_legal_demo, now create_legal_demo_main)
[0m17:59:50.413677 [debug] [ThreadPool]: Creating schema "database: "legal_demo"
schema: "main"
"
[0m17:59:50.423611 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m17:59:50.425388 [debug] [ThreadPool]: On create_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "create_legal_demo_main"} */

    
        select type from duckdb_databases()
        where database_name='legal_demo'
        and type='sqlite'
    
  
[0m17:59:50.427132 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:59:50.454676 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:59:50.457395 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m17:59:50.458991 [debug] [ThreadPool]: On create_legal_demo_main: BEGIN
[0m17:59:50.460860 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:59:50.462389 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m17:59:50.463799 [debug] [ThreadPool]: On create_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "create_legal_demo_main"} */

    
    
        create schema if not exists "legal_demo"."main"
    
[0m17:59:50.465776 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:59:50.467865 [debug] [ThreadPool]: On create_legal_demo_main: COMMIT
[0m17:59:50.469513 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m17:59:50.471103 [debug] [ThreadPool]: On create_legal_demo_main: COMMIT
[0m17:59:50.473646 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:59:50.475253 [debug] [ThreadPool]: On create_legal_demo_main: Close
[0m17:59:50.485050 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_legal_demo_main, now list_legal_demo_main)
[0m17:59:50.492643 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo_main"
[0m17:59:50.495231 [debug] [ThreadPool]: On list_legal_demo_main: BEGIN
[0m17:59:50.496668 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:59:50.519439 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:59:50.521388 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo_main"
[0m17:59:50.523463 [debug] [ThreadPool]: On list_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo_main"} */
select
      'legal_demo' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'legal_demo'
  
[0m17:59:50.550113 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:59:50.561927 [debug] [ThreadPool]: On list_legal_demo_main: ROLLBACK
[0m17:59:50.564336 [debug] [ThreadPool]: Failed to rollback 'list_legal_demo_main'
[0m17:59:50.565780 [debug] [ThreadPool]: On list_legal_demo_main: Close
[0m17:59:50.572930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8e29e82d-bb91-4db3-80cf-5c92aa42687b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c9885f88b90>]}
[0m17:59:50.574741 [debug] [MainThread]: Using duckdb connection "master"
[0m17:59:50.576343 [debug] [MainThread]: On master: BEGIN
[0m17:59:50.578670 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:59:50.601437 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:59:50.603947 [debug] [MainThread]: On master: COMMIT
[0m17:59:50.605497 [debug] [MainThread]: Using duckdb connection "master"
[0m17:59:50.607052 [debug] [MainThread]: On master: COMMIT
[0m17:59:50.608712 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:59:50.610125 [debug] [MainThread]: On master: Close
[0m17:59:50.615313 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:59:50.617180 [info ] [MainThread]: 
[0m17:59:50.629494 [debug] [Thread-1 (]: Began running node model.legal_demo.acris_cases
[0m17:59:50.631625 [info ] [Thread-1 (]: 1 of 1 START sql table model main.acris_clean .................................. [RUN]
[0m17:59:50.633815 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.legal_demo.acris_cases'
[0m17:59:50.635543 [debug] [Thread-1 (]: Began compiling node model.legal_demo.acris_cases
[0m17:59:50.644746 [debug] [Thread-1 (]: Writing injected SQL for node "model.legal_demo.acris_cases"
[0m17:59:50.659602 [debug] [Thread-1 (]: Timing info for model.legal_demo.acris_cases (compile): 17:59:50.636816 => 17:59:50.658992
[0m17:59:50.661631 [debug] [Thread-1 (]: Began executing node model.legal_demo.acris_cases
[0m17:59:50.706893 [debug] [Thread-1 (]: Writing runtime sql for node "model.legal_demo.acris_cases"
[0m17:59:50.759188 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m17:59:50.761118 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: BEGIN
[0m17:59:50.763308 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:59:50.785837 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:59:50.787748 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m17:59:50.789397 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */

  
    
    

    create  table
      "legal_demo"."main"."acris_clean__dbt_tmp"
  
    as (
      

SELECT *
FROM read_csv_auto('/opt/airflow/data/first_500k_acris.csv', header=True, delim=',')
    );
  
  
[0m17:59:53.268460 [debug] [Thread-1 (]: SQL status: OK in 2.0 seconds
[0m17:59:53.279450 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m17:59:53.281370 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
alter table "legal_demo"."main"."acris_clean" rename to "acris_clean__dbt_backup"
[0m17:59:53.284528 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:59:53.289863 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m17:59:53.291707 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
alter table "legal_demo"."main"."acris_clean__dbt_tmp" rename to "acris_clean"
[0m17:59:53.294131 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:59:53.334997 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: COMMIT
[0m17:59:53.348429 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m17:59:53.351174 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: COMMIT
[0m17:59:53.384403 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:59:53.396198 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m17:59:53.398558 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
drop table if exists "legal_demo"."main"."acris_clean__dbt_backup" cascade
[0m17:59:53.408568 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:59:53.412819 [debug] [Thread-1 (]: Timing info for model.legal_demo.acris_cases (execute): 17:59:50.663805 => 17:59:53.412418
[0m17:59:53.414841 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: Close
[0m17:59:53.492516 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e29e82d-bb91-4db3-80cf-5c92aa42687b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c987cba0a90>]}
[0m17:59:53.495520 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main.acris_clean ............................. [[32mOK[0m in 2.86s]
[0m17:59:53.497993 [debug] [Thread-1 (]: Finished running node model.legal_demo.acris_cases
[0m17:59:53.502576 [debug] [MainThread]: Using duckdb connection "master"
[0m17:59:53.503961 [debug] [MainThread]: On master: BEGIN
[0m17:59:53.505361 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:59:53.526476 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:59:53.528503 [debug] [MainThread]: On master: COMMIT
[0m17:59:53.530012 [debug] [MainThread]: Using duckdb connection "master"
[0m17:59:53.531495 [debug] [MainThread]: On master: COMMIT
[0m17:59:53.533690 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:59:53.535141 [debug] [MainThread]: On master: Close
[0m17:59:53.540249 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:59:53.541828 [debug] [MainThread]: Connection 'list_legal_demo_main' was properly closed.
[0m17:59:53.543381 [debug] [MainThread]: Connection 'model.legal_demo.acris_cases' was properly closed.
[0m17:59:53.545025 [info ] [MainThread]: 
[0m17:59:53.546713 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.20 seconds (3.20s).
[0m17:59:53.548532 [debug] [MainThread]: Command end result
[0m17:59:53.581333 [info ] [MainThread]: 
[0m17:59:53.583048 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:59:53.584470 [info ] [MainThread]: 
[0m17:59:53.585955 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:59:53.588376 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.9793577, "process_user_time": 7.396222, "process_kernel_time": 1.233379, "process_mem_max_rss": "298436", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:59:53.590025 [debug] [MainThread]: Command `dbt run` succeeded at 17:59:53.589832 after 3.98 seconds
[0m17:59:53.591569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c9885fddd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c988afea250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c988ad52b90>]}
[0m17:59:53.592881 [debug] [MainThread]: Flushing usage events
[0m18:00:26.514101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b137be14050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b137be66790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b137ba29750>]}


============================== 18:00:26.522890 | 7cb06f41-b75e-4ab2-882c-159a58e13226 ==============================
[0m18:00:26.522890 [info ] [MainThread]: Running with dbt=1.7.4
[0m18:00:26.525004 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:00:26.947261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7cb06f41-b75e-4ab2-882c-159a58e13226', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b137b723b90>]}
[0m18:00:27.061441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7cb06f41-b75e-4ab2-882c-159a58e13226', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b137b723cd0>]}
[0m18:00:27.064373 [info ] [MainThread]: Registered adapter: duckdb=1.7.4
[0m18:00:27.087437 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m18:00:27.169397 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:00:27.171967 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:00:27.179896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7cb06f41-b75e-4ab2-882c-159a58e13226', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1371cf90d0>]}
[0m18:00:27.226942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7cb06f41-b75e-4ab2-882c-159a58e13226', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1371f9ced0>]}
[0m18:00:27.228776 [info ] [MainThread]: Found 1 model, 0 sources, 0 exposures, 0 metrics, 394 macros, 0 groups, 0 semantic models
[0m18:00:27.230286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7cb06f41-b75e-4ab2-882c-159a58e13226', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b137b733c50>]}
[0m18:00:27.233952 [info ] [MainThread]: 
[0m18:00:27.236075 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:00:27.239801 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_legal_demo'
[0m18:00:27.255632 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo"
[0m18:00:27.258022 [debug] [ThreadPool]: On list_legal_demo: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"legal_demo"'
    
  
  
[0m18:00:27.259988 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:00:27.293453 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:00:27.297210 [debug] [ThreadPool]: On list_legal_demo: Close
[0m18:00:27.305523 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_legal_demo, now create_legal_demo_main)
[0m18:00:27.307872 [debug] [ThreadPool]: Creating schema "database: "legal_demo"
schema: "main"
"
[0m18:00:27.317004 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m18:00:27.318991 [debug] [ThreadPool]: On create_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "create_legal_demo_main"} */

    
        select type from duckdb_databases()
        where database_name='legal_demo'
        and type='sqlite'
    
  
[0m18:00:27.320925 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:00:27.347492 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:00:27.350222 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m18:00:27.351964 [debug] [ThreadPool]: On create_legal_demo_main: BEGIN
[0m18:00:27.354037 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:00:27.355745 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m18:00:27.357189 [debug] [ThreadPool]: On create_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "create_legal_demo_main"} */

    
    
        create schema if not exists "legal_demo"."main"
    
[0m18:00:27.359197 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:00:27.361365 [debug] [ThreadPool]: On create_legal_demo_main: COMMIT
[0m18:00:27.362892 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m18:00:27.364298 [debug] [ThreadPool]: On create_legal_demo_main: COMMIT
[0m18:00:27.367008 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:00:27.368418 [debug] [ThreadPool]: On create_legal_demo_main: Close
[0m18:00:27.378295 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_legal_demo_main, now list_legal_demo_main)
[0m18:00:27.385970 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo_main"
[0m18:00:27.388023 [debug] [ThreadPool]: On list_legal_demo_main: BEGIN
[0m18:00:27.389529 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:00:27.411220 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:00:27.413141 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo_main"
[0m18:00:27.414641 [debug] [ThreadPool]: On list_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo_main"} */
select
      'legal_demo' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'legal_demo'
  
[0m18:00:27.442497 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:00:27.451177 [debug] [ThreadPool]: On list_legal_demo_main: ROLLBACK
[0m18:00:27.453486 [debug] [ThreadPool]: Failed to rollback 'list_legal_demo_main'
[0m18:00:27.455266 [debug] [ThreadPool]: On list_legal_demo_main: Close
[0m18:00:27.462056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7cb06f41-b75e-4ab2-882c-159a58e13226', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1371d008d0>]}
[0m18:00:27.463813 [debug] [MainThread]: Using duckdb connection "master"
[0m18:00:27.465298 [debug] [MainThread]: On master: BEGIN
[0m18:00:27.467098 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:00:27.489447 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m18:00:27.491139 [debug] [MainThread]: On master: COMMIT
[0m18:00:27.492668 [debug] [MainThread]: Using duckdb connection "master"
[0m18:00:27.494585 [debug] [MainThread]: On master: COMMIT
[0m18:00:27.496539 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m18:00:27.545576 [debug] [MainThread]: On master: Close
[0m18:00:27.553571 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:00:27.555553 [info ] [MainThread]: 
[0m18:00:27.570402 [debug] [Thread-1 (]: Began running node model.legal_demo.acris_cases
[0m18:00:27.572133 [info ] [Thread-1 (]: 1 of 1 START sql table model main.acris_clean .................................. [RUN]
[0m18:00:27.574294 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.legal_demo.acris_cases'
[0m18:00:27.575748 [debug] [Thread-1 (]: Began compiling node model.legal_demo.acris_cases
[0m18:00:27.585400 [debug] [Thread-1 (]: Writing injected SQL for node "model.legal_demo.acris_cases"
[0m18:00:27.596197 [debug] [Thread-1 (]: Timing info for model.legal_demo.acris_cases (compile): 18:00:27.577200 => 18:00:27.595723
[0m18:00:27.597664 [debug] [Thread-1 (]: Began executing node model.legal_demo.acris_cases
[0m18:00:27.637520 [debug] [Thread-1 (]: Writing runtime sql for node "model.legal_demo.acris_cases"
[0m18:00:27.650596 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m18:00:27.652419 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: BEGIN
[0m18:00:27.654476 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:00:27.678402 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:00:27.680136 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m18:00:27.681551 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */

  
    
    

    create  table
      "legal_demo"."main"."acris_clean__dbt_tmp"
  
    as (
      

SELECT *
FROM read_csv_auto('/opt/airflow/data/first_500k_acris.csv', header=True, delim=',')
    );
  
  
[0m18:00:30.081475 [debug] [Thread-1 (]: SQL status: OK in 2.0 seconds
[0m18:00:30.091239 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m18:00:30.093587 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
alter table "legal_demo"."main"."acris_clean" rename to "acris_clean__dbt_backup"
[0m18:00:30.096672 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:00:30.101561 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m18:00:30.103757 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
alter table "legal_demo"."main"."acris_clean__dbt_tmp" rename to "acris_clean"
[0m18:00:30.106331 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:00:30.130605 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: COMMIT
[0m18:00:30.132546 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m18:00:30.134591 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: COMMIT
[0m18:00:30.207978 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:00:30.215560 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m18:00:30.218069 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
drop table if exists "legal_demo"."main"."acris_clean__dbt_backup" cascade
[0m18:00:30.227403 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:00:30.231312 [debug] [Thread-1 (]: Timing info for model.legal_demo.acris_cases (execute): 18:00:27.598663 => 18:00:30.230980
[0m18:00:30.233555 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: Close
[0m18:00:30.306327 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7cb06f41-b75e-4ab2-882c-159a58e13226', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1371db8a50>]}
[0m18:00:30.308895 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main.acris_clean ............................. [[32mOK[0m in 2.73s]
[0m18:00:30.311042 [debug] [Thread-1 (]: Finished running node model.legal_demo.acris_cases
[0m18:00:30.314929 [debug] [MainThread]: Using duckdb connection "master"
[0m18:00:30.316666 [debug] [MainThread]: On master: BEGIN
[0m18:00:30.318338 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:00:30.340564 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m18:00:30.342448 [debug] [MainThread]: On master: COMMIT
[0m18:00:30.343915 [debug] [MainThread]: Using duckdb connection "master"
[0m18:00:30.345316 [debug] [MainThread]: On master: COMMIT
[0m18:00:30.347213 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m18:00:30.348679 [debug] [MainThread]: On master: Close
[0m18:00:30.353591 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:00:30.355160 [debug] [MainThread]: Connection 'list_legal_demo_main' was properly closed.
[0m18:00:30.356830 [debug] [MainThread]: Connection 'model.legal_demo.acris_cases' was properly closed.
[0m18:00:30.358400 [info ] [MainThread]: 
[0m18:00:30.360020 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.12 seconds (3.12s).
[0m18:00:30.363140 [debug] [MainThread]: Command end result
[0m18:00:30.398546 [info ] [MainThread]: 
[0m18:00:30.400810 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:00:30.402543 [info ] [MainThread]: 
[0m18:00:30.404272 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:00:30.406804 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.9561198, "process_user_time": 7.565114, "process_kernel_time": 1.31375, "process_mem_max_rss": "299000", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:00:30.408552 [debug] [MainThread]: Command `dbt run` succeeded at 18:00:30.408356 after 3.96 seconds
[0m18:00:30.410138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b137ba39f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b137ba39e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b138058ee10>]}
[0m18:00:30.411644 [debug] [MainThread]: Flushing usage events
[0m18:01:03.936564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73321db59750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73321b271750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73321b130950>]}


============================== 18:01:03.946143 | 6d351646-b954-4a6e-86e5-ee7ed003d228 ==============================
[0m18:01:03.946143 [info ] [MainThread]: Running with dbt=1.7.4
[0m18:01:03.948103 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:01:04.366253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6d351646-b954-4a6e-86e5-ee7ed003d228', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73321b1fbb10>]}
[0m18:01:04.475785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6d351646-b954-4a6e-86e5-ee7ed003d228', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x733217c52f90>]}
[0m18:01:04.478552 [info ] [MainThread]: Registered adapter: duckdb=1.7.4
[0m18:01:04.500794 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m18:01:04.592308 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:01:04.594321 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:01:04.602662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6d351646-b954-4a6e-86e5-ee7ed003d228', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x733217c97fd0>]}
[0m18:01:04.652631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6d351646-b954-4a6e-86e5-ee7ed003d228', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x733211da24d0>]}
[0m18:01:04.654351 [info ] [MainThread]: Found 1 model, 0 sources, 0 exposures, 0 metrics, 394 macros, 0 groups, 0 semantic models
[0m18:01:04.656150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6d351646-b954-4a6e-86e5-ee7ed003d228', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x733211d4e890>]}
[0m18:01:04.659274 [info ] [MainThread]: 
[0m18:01:04.661772 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:01:04.664930 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_legal_demo'
[0m18:01:04.680672 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo"
[0m18:01:04.682899 [debug] [ThreadPool]: On list_legal_demo: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"legal_demo"'
    
  
  
[0m18:01:04.684717 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:01:04.719320 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:01:04.722848 [debug] [ThreadPool]: On list_legal_demo: Close
[0m18:01:04.732193 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_legal_demo, now create_legal_demo_main)
[0m18:01:04.734435 [debug] [ThreadPool]: Creating schema "database: "legal_demo"
schema: "main"
"
[0m18:01:04.743756 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m18:01:04.745902 [debug] [ThreadPool]: On create_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "create_legal_demo_main"} */

    
        select type from duckdb_databases()
        where database_name='legal_demo'
        and type='sqlite'
    
  
[0m18:01:04.747574 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:01:04.774024 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:01:04.776762 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m18:01:04.778787 [debug] [ThreadPool]: On create_legal_demo_main: BEGIN
[0m18:01:04.780965 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:01:04.782717 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m18:01:04.784422 [debug] [ThreadPool]: On create_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "create_legal_demo_main"} */

    
    
        create schema if not exists "legal_demo"."main"
    
[0m18:01:04.786650 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:01:04.789053 [debug] [ThreadPool]: On create_legal_demo_main: COMMIT
[0m18:01:04.791026 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m18:01:04.792721 [debug] [ThreadPool]: On create_legal_demo_main: COMMIT
[0m18:01:04.795635 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:01:04.797264 [debug] [ThreadPool]: On create_legal_demo_main: Close
[0m18:01:04.807601 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_legal_demo_main, now list_legal_demo_main)
[0m18:01:04.814999 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo_main"
[0m18:01:04.817160 [debug] [ThreadPool]: On list_legal_demo_main: BEGIN
[0m18:01:04.819512 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:01:04.850374 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:01:04.852477 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo_main"
[0m18:01:04.854084 [debug] [ThreadPool]: On list_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo_main"} */
select
      'legal_demo' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'legal_demo'
  
[0m18:01:04.881326 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:01:04.892057 [debug] [ThreadPool]: On list_legal_demo_main: ROLLBACK
[0m18:01:04.894723 [debug] [ThreadPool]: Failed to rollback 'list_legal_demo_main'
[0m18:01:04.896856 [debug] [ThreadPool]: On list_legal_demo_main: Close
[0m18:01:04.904281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6d351646-b954-4a6e-86e5-ee7ed003d228', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73321af033d0>]}
[0m18:01:04.905973 [debug] [MainThread]: Using duckdb connection "master"
[0m18:01:04.907530 [debug] [MainThread]: On master: BEGIN
[0m18:01:04.908969 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:01:04.937258 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m18:01:04.939143 [debug] [MainThread]: On master: COMMIT
[0m18:01:04.940402 [debug] [MainThread]: Using duckdb connection "master"
[0m18:01:04.943943 [debug] [MainThread]: On master: COMMIT
[0m18:01:04.946384 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m18:01:04.948552 [debug] [MainThread]: On master: Close
[0m18:01:04.954011 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:01:04.955836 [info ] [MainThread]: 
[0m18:01:04.969134 [debug] [Thread-1 (]: Began running node model.legal_demo.acris_cases
[0m18:01:04.971136 [info ] [Thread-1 (]: 1 of 1 START sql table model main.acris_clean .................................. [RUN]
[0m18:01:04.973179 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.legal_demo.acris_cases'
[0m18:01:04.974775 [debug] [Thread-1 (]: Began compiling node model.legal_demo.acris_cases
[0m18:01:04.983710 [debug] [Thread-1 (]: Writing injected SQL for node "model.legal_demo.acris_cases"
[0m18:01:04.996184 [debug] [Thread-1 (]: Timing info for model.legal_demo.acris_cases (compile): 18:01:04.975989 => 18:01:04.995805
[0m18:01:04.997826 [debug] [Thread-1 (]: Began executing node model.legal_demo.acris_cases
[0m18:01:05.036819 [debug] [Thread-1 (]: Writing runtime sql for node "model.legal_demo.acris_cases"
[0m18:01:05.050027 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m18:01:05.051628 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: BEGIN
[0m18:01:05.052974 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:01:05.075847 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:01:05.077547 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m18:01:05.079187 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */

  
    
    

    create  table
      "legal_demo"."main"."acris_clean__dbt_tmp"
  
    as (
      

SELECT *
FROM read_csv_auto('/opt/airflow/data/first_500k_acris.csv', header=True, delim=',')
    );
  
  
[0m18:01:07.526894 [debug] [Thread-1 (]: SQL status: OK in 2.0 seconds
[0m18:01:07.544039 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m18:01:07.546036 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
alter table "legal_demo"."main"."acris_clean" rename to "acris_clean__dbt_backup"
[0m18:01:07.549666 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:01:07.554425 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m18:01:07.556571 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
alter table "legal_demo"."main"."acris_clean__dbt_tmp" rename to "acris_clean"
[0m18:01:07.558738 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:01:07.583488 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: COMMIT
[0m18:01:07.585735 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m18:01:07.587485 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: COMMIT
[0m18:01:07.656067 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:01:07.664194 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m18:01:07.666438 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
drop table if exists "legal_demo"."main"."acris_clean__dbt_backup" cascade
[0m18:01:07.675115 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:01:07.679251 [debug] [Thread-1 (]: Timing info for model.legal_demo.acris_cases (execute): 18:01:04.999108 => 18:01:07.678891
[0m18:01:07.681335 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: Close
[0m18:01:07.748855 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d351646-b954-4a6e-86e5-ee7ed003d228', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x733211dec090>]}
[0m18:01:07.751801 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main.acris_clean ............................. [[32mOK[0m in 2.78s]
[0m18:01:07.754247 [debug] [Thread-1 (]: Finished running node model.legal_demo.acris_cases
[0m18:01:07.760505 [debug] [MainThread]: Using duckdb connection "master"
[0m18:01:07.762237 [debug] [MainThread]: On master: BEGIN
[0m18:01:07.763843 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:01:07.793399 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m18:01:07.795255 [debug] [MainThread]: On master: COMMIT
[0m18:01:07.796715 [debug] [MainThread]: Using duckdb connection "master"
[0m18:01:07.798216 [debug] [MainThread]: On master: COMMIT
[0m18:01:07.800151 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m18:01:07.801574 [debug] [MainThread]: On master: Close
[0m18:01:07.806840 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:01:07.808516 [debug] [MainThread]: Connection 'list_legal_demo_main' was properly closed.
[0m18:01:07.809993 [debug] [MainThread]: Connection 'model.legal_demo.acris_cases' was properly closed.
[0m18:01:07.811808 [info ] [MainThread]: 
[0m18:01:07.813535 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.15 seconds (3.15s).
[0m18:01:07.815767 [debug] [MainThread]: Command end result
[0m18:01:07.858920 [info ] [MainThread]: 
[0m18:01:07.861266 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:01:07.863325 [info ] [MainThread]: 
[0m18:01:07.865433 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:01:07.869114 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.006723, "process_user_time": 7.704422, "process_kernel_time": 1.326007, "process_mem_max_rss": "296412", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:01:07.871874 [debug] [MainThread]: Command `dbt run` succeeded at 18:01:07.871569 after 4.01 seconds
[0m18:01:07.873864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73321b597fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73321fd3ad10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73321fd3b350>]}
[0m18:01:07.875574 [debug] [MainThread]: Flushing usage events
[0m18:01:39.714169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c6ab5f2ea90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c6ab636bc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c6ab6a41410>]}


============================== 18:01:39.722954 | 1c936b5e-612a-4b1e-a7a4-65efeedae730 ==============================
[0m18:01:39.722954 [info ] [MainThread]: Running with dbt=1.7.4
[0m18:01:39.725153 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:01:40.083593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1c936b5e-612a-4b1e-a7a4-65efeedae730', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c6ab5f3a350>]}
[0m18:01:40.181244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1c936b5e-612a-4b1e-a7a4-65efeedae730', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c6ab5f3be10>]}
[0m18:01:40.184014 [info ] [MainThread]: Registered adapter: duckdb=1.7.4
[0m18:01:40.207331 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m18:01:40.286197 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:01:40.289534 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:01:40.297293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1c936b5e-612a-4b1e-a7a4-65efeedae730', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c6ab5f9b990>]}
[0m18:01:40.346716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1c936b5e-612a-4b1e-a7a4-65efeedae730', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c6ab5fa7fd0>]}
[0m18:01:40.348641 [info ] [MainThread]: Found 1 model, 0 sources, 0 exposures, 0 metrics, 394 macros, 0 groups, 0 semantic models
[0m18:01:40.350326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1c936b5e-612a-4b1e-a7a4-65efeedae730', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c6aacd55610>]}
[0m18:01:40.353906 [info ] [MainThread]: 
[0m18:01:40.356185 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:01:40.359219 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_legal_demo'
[0m18:01:40.374985 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo"
[0m18:01:40.377140 [debug] [ThreadPool]: On list_legal_demo: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"legal_demo"'
    
  
  
[0m18:01:40.379016 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:01:40.413480 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:01:40.417293 [debug] [ThreadPool]: On list_legal_demo: Close
[0m18:01:40.426749 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_legal_demo, now create_legal_demo_main)
[0m18:01:40.429252 [debug] [ThreadPool]: Creating schema "database: "legal_demo"
schema: "main"
"
[0m18:01:40.438299 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m18:01:40.440566 [debug] [ThreadPool]: On create_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "create_legal_demo_main"} */

    
        select type from duckdb_databases()
        where database_name='legal_demo'
        and type='sqlite'
    
  
[0m18:01:40.442523 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:01:40.469236 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:01:40.472019 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m18:01:40.473829 [debug] [ThreadPool]: On create_legal_demo_main: BEGIN
[0m18:01:40.475615 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:01:40.477150 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m18:01:40.478662 [debug] [ThreadPool]: On create_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "create_legal_demo_main"} */

    
    
        create schema if not exists "legal_demo"."main"
    
[0m18:01:40.481173 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:01:40.483302 [debug] [ThreadPool]: On create_legal_demo_main: COMMIT
[0m18:01:40.485220 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m18:01:40.486896 [debug] [ThreadPool]: On create_legal_demo_main: COMMIT
[0m18:01:40.489616 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:01:40.491232 [debug] [ThreadPool]: On create_legal_demo_main: Close
[0m18:01:40.500896 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_legal_demo_main, now list_legal_demo_main)
[0m18:01:40.508190 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo_main"
[0m18:01:40.510584 [debug] [ThreadPool]: On list_legal_demo_main: BEGIN
[0m18:01:40.512090 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:01:40.535719 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:01:40.537540 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo_main"
[0m18:01:40.539053 [debug] [ThreadPool]: On list_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo_main"} */
select
      'legal_demo' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'legal_demo'
  
[0m18:01:40.564757 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:01:40.571591 [debug] [ThreadPool]: On list_legal_demo_main: ROLLBACK
[0m18:01:40.574520 [debug] [ThreadPool]: Failed to rollback 'list_legal_demo_main'
[0m18:01:40.576309 [debug] [ThreadPool]: On list_legal_demo_main: Close
[0m18:01:40.582777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1c936b5e-612a-4b1e-a7a4-65efeedae730', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c6aacd55610>]}
[0m18:01:40.584808 [debug] [MainThread]: Using duckdb connection "master"
[0m18:01:40.586286 [debug] [MainThread]: On master: BEGIN
[0m18:01:40.587734 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:01:40.610936 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m18:01:40.612576 [debug] [MainThread]: On master: COMMIT
[0m18:01:40.614034 [debug] [MainThread]: Using duckdb connection "master"
[0m18:01:40.615582 [debug] [MainThread]: On master: COMMIT
[0m18:01:40.617632 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m18:01:40.619080 [debug] [MainThread]: On master: Close
[0m18:01:40.624197 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:01:40.625989 [info ] [MainThread]: 
[0m18:01:40.638571 [debug] [Thread-1 (]: Began running node model.legal_demo.acris_cases
[0m18:01:40.640724 [info ] [Thread-1 (]: 1 of 1 START sql table model main.acris_clean .................................. [RUN]
[0m18:01:40.642855 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.legal_demo.acris_cases'
[0m18:01:40.644244 [debug] [Thread-1 (]: Began compiling node model.legal_demo.acris_cases
[0m18:01:40.653189 [debug] [Thread-1 (]: Writing injected SQL for node "model.legal_demo.acris_cases"
[0m18:01:40.665918 [debug] [Thread-1 (]: Timing info for model.legal_demo.acris_cases (compile): 18:01:40.645487 => 18:01:40.665462
[0m18:01:40.667511 [debug] [Thread-1 (]: Began executing node model.legal_demo.acris_cases
[0m18:01:40.707545 [debug] [Thread-1 (]: Writing runtime sql for node "model.legal_demo.acris_cases"
[0m18:01:40.720831 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m18:01:40.722865 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: BEGIN
[0m18:01:40.724782 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:01:40.751298 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:01:40.753155 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m18:01:40.754746 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */

  
    
    

    create  table
      "legal_demo"."main"."acris_clean__dbt_tmp"
  
    as (
      

SELECT *
FROM read_csv_auto('/opt/airflow/data/first_500k_acris.csv', header=True, delim=',')
    );
  
  
[0m18:01:43.138851 [debug] [Thread-1 (]: SQL status: OK in 2.0 seconds
[0m18:01:43.157580 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m18:01:43.160304 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
alter table "legal_demo"."main"."acris_clean" rename to "acris_clean__dbt_backup"
[0m18:01:43.163138 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:01:43.167868 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m18:01:43.170153 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
alter table "legal_demo"."main"."acris_clean__dbt_tmp" rename to "acris_clean"
[0m18:01:43.172590 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:01:43.197207 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: COMMIT
[0m18:01:43.199491 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m18:01:43.201340 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: COMMIT
[0m18:01:43.276408 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:01:43.284560 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m18:01:43.286731 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
drop table if exists "legal_demo"."main"."acris_clean__dbt_backup" cascade
[0m18:01:43.295564 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:01:43.299874 [debug] [Thread-1 (]: Timing info for model.legal_demo.acris_cases (execute): 18:01:40.668775 => 18:01:43.299207
[0m18:01:43.301982 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: Close
[0m18:01:43.380358 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c936b5e-612a-4b1e-a7a4-65efeedae730', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c6aacc82f90>]}
[0m18:01:43.384741 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main.acris_clean ............................. [[32mOK[0m in 2.74s]
[0m18:01:43.389563 [debug] [Thread-1 (]: Finished running node model.legal_demo.acris_cases
[0m18:01:43.396422 [debug] [MainThread]: Using duckdb connection "master"
[0m18:01:43.398643 [debug] [MainThread]: On master: BEGIN
[0m18:01:43.400766 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:01:43.432030 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m18:01:43.434347 [debug] [MainThread]: On master: COMMIT
[0m18:01:43.436005 [debug] [MainThread]: Using duckdb connection "master"
[0m18:01:43.437706 [debug] [MainThread]: On master: COMMIT
[0m18:01:43.439687 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m18:01:43.441627 [debug] [MainThread]: On master: Close
[0m18:01:43.448003 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:01:43.449960 [debug] [MainThread]: Connection 'list_legal_demo_main' was properly closed.
[0m18:01:43.451564 [debug] [MainThread]: Connection 'model.legal_demo.acris_cases' was properly closed.
[0m18:01:43.453227 [info ] [MainThread]: 
[0m18:01:43.455123 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.10 seconds (3.10s).
[0m18:01:43.457628 [debug] [MainThread]: Command end result
[0m18:01:43.504454 [info ] [MainThread]: 
[0m18:01:43.507021 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:01:43.509339 [info ] [MainThread]: 
[0m18:01:43.512138 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:01:43.516335 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.870349, "process_user_time": 7.528982, "process_kernel_time": 1.250846, "process_mem_max_rss": "298280", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:01:43.520951 [debug] [MainThread]: Command `dbt run` succeeded at 18:01:43.520638 after 3.88 seconds
[0m18:01:43.523135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c6abab94dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c6abad574d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c6abad268d0>]}
[0m18:01:43.524994 [debug] [MainThread]: Flushing usage events
[0m22:40:32.719656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x716b2b759150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x716b2bb02f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x716b2bb008d0>]}


============================== 22:40:32.729062 | 0e83dec0-939c-40e9-8db8-9c4fcfc4147b ==============================
[0m22:40:32.729062 [info ] [MainThread]: Running with dbt=1.7.4
[0m22:40:32.731323 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:40:33.251253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0e83dec0-939c-40e9-8db8-9c4fcfc4147b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x716b2bb12f10>]}
[0m22:40:33.351363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0e83dec0-939c-40e9-8db8-9c4fcfc4147b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x716b2bb12f10>]}
[0m22:40:33.354576 [info ] [MainThread]: Registered adapter: duckdb=1.7.4
[0m22:40:33.373846 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m22:40:33.614964 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:40:33.617488 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:40:33.627115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0e83dec0-939c-40e9-8db8-9c4fcfc4147b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x716b22166250>]}
[0m22:40:33.724941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0e83dec0-939c-40e9-8db8-9c4fcfc4147b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x716b22204790>]}
[0m22:40:33.727070 [info ] [MainThread]: Found 1 model, 0 sources, 0 exposures, 0 metrics, 394 macros, 0 groups, 0 semantic models
[0m22:40:33.728865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0e83dec0-939c-40e9-8db8-9c4fcfc4147b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x716b2eda1910>]}
[0m22:40:33.732446 [info ] [MainThread]: 
[0m22:40:33.735273 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:40:33.738112 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_legal_demo'
[0m22:40:33.754848 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo"
[0m22:40:33.756797 [debug] [ThreadPool]: On list_legal_demo: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"legal_demo"'
    
  
  
[0m22:40:33.758395 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:40:33.828921 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:40:33.834085 [debug] [ThreadPool]: On list_legal_demo: Close
[0m22:40:33.844673 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_legal_demo, now create_legal_demo_main)
[0m22:40:33.846868 [debug] [ThreadPool]: Creating schema "database: "legal_demo"
schema: "main"
"
[0m22:40:33.855678 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m22:40:33.857852 [debug] [ThreadPool]: On create_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "create_legal_demo_main"} */

    
        select type from duckdb_databases()
        where database_name='legal_demo'
        and type='sqlite'
    
  
[0m22:40:33.859868 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:40:33.888775 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:40:33.892035 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m22:40:33.894022 [debug] [ThreadPool]: On create_legal_demo_main: BEGIN
[0m22:40:33.896020 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:40:33.897499 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m22:40:33.898822 [debug] [ThreadPool]: On create_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "create_legal_demo_main"} */

    
    
        create schema if not exists "legal_demo"."main"
    
[0m22:40:33.901642 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:40:33.903871 [debug] [ThreadPool]: On create_legal_demo_main: COMMIT
[0m22:40:33.905813 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m22:40:33.907263 [debug] [ThreadPool]: On create_legal_demo_main: COMMIT
[0m22:40:33.909686 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:40:33.911010 [debug] [ThreadPool]: On create_legal_demo_main: Close
[0m22:40:33.920047 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_legal_demo_main, now list_legal_demo_main)
[0m22:40:33.927946 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo_main"
[0m22:40:33.930236 [debug] [ThreadPool]: On list_legal_demo_main: BEGIN
[0m22:40:33.932146 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:40:33.956426 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:40:33.958185 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo_main"
[0m22:40:33.959939 [debug] [ThreadPool]: On list_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo_main"} */
select
      'legal_demo' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'legal_demo'
  
[0m22:40:34.043905 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:40:34.053317 [debug] [ThreadPool]: On list_legal_demo_main: ROLLBACK
[0m22:40:34.056310 [debug] [ThreadPool]: Failed to rollback 'list_legal_demo_main'
[0m22:40:34.058002 [debug] [ThreadPool]: On list_legal_demo_main: Close
[0m22:40:34.065789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0e83dec0-939c-40e9-8db8-9c4fcfc4147b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x716b22127150>]}
[0m22:40:34.067828 [debug] [MainThread]: Using duckdb connection "master"
[0m22:40:34.069416 [debug] [MainThread]: On master: BEGIN
[0m22:40:34.070866 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:40:34.092764 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:40:34.094538 [debug] [MainThread]: On master: COMMIT
[0m22:40:34.096013 [debug] [MainThread]: Using duckdb connection "master"
[0m22:40:34.097354 [debug] [MainThread]: On master: COMMIT
[0m22:40:34.099332 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:40:34.100816 [debug] [MainThread]: On master: Close
[0m22:40:34.105527 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:40:34.107447 [info ] [MainThread]: 
[0m22:40:34.118737 [debug] [Thread-1 (]: Began running node model.legal_demo.acris_cases
[0m22:40:34.120848 [info ] [Thread-1 (]: 1 of 1 START sql table model main.acris_clean .................................. [RUN]
[0m22:40:34.123234 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.legal_demo.acris_cases'
[0m22:40:34.125070 [debug] [Thread-1 (]: Began compiling node model.legal_demo.acris_cases
[0m22:40:34.134456 [debug] [Thread-1 (]: Writing injected SQL for node "model.legal_demo.acris_cases"
[0m22:40:34.208137 [debug] [Thread-1 (]: Timing info for model.legal_demo.acris_cases (compile): 22:40:34.126936 => 22:40:34.207626
[0m22:40:34.210109 [debug] [Thread-1 (]: Began executing node model.legal_demo.acris_cases
[0m22:40:34.246739 [debug] [Thread-1 (]: Writing runtime sql for node "model.legal_demo.acris_cases"
[0m22:40:34.320511 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m22:40:34.322401 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: BEGIN
[0m22:40:34.324164 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:40:34.346302 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:40:34.348211 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m22:40:34.349723 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */

  
    
    

    create  table
      "legal_demo"."main"."acris_clean__dbt_tmp"
  
    as (
      

SELECT *
FROM read_csv_auto('/opt/airflow/data/first_500k_acris.csv', header=True, delim=',')
    );
  
  
[0m22:40:37.132025 [debug] [Thread-1 (]: SQL status: OK in 3.0 seconds
[0m22:40:37.141646 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m22:40:37.143810 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
alter table "legal_demo"."main"."acris_clean" rename to "acris_clean__dbt_backup"
[0m22:40:37.147081 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:40:37.153323 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m22:40:37.155071 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
alter table "legal_demo"."main"."acris_clean__dbt_tmp" rename to "acris_clean"
[0m22:40:37.157290 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:40:37.179436 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: COMMIT
[0m22:40:37.182029 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m22:40:37.183866 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: COMMIT
[0m22:40:37.208744 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:40:37.216566 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m22:40:37.218910 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
drop table if exists "legal_demo"."main"."acris_clean__dbt_backup" cascade
[0m22:40:37.227278 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:40:37.230301 [debug] [Thread-1 (]: Timing info for model.legal_demo.acris_cases (execute): 22:40:34.211558 => 22:40:37.230049
[0m22:40:37.232395 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: Close
[0m22:40:37.294801 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e83dec0-939c-40e9-8db8-9c4fcfc4147b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x716b22264090>]}
[0m22:40:37.297423 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main.acris_clean ............................. [[32mOK[0m in 3.17s]
[0m22:40:37.299485 [debug] [Thread-1 (]: Finished running node model.legal_demo.acris_cases
[0m22:40:37.305158 [debug] [MainThread]: Using duckdb connection "master"
[0m22:40:37.306516 [debug] [MainThread]: On master: BEGIN
[0m22:40:37.307959 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:40:37.371730 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:40:37.373645 [debug] [MainThread]: On master: COMMIT
[0m22:40:37.375123 [debug] [MainThread]: Using duckdb connection "master"
[0m22:40:37.376619 [debug] [MainThread]: On master: COMMIT
[0m22:40:37.378435 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:40:37.379824 [debug] [MainThread]: On master: Close
[0m22:40:37.384672 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:40:37.386230 [debug] [MainThread]: Connection 'list_legal_demo_main' was properly closed.
[0m22:40:37.387664 [debug] [MainThread]: Connection 'model.legal_demo.acris_cases' was properly closed.
[0m22:40:37.389187 [info ] [MainThread]: 
[0m22:40:37.390806 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.65 seconds (3.65s).
[0m22:40:37.392780 [debug] [MainThread]: Command end result
[0m22:40:37.491914 [info ] [MainThread]: 
[0m22:40:37.493929 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:40:37.495486 [info ] [MainThread]: 
[0m22:40:37.497267 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m22:40:37.499584 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.979399, "process_user_time": 8.767175, "process_kernel_time": 2.176185, "process_mem_max_rss": "298264", "process_out_blocks": "8384", "process_in_blocks": "0"}
[0m22:40:37.501303 [debug] [MainThread]: Command `dbt run` succeeded at 22:40:37.501115 after 4.98 seconds
[0m22:40:37.502808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x716b2b75b750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x716b30242ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x716b30225990>]}
[0m22:40:37.504388 [debug] [MainThread]: Flushing usage events
[0m22:41:27.748979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76bfe80769d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76bfe87d0190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76bfe8345790>]}


============================== 22:41:27.757549 | ef35e783-9a4d-47c8-a604-4fed1f702628 ==============================
[0m22:41:27.757549 [info ] [MainThread]: Running with dbt=1.7.4
[0m22:41:27.759371 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:41:28.132668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ef35e783-9a4d-47c8-a604-4fed1f702628', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76bfe4e7de90>]}
[0m22:41:28.235556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ef35e783-9a4d-47c8-a604-4fed1f702628', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76bfe4e3ea90>]}
[0m22:41:28.261484 [info ] [MainThread]: Registered adapter: duckdb=1.7.4
[0m22:41:28.282559 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m22:41:28.362798 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:41:28.364853 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:41:28.372828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ef35e783-9a4d-47c8-a604-4fed1f702628', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76bfdeea4310>]}
[0m22:41:28.419032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ef35e783-9a4d-47c8-a604-4fed1f702628', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76bfdef93dd0>]}
[0m22:41:28.421240 [info ] [MainThread]: Found 1 model, 0 sources, 0 exposures, 0 metrics, 394 macros, 0 groups, 0 semantic models
[0m22:41:28.423479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ef35e783-9a4d-47c8-a604-4fed1f702628', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76bfe8499990>]}
[0m22:41:28.427064 [info ] [MainThread]: 
[0m22:41:28.429329 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:41:28.432125 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_legal_demo'
[0m22:41:28.449988 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo"
[0m22:41:28.452563 [debug] [ThreadPool]: On list_legal_demo: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"legal_demo"'
    
  
  
[0m22:41:28.454313 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:41:28.490039 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:41:28.493503 [debug] [ThreadPool]: On list_legal_demo: Close
[0m22:41:28.503052 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_legal_demo, now create_legal_demo_main)
[0m22:41:28.505141 [debug] [ThreadPool]: Creating schema "database: "legal_demo"
schema: "main"
"
[0m22:41:28.513750 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m22:41:28.515548 [debug] [ThreadPool]: On create_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "create_legal_demo_main"} */

    
        select type from duckdb_databases()
        where database_name='legal_demo'
        and type='sqlite'
    
  
[0m22:41:28.517757 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:41:28.545466 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:41:28.548604 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m22:41:28.550114 [debug] [ThreadPool]: On create_legal_demo_main: BEGIN
[0m22:41:28.552552 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:41:28.554331 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m22:41:28.555881 [debug] [ThreadPool]: On create_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "create_legal_demo_main"} */

    
    
        create schema if not exists "legal_demo"."main"
    
[0m22:41:28.558529 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:41:28.560796 [debug] [ThreadPool]: On create_legal_demo_main: COMMIT
[0m22:41:28.562347 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m22:41:28.563947 [debug] [ThreadPool]: On create_legal_demo_main: COMMIT
[0m22:41:28.566822 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:41:28.568475 [debug] [ThreadPool]: On create_legal_demo_main: Close
[0m22:41:28.577936 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_legal_demo_main, now list_legal_demo_main)
[0m22:41:28.585603 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo_main"
[0m22:41:28.587917 [debug] [ThreadPool]: On list_legal_demo_main: BEGIN
[0m22:41:28.589707 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:41:28.612970 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:41:28.614659 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo_main"
[0m22:41:28.616074 [debug] [ThreadPool]: On list_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo_main"} */
select
      'legal_demo' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'legal_demo'
  
[0m22:41:28.645437 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:41:28.652833 [debug] [ThreadPool]: On list_legal_demo_main: ROLLBACK
[0m22:41:28.655498 [debug] [ThreadPool]: Failed to rollback 'list_legal_demo_main'
[0m22:41:28.657307 [debug] [ThreadPool]: On list_legal_demo_main: Close
[0m22:41:28.663930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ef35e783-9a4d-47c8-a604-4fed1f702628', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76bfe4ec9450>]}
[0m22:41:28.665557 [debug] [MainThread]: Using duckdb connection "master"
[0m22:41:28.666843 [debug] [MainThread]: On master: BEGIN
[0m22:41:28.668124 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:41:28.689696 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:41:28.691481 [debug] [MainThread]: On master: COMMIT
[0m22:41:28.692953 [debug] [MainThread]: Using duckdb connection "master"
[0m22:41:28.694236 [debug] [MainThread]: On master: COMMIT
[0m22:41:28.695926 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:41:28.697334 [debug] [MainThread]: On master: Close
[0m22:41:28.701773 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:41:28.703433 [info ] [MainThread]: 
[0m22:41:28.716882 [debug] [Thread-1 (]: Began running node model.legal_demo.acris_cases
[0m22:41:28.718748 [info ] [Thread-1 (]: 1 of 1 START sql table model main.acris_clean .................................. [RUN]
[0m22:41:28.721004 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.legal_demo.acris_cases'
[0m22:41:28.723381 [debug] [Thread-1 (]: Began compiling node model.legal_demo.acris_cases
[0m22:41:28.732966 [debug] [Thread-1 (]: Writing injected SQL for node "model.legal_demo.acris_cases"
[0m22:41:28.745858 [debug] [Thread-1 (]: Timing info for model.legal_demo.acris_cases (compile): 22:41:28.724874 => 22:41:28.745391
[0m22:41:28.747593 [debug] [Thread-1 (]: Began executing node model.legal_demo.acris_cases
[0m22:41:28.788277 [debug] [Thread-1 (]: Writing runtime sql for node "model.legal_demo.acris_cases"
[0m22:41:28.802006 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m22:41:28.803578 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: BEGIN
[0m22:41:28.805277 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:41:28.829826 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:41:28.832082 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m22:41:28.833918 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */

  
    
    

    create  table
      "legal_demo"."main"."acris_clean__dbt_tmp"
  
    as (
      

SELECT *
FROM read_csv_auto('/opt/airflow/data/first_500k_acris.csv', header=True, delim=',')
    );
  
  
[0m22:41:31.665586 [debug] [Thread-1 (]: SQL status: OK in 3.0 seconds
[0m22:41:31.674770 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m22:41:31.676681 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
alter table "legal_demo"."main"."acris_clean" rename to "acris_clean__dbt_backup"
[0m22:41:31.679317 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:41:31.683723 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m22:41:31.685435 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
alter table "legal_demo"."main"."acris_clean__dbt_tmp" rename to "acris_clean"
[0m22:41:31.687548 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:41:31.711185 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: COMMIT
[0m22:41:31.712969 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m22:41:31.714594 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: COMMIT
[0m22:41:31.788022 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:41:31.796309 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m22:41:31.797959 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
drop table if exists "legal_demo"."main"."acris_clean__dbt_backup" cascade
[0m22:41:31.805448 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:41:31.808649 [debug] [Thread-1 (]: Timing info for model.legal_demo.acris_cases (execute): 22:41:28.748934 => 22:41:31.808303
[0m22:41:31.810463 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: Close
[0m22:41:31.877655 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef35e783-9a4d-47c8-a604-4fed1f702628', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76bfdedb4050>]}
[0m22:41:31.880488 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main.acris_clean ............................. [[32mOK[0m in 3.16s]
[0m22:41:31.882679 [debug] [Thread-1 (]: Finished running node model.legal_demo.acris_cases
[0m22:41:31.886821 [debug] [MainThread]: Using duckdb connection "master"
[0m22:41:31.888494 [debug] [MainThread]: On master: BEGIN
[0m22:41:31.889968 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:41:31.961041 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:41:31.962795 [debug] [MainThread]: On master: COMMIT
[0m22:41:31.964332 [debug] [MainThread]: Using duckdb connection "master"
[0m22:41:31.965696 [debug] [MainThread]: On master: COMMIT
[0m22:41:31.967588 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:41:31.969013 [debug] [MainThread]: On master: Close
[0m22:41:31.973799 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:41:31.975357 [debug] [MainThread]: Connection 'list_legal_demo_main' was properly closed.
[0m22:41:31.976952 [debug] [MainThread]: Connection 'model.legal_demo.acris_cases' was properly closed.
[0m22:41:31.978482 [info ] [MainThread]: 
[0m22:41:31.979996 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.55 seconds (3.55s).
[0m22:41:31.981912 [debug] [MainThread]: Command end result
[0m22:41:32.014791 [info ] [MainThread]: 
[0m22:41:32.016597 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:41:32.018271 [info ] [MainThread]: 
[0m22:41:32.020061 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m22:41:32.025587 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.344042, "process_user_time": 7.832857, "process_kernel_time": 1.312951, "process_mem_max_rss": "300492", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:41:32.027506 [debug] [MainThread]: Command `dbt run` succeeded at 22:41:32.027313 after 4.35 seconds
[0m22:41:32.029052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76bfe8082c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76bfecd91990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76bfe87af510>]}
[0m22:41:32.030628 [debug] [MainThread]: Flushing usage events
[0m22:42:15.679867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c46c69aafd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c46c6cb0950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c46c6cb0e90>]}


============================== 22:42:15.688905 | 51d30767-99e2-4d9e-9ba9-292c5a386f94 ==============================
[0m22:42:15.688905 [info ] [MainThread]: Running with dbt=1.7.4
[0m22:42:15.691064 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:42:16.060810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '51d30767-99e2-4d9e-9ba9-292c5a386f94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c46c653c5d0>]}
[0m22:42:16.158720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '51d30767-99e2-4d9e-9ba9-292c5a386f94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c46c65785d0>]}
[0m22:42:16.161610 [info ] [MainThread]: Registered adapter: duckdb=1.7.4
[0m22:42:16.183409 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m22:42:16.265955 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:42:16.267972 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:42:16.275327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '51d30767-99e2-4d9e-9ba9-292c5a386f94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c46c7393510>]}
[0m22:42:16.322913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '51d30767-99e2-4d9e-9ba9-292c5a386f94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c46bd3a6850>]}
[0m22:42:16.324817 [info ] [MainThread]: Found 1 model, 0 sources, 0 exposures, 0 metrics, 394 macros, 0 groups, 0 semantic models
[0m22:42:16.326575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '51d30767-99e2-4d9e-9ba9-292c5a386f94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c46bd24b750>]}
[0m22:42:16.330112 [info ] [MainThread]: 
[0m22:42:16.332283 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:42:16.335272 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_legal_demo'
[0m22:42:16.351773 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo"
[0m22:42:16.353812 [debug] [ThreadPool]: On list_legal_demo: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"legal_demo"'
    
  
  
[0m22:42:16.355539 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:42:16.438359 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:42:16.442826 [debug] [ThreadPool]: On list_legal_demo: Close
[0m22:42:16.453210 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_legal_demo, now create_legal_demo_main)
[0m22:42:16.455422 [debug] [ThreadPool]: Creating schema "database: "legal_demo"
schema: "main"
"
[0m22:42:16.464800 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m22:42:16.466857 [debug] [ThreadPool]: On create_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "create_legal_demo_main"} */

    
        select type from duckdb_databases()
        where database_name='legal_demo'
        and type='sqlite'
    
  
[0m22:42:16.468444 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:42:16.494584 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:42:16.497254 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m22:42:16.498760 [debug] [ThreadPool]: On create_legal_demo_main: BEGIN
[0m22:42:16.500753 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:42:16.502236 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m22:42:16.503674 [debug] [ThreadPool]: On create_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "create_legal_demo_main"} */

    
    
        create schema if not exists "legal_demo"."main"
    
[0m22:42:16.505980 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:42:16.508153 [debug] [ThreadPool]: On create_legal_demo_main: COMMIT
[0m22:42:16.509579 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m22:42:16.511047 [debug] [ThreadPool]: On create_legal_demo_main: COMMIT
[0m22:42:16.513826 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:42:16.515279 [debug] [ThreadPool]: On create_legal_demo_main: Close
[0m22:42:16.525996 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_legal_demo_main, now list_legal_demo_main)
[0m22:42:16.533511 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo_main"
[0m22:42:16.535253 [debug] [ThreadPool]: On list_legal_demo_main: BEGIN
[0m22:42:16.536958 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:42:16.560876 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:42:16.562990 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo_main"
[0m22:42:16.564620 [debug] [ThreadPool]: On list_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo_main"} */
select
      'legal_demo' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'legal_demo'
  
[0m22:42:16.592152 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:42:16.599806 [debug] [ThreadPool]: On list_legal_demo_main: ROLLBACK
[0m22:42:16.602676 [debug] [ThreadPool]: Failed to rollback 'list_legal_demo_main'
[0m22:42:16.604714 [debug] [ThreadPool]: On list_legal_demo_main: Close
[0m22:42:16.611151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '51d30767-99e2-4d9e-9ba9-292c5a386f94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c46bd204d10>]}
[0m22:42:16.612982 [debug] [MainThread]: Using duckdb connection "master"
[0m22:42:16.614625 [debug] [MainThread]: On master: BEGIN
[0m22:42:16.615917 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:42:16.636495 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:42:16.638194 [debug] [MainThread]: On master: COMMIT
[0m22:42:16.639890 [debug] [MainThread]: Using duckdb connection "master"
[0m22:42:16.641271 [debug] [MainThread]: On master: COMMIT
[0m22:42:16.643868 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:42:16.646355 [debug] [MainThread]: On master: Close
[0m22:42:16.651928 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:42:16.653693 [info ] [MainThread]: 
[0m22:42:16.667391 [debug] [Thread-1 (]: Began running node model.legal_demo.acris_cases
[0m22:42:16.669445 [info ] [Thread-1 (]: 1 of 1 START sql table model main.acris_clean .................................. [RUN]
[0m22:42:16.671803 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.legal_demo.acris_cases'
[0m22:42:16.674339 [debug] [Thread-1 (]: Began compiling node model.legal_demo.acris_cases
[0m22:42:16.683719 [debug] [Thread-1 (]: Writing injected SQL for node "model.legal_demo.acris_cases"
[0m22:42:16.697863 [debug] [Thread-1 (]: Timing info for model.legal_demo.acris_cases (compile): 22:42:16.675825 => 22:42:16.697404
[0m22:42:16.699643 [debug] [Thread-1 (]: Began executing node model.legal_demo.acris_cases
[0m22:42:16.742110 [debug] [Thread-1 (]: Writing runtime sql for node "model.legal_demo.acris_cases"
[0m22:42:16.755352 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m22:42:16.756995 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: BEGIN
[0m22:42:16.758440 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:42:16.784966 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:42:16.787717 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m22:42:16.789283 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */

  
    
    

    create  table
      "legal_demo"."main"."acris_clean__dbt_tmp"
  
    as (
      

SELECT *
FROM read_csv_auto('/opt/airflow/data/first_500k_acris.csv', header=True, delim=',')
    );
  
  
[0m22:42:19.222501 [debug] [Thread-1 (]: SQL status: OK in 2.0 seconds
[0m22:42:19.231110 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m22:42:19.233626 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
alter table "legal_demo"."main"."acris_clean" rename to "acris_clean__dbt_backup"
[0m22:42:19.236374 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:42:19.241177 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m22:42:19.243237 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
alter table "legal_demo"."main"."acris_clean__dbt_tmp" rename to "acris_clean"
[0m22:42:19.245451 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:42:19.268562 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: COMMIT
[0m22:42:19.270960 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m22:42:19.272849 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: COMMIT
[0m22:42:19.341622 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:42:19.349206 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m22:42:19.351433 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
drop table if exists "legal_demo"."main"."acris_clean__dbt_backup" cascade
[0m22:42:19.359858 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:42:19.363247 [debug] [Thread-1 (]: Timing info for model.legal_demo.acris_cases (execute): 22:42:16.701096 => 22:42:19.362981
[0m22:42:19.365079 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: Close
[0m22:42:19.425729 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51d30767-99e2-4d9e-9ba9-292c5a386f94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c46bd37e350>]}
[0m22:42:19.428465 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main.acris_clean ............................. [[32mOK[0m in 2.75s]
[0m22:42:19.430815 [debug] [Thread-1 (]: Finished running node model.legal_demo.acris_cases
[0m22:42:19.436026 [debug] [MainThread]: Using duckdb connection "master"
[0m22:42:19.437851 [debug] [MainThread]: On master: BEGIN
[0m22:42:19.439564 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:42:19.461876 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:42:19.463889 [debug] [MainThread]: On master: COMMIT
[0m22:42:19.465687 [debug] [MainThread]: Using duckdb connection "master"
[0m22:42:19.467077 [debug] [MainThread]: On master: COMMIT
[0m22:42:19.469003 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:42:19.470532 [debug] [MainThread]: On master: Close
[0m22:42:19.475311 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:42:19.476837 [debug] [MainThread]: Connection 'list_legal_demo_main' was properly closed.
[0m22:42:19.478319 [debug] [MainThread]: Connection 'model.legal_demo.acris_cases' was properly closed.
[0m22:42:19.479718 [info ] [MainThread]: 
[0m22:42:19.481205 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.15 seconds (3.15s).
[0m22:42:19.483054 [debug] [MainThread]: Command end result
[0m22:42:19.516358 [info ] [MainThread]: 
[0m22:42:19.518749 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:42:19.520524 [info ] [MainThread]: 
[0m22:42:19.522315 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m22:42:19.524903 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.9105277, "process_user_time": 7.254296, "process_kernel_time": 1.249217, "process_mem_max_rss": "298868", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:42:19.526786 [debug] [MainThread]: Command `dbt run` succeeded at 22:42:19.526596 after 3.91 seconds
[0m22:42:19.528235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c46c6c8d010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c46c681dc90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c46cb41b190>]}
[0m22:42:19.529705 [debug] [MainThread]: Flushing usage events
[0m01:53:16.262017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x787ecf0db410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x787ecead1810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x787eceb0da90>]}


============================== 01:53:16.270718 | 644244f9-d912-480b-9ef3-f274c6854ad8 ==============================
[0m01:53:16.270718 [info ] [MainThread]: Running with dbt=1.7.4
[0m01:53:16.272821 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m01:53:16.641043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '644244f9-d912-480b-9ef3-f274c6854ad8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x787ecf24b510>]}
[0m01:53:16.743363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '644244f9-d912-480b-9ef3-f274c6854ad8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x787eceeb7410>]}
[0m01:53:16.745736 [info ] [MainThread]: Registered adapter: duckdb=1.7.4
[0m01:53:16.766474 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m01:53:16.853784 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:53:16.856084 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:53:16.863427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '644244f9-d912-480b-9ef3-f274c6854ad8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x787ecef74b90>]}
[0m01:53:16.957102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '644244f9-d912-480b-9ef3-f274c6854ad8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x787ec5953b90>]}
[0m01:53:16.959167 [info ] [MainThread]: Found 1 model, 0 sources, 0 exposures, 0 metrics, 394 macros, 0 groups, 0 semantic models
[0m01:53:16.960899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '644244f9-d912-480b-9ef3-f274c6854ad8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x787ed2497a50>]}
[0m01:53:16.964045 [info ] [MainThread]: 
[0m01:53:16.966770 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m01:53:16.969838 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_legal_demo'
[0m01:53:16.985199 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo"
[0m01:53:16.987433 [debug] [ThreadPool]: On list_legal_demo: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"legal_demo"'
    
  
  
[0m01:53:16.989315 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:53:17.074416 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m01:53:17.078284 [debug] [ThreadPool]: On list_legal_demo: Close
[0m01:53:17.088153 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_legal_demo, now create_legal_demo_main)
[0m01:53:17.090394 [debug] [ThreadPool]: Creating schema "database: "legal_demo"
schema: "main"
"
[0m01:53:17.099495 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m01:53:17.101768 [debug] [ThreadPool]: On create_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "create_legal_demo_main"} */

    
        select type from duckdb_databases()
        where database_name='legal_demo'
        and type='sqlite'
    
  
[0m01:53:17.103569 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:53:17.131520 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m01:53:17.134352 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m01:53:17.136416 [debug] [ThreadPool]: On create_legal_demo_main: BEGIN
[0m01:53:17.138697 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m01:53:17.140318 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m01:53:17.142074 [debug] [ThreadPool]: On create_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "create_legal_demo_main"} */

    
    
        create schema if not exists "legal_demo"."main"
    
[0m01:53:17.144035 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m01:53:17.146085 [debug] [ThreadPool]: On create_legal_demo_main: COMMIT
[0m01:53:17.148037 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m01:53:17.149673 [debug] [ThreadPool]: On create_legal_demo_main: COMMIT
[0m01:53:17.152378 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m01:53:17.154048 [debug] [ThreadPool]: On create_legal_demo_main: Close
[0m01:53:17.163103 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_legal_demo_main, now list_legal_demo_main)
[0m01:53:17.170800 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo_main"
[0m01:53:17.172495 [debug] [ThreadPool]: On list_legal_demo_main: BEGIN
[0m01:53:17.174035 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:53:17.204896 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m01:53:17.207045 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo_main"
[0m01:53:17.208872 [debug] [ThreadPool]: On list_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo_main"} */
select
      'legal_demo' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'legal_demo'
  
[0m01:53:17.239183 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m01:53:17.247841 [debug] [ThreadPool]: On list_legal_demo_main: ROLLBACK
[0m01:53:17.250439 [debug] [ThreadPool]: Failed to rollback 'list_legal_demo_main'
[0m01:53:17.251981 [debug] [ThreadPool]: On list_legal_demo_main: Close
[0m01:53:17.258676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '644244f9-d912-480b-9ef3-f274c6854ad8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x787ed2497a50>]}
[0m01:53:17.260499 [debug] [MainThread]: Using duckdb connection "master"
[0m01:53:17.261850 [debug] [MainThread]: On master: BEGIN
[0m01:53:17.263116 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:53:17.284892 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m01:53:17.286645 [debug] [MainThread]: On master: COMMIT
[0m01:53:17.288193 [debug] [MainThread]: Using duckdb connection "master"
[0m01:53:17.289784 [debug] [MainThread]: On master: COMMIT
[0m01:53:17.291856 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m01:53:17.293326 [debug] [MainThread]: On master: Close
[0m01:53:17.298324 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:53:17.299939 [info ] [MainThread]: 
[0m01:53:17.312924 [debug] [Thread-1 (]: Began running node model.legal_demo.acris_cases
[0m01:53:17.314835 [info ] [Thread-1 (]: 1 of 1 START sql table model main.acris_clean .................................. [RUN]
[0m01:53:17.316747 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.legal_demo.acris_cases'
[0m01:53:17.318407 [debug] [Thread-1 (]: Began compiling node model.legal_demo.acris_cases
[0m01:53:17.328621 [debug] [Thread-1 (]: Writing injected SQL for node "model.legal_demo.acris_cases"
[0m01:53:17.343031 [debug] [Thread-1 (]: Timing info for model.legal_demo.acris_cases (compile): 01:53:17.319751 => 01:53:17.342534
[0m01:53:17.344765 [debug] [Thread-1 (]: Began executing node model.legal_demo.acris_cases
[0m01:53:17.385014 [debug] [Thread-1 (]: Writing runtime sql for node "model.legal_demo.acris_cases"
[0m01:53:17.398130 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m01:53:17.399774 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: BEGIN
[0m01:53:17.401226 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:53:17.428478 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m01:53:17.430473 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m01:53:17.432025 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */

  
    
    

    create  table
      "legal_demo"."main"."acris_clean__dbt_tmp"
  
    as (
      

SELECT *
FROM read_csv_auto('/opt/airflow/data/first_500k_acris.csv', header=True, delim=',')
    );
  
  
[0m01:53:19.930957 [debug] [Thread-1 (]: SQL status: OK in 2.0 seconds
[0m01:53:19.941365 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m01:53:19.943759 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
alter table "legal_demo"."main"."acris_clean" rename to "acris_clean__dbt_backup"
[0m01:53:19.946616 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m01:53:19.952475 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m01:53:19.954445 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
alter table "legal_demo"."main"."acris_clean__dbt_tmp" rename to "acris_clean"
[0m01:53:19.956989 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m01:53:19.998401 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: COMMIT
[0m01:53:20.000651 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m01:53:20.002759 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: COMMIT
[0m01:53:20.044251 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m01:53:20.053254 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m01:53:20.054949 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
drop table if exists "legal_demo"."main"."acris_clean__dbt_backup" cascade
[0m01:53:20.063225 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m01:53:20.066431 [debug] [Thread-1 (]: Timing info for model.legal_demo.acris_cases (execute): 01:53:17.346106 => 01:53:20.066166
[0m01:53:20.068090 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: Close
[0m01:53:20.133345 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '644244f9-d912-480b-9ef3-f274c6854ad8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x787ec574eb50>]}
[0m01:53:20.135681 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main.acris_clean ............................. [[32mOK[0m in 2.82s]
[0m01:53:20.137992 [debug] [Thread-1 (]: Finished running node model.legal_demo.acris_cases
[0m01:53:20.142287 [debug] [MainThread]: Using duckdb connection "master"
[0m01:53:20.143693 [debug] [MainThread]: On master: BEGIN
[0m01:53:20.145260 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:53:20.167626 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m01:53:20.169537 [debug] [MainThread]: On master: COMMIT
[0m01:53:20.171021 [debug] [MainThread]: Using duckdb connection "master"
[0m01:53:20.172506 [debug] [MainThread]: On master: COMMIT
[0m01:53:20.174488 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m01:53:20.175884 [debug] [MainThread]: On master: Close
[0m01:53:20.180868 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:53:20.182862 [debug] [MainThread]: Connection 'list_legal_demo_main' was properly closed.
[0m01:53:20.184599 [debug] [MainThread]: Connection 'model.legal_demo.acris_cases' was properly closed.
[0m01:53:20.186157 [info ] [MainThread]: 
[0m01:53:20.188033 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.22 seconds (3.22s).
[0m01:53:20.190177 [debug] [MainThread]: Command end result
[0m01:53:20.221411 [info ] [MainThread]: 
[0m01:53:20.223193 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:53:20.224800 [info ] [MainThread]: 
[0m01:53:20.226372 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m01:53:20.228605 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.0346317, "process_user_time": 7.007906, "process_kernel_time": 1.54432, "process_mem_max_rss": "299660", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m01:53:20.230464 [debug] [MainThread]: Command `dbt run` succeeded at 01:53:20.230268 after 4.04 seconds
[0m01:53:20.232018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x787ecef75990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x787ecef74cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x787ed375f4d0>]}
[0m01:53:20.233932 [debug] [MainThread]: Flushing usage events
[0m01:54:29.603139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72435094ebd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x724352f0ab90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x724350c12c50>]}


============================== 01:54:29.612638 | d851d6c7-0fee-48bf-96d0-c77b85f3f0c5 ==============================
[0m01:54:29.612638 [info ] [MainThread]: Running with dbt=1.7.4
[0m01:54:29.614591 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:54:30.054782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd851d6c7-0fee-48bf-96d0-c77b85f3f0c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72435088e050>]}
[0m01:54:30.163153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd851d6c7-0fee-48bf-96d0-c77b85f3f0c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72434752e610>]}
[0m01:54:30.165972 [info ] [MainThread]: Registered adapter: duckdb=1.7.4
[0m01:54:30.185672 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m01:54:30.268682 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:54:30.270772 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:54:30.278298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd851d6c7-0fee-48bf-96d0-c77b85f3f0c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x724350a6c150>]}
[0m01:54:30.327957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd851d6c7-0fee-48bf-96d0-c77b85f3f0c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x724350662950>]}
[0m01:54:30.329765 [info ] [MainThread]: Found 1 model, 0 sources, 0 exposures, 0 metrics, 394 macros, 0 groups, 0 semantic models
[0m01:54:30.331664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd851d6c7-0fee-48bf-96d0-c77b85f3f0c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x724350a439d0>]}
[0m01:54:30.334623 [info ] [MainThread]: 
[0m01:54:30.337291 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m01:54:30.340211 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_legal_demo'
[0m01:54:30.355728 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo"
[0m01:54:30.357515 [debug] [ThreadPool]: On list_legal_demo: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"legal_demo"'
    
  
  
[0m01:54:30.359554 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:54:30.394214 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m01:54:30.397801 [debug] [ThreadPool]: On list_legal_demo: Close
[0m01:54:30.407130 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_legal_demo, now create_legal_demo_main)
[0m01:54:30.409338 [debug] [ThreadPool]: Creating schema "database: "legal_demo"
schema: "main"
"
[0m01:54:30.417921 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m01:54:30.419795 [debug] [ThreadPool]: On create_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "create_legal_demo_main"} */

    
        select type from duckdb_databases()
        where database_name='legal_demo'
        and type='sqlite'
    
  
[0m01:54:30.421644 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:54:30.449286 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m01:54:30.452167 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m01:54:30.453975 [debug] [ThreadPool]: On create_legal_demo_main: BEGIN
[0m01:54:30.456315 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m01:54:30.457813 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m01:54:30.459295 [debug] [ThreadPool]: On create_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "create_legal_demo_main"} */

    
    
        create schema if not exists "legal_demo"."main"
    
[0m01:54:30.461288 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m01:54:30.463371 [debug] [ThreadPool]: On create_legal_demo_main: COMMIT
[0m01:54:30.464989 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m01:54:30.466543 [debug] [ThreadPool]: On create_legal_demo_main: COMMIT
[0m01:54:30.469682 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m01:54:30.471119 [debug] [ThreadPool]: On create_legal_demo_main: Close
[0m01:54:30.480532 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_legal_demo_main, now list_legal_demo_main)
[0m01:54:30.488950 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo_main"
[0m01:54:30.491080 [debug] [ThreadPool]: On list_legal_demo_main: BEGIN
[0m01:54:30.492615 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:54:30.516544 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m01:54:30.561297 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo_main"
[0m01:54:30.563295 [debug] [ThreadPool]: On list_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo_main"} */
select
      'legal_demo' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'legal_demo'
  
[0m01:54:30.596458 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m01:54:30.604420 [debug] [ThreadPool]: On list_legal_demo_main: ROLLBACK
[0m01:54:30.607070 [debug] [ThreadPool]: Failed to rollback 'list_legal_demo_main'
[0m01:54:30.608972 [debug] [ThreadPool]: On list_legal_demo_main: Close
[0m01:54:30.617310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd851d6c7-0fee-48bf-96d0-c77b85f3f0c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x724351fa4990>]}
[0m01:54:30.619848 [debug] [MainThread]: Using duckdb connection "master"
[0m01:54:30.621529 [debug] [MainThread]: On master: BEGIN
[0m01:54:30.623122 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:54:30.648787 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m01:54:30.650701 [debug] [MainThread]: On master: COMMIT
[0m01:54:30.652306 [debug] [MainThread]: Using duckdb connection "master"
[0m01:54:30.653919 [debug] [MainThread]: On master: COMMIT
[0m01:54:30.656094 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m01:54:30.657719 [debug] [MainThread]: On master: Close
[0m01:54:30.662635 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:54:30.664402 [info ] [MainThread]: 
[0m01:54:30.677405 [debug] [Thread-1 (]: Began running node model.legal_demo.acris_cases
[0m01:54:30.679422 [info ] [Thread-1 (]: 1 of 1 START sql table model main.acris_clean .................................. [RUN]
[0m01:54:30.681564 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.legal_demo.acris_cases'
[0m01:54:30.683169 [debug] [Thread-1 (]: Began compiling node model.legal_demo.acris_cases
[0m01:54:30.692697 [debug] [Thread-1 (]: Writing injected SQL for node "model.legal_demo.acris_cases"
[0m01:54:30.707273 [debug] [Thread-1 (]: Timing info for model.legal_demo.acris_cases (compile): 01:54:30.684509 => 01:54:30.706843
[0m01:54:30.708981 [debug] [Thread-1 (]: Began executing node model.legal_demo.acris_cases
[0m01:54:30.747926 [debug] [Thread-1 (]: Writing runtime sql for node "model.legal_demo.acris_cases"
[0m01:54:30.763217 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m01:54:30.765033 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: BEGIN
[0m01:54:30.766657 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:54:30.792724 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m01:54:30.794605 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m01:54:30.796457 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */

  
    
    

    create  table
      "legal_demo"."main"."acris_clean__dbt_tmp"
  
    as (
      

SELECT *
FROM read_csv_auto('/opt/airflow/data/first_500k_acris.csv', header=True, delim=',')
    );
  
  
[0m01:54:33.229013 [debug] [Thread-1 (]: SQL status: OK in 2.0 seconds
[0m01:54:33.238084 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m01:54:33.241364 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
alter table "legal_demo"."main"."acris_clean" rename to "acris_clean__dbt_backup"
[0m01:54:33.244286 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m01:54:33.248993 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m01:54:33.250838 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
alter table "legal_demo"."main"."acris_clean__dbt_tmp" rename to "acris_clean"
[0m01:54:33.253048 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m01:54:33.277210 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: COMMIT
[0m01:54:33.279411 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m01:54:33.281142 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: COMMIT
[0m01:54:33.302210 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m01:54:33.309661 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m01:54:33.311905 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
drop table if exists "legal_demo"."main"."acris_clean__dbt_backup" cascade
[0m01:54:33.320294 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m01:54:33.323219 [debug] [Thread-1 (]: Timing info for model.legal_demo.acris_cases (execute): 01:54:30.710319 => 01:54:33.322966
[0m01:54:33.325235 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: Close
[0m01:54:33.393841 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd851d6c7-0fee-48bf-96d0-c77b85f3f0c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72434726c6d0>]}
[0m01:54:33.396465 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main.acris_clean ............................. [[32mOK[0m in 2.71s]
[0m01:54:33.398648 [debug] [Thread-1 (]: Finished running node model.legal_demo.acris_cases
[0m01:54:33.403154 [debug] [MainThread]: Using duckdb connection "master"
[0m01:54:33.404767 [debug] [MainThread]: On master: BEGIN
[0m01:54:33.406237 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:54:33.428539 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m01:54:33.430257 [debug] [MainThread]: On master: COMMIT
[0m01:54:33.431927 [debug] [MainThread]: Using duckdb connection "master"
[0m01:54:33.433434 [debug] [MainThread]: On master: COMMIT
[0m01:54:33.435070 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m01:54:33.436583 [debug] [MainThread]: On master: Close
[0m01:54:33.441010 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:54:33.443240 [debug] [MainThread]: Connection 'list_legal_demo_main' was properly closed.
[0m01:54:33.444750 [debug] [MainThread]: Connection 'model.legal_demo.acris_cases' was properly closed.
[0m01:54:33.446362 [info ] [MainThread]: 
[0m01:54:33.447949 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.11 seconds (3.11s).
[0m01:54:33.449692 [debug] [MainThread]: Command end result
[0m01:54:33.481871 [info ] [MainThread]: 
[0m01:54:33.483725 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:54:33.485322 [info ] [MainThread]: 
[0m01:54:33.487225 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m01:54:33.489648 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.9552124, "process_user_time": 7.275396, "process_kernel_time": 1.307891, "process_mem_max_rss": "299436", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m01:54:33.491484 [debug] [MainThread]: Command `dbt run` succeeded at 01:54:33.491276 after 3.96 seconds
[0m01:54:33.493489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7243505f4190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x724350629e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7243553181d0>]}
[0m01:54:33.495102 [debug] [MainThread]: Flushing usage events
[0m01:56:04.082650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793f59ed0590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793f5a4c5350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793f5a5ed290>]}


============================== 01:56:04.091899 | 9caaf7fe-17f7-4127-a072-fd7cf0390a03 ==============================
[0m01:56:04.091899 [info ] [MainThread]: Running with dbt=1.7.4
[0m01:56:04.093971 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:56:04.474500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9caaf7fe-17f7-4127-a072-fd7cf0390a03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793f59ea40d0>]}
[0m01:56:04.575723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9caaf7fe-17f7-4127-a072-fd7cf0390a03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793f5a19c490>]}
[0m01:56:04.597349 [info ] [MainThread]: Registered adapter: duckdb=1.7.4
[0m01:56:04.621416 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m01:56:04.706538 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:56:04.708973 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:56:04.716547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9caaf7fe-17f7-4127-a072-fd7cf0390a03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793f56d47cd0>]}
[0m01:56:04.768654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9caaf7fe-17f7-4127-a072-fd7cf0390a03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793f50dc5e10>]}
[0m01:56:04.770756 [info ] [MainThread]: Found 1 model, 0 sources, 0 exposures, 0 metrics, 394 macros, 0 groups, 0 semantic models
[0m01:56:04.772531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9caaf7fe-17f7-4127-a072-fd7cf0390a03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793f50d72190>]}
[0m01:56:04.775702 [info ] [MainThread]: 
[0m01:56:04.778000 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m01:56:04.781034 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_legal_demo'
[0m01:56:04.797736 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo"
[0m01:56:04.799706 [debug] [ThreadPool]: On list_legal_demo: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"legal_demo"'
    
  
  
[0m01:56:04.802013 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:56:04.834999 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m01:56:04.838573 [debug] [ThreadPool]: On list_legal_demo: Close
[0m01:56:04.848766 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_legal_demo, now create_legal_demo_main)
[0m01:56:04.850907 [debug] [ThreadPool]: Creating schema "database: "legal_demo"
schema: "main"
"
[0m01:56:04.860444 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m01:56:04.862507 [debug] [ThreadPool]: On create_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "create_legal_demo_main"} */

    
        select type from duckdb_databases()
        where database_name='legal_demo'
        and type='sqlite'
    
  
[0m01:56:04.864186 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:56:04.893545 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m01:56:04.896814 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m01:56:04.898785 [debug] [ThreadPool]: On create_legal_demo_main: BEGIN
[0m01:56:04.901148 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m01:56:04.902746 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m01:56:04.904361 [debug] [ThreadPool]: On create_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "create_legal_demo_main"} */

    
    
        create schema if not exists "legal_demo"."main"
    
[0m01:56:04.906426 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m01:56:04.909251 [debug] [ThreadPool]: On create_legal_demo_main: COMMIT
[0m01:56:04.911213 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m01:56:04.912772 [debug] [ThreadPool]: On create_legal_demo_main: COMMIT
[0m01:56:04.915379 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m01:56:04.916932 [debug] [ThreadPool]: On create_legal_demo_main: Close
[0m01:56:04.927150 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_legal_demo_main, now list_legal_demo_main)
[0m01:56:04.934589 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo_main"
[0m01:56:04.936445 [debug] [ThreadPool]: On list_legal_demo_main: BEGIN
[0m01:56:04.938126 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:56:04.961037 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m01:56:04.963043 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo_main"
[0m01:56:04.964584 [debug] [ThreadPool]: On list_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo_main"} */
select
      'legal_demo' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'legal_demo'
  
[0m01:56:04.992777 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m01:56:05.000521 [debug] [ThreadPool]: On list_legal_demo_main: ROLLBACK
[0m01:56:05.003238 [debug] [ThreadPool]: Failed to rollback 'list_legal_demo_main'
[0m01:56:05.004694 [debug] [ThreadPool]: On list_legal_demo_main: Close
[0m01:56:05.011875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9caaf7fe-17f7-4127-a072-fd7cf0390a03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793f5a5fbd50>]}
[0m01:56:05.013692 [debug] [MainThread]: Using duckdb connection "master"
[0m01:56:05.015408 [debug] [MainThread]: On master: BEGIN
[0m01:56:05.016968 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:56:05.040748 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m01:56:05.042731 [debug] [MainThread]: On master: COMMIT
[0m01:56:05.044228 [debug] [MainThread]: Using duckdb connection "master"
[0m01:56:05.045589 [debug] [MainThread]: On master: COMMIT
[0m01:56:05.047422 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m01:56:05.049025 [debug] [MainThread]: On master: Close
[0m01:56:05.057419 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:56:05.061114 [info ] [MainThread]: 
[0m01:56:05.078606 [debug] [Thread-1 (]: Began running node model.legal_demo.acris_cases
[0m01:56:05.081584 [info ] [Thread-1 (]: 1 of 1 START sql table model main.acris_clean .................................. [RUN]
[0m01:56:05.084371 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.legal_demo.acris_cases'
[0m01:56:05.086451 [debug] [Thread-1 (]: Began compiling node model.legal_demo.acris_cases
[0m01:56:05.098523 [debug] [Thread-1 (]: Writing injected SQL for node "model.legal_demo.acris_cases"
[0m01:56:05.112209 [debug] [Thread-1 (]: Timing info for model.legal_demo.acris_cases (compile): 01:56:05.087919 => 01:56:05.111709
[0m01:56:05.114179 [debug] [Thread-1 (]: Began executing node model.legal_demo.acris_cases
[0m01:56:05.157392 [debug] [Thread-1 (]: Writing runtime sql for node "model.legal_demo.acris_cases"
[0m01:56:05.183107 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m01:56:05.185594 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: BEGIN
[0m01:56:05.187374 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:56:05.208166 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m01:56:05.209726 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m01:56:05.211546 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */

  
    
    

    create  table
      "legal_demo"."main"."acris_clean__dbt_tmp"
  
    as (
      

SELECT *
FROM read_csv_auto('/opt/airflow/data/first_500k_acris.csv', header=True, delim=',')
    );
  
  
[0m01:56:07.569338 [debug] [Thread-1 (]: SQL status: OK in 2.0 seconds
[0m01:56:07.577738 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m01:56:07.579793 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
alter table "legal_demo"."main"."acris_clean" rename to "acris_clean__dbt_backup"
[0m01:56:07.582307 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m01:56:07.587136 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m01:56:07.589111 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
alter table "legal_demo"."main"."acris_clean__dbt_tmp" rename to "acris_clean"
[0m01:56:07.591432 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m01:56:07.615317 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: COMMIT
[0m01:56:07.617325 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m01:56:07.618885 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: COMMIT
[0m01:56:07.689687 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m01:56:07.698220 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m01:56:07.700418 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
drop table if exists "legal_demo"."main"."acris_clean__dbt_backup" cascade
[0m01:56:07.708976 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m01:56:07.713041 [debug] [Thread-1 (]: Timing info for model.legal_demo.acris_cases (execute): 01:56:05.115580 => 01:56:07.712731
[0m01:56:07.715130 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: Close
[0m01:56:07.783789 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9caaf7fe-17f7-4127-a072-fd7cf0390a03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793f50c14250>]}
[0m01:56:07.786738 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main.acris_clean ............................. [[32mOK[0m in 2.70s]
[0m01:56:07.788881 [debug] [Thread-1 (]: Finished running node model.legal_demo.acris_cases
[0m01:56:07.793362 [debug] [MainThread]: Using duckdb connection "master"
[0m01:56:07.795000 [debug] [MainThread]: On master: BEGIN
[0m01:56:07.796370 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:56:07.818164 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m01:56:07.820078 [debug] [MainThread]: On master: COMMIT
[0m01:56:07.821747 [debug] [MainThread]: Using duckdb connection "master"
[0m01:56:07.823429 [debug] [MainThread]: On master: COMMIT
[0m01:56:07.825530 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m01:56:07.827002 [debug] [MainThread]: On master: Close
[0m01:56:07.832024 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:56:07.834156 [debug] [MainThread]: Connection 'list_legal_demo_main' was properly closed.
[0m01:56:07.835335 [debug] [MainThread]: Connection 'model.legal_demo.acris_cases' was properly closed.
[0m01:56:07.836685 [info ] [MainThread]: 
[0m01:56:07.838302 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.06 seconds (3.06s).
[0m01:56:07.840410 [debug] [MainThread]: Command end result
[0m01:56:07.874884 [info ] [MainThread]: 
[0m01:56:07.876518 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:56:07.878007 [info ] [MainThread]: 
[0m01:56:07.879509 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m01:56:07.881846 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.8685544, "process_user_time": 6.999491, "process_kernel_time": 1.248622, "process_mem_max_rss": "296776", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m01:56:07.883761 [debug] [MainThread]: Command `dbt run` succeeded at 01:56:07.883572 after 3.87 seconds
[0m01:56:07.885308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793f5a2dc8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793f5a1e7d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793f5ed77290>]}
[0m01:56:07.887849 [debug] [MainThread]: Flushing usage events
[0m01:56:51.400726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77be99d69b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77be9c14a510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77be99dabf90>]}


============================== 01:56:51.409989 | 5c8a75b3-5f67-4faa-8ec6-52d74745f198 ==============================
[0m01:56:51.409989 [info ] [MainThread]: Running with dbt=1.7.4
[0m01:56:51.412249 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m01:56:51.808659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5c8a75b3-5f67-4faa-8ec6-52d74745f198', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77be908fc690>]}
[0m01:56:51.909725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5c8a75b3-5f67-4faa-8ec6-52d74745f198', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77be90936f10>]}
[0m01:56:51.912620 [info ] [MainThread]: Registered adapter: duckdb=1.7.4
[0m01:56:51.932754 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m01:56:52.010103 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:56:52.012217 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:56:52.019388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5c8a75b3-5f67-4faa-8ec6-52d74745f198', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77be9097bf50>]}
[0m01:56:52.066728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5c8a75b3-5f67-4faa-8ec6-52d74745f198', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77be908a3750>]}
[0m01:56:52.068654 [info ] [MainThread]: Found 1 model, 0 sources, 0 exposures, 0 metrics, 394 macros, 0 groups, 0 semantic models
[0m01:56:52.070409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5c8a75b3-5f67-4faa-8ec6-52d74745f198', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77be99a69190>]}
[0m01:56:52.074321 [info ] [MainThread]: 
[0m01:56:52.076589 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m01:56:52.079795 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_legal_demo'
[0m01:56:52.095736 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo"
[0m01:56:52.097944 [debug] [ThreadPool]: On list_legal_demo: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"legal_demo"'
    
  
  
[0m01:56:52.099460 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:56:52.133251 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m01:56:52.136875 [debug] [ThreadPool]: On list_legal_demo: Close
[0m01:56:52.150845 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_legal_demo, now create_legal_demo_main)
[0m01:56:52.156155 [debug] [ThreadPool]: Creating schema "database: "legal_demo"
schema: "main"
"
[0m01:56:52.167418 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m01:56:52.169725 [debug] [ThreadPool]: On create_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "create_legal_demo_main"} */

    
        select type from duckdb_databases()
        where database_name='legal_demo'
        and type='sqlite'
    
  
[0m01:56:52.171431 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:56:52.196328 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m01:56:52.199225 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m01:56:52.200745 [debug] [ThreadPool]: On create_legal_demo_main: BEGIN
[0m01:56:52.202603 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m01:56:52.204139 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m01:56:52.205622 [debug] [ThreadPool]: On create_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "create_legal_demo_main"} */

    
    
        create schema if not exists "legal_demo"."main"
    
[0m01:56:52.207978 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m01:56:52.210581 [debug] [ThreadPool]: On create_legal_demo_main: COMMIT
[0m01:56:52.212651 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m01:56:52.214247 [debug] [ThreadPool]: On create_legal_demo_main: COMMIT
[0m01:56:52.217247 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m01:56:52.218692 [debug] [ThreadPool]: On create_legal_demo_main: Close
[0m01:56:52.228507 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_legal_demo_main, now list_legal_demo_main)
[0m01:56:52.236398 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo_main"
[0m01:56:52.238656 [debug] [ThreadPool]: On list_legal_demo_main: BEGIN
[0m01:56:52.240302 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:56:52.261199 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m01:56:52.262927 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo_main"
[0m01:56:52.264049 [debug] [ThreadPool]: On list_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo_main"} */
select
      'legal_demo' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'legal_demo'
  
[0m01:56:52.291364 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m01:56:52.298688 [debug] [ThreadPool]: On list_legal_demo_main: ROLLBACK
[0m01:56:52.301120 [debug] [ThreadPool]: Failed to rollback 'list_legal_demo_main'
[0m01:56:52.302726 [debug] [ThreadPool]: On list_legal_demo_main: Close
[0m01:56:52.310951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5c8a75b3-5f67-4faa-8ec6-52d74745f198', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77be90937210>]}
[0m01:56:52.312784 [debug] [MainThread]: Using duckdb connection "master"
[0m01:56:52.314129 [debug] [MainThread]: On master: BEGIN
[0m01:56:52.315645 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:56:52.335725 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m01:56:52.338502 [debug] [MainThread]: On master: COMMIT
[0m01:56:52.340160 [debug] [MainThread]: Using duckdb connection "master"
[0m01:56:52.341730 [debug] [MainThread]: On master: COMMIT
[0m01:56:52.343902 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m01:56:52.345757 [debug] [MainThread]: On master: Close
[0m01:56:52.350697 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:56:52.352238 [info ] [MainThread]: 
[0m01:56:52.365061 [debug] [Thread-1 (]: Began running node model.legal_demo.acris_cases
[0m01:56:52.367488 [info ] [Thread-1 (]: 1 of 1 START sql table model main.acris_clean .................................. [RUN]
[0m01:56:52.369804 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.legal_demo.acris_cases'
[0m01:56:52.371534 [debug] [Thread-1 (]: Began compiling node model.legal_demo.acris_cases
[0m01:56:52.380105 [debug] [Thread-1 (]: Writing injected SQL for node "model.legal_demo.acris_cases"
[0m01:56:52.394077 [debug] [Thread-1 (]: Timing info for model.legal_demo.acris_cases (compile): 01:56:52.372974 => 01:56:52.393623
[0m01:56:52.395815 [debug] [Thread-1 (]: Began executing node model.legal_demo.acris_cases
[0m01:56:52.434282 [debug] [Thread-1 (]: Writing runtime sql for node "model.legal_demo.acris_cases"
[0m01:56:52.446238 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m01:56:52.447513 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: BEGIN
[0m01:56:52.448662 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:56:52.469396 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m01:56:52.471640 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m01:56:52.473795 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */

  
    
    

    create  table
      "legal_demo"."main"."acris_clean__dbt_tmp"
  
    as (
      

SELECT *
FROM read_csv_auto('/opt/airflow/data/first_500k_acris.csv', header=True, delim=',')
    );
  
  
[0m01:56:54.912088 [debug] [Thread-1 (]: SQL status: OK in 2.0 seconds
[0m01:56:54.921612 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m01:56:54.923548 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
alter table "legal_demo"."main"."acris_clean" rename to "acris_clean__dbt_backup"
[0m01:56:54.925825 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m01:56:54.930475 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m01:56:54.932216 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
alter table "legal_demo"."main"."acris_clean__dbt_tmp" rename to "acris_clean"
[0m01:56:54.935009 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m01:56:54.957885 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: COMMIT
[0m01:56:54.959981 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m01:56:54.961520 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: COMMIT
[0m01:56:55.032499 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m01:56:55.040128 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m01:56:55.042165 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
drop table if exists "legal_demo"."main"."acris_clean__dbt_backup" cascade
[0m01:56:55.050940 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m01:56:55.054214 [debug] [Thread-1 (]: Timing info for model.legal_demo.acris_cases (execute): 01:56:52.397290 => 01:56:55.053870
[0m01:56:55.056131 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: Close
[0m01:56:55.120945 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c8a75b3-5f67-4faa-8ec6-52d74745f198', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77be9a09bc10>]}
[0m01:56:55.123478 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main.acris_clean ............................. [[32mOK[0m in 2.75s]
[0m01:56:55.125912 [debug] [Thread-1 (]: Finished running node model.legal_demo.acris_cases
[0m01:56:55.129809 [debug] [MainThread]: Using duckdb connection "master"
[0m01:56:55.131352 [debug] [MainThread]: On master: BEGIN
[0m01:56:55.132677 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:56:55.153804 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m01:56:55.155702 [debug] [MainThread]: On master: COMMIT
[0m01:56:55.157353 [debug] [MainThread]: Using duckdb connection "master"
[0m01:56:55.158801 [debug] [MainThread]: On master: COMMIT
[0m01:56:55.160803 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m01:56:55.162304 [debug] [MainThread]: On master: Close
[0m01:56:55.166764 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:56:55.168508 [debug] [MainThread]: Connection 'list_legal_demo_main' was properly closed.
[0m01:56:55.169984 [debug] [MainThread]: Connection 'model.legal_demo.acris_cases' was properly closed.
[0m01:56:55.171517 [info ] [MainThread]: 
[0m01:56:55.173196 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.10 seconds (3.10s).
[0m01:56:55.175158 [debug] [MainThread]: Command end result
[0m01:56:55.208390 [info ] [MainThread]: 
[0m01:56:55.210355 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:56:55.212055 [info ] [MainThread]: 
[0m01:56:55.215106 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m01:56:55.218824 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.8890843, "process_user_time": 7.494484, "process_kernel_time": 1.299414, "process_mem_max_rss": "296048", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m01:56:55.221078 [debug] [MainThread]: Command `dbt run` succeeded at 01:56:55.220844 after 3.89 seconds
[0m01:56:55.222949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77be9e5b33d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77be9a09a3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77be9a09a110>]}
[0m01:56:55.224734 [debug] [MainThread]: Flushing usage events
[0m01:57:30.277684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x769d408f3dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x769d4109d7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x769d41450fd0>]}


============================== 01:57:30.287172 | a1201067-fa14-4809-a6f1-4a81997e41df ==============================
[0m01:57:30.287172 [info ] [MainThread]: Running with dbt=1.7.4
[0m01:57:30.288998 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m01:57:30.654954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a1201067-fa14-4809-a6f1-4a81997e41df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x769d3d7d9e50>]}
[0m01:57:30.756466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a1201067-fa14-4809-a6f1-4a81997e41df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x769d3d738fd0>]}
[0m01:57:30.759268 [info ] [MainThread]: Registered adapter: duckdb=1.7.4
[0m01:57:30.779540 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m01:57:30.853629 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:57:30.855369 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:57:30.862455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a1201067-fa14-4809-a6f1-4a81997e41df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x769d3706d2d0>]}
[0m01:57:30.905216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a1201067-fa14-4809-a6f1-4a81997e41df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x769d37141950>]}
[0m01:57:30.906925 [info ] [MainThread]: Found 1 model, 0 sources, 0 exposures, 0 metrics, 394 macros, 0 groups, 0 semantic models
[0m01:57:30.908651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a1201067-fa14-4809-a6f1-4a81997e41df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x769d4423f8d0>]}
[0m01:57:30.912014 [info ] [MainThread]: 
[0m01:57:30.914244 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m01:57:30.917284 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_legal_demo'
[0m01:57:30.933339 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo"
[0m01:57:30.935421 [debug] [ThreadPool]: On list_legal_demo: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"legal_demo"'
    
  
  
[0m01:57:30.937011 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:57:30.966049 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m01:57:30.969350 [debug] [ThreadPool]: On list_legal_demo: Close
[0m01:57:30.977867 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_legal_demo, now create_legal_demo_main)
[0m01:57:30.979686 [debug] [ThreadPool]: Creating schema "database: "legal_demo"
schema: "main"
"
[0m01:57:30.988876 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m01:57:30.990993 [debug] [ThreadPool]: On create_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "create_legal_demo_main"} */

    
        select type from duckdb_databases()
        where database_name='legal_demo'
        and type='sqlite'
    
  
[0m01:57:30.992532 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:57:31.017303 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m01:57:31.020359 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m01:57:31.022086 [debug] [ThreadPool]: On create_legal_demo_main: BEGIN
[0m01:57:31.023943 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m01:57:31.025435 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m01:57:31.026813 [debug] [ThreadPool]: On create_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "create_legal_demo_main"} */

    
    
        create schema if not exists "legal_demo"."main"
    
[0m01:57:31.028959 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m01:57:31.031086 [debug] [ThreadPool]: On create_legal_demo_main: COMMIT
[0m01:57:31.032820 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m01:57:31.034241 [debug] [ThreadPool]: On create_legal_demo_main: COMMIT
[0m01:57:31.036811 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m01:57:31.038379 [debug] [ThreadPool]: On create_legal_demo_main: Close
[0m01:57:31.091732 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_legal_demo_main, now list_legal_demo_main)
[0m01:57:31.099703 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo_main"
[0m01:57:31.101506 [debug] [ThreadPool]: On list_legal_demo_main: BEGIN
[0m01:57:31.103157 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:57:31.125767 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m01:57:31.127641 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo_main"
[0m01:57:31.129333 [debug] [ThreadPool]: On list_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo_main"} */
select
      'legal_demo' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'legal_demo'
  
[0m01:57:31.171935 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m01:57:31.179954 [debug] [ThreadPool]: On list_legal_demo_main: ROLLBACK
[0m01:57:31.182417 [debug] [ThreadPool]: Failed to rollback 'list_legal_demo_main'
[0m01:57:31.183926 [debug] [ThreadPool]: On list_legal_demo_main: Close
[0m01:57:31.190834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a1201067-fa14-4809-a6f1-4a81997e41df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x769d4423f1d0>]}
[0m01:57:31.192544 [debug] [MainThread]: Using duckdb connection "master"
[0m01:57:31.194167 [debug] [MainThread]: On master: BEGIN
[0m01:57:31.195771 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:57:31.217715 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m01:57:31.219675 [debug] [MainThread]: On master: COMMIT
[0m01:57:31.221122 [debug] [MainThread]: Using duckdb connection "master"
[0m01:57:31.222384 [debug] [MainThread]: On master: COMMIT
[0m01:57:31.224578 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m01:57:31.226169 [debug] [MainThread]: On master: Close
[0m01:57:31.231698 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:57:31.233597 [info ] [MainThread]: 
[0m01:57:31.245385 [debug] [Thread-1 (]: Began running node model.legal_demo.acris_cases
[0m01:57:31.247255 [info ] [Thread-1 (]: 1 of 1 START sql table model main.acris_clean .................................. [RUN]
[0m01:57:31.249545 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.legal_demo.acris_cases'
[0m01:57:31.251060 [debug] [Thread-1 (]: Began compiling node model.legal_demo.acris_cases
[0m01:57:31.259648 [debug] [Thread-1 (]: Writing injected SQL for node "model.legal_demo.acris_cases"
[0m01:57:31.271151 [debug] [Thread-1 (]: Timing info for model.legal_demo.acris_cases (compile): 01:57:31.252201 => 01:57:31.270665
[0m01:57:31.272715 [debug] [Thread-1 (]: Began executing node model.legal_demo.acris_cases
[0m01:57:31.312537 [debug] [Thread-1 (]: Writing runtime sql for node "model.legal_demo.acris_cases"
[0m01:57:31.325828 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m01:57:31.327728 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: BEGIN
[0m01:57:31.328945 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:57:31.350585 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m01:57:31.352848 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m01:57:31.354847 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */

  
    
    

    create  table
      "legal_demo"."main"."acris_clean__dbt_tmp"
  
    as (
      

SELECT *
FROM read_csv_auto('/opt/airflow/data/first_500k_acris.csv', header=True, delim=',')
    );
  
  
[0m01:57:33.778845 [debug] [Thread-1 (]: SQL status: OK in 2.0 seconds
[0m01:57:33.788712 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m01:57:33.790721 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
alter table "legal_demo"."main"."acris_clean" rename to "acris_clean__dbt_backup"
[0m01:57:33.793356 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m01:57:33.798149 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m01:57:33.799839 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
alter table "legal_demo"."main"."acris_clean__dbt_tmp" rename to "acris_clean"
[0m01:57:33.802267 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m01:57:33.826833 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: COMMIT
[0m01:57:33.829379 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m01:57:33.831336 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: COMMIT
[0m01:57:33.901710 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m01:57:33.909504 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m01:57:33.911570 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
drop table if exists "legal_demo"."main"."acris_clean__dbt_backup" cascade
[0m01:57:33.919216 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m01:57:33.922893 [debug] [Thread-1 (]: Timing info for model.legal_demo.acris_cases (execute): 01:57:31.273871 => 01:57:33.922575
[0m01:57:33.924736 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: Close
[0m01:57:33.992095 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a1201067-fa14-4809-a6f1-4a81997e41df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x769d409713d0>]}
[0m01:57:33.994664 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main.acris_clean ............................. [[32mOK[0m in 2.74s]
[0m01:57:33.996705 [debug] [Thread-1 (]: Finished running node model.legal_demo.acris_cases
[0m01:57:34.000875 [debug] [MainThread]: Using duckdb connection "master"
[0m01:57:34.002652 [debug] [MainThread]: On master: BEGIN
[0m01:57:34.004238 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:57:34.026102 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m01:57:34.027816 [debug] [MainThread]: On master: COMMIT
[0m01:57:34.029347 [debug] [MainThread]: Using duckdb connection "master"
[0m01:57:34.030721 [debug] [MainThread]: On master: COMMIT
[0m01:57:34.032747 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m01:57:34.034374 [debug] [MainThread]: On master: Close
[0m01:57:34.039339 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:57:34.041115 [debug] [MainThread]: Connection 'list_legal_demo_main' was properly closed.
[0m01:57:34.042564 [debug] [MainThread]: Connection 'model.legal_demo.acris_cases' was properly closed.
[0m01:57:34.044007 [info ] [MainThread]: 
[0m01:57:34.045724 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.13 seconds (3.13s).
[0m01:57:34.047639 [debug] [MainThread]: Command end result
[0m01:57:34.082573 [info ] [MainThread]: 
[0m01:57:34.084917 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:57:34.086778 [info ] [MainThread]: 
[0m01:57:34.088506 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m01:57:34.091019 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.9012878, "process_user_time": 7.513073, "process_kernel_time": 1.389817, "process_mem_max_rss": "296360", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m01:57:34.092980 [debug] [MainThread]: Command `dbt run` succeeded at 01:57:34.092760 after 3.90 seconds
[0m01:57:34.094359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x769d40942a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x769d41450fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x769d457094d0>]}
[0m01:57:34.095742 [debug] [MainThread]: Flushing usage events
[0m01:59:45.049024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7044a52c77d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7044a52ba950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7044a52b8490>]}


============================== 01:59:45.058061 | ad796647-9c2e-469c-9989-49c2ae35aaa7 ==============================
[0m01:59:45.058061 [info ] [MainThread]: Running with dbt=1.7.4
[0m01:59:45.060104 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m01:59:45.488415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ad796647-9c2e-469c-9989-49c2ae35aaa7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7044a559b950>]}
[0m01:59:45.586545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ad796647-9c2e-469c-9989-49c2ae35aaa7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7044a559b110>]}
[0m01:59:45.589587 [info ] [MainThread]: Registered adapter: duckdb=1.7.4
[0m01:59:45.610647 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m01:59:45.687305 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:59:45.689559 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:59:45.696716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ad796647-9c2e-469c-9989-49c2ae35aaa7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70449c0b9a50>]}
[0m01:59:45.738545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ad796647-9c2e-469c-9989-49c2ae35aaa7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70449c1ed550>]}
[0m01:59:45.740321 [info ] [MainThread]: Found 1 model, 0 sources, 0 exposures, 0 metrics, 394 macros, 0 groups, 0 semantic models
[0m01:59:45.741816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ad796647-9c2e-469c-9989-49c2ae35aaa7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70449c1defd0>]}
[0m01:59:45.744738 [info ] [MainThread]: 
[0m01:59:45.747358 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m01:59:45.750041 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_legal_demo'
[0m01:59:45.765790 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo"
[0m01:59:45.767964 [debug] [ThreadPool]: On list_legal_demo: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"legal_demo"'
    
  
  
[0m01:59:45.769427 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:59:45.800559 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m01:59:45.804149 [debug] [ThreadPool]: On list_legal_demo: Close
[0m01:59:45.813312 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_legal_demo, now create_legal_demo_main)
[0m01:59:45.815865 [debug] [ThreadPool]: Creating schema "database: "legal_demo"
schema: "main"
"
[0m01:59:45.824235 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m01:59:45.826376 [debug] [ThreadPool]: On create_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "create_legal_demo_main"} */

    
        select type from duckdb_databases()
        where database_name='legal_demo'
        and type='sqlite'
    
  
[0m01:59:45.828080 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:59:45.855625 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m01:59:45.858539 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m01:59:45.860498 [debug] [ThreadPool]: On create_legal_demo_main: BEGIN
[0m01:59:45.862663 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m01:59:45.864030 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m01:59:45.865351 [debug] [ThreadPool]: On create_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "create_legal_demo_main"} */

    
    
        create schema if not exists "legal_demo"."main"
    
[0m01:59:45.867247 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m01:59:45.869233 [debug] [ThreadPool]: On create_legal_demo_main: COMMIT
[0m01:59:45.870611 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m01:59:45.871854 [debug] [ThreadPool]: On create_legal_demo_main: COMMIT
[0m01:59:45.874333 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m01:59:45.875652 [debug] [ThreadPool]: On create_legal_demo_main: Close
[0m01:59:45.885378 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_legal_demo_main, now list_legal_demo_main)
[0m01:59:45.892994 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo_main"
[0m01:59:45.895001 [debug] [ThreadPool]: On list_legal_demo_main: BEGIN
[0m01:59:45.896334 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:59:45.919073 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m01:59:45.920751 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo_main"
[0m01:59:45.922305 [debug] [ThreadPool]: On list_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo_main"} */
select
      'legal_demo' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'legal_demo'
  
[0m01:59:45.947639 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m01:59:45.955266 [debug] [ThreadPool]: On list_legal_demo_main: ROLLBACK
[0m01:59:45.957535 [debug] [ThreadPool]: Failed to rollback 'list_legal_demo_main'
[0m01:59:45.959105 [debug] [ThreadPool]: On list_legal_demo_main: Close
[0m01:59:45.965592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ad796647-9c2e-469c-9989-49c2ae35aaa7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7044a59ffe90>]}
[0m01:59:45.967258 [debug] [MainThread]: Using duckdb connection "master"
[0m01:59:45.968636 [debug] [MainThread]: On master: BEGIN
[0m01:59:45.970304 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:59:45.991252 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m01:59:45.993030 [debug] [MainThread]: On master: COMMIT
[0m01:59:45.994459 [debug] [MainThread]: Using duckdb connection "master"
[0m01:59:45.995790 [debug] [MainThread]: On master: COMMIT
[0m01:59:45.997721 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m01:59:45.999270 [debug] [MainThread]: On master: Close
[0m01:59:46.004091 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:59:46.005763 [info ] [MainThread]: 
[0m01:59:46.017440 [debug] [Thread-1 (]: Began running node model.legal_demo.acris_cases
[0m01:59:46.019408 [info ] [Thread-1 (]: 1 of 1 START sql table model main.acris_clean .................................. [RUN]
[0m01:59:46.021593 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.legal_demo.acris_cases'
[0m01:59:46.023186 [debug] [Thread-1 (]: Began compiling node model.legal_demo.acris_cases
[0m01:59:46.032082 [debug] [Thread-1 (]: Writing injected SQL for node "model.legal_demo.acris_cases"
[0m01:59:46.045472 [debug] [Thread-1 (]: Timing info for model.legal_demo.acris_cases (compile): 01:59:46.024480 => 01:59:46.045047
[0m01:59:46.046959 [debug] [Thread-1 (]: Began executing node model.legal_demo.acris_cases
[0m01:59:46.086908 [debug] [Thread-1 (]: Writing runtime sql for node "model.legal_demo.acris_cases"
[0m01:59:46.102808 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m01:59:46.105012 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: BEGIN
[0m01:59:46.106601 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:59:46.133433 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m01:59:46.135316 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m01:59:46.136988 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */

  
    
    

    create  table
      "legal_demo"."main"."acris_clean__dbt_tmp"
  
    as (
      

SELECT *
FROM read_csv_auto('/opt/airflow/data/first_500k_acris.csv', header=True, delim=',')
    );
  
  
[0m01:59:48.612456 [debug] [Thread-1 (]: SQL status: OK in 2.0 seconds
[0m01:59:48.621751 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m01:59:48.623841 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
alter table "legal_demo"."main"."acris_clean" rename to "acris_clean__dbt_backup"
[0m01:59:48.626951 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m01:59:48.631391 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m01:59:48.633408 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
alter table "legal_demo"."main"."acris_clean__dbt_tmp" rename to "acris_clean"
[0m01:59:48.635534 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m01:59:48.660997 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: COMMIT
[0m01:59:48.663297 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m01:59:48.665308 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: COMMIT
[0m01:59:48.692668 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m01:59:48.700422 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m01:59:48.702198 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
drop table if exists "legal_demo"."main"."acris_clean__dbt_backup" cascade
[0m01:59:48.709353 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m01:59:48.712417 [debug] [Thread-1 (]: Timing info for model.legal_demo.acris_cases (execute): 01:59:46.048223 => 01:59:48.712119
[0m01:59:48.713954 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: Close
[0m01:59:48.782262 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad796647-9c2e-469c-9989-49c2ae35aaa7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70449bf90e10>]}
[0m01:59:48.784898 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main.acris_clean ............................. [[32mOK[0m in 2.76s]
[0m01:59:48.787349 [debug] [Thread-1 (]: Finished running node model.legal_demo.acris_cases
[0m01:59:48.791770 [debug] [MainThread]: Using duckdb connection "master"
[0m01:59:48.793769 [debug] [MainThread]: On master: BEGIN
[0m01:59:48.795431 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:59:48.817523 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m01:59:48.819185 [debug] [MainThread]: On master: COMMIT
[0m01:59:48.821397 [debug] [MainThread]: Using duckdb connection "master"
[0m01:59:48.823076 [debug] [MainThread]: On master: COMMIT
[0m01:59:48.825369 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m01:59:48.826955 [debug] [MainThread]: On master: Close
[0m01:59:48.831892 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:59:48.833641 [debug] [MainThread]: Connection 'list_legal_demo_main' was properly closed.
[0m01:59:48.835164 [debug] [MainThread]: Connection 'model.legal_demo.acris_cases' was properly closed.
[0m01:59:48.837677 [info ] [MainThread]: 
[0m01:59:48.839584 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.09 seconds (3.09s).
[0m01:59:48.841635 [debug] [MainThread]: Command end result
[0m01:59:48.878209 [info ] [MainThread]: 
[0m01:59:48.880004 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:59:48.881756 [info ] [MainThread]: 
[0m01:59:48.883367 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m01:59:48.885970 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.9078948, "process_user_time": 7.33829, "process_kernel_time": 1.293583, "process_mem_max_rss": "295392", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m01:59:48.888115 [debug] [MainThread]: Command `dbt run` succeeded at 01:59:48.887901 after 3.91 seconds
[0m01:59:48.890156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7044a56d9410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7044aa0b2690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7044aa15eb50>]}
[0m01:59:48.891940 [debug] [MainThread]: Flushing usage events
[0m02:01:19.260807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7385357484d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73853575bd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7385354741d0>]}


============================== 02:01:19.283444 | 545abda5-dd02-467a-8c65-ec42aaa17df0 ==============================
[0m02:01:19.283444 [info ] [MainThread]: Running with dbt=1.7.4
[0m02:01:19.285612 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m02:01:19.648818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '545abda5-dd02-467a-8c65-ec42aaa17df0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x738534ffff50>]}
[0m02:01:19.750940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '545abda5-dd02-467a-8c65-ec42aaa17df0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x738535767990>]}
[0m02:01:19.753736 [info ] [MainThread]: Registered adapter: duckdb=1.7.4
[0m02:01:19.771101 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m02:01:19.842787 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:01:19.844867 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:01:19.852430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '545abda5-dd02-467a-8c65-ec42aaa17df0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73852bdb4e50>]}
[0m02:01:19.905682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '545abda5-dd02-467a-8c65-ec42aaa17df0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x738535759f10>]}
[0m02:01:19.907522 [info ] [MainThread]: Found 1 model, 0 sources, 0 exposures, 0 metrics, 394 macros, 0 groups, 0 semantic models
[0m02:01:19.909151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '545abda5-dd02-467a-8c65-ec42aaa17df0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x738535086b50>]}
[0m02:01:19.912461 [info ] [MainThread]: 
[0m02:01:19.914712 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m02:01:19.917611 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_legal_demo'
[0m02:01:19.936828 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo"
[0m02:01:19.938846 [debug] [ThreadPool]: On list_legal_demo: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"legal_demo"'
    
  
  
[0m02:01:19.940389 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:01:19.975235 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:01:19.978806 [debug] [ThreadPool]: On list_legal_demo: Close
[0m02:01:19.988281 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_legal_demo, now create_legal_demo_main)
[0m02:01:19.990798 [debug] [ThreadPool]: Creating schema "database: "legal_demo"
schema: "main"
"
[0m02:01:19.999253 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m02:01:20.001080 [debug] [ThreadPool]: On create_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "create_legal_demo_main"} */

    
        select type from duckdb_databases()
        where database_name='legal_demo'
        and type='sqlite'
    
  
[0m02:01:20.002683 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:01:20.029142 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:01:20.032072 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m02:01:20.033629 [debug] [ThreadPool]: On create_legal_demo_main: BEGIN
[0m02:01:20.035541 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:01:20.036845 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m02:01:20.038704 [debug] [ThreadPool]: On create_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "create_legal_demo_main"} */

    
    
        create schema if not exists "legal_demo"."main"
    
[0m02:01:20.040832 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:01:20.043011 [debug] [ThreadPool]: On create_legal_demo_main: COMMIT
[0m02:01:20.044389 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m02:01:20.045702 [debug] [ThreadPool]: On create_legal_demo_main: COMMIT
[0m02:01:20.048547 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:01:20.050040 [debug] [ThreadPool]: On create_legal_demo_main: Close
[0m02:01:20.060079 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_legal_demo_main, now list_legal_demo_main)
[0m02:01:20.067527 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo_main"
[0m02:01:20.069474 [debug] [ThreadPool]: On list_legal_demo_main: BEGIN
[0m02:01:20.071117 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:01:20.093068 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:01:20.094960 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo_main"
[0m02:01:20.096794 [debug] [ThreadPool]: On list_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo_main"} */
select
      'legal_demo' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'legal_demo'
  
[0m02:01:20.136379 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:01:20.145146 [debug] [ThreadPool]: On list_legal_demo_main: ROLLBACK
[0m02:01:20.147604 [debug] [ThreadPool]: Failed to rollback 'list_legal_demo_main'
[0m02:01:20.149264 [debug] [ThreadPool]: On list_legal_demo_main: Close
[0m02:01:20.158021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '545abda5-dd02-467a-8c65-ec42aaa17df0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x738535449410>]}
[0m02:01:20.160030 [debug] [MainThread]: Using duckdb connection "master"
[0m02:01:20.161565 [debug] [MainThread]: On master: BEGIN
[0m02:01:20.163268 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:01:20.186472 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m02:01:20.188451 [debug] [MainThread]: On master: COMMIT
[0m02:01:20.190388 [debug] [MainThread]: Using duckdb connection "master"
[0m02:01:20.194302 [debug] [MainThread]: On master: COMMIT
[0m02:01:20.197380 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m02:01:20.199263 [debug] [MainThread]: On master: Close
[0m02:01:20.206590 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:01:20.209057 [info ] [MainThread]: 
[0m02:01:20.226268 [debug] [Thread-1 (]: Began running node model.legal_demo.acris_cases
[0m02:01:20.228978 [info ] [Thread-1 (]: 1 of 1 START sql table model main.acris_clean .................................. [RUN]
[0m02:01:20.232093 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.legal_demo.acris_cases'
[0m02:01:20.234394 [debug] [Thread-1 (]: Began compiling node model.legal_demo.acris_cases
[0m02:01:20.247974 [debug] [Thread-1 (]: Writing injected SQL for node "model.legal_demo.acris_cases"
[0m02:01:20.262338 [debug] [Thread-1 (]: Timing info for model.legal_demo.acris_cases (compile): 02:01:20.236037 => 02:01:20.261552
[0m02:01:20.264342 [debug] [Thread-1 (]: Began executing node model.legal_demo.acris_cases
[0m02:01:20.351881 [debug] [Thread-1 (]: Writing runtime sql for node "model.legal_demo.acris_cases"
[0m02:01:20.367989 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m02:01:20.370998 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: BEGIN
[0m02:01:20.372911 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:01:20.408717 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:01:20.411352 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m02:01:20.413405 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */

  
    
    

    create  table
      "legal_demo"."main"."acris_clean__dbt_tmp"
  
    as (
      

SELECT *
FROM read_csv_auto('/opt/airflow/data/first_500k_acris.csv', header=True, delim=',')
    );
  
  
[0m02:01:22.823199 [debug] [Thread-1 (]: SQL status: OK in 2.0 seconds
[0m02:01:22.831786 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m02:01:22.833681 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
alter table "legal_demo"."main"."acris_clean" rename to "acris_clean__dbt_backup"
[0m02:01:22.836308 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:01:22.841225 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m02:01:22.843270 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
alter table "legal_demo"."main"."acris_clean__dbt_tmp" rename to "acris_clean"
[0m02:01:22.845632 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:01:22.869561 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: COMMIT
[0m02:01:22.871749 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m02:01:22.873879 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: COMMIT
[0m02:01:22.915323 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:01:22.923300 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m02:01:22.925702 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
drop table if exists "legal_demo"."main"."acris_clean__dbt_backup" cascade
[0m02:01:22.935109 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:01:22.939143 [debug] [Thread-1 (]: Timing info for model.legal_demo.acris_cases (execute): 02:01:20.265920 => 02:01:22.938868
[0m02:01:22.941598 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: Close
[0m02:01:23.009169 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '545abda5-dd02-467a-8c65-ec42aaa17df0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73853507fa90>]}
[0m02:01:23.011947 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main.acris_clean ............................. [[32mOK[0m in 2.78s]
[0m02:01:23.014319 [debug] [Thread-1 (]: Finished running node model.legal_demo.acris_cases
[0m02:01:23.019116 [debug] [MainThread]: Using duckdb connection "master"
[0m02:01:23.020996 [debug] [MainThread]: On master: BEGIN
[0m02:01:23.023071 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:01:23.048956 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m02:01:23.050868 [debug] [MainThread]: On master: COMMIT
[0m02:01:23.052529 [debug] [MainThread]: Using duckdb connection "master"
[0m02:01:23.054170 [debug] [MainThread]: On master: COMMIT
[0m02:01:23.056184 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m02:01:23.058034 [debug] [MainThread]: On master: Close
[0m02:01:23.063116 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:01:23.065126 [debug] [MainThread]: Connection 'list_legal_demo_main' was properly closed.
[0m02:01:23.066850 [debug] [MainThread]: Connection 'model.legal_demo.acris_cases' was properly closed.
[0m02:01:23.068873 [info ] [MainThread]: 
[0m02:01:23.070756 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.15 seconds (3.15s).
[0m02:01:23.072838 [debug] [MainThread]: Command end result
[0m02:01:23.111048 [info ] [MainThread]: 
[0m02:01:23.113307 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:01:23.115090 [info ] [MainThread]: 
[0m02:01:23.116861 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m02:01:23.119328 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.9266055, "process_user_time": 7.246432, "process_kernel_time": 1.302594, "process_mem_max_rss": "297188", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m02:01:23.121612 [debug] [MainThread]: Command `dbt run` succeeded at 02:01:23.121379 after 3.93 seconds
[0m02:01:23.123387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73853577a3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7385389527d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x738539e7d4d0>]}
[0m02:01:23.125345 [debug] [MainThread]: Flushing usage events
[0m02:01:55.443674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x731205c12910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x731205ef1d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73120633cdd0>]}


============================== 02:01:55.462010 | 465aa564-91d2-4eae-8281-268801e4a939 ==============================
[0m02:01:55.462010 [info ] [MainThread]: Running with dbt=1.7.4
[0m02:01:55.464119 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt', 'send_anonymous_usage_stats': 'True'}
[0m02:01:55.825325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '465aa564-91d2-4eae-8281-268801e4a939', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x731205d3de90>]}
[0m02:01:55.928994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '465aa564-91d2-4eae-8281-268801e4a939', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x731205fac250>]}
[0m02:01:55.931525 [info ] [MainThread]: Registered adapter: duckdb=1.7.4
[0m02:01:55.953382 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m02:01:56.033529 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:01:56.035809 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:01:56.043445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '465aa564-91d2-4eae-8281-268801e4a939', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7311fc9c0850>]}
[0m02:01:56.090593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '465aa564-91d2-4eae-8281-268801e4a939', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7311fcb998d0>]}
[0m02:01:56.092526 [info ] [MainThread]: Found 1 model, 0 sources, 0 exposures, 0 metrics, 394 macros, 0 groups, 0 semantic models
[0m02:01:56.094091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '465aa564-91d2-4eae-8281-268801e4a939', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7312095a38d0>]}
[0m02:01:56.097164 [info ] [MainThread]: 
[0m02:01:56.099321 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m02:01:56.102906 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_legal_demo'
[0m02:01:56.118748 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo"
[0m02:01:56.120700 [debug] [ThreadPool]: On list_legal_demo: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"legal_demo"'
    
  
  
[0m02:01:56.122513 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:01:56.155536 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:01:56.158870 [debug] [ThreadPool]: On list_legal_demo: Close
[0m02:01:56.168370 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_legal_demo, now create_legal_demo_main)
[0m02:01:56.170452 [debug] [ThreadPool]: Creating schema "database: "legal_demo"
schema: "main"
"
[0m02:01:56.179358 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m02:01:56.181535 [debug] [ThreadPool]: On create_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "create_legal_demo_main"} */

    
        select type from duckdb_databases()
        where database_name='legal_demo'
        and type='sqlite'
    
  
[0m02:01:56.183212 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:01:56.209772 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:01:56.212611 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m02:01:56.214164 [debug] [ThreadPool]: On create_legal_demo_main: BEGIN
[0m02:01:56.216319 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:01:56.217846 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m02:01:56.219302 [debug] [ThreadPool]: On create_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "create_legal_demo_main"} */

    
    
        create schema if not exists "legal_demo"."main"
    
[0m02:01:56.221339 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:01:56.223480 [debug] [ThreadPool]: On create_legal_demo_main: COMMIT
[0m02:01:56.224967 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m02:01:56.226706 [debug] [ThreadPool]: On create_legal_demo_main: COMMIT
[0m02:01:56.229730 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:01:56.231355 [debug] [ThreadPool]: On create_legal_demo_main: Close
[0m02:01:56.241848 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_legal_demo_main, now list_legal_demo_main)
[0m02:01:56.249502 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo_main"
[0m02:01:56.251454 [debug] [ThreadPool]: On list_legal_demo_main: BEGIN
[0m02:01:56.253244 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:01:56.277788 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:01:56.313237 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo_main"
[0m02:01:56.314953 [debug] [ThreadPool]: On list_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo_main"} */
select
      'legal_demo' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'legal_demo'
  
[0m02:01:56.341117 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:01:56.349877 [debug] [ThreadPool]: On list_legal_demo_main: ROLLBACK
[0m02:01:56.352475 [debug] [ThreadPool]: Failed to rollback 'list_legal_demo_main'
[0m02:01:56.354023 [debug] [ThreadPool]: On list_legal_demo_main: Close
[0m02:01:56.361167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '465aa564-91d2-4eae-8281-268801e4a939', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7311fca492d0>]}
[0m02:01:56.362835 [debug] [MainThread]: Using duckdb connection "master"
[0m02:01:56.364411 [debug] [MainThread]: On master: BEGIN
[0m02:01:56.365755 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:01:56.387042 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m02:01:56.388705 [debug] [MainThread]: On master: COMMIT
[0m02:01:56.390223 [debug] [MainThread]: Using duckdb connection "master"
[0m02:01:56.391879 [debug] [MainThread]: On master: COMMIT
[0m02:01:56.393956 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m02:01:56.395390 [debug] [MainThread]: On master: Close
[0m02:01:56.400321 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:01:56.402025 [info ] [MainThread]: 
[0m02:01:56.414208 [debug] [Thread-1 (]: Began running node model.legal_demo.acris_cases
[0m02:01:56.415960 [info ] [Thread-1 (]: 1 of 1 START sql table model main.acris_clean .................................. [RUN]
[0m02:01:56.418026 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.legal_demo.acris_cases'
[0m02:01:56.419482 [debug] [Thread-1 (]: Began compiling node model.legal_demo.acris_cases
[0m02:01:56.428779 [debug] [Thread-1 (]: Writing injected SQL for node "model.legal_demo.acris_cases"
[0m02:01:56.441720 [debug] [Thread-1 (]: Timing info for model.legal_demo.acris_cases (compile): 02:01:56.420890 => 02:01:56.441358
[0m02:01:56.443131 [debug] [Thread-1 (]: Began executing node model.legal_demo.acris_cases
[0m02:01:56.486953 [debug] [Thread-1 (]: Writing runtime sql for node "model.legal_demo.acris_cases"
[0m02:01:56.499866 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m02:01:56.501506 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: BEGIN
[0m02:01:56.503094 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:01:56.529520 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:01:56.532006 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m02:01:56.533973 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */

  
    
    

    create  table
      "legal_demo"."main"."acris_clean__dbt_tmp"
  
    as (
      

SELECT *
FROM read_csv_auto('/opt/airflow/data/first_500k_acris.csv', header=True, delim=',')
    );
  
  
[0m02:01:58.971529 [debug] [Thread-1 (]: SQL status: OK in 2.0 seconds
[0m02:01:58.981086 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m02:01:58.983047 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
alter table "legal_demo"."main"."acris_clean" rename to "acris_clean__dbt_backup"
[0m02:01:58.985659 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:01:58.990564 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m02:01:58.992395 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
alter table "legal_demo"."main"."acris_clean__dbt_tmp" rename to "acris_clean"
[0m02:01:58.994446 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:01:59.019232 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: COMMIT
[0m02:01:59.021392 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m02:01:59.023053 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: COMMIT
[0m02:01:59.050441 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:01:59.058092 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m02:01:59.060158 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
drop table if exists "legal_demo"."main"."acris_clean__dbt_backup" cascade
[0m02:01:59.068401 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:01:59.071635 [debug] [Thread-1 (]: Timing info for model.legal_demo.acris_cases (execute): 02:01:56.444373 => 02:01:59.071359
[0m02:01:59.073579 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: Close
[0m02:01:59.140944 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '465aa564-91d2-4eae-8281-268801e4a939', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7311fc854bd0>]}
[0m02:01:59.143304 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main.acris_clean ............................. [[32mOK[0m in 2.72s]
[0m02:01:59.145201 [debug] [Thread-1 (]: Finished running node model.legal_demo.acris_cases
[0m02:01:59.149265 [debug] [MainThread]: Using duckdb connection "master"
[0m02:01:59.150738 [debug] [MainThread]: On master: BEGIN
[0m02:01:59.152219 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:01:59.174160 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m02:01:59.176020 [debug] [MainThread]: On master: COMMIT
[0m02:01:59.177513 [debug] [MainThread]: Using duckdb connection "master"
[0m02:01:59.178938 [debug] [MainThread]: On master: COMMIT
[0m02:01:59.180621 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m02:01:59.182001 [debug] [MainThread]: On master: Close
[0m02:01:59.186693 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:01:59.188354 [debug] [MainThread]: Connection 'list_legal_demo_main' was properly closed.
[0m02:01:59.189867 [debug] [MainThread]: Connection 'model.legal_demo.acris_cases' was properly closed.
[0m02:01:59.191229 [info ] [MainThread]: 
[0m02:01:59.192780 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.09 seconds (3.09s).
[0m02:01:59.194575 [debug] [MainThread]: Command end result
[0m02:01:59.225502 [info ] [MainThread]: 
[0m02:01:59.227157 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:01:59.228682 [info ] [MainThread]: 
[0m02:01:59.230071 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m02:01:59.232533 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.858149, "process_user_time": 7.277973, "process_kernel_time": 1.261729, "process_mem_max_rss": "298956", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m02:01:59.234300 [debug] [MainThread]: Command `dbt run` succeeded at 02:01:59.234103 after 3.86 seconds
[0m02:01:59.235798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73120aa29b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73120a8833d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73120634bb10>]}
[0m02:01:59.237229 [debug] [MainThread]: Flushing usage events
[0m02:25:47.616359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727ef25e2b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727ef25e2810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727ef25e3e90>]}


============================== 02:25:47.627467 | 30df1a59-feaf-4cd5-8a0b-0c50c9db7a8a ==============================
[0m02:25:47.627467 [info ] [MainThread]: Running with dbt=1.7.4
[0m02:25:47.629976 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:25:48.043880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '30df1a59-feaf-4cd5-8a0b-0c50c9db7a8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727ef244aed0>]}
[0m02:25:48.150302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '30df1a59-feaf-4cd5-8a0b-0c50c9db7a8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727ef281ee90>]}
[0m02:25:48.153398 [info ] [MainThread]: Registered adapter: duckdb=1.7.4
[0m02:25:48.173943 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m02:25:48.271008 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:25:48.273241 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:25:48.281382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '30df1a59-feaf-4cd5-8a0b-0c50c9db7a8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727ef242f510>]}
[0m02:25:48.332938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '30df1a59-feaf-4cd5-8a0b-0c50c9db7a8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727ee9251f90>]}
[0m02:25:48.335309 [info ] [MainThread]: Found 1 model, 0 sources, 0 exposures, 0 metrics, 394 macros, 0 groups, 0 semantic models
[0m02:25:48.337088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '30df1a59-feaf-4cd5-8a0b-0c50c9db7a8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727ee915a250>]}
[0m02:25:48.340689 [info ] [MainThread]: 
[0m02:25:48.343159 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m02:25:48.346228 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_legal_demo'
[0m02:25:48.360721 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo"
[0m02:25:48.362588 [debug] [ThreadPool]: On list_legal_demo: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"legal_demo"'
    
  
  
[0m02:25:48.364290 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:25:48.420376 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:25:48.424419 [debug] [ThreadPool]: On list_legal_demo: Close
[0m02:25:48.434390 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_legal_demo, now create_legal_demo_main)
[0m02:25:48.436583 [debug] [ThreadPool]: Creating schema "database: "legal_demo"
schema: "main"
"
[0m02:25:48.445951 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m02:25:48.448886 [debug] [ThreadPool]: On create_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "create_legal_demo_main"} */

    
        select type from duckdb_databases()
        where database_name='legal_demo'
        and type='sqlite'
    
  
[0m02:25:48.453643 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:25:48.494230 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:25:48.497611 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m02:25:48.499462 [debug] [ThreadPool]: On create_legal_demo_main: BEGIN
[0m02:25:48.501848 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:25:48.503642 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m02:25:48.505057 [debug] [ThreadPool]: On create_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "create_legal_demo_main"} */

    
    
        create schema if not exists "legal_demo"."main"
    
[0m02:25:48.508559 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:25:48.510795 [debug] [ThreadPool]: On create_legal_demo_main: COMMIT
[0m02:25:48.512612 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m02:25:48.514251 [debug] [ThreadPool]: On create_legal_demo_main: COMMIT
[0m02:25:48.516935 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:25:48.518680 [debug] [ThreadPool]: On create_legal_demo_main: Close
[0m02:25:48.529757 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_legal_demo_main, now list_legal_demo_main)
[0m02:25:48.538704 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo_main"
[0m02:25:48.540516 [debug] [ThreadPool]: On list_legal_demo_main: BEGIN
[0m02:25:48.541941 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:25:48.569612 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:25:48.571468 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo_main"
[0m02:25:48.573699 [debug] [ThreadPool]: On list_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo_main"} */
select
      'legal_demo' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'legal_demo'
  
[0m02:25:48.609356 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:25:48.618469 [debug] [ThreadPool]: On list_legal_demo_main: ROLLBACK
[0m02:25:48.621413 [debug] [ThreadPool]: Failed to rollback 'list_legal_demo_main'
[0m02:25:48.623139 [debug] [ThreadPool]: On list_legal_demo_main: Close
[0m02:25:48.630315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '30df1a59-feaf-4cd5-8a0b-0c50c9db7a8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727ee935e890>]}
[0m02:25:48.632172 [debug] [MainThread]: Using duckdb connection "master"
[0m02:25:48.633780 [debug] [MainThread]: On master: BEGIN
[0m02:25:48.635453 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:25:48.657460 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m02:25:48.659529 [debug] [MainThread]: On master: COMMIT
[0m02:25:48.661364 [debug] [MainThread]: Using duckdb connection "master"
[0m02:25:48.662914 [debug] [MainThread]: On master: COMMIT
[0m02:25:48.665057 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m02:25:48.666685 [debug] [MainThread]: On master: Close
[0m02:25:48.672103 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:25:48.673944 [info ] [MainThread]: 
[0m02:25:48.685722 [debug] [Thread-1 (]: Began running node model.legal_demo.acris_cases
[0m02:25:48.687886 [info ] [Thread-1 (]: 1 of 1 START sql table model main.acris_clean .................................. [RUN]
[0m02:25:48.690683 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.legal_demo.acris_cases'
[0m02:25:48.692699 [debug] [Thread-1 (]: Began compiling node model.legal_demo.acris_cases
[0m02:25:48.702037 [debug] [Thread-1 (]: Writing injected SQL for node "model.legal_demo.acris_cases"
[0m02:25:48.718989 [debug] [Thread-1 (]: Timing info for model.legal_demo.acris_cases (compile): 02:25:48.694381 => 02:25:48.718533
[0m02:25:48.720784 [debug] [Thread-1 (]: Began executing node model.legal_demo.acris_cases
[0m02:25:48.760076 [debug] [Thread-1 (]: Writing runtime sql for node "model.legal_demo.acris_cases"
[0m02:25:48.774787 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m02:25:48.776719 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: BEGIN
[0m02:25:48.778360 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:25:48.805045 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:25:48.807275 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m02:25:48.809073 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */

  
    
    

    create  table
      "legal_demo"."main"."acris_clean__dbt_tmp"
  
    as (
      

SELECT *
FROM read_csv_auto('/opt/airflow/data/first_500k_acris.csv', header=True, delim=',')
    );
  
  
[0m02:25:51.321620 [debug] [Thread-1 (]: SQL status: OK in 3.0 seconds
[0m02:25:51.330485 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m02:25:51.332652 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
alter table "legal_demo"."main"."acris_clean" rename to "acris_clean__dbt_backup"
[0m02:25:51.336315 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:25:51.343428 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m02:25:51.345079 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
alter table "legal_demo"."main"."acris_clean__dbt_tmp" rename to "acris_clean"
[0m02:25:51.347421 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:25:51.371409 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: COMMIT
[0m02:25:51.373689 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m02:25:51.375169 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: COMMIT
[0m02:25:51.448840 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:25:51.456986 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m02:25:51.458708 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
drop table if exists "legal_demo"."main"."acris_clean__dbt_backup" cascade
[0m02:25:51.466236 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:25:51.469207 [debug] [Thread-1 (]: Timing info for model.legal_demo.acris_cases (execute): 02:25:48.722179 => 02:25:51.468951
[0m02:25:51.471027 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: Close
[0m02:25:51.534936 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30df1a59-feaf-4cd5-8a0b-0c50c9db7a8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727ee9054690>]}
[0m02:25:51.537333 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main.acris_clean ............................. [[32mOK[0m in 2.84s]
[0m02:25:51.539835 [debug] [Thread-1 (]: Finished running node model.legal_demo.acris_cases
[0m02:25:51.544781 [debug] [MainThread]: Using duckdb connection "master"
[0m02:25:51.546582 [debug] [MainThread]: On master: BEGIN
[0m02:25:51.548304 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:25:51.570599 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m02:25:51.572298 [debug] [MainThread]: On master: COMMIT
[0m02:25:51.573718 [debug] [MainThread]: Using duckdb connection "master"
[0m02:25:51.575009 [debug] [MainThread]: On master: COMMIT
[0m02:25:51.576795 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m02:25:51.578100 [debug] [MainThread]: On master: Close
[0m02:25:51.582637 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:25:51.584457 [debug] [MainThread]: Connection 'list_legal_demo_main' was properly closed.
[0m02:25:51.585938 [debug] [MainThread]: Connection 'model.legal_demo.acris_cases' was properly closed.
[0m02:25:51.587506 [info ] [MainThread]: 
[0m02:25:51.589082 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.24 seconds (3.24s).
[0m02:25:51.590931 [debug] [MainThread]: Command end result
[0m02:25:51.622048 [info ] [MainThread]: 
[0m02:25:51.624184 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:25:51.626192 [info ] [MainThread]: 
[0m02:25:51.628298 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m02:25:51.631032 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.0912156, "process_user_time": 8.097068, "process_kernel_time": 1.753686, "process_mem_max_rss": "300392", "process_out_blocks": "8384", "process_in_blocks": "0"}
[0m02:25:51.632949 [debug] [MainThread]: Command `dbt run` succeeded at 02:25:51.632751 after 4.09 seconds
[0m02:25:51.634396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727ef270eb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727ef735bb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727ef72bc810>]}
[0m02:25:51.635937 [debug] [MainThread]: Flushing usage events
[0m02:33:08.127969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74875eff4fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74875eff54d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74875f6df610>]}


============================== 02:33:08.137063 | 0d1bfa3c-5682-446e-85a2-2c9f632ae948 ==============================
[0m02:33:08.137063 [info ] [MainThread]: Running with dbt=1.7.4
[0m02:33:08.138931 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt', 'send_anonymous_usage_stats': 'True'}
[0m02:33:08.536311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0d1bfa3c-5682-446e-85a2-2c9f632ae948', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74875f02ff10>]}
[0m02:33:08.642105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0d1bfa3c-5682-446e-85a2-2c9f632ae948', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74875fb57bd0>]}
[0m02:33:08.644945 [info ] [MainThread]: Registered adapter: duckdb=1.7.4
[0m02:33:08.665763 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m02:33:08.748165 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:33:08.750392 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:33:08.758356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0d1bfa3c-5682-446e-85a2-2c9f632ae948', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74875f0c1910>]}
[0m02:33:08.807486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0d1bfa3c-5682-446e-85a2-2c9f632ae948', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x748755e50ed0>]}
[0m02:33:08.810667 [info ] [MainThread]: Found 1 model, 0 sources, 0 exposures, 0 metrics, 394 macros, 0 groups, 0 semantic models
[0m02:33:08.812385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0d1bfa3c-5682-446e-85a2-2c9f632ae948', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x748755d66390>]}
[0m02:33:08.815814 [info ] [MainThread]: 
[0m02:33:08.818313 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m02:33:08.821507 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_legal_demo'
[0m02:33:08.838357 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo"
[0m02:33:08.840706 [debug] [ThreadPool]: On list_legal_demo: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"legal_demo"'
    
  
  
[0m02:33:08.842877 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:33:08.883955 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:33:08.887903 [debug] [ThreadPool]: On list_legal_demo: Close
[0m02:33:08.898663 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_legal_demo, now create_legal_demo_main)
[0m02:33:08.901619 [debug] [ThreadPool]: Creating schema "database: "legal_demo"
schema: "main"
"
[0m02:33:08.911517 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m02:33:08.913861 [debug] [ThreadPool]: On create_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "create_legal_demo_main"} */

    
        select type from duckdb_databases()
        where database_name='legal_demo'
        and type='sqlite'
    
  
[0m02:33:08.915510 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:33:08.942646 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:33:08.945442 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m02:33:08.947428 [debug] [ThreadPool]: On create_legal_demo_main: BEGIN
[0m02:33:08.949798 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:33:08.951550 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m02:33:08.953226 [debug] [ThreadPool]: On create_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "create_legal_demo_main"} */

    
    
        create schema if not exists "legal_demo"."main"
    
[0m02:33:08.955673 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:33:08.957650 [debug] [ThreadPool]: On create_legal_demo_main: COMMIT
[0m02:33:08.959521 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m02:33:08.960875 [debug] [ThreadPool]: On create_legal_demo_main: COMMIT
[0m02:33:08.963896 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:33:08.965504 [debug] [ThreadPool]: On create_legal_demo_main: Close
[0m02:33:08.975981 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_legal_demo_main, now list_legal_demo_main)
[0m02:33:08.983751 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo_main"
[0m02:33:08.985797 [debug] [ThreadPool]: On list_legal_demo_main: BEGIN
[0m02:33:08.987416 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:33:09.010102 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:33:09.011772 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo_main"
[0m02:33:09.013166 [debug] [ThreadPool]: On list_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo_main"} */
select
      'legal_demo' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'legal_demo'
  
[0m02:33:09.043158 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:33:09.051527 [debug] [ThreadPool]: On list_legal_demo_main: ROLLBACK
[0m02:33:09.054212 [debug] [ThreadPool]: Failed to rollback 'list_legal_demo_main'
[0m02:33:09.055976 [debug] [ThreadPool]: On list_legal_demo_main: Close
[0m02:33:09.063534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0d1bfa3c-5682-446e-85a2-2c9f632ae948', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74875f4bbc10>]}
[0m02:33:09.065988 [debug] [MainThread]: Using duckdb connection "master"
[0m02:33:09.067627 [debug] [MainThread]: On master: BEGIN
[0m02:33:09.069204 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:33:09.093900 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m02:33:09.095941 [debug] [MainThread]: On master: COMMIT
[0m02:33:09.097446 [debug] [MainThread]: Using duckdb connection "master"
[0m02:33:09.098901 [debug] [MainThread]: On master: COMMIT
[0m02:33:09.101343 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m02:33:09.103141 [debug] [MainThread]: On master: Close
[0m02:33:09.108785 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:33:09.110742 [info ] [MainThread]: 
[0m02:33:09.121945 [debug] [Thread-1 (]: Began running node model.legal_demo.acris_cases
[0m02:33:09.124055 [info ] [Thread-1 (]: 1 of 1 START sql table model main.acris_clean .................................. [RUN]
[0m02:33:09.126705 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.legal_demo.acris_cases'
[0m02:33:09.128437 [debug] [Thread-1 (]: Began compiling node model.legal_demo.acris_cases
[0m02:33:09.137865 [debug] [Thread-1 (]: Writing injected SQL for node "model.legal_demo.acris_cases"
[0m02:33:09.151599 [debug] [Thread-1 (]: Timing info for model.legal_demo.acris_cases (compile): 02:33:09.129784 => 02:33:09.151041
[0m02:33:09.153514 [debug] [Thread-1 (]: Began executing node model.legal_demo.acris_cases
[0m02:33:09.209227 [debug] [Thread-1 (]: Writing runtime sql for node "model.legal_demo.acris_cases"
[0m02:33:09.224988 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m02:33:09.227106 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: BEGIN
[0m02:33:09.228951 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:33:09.254282 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:33:09.256784 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m02:33:09.259362 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */

  
    
    

    create  table
      "legal_demo"."main"."acris_clean__dbt_tmp"
  
    as (
      

SELECT *
FROM read_csv_auto('/opt/airflow/data/first_500k_acris.csv', header=True, delim=',')
    );
  
  
[0m02:33:12.317045 [debug] [Thread-1 (]: SQL status: OK in 3.0 seconds
[0m02:33:12.328520 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m02:33:12.331115 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
alter table "legal_demo"."main"."acris_clean" rename to "acris_clean__dbt_backup"
[0m02:33:12.334815 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:33:12.343352 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m02:33:12.345477 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
alter table "legal_demo"."main"."acris_clean__dbt_tmp" rename to "acris_clean"
[0m02:33:12.347946 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:33:12.374068 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: COMMIT
[0m02:33:12.376649 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m02:33:12.378308 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: COMMIT
[0m02:33:12.420395 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:33:12.430779 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m02:33:12.433301 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
drop table if exists "legal_demo"."main"."acris_clean__dbt_backup" cascade
[0m02:33:12.442300 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m02:33:12.446889 [debug] [Thread-1 (]: Timing info for model.legal_demo.acris_cases (execute): 02:33:09.154830 => 02:33:12.446456
[0m02:33:12.448767 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: Close
[0m02:33:12.519477 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d1bfa3c-5682-446e-85a2-2c9f632ae948', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x748755ded090>]}
[0m02:33:12.522358 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main.acris_clean ............................. [[32mOK[0m in 3.39s]
[0m02:33:12.524473 [debug] [Thread-1 (]: Finished running node model.legal_demo.acris_cases
[0m02:33:12.530267 [debug] [MainThread]: Using duckdb connection "master"
[0m02:33:12.531864 [debug] [MainThread]: On master: BEGIN
[0m02:33:12.533155 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:33:12.555896 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m02:33:12.557644 [debug] [MainThread]: On master: COMMIT
[0m02:33:12.560207 [debug] [MainThread]: Using duckdb connection "master"
[0m02:33:12.561557 [debug] [MainThread]: On master: COMMIT
[0m02:33:12.563422 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m02:33:12.564803 [debug] [MainThread]: On master: Close
[0m02:33:12.572506 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:33:12.574988 [debug] [MainThread]: Connection 'list_legal_demo_main' was properly closed.
[0m02:33:12.576681 [debug] [MainThread]: Connection 'model.legal_demo.acris_cases' was properly closed.
[0m02:33:12.578236 [info ] [MainThread]: 
[0m02:33:12.579855 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.76 seconds (3.76s).
[0m02:33:12.581716 [debug] [MainThread]: Command end result
[0m02:33:12.616212 [info ] [MainThread]: 
[0m02:33:12.618180 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:33:12.619952 [info ] [MainThread]: 
[0m02:33:12.621736 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m02:33:12.624933 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.5775986, "process_user_time": 8.444991, "process_kernel_time": 1.521296, "process_mem_max_rss": "298352", "process_out_blocks": "8384", "process_in_blocks": "0"}
[0m02:33:12.627487 [debug] [MainThread]: Command `dbt run` succeeded at 02:33:12.627163 after 4.58 seconds
[0m02:33:12.629204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74875f4bb490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74875f312450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x748763ff3350>]}
[0m02:33:12.630905 [debug] [MainThread]: Flushing usage events
[0m03:21:11.830223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727c757e3810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727c74ff4fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727c74ec7e50>]}


============================== 03:21:11.842744 | a23f76a5-e1ed-4960-852b-31fcb3825d20 ==============================
[0m03:21:11.842744 [info ] [MainThread]: Running with dbt=1.7.4
[0m03:21:11.844989 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m03:21:12.371120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a23f76a5-e1ed-4960-852b-31fcb3825d20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727c74a89790>]}
[0m03:21:12.488548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a23f76a5-e1ed-4960-852b-31fcb3825d20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727c74afcd10>]}
[0m03:21:12.491719 [info ] [MainThread]: Registered adapter: duckdb=1.7.4
[0m03:21:12.514287 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m03:21:12.675004 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:21:12.677158 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:21:12.685069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a23f76a5-e1ed-4960-852b-31fcb3825d20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727c6b866bd0>]}
[0m03:21:12.734995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a23f76a5-e1ed-4960-852b-31fcb3825d20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727c74a97a10>]}
[0m03:21:12.763131 [info ] [MainThread]: Found 1 model, 0 sources, 0 exposures, 0 metrics, 394 macros, 0 groups, 0 semantic models
[0m03:21:12.765310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a23f76a5-e1ed-4960-852b-31fcb3825d20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727c718270d0>]}
[0m03:21:12.768644 [info ] [MainThread]: 
[0m03:21:12.770845 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m03:21:12.774629 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_legal_demo'
[0m03:21:12.789956 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo"
[0m03:21:12.792612 [debug] [ThreadPool]: On list_legal_demo: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"legal_demo"'
    
  
  
[0m03:21:12.794497 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:21:12.862633 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:21:12.867546 [debug] [ThreadPool]: On list_legal_demo: Close
[0m03:21:12.877839 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_legal_demo, now create_legal_demo_main)
[0m03:21:12.880215 [debug] [ThreadPool]: Creating schema "database: "legal_demo"
schema: "main"
"
[0m03:21:12.889506 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m03:21:12.892123 [debug] [ThreadPool]: On create_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "create_legal_demo_main"} */

    
        select type from duckdb_databases()
        where database_name='legal_demo'
        and type='sqlite'
    
  
[0m03:21:12.894189 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:21:12.925926 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:21:12.929356 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m03:21:12.931060 [debug] [ThreadPool]: On create_legal_demo_main: BEGIN
[0m03:21:12.934110 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:21:12.935977 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m03:21:12.937804 [debug] [ThreadPool]: On create_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "create_legal_demo_main"} */

    
    
        create schema if not exists "legal_demo"."main"
    
[0m03:21:12.940760 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:21:12.943476 [debug] [ThreadPool]: On create_legal_demo_main: COMMIT
[0m03:21:12.945570 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m03:21:12.947039 [debug] [ThreadPool]: On create_legal_demo_main: COMMIT
[0m03:21:12.951250 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:21:12.953155 [debug] [ThreadPool]: On create_legal_demo_main: Close
[0m03:21:12.964048 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_legal_demo_main, now list_legal_demo_main)
[0m03:21:12.973300 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo_main"
[0m03:21:12.975469 [debug] [ThreadPool]: On list_legal_demo_main: BEGIN
[0m03:21:12.977597 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:21:13.002213 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:21:13.004721 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo_main"
[0m03:21:13.006569 [debug] [ThreadPool]: On list_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo_main"} */
select
      'legal_demo' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'legal_demo'
  
[0m03:21:13.042671 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m03:21:13.051236 [debug] [ThreadPool]: On list_legal_demo_main: ROLLBACK
[0m03:21:13.053900 [debug] [ThreadPool]: Failed to rollback 'list_legal_demo_main'
[0m03:21:13.055784 [debug] [ThreadPool]: On list_legal_demo_main: Close
[0m03:21:13.062673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a23f76a5-e1ed-4960-852b-31fcb3825d20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727c6b866190>]}
[0m03:21:13.064613 [debug] [MainThread]: Using duckdb connection "master"
[0m03:21:13.066292 [debug] [MainThread]: On master: BEGIN
[0m03:21:13.067918 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:21:13.090758 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m03:21:13.092702 [debug] [MainThread]: On master: COMMIT
[0m03:21:13.094743 [debug] [MainThread]: Using duckdb connection "master"
[0m03:21:13.096418 [debug] [MainThread]: On master: COMMIT
[0m03:21:13.098298 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m03:21:13.100393 [debug] [MainThread]: On master: Close
[0m03:21:13.105352 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:21:13.107300 [info ] [MainThread]: 
[0m03:21:13.119321 [debug] [Thread-1 (]: Began running node model.legal_demo.acris_cases
[0m03:21:13.121827 [info ] [Thread-1 (]: 1 of 1 START sql table model main.acris_clean .................................. [RUN]
[0m03:21:13.124150 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.legal_demo.acris_cases'
[0m03:21:13.125554 [debug] [Thread-1 (]: Began compiling node model.legal_demo.acris_cases
[0m03:21:13.135652 [debug] [Thread-1 (]: Writing injected SQL for node "model.legal_demo.acris_cases"
[0m03:21:13.151236 [debug] [Thread-1 (]: Timing info for model.legal_demo.acris_cases (compile): 03:21:13.127272 => 03:21:13.150723
[0m03:21:13.153021 [debug] [Thread-1 (]: Began executing node model.legal_demo.acris_cases
[0m03:21:13.193379 [debug] [Thread-1 (]: Writing runtime sql for node "model.legal_demo.acris_cases"
[0m03:21:13.207344 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:21:13.208964 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: BEGIN
[0m03:21:13.210680 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m03:21:13.238811 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:21:13.241124 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:21:13.242823 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */

  
    
    

    create  table
      "legal_demo"."main"."acris_clean__dbt_tmp"
  
    as (
      

SELECT *
FROM read_csv_auto('/opt/airflow/data/first_500k_acris.csv', header=True, delim=',')
    );
  
  
[0m03:21:16.256900 [debug] [Thread-1 (]: SQL status: OK in 3.0 seconds
[0m03:21:16.267024 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:21:16.269091 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
alter table "legal_demo"."main"."acris_clean" rename to "acris_clean__dbt_backup"
[0m03:21:16.272592 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:21:16.279658 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:21:16.281998 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
alter table "legal_demo"."main"."acris_clean__dbt_tmp" rename to "acris_clean"
[0m03:21:16.285011 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:21:16.311261 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: COMMIT
[0m03:21:16.313911 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:21:16.316214 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: COMMIT
[0m03:21:16.344253 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:21:16.353275 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m03:21:16.355223 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
drop table if exists "legal_demo"."main"."acris_clean__dbt_backup" cascade
[0m03:21:16.362912 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m03:21:16.366530 [debug] [Thread-1 (]: Timing info for model.legal_demo.acris_cases (execute): 03:21:13.154520 => 03:21:16.365900
[0m03:21:16.372645 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: Close
[0m03:21:16.436682 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a23f76a5-e1ed-4960-852b-31fcb3825d20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727c74a97dd0>]}
[0m03:21:16.439234 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main.acris_clean ............................. [[32mOK[0m in 3.31s]
[0m03:21:16.441169 [debug] [Thread-1 (]: Finished running node model.legal_demo.acris_cases
[0m03:21:16.446075 [debug] [MainThread]: Using duckdb connection "master"
[0m03:21:16.447894 [debug] [MainThread]: On master: BEGIN
[0m03:21:16.450424 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:21:16.472746 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m03:21:16.474522 [debug] [MainThread]: On master: COMMIT
[0m03:21:16.476051 [debug] [MainThread]: Using duckdb connection "master"
[0m03:21:16.477331 [debug] [MainThread]: On master: COMMIT
[0m03:21:16.479101 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m03:21:16.480503 [debug] [MainThread]: On master: Close
[0m03:21:16.485652 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:21:16.487647 [debug] [MainThread]: Connection 'list_legal_demo_main' was properly closed.
[0m03:21:16.489124 [debug] [MainThread]: Connection 'model.legal_demo.acris_cases' was properly closed.
[0m03:21:16.490768 [info ] [MainThread]: 
[0m03:21:16.492472 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.72 seconds (3.72s).
[0m03:21:16.494277 [debug] [MainThread]: Command end result
[0m03:21:16.527729 [info ] [MainThread]: 
[0m03:21:16.529939 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:21:16.532110 [info ] [MainThread]: 
[0m03:21:16.534419 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m03:21:16.536783 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.79144, "process_user_time": 10.109094, "process_kernel_time": 2.260609, "process_mem_max_rss": "299076", "process_out_blocks": "8384", "process_in_blocks": "0"}
[0m03:21:16.539113 [debug] [MainThread]: Command `dbt run` succeeded at 03:21:16.538813 after 4.79 seconds
[0m03:21:16.540790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727c74a57810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727c74a57950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727c79a4ad10>]}
[0m03:21:16.542262 [debug] [MainThread]: Flushing usage events
[0m17:54:54.841791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x791e90f4e290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x791e9233f210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x791e90d2b810>]}


============================== 17:54:54.851975 | dc26592e-06ce-4a1f-aaf9-a19568d6b111 ==============================
[0m17:54:54.851975 [info ] [MainThread]: Running with dbt=1.7.4
[0m17:54:54.853921 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt', 'send_anonymous_usage_stats': 'True'}
[0m17:54:55.287550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dc26592e-06ce-4a1f-aaf9-a19568d6b111', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x791e908b1390>]}
[0m17:54:55.394328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dc26592e-06ce-4a1f-aaf9-a19568d6b111', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x791e9092bfd0>]}
[0m17:54:55.397470 [info ] [MainThread]: Registered adapter: duckdb=1.7.4
[0m17:54:55.420032 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m17:54:55.564941 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:54:55.567644 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:54:55.575296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dc26592e-06ce-4a1f-aaf9-a19568d6b111', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x791e90880490>]}
[0m17:54:55.741761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dc26592e-06ce-4a1f-aaf9-a19568d6b111', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x791e908b89d0>]}
[0m17:54:55.744056 [info ] [MainThread]: Found 1 model, 0 sources, 0 exposures, 0 metrics, 394 macros, 0 groups, 0 semantic models
[0m17:54:55.745768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dc26592e-06ce-4a1f-aaf9-a19568d6b111', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x791e87770910>]}
[0m17:54:55.748879 [info ] [MainThread]: 
[0m17:54:55.751015 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:54:55.754416 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_legal_demo'
[0m17:54:55.770207 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo"
[0m17:54:55.772557 [debug] [ThreadPool]: On list_legal_demo: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"legal_demo"'
    
  
  
[0m17:54:55.774815 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:54:55.853215 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:54:55.857388 [debug] [ThreadPool]: On list_legal_demo: Close
[0m17:54:55.867875 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_legal_demo, now create_legal_demo_main)
[0m17:54:55.870013 [debug] [ThreadPool]: Creating schema "database: "legal_demo"
schema: "main"
"
[0m17:54:55.882004 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m17:54:55.884125 [debug] [ThreadPool]: On create_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "create_legal_demo_main"} */

    
        select type from duckdb_databases()
        where database_name='legal_demo'
        and type='sqlite'
    
  
[0m17:54:55.885591 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:54:55.914163 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:54:55.916967 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m17:54:55.918419 [debug] [ThreadPool]: On create_legal_demo_main: BEGIN
[0m17:54:55.920778 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:54:55.922287 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m17:54:55.923753 [debug] [ThreadPool]: On create_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "create_legal_demo_main"} */

    
    
        create schema if not exists "legal_demo"."main"
    
[0m17:54:55.927420 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:54:55.929709 [debug] [ThreadPool]: On create_legal_demo_main: COMMIT
[0m17:54:55.931331 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m17:54:55.932742 [debug] [ThreadPool]: On create_legal_demo_main: COMMIT
[0m17:54:55.935666 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:54:55.937178 [debug] [ThreadPool]: On create_legal_demo_main: Close
[0m17:54:55.947956 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_legal_demo_main, now list_legal_demo_main)
[0m17:54:55.955807 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo_main"
[0m17:54:55.958102 [debug] [ThreadPool]: On list_legal_demo_main: BEGIN
[0m17:54:55.959936 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:54:55.986278 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:54:55.988104 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo_main"
[0m17:54:55.989551 [debug] [ThreadPool]: On list_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo_main"} */
select
      'legal_demo' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'legal_demo'
  
[0m17:54:56.023018 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:54:56.030987 [debug] [ThreadPool]: On list_legal_demo_main: ROLLBACK
[0m17:54:56.034058 [debug] [ThreadPool]: Failed to rollback 'list_legal_demo_main'
[0m17:54:56.036028 [debug] [ThreadPool]: On list_legal_demo_main: Close
[0m17:54:56.042952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dc26592e-06ce-4a1f-aaf9-a19568d6b111', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x791e877af350>]}
[0m17:54:56.044560 [debug] [MainThread]: Using duckdb connection "master"
[0m17:54:56.045814 [debug] [MainThread]: On master: BEGIN
[0m17:54:56.047089 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:54:56.067220 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:54:56.069155 [debug] [MainThread]: On master: COMMIT
[0m17:54:56.070388 [debug] [MainThread]: Using duckdb connection "master"
[0m17:54:56.071674 [debug] [MainThread]: On master: COMMIT
[0m17:54:56.073243 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:54:56.074882 [debug] [MainThread]: On master: Close
[0m17:54:56.079452 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:54:56.081200 [info ] [MainThread]: 
[0m17:54:56.093170 [debug] [Thread-1 (]: Began running node model.legal_demo.acris_cases
[0m17:54:56.095379 [info ] [Thread-1 (]: 1 of 1 START sql table model main.acris_clean .................................. [RUN]
[0m17:54:56.097432 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.legal_demo.acris_cases'
[0m17:54:56.099123 [debug] [Thread-1 (]: Began compiling node model.legal_demo.acris_cases
[0m17:54:56.107690 [debug] [Thread-1 (]: Writing injected SQL for node "model.legal_demo.acris_cases"
[0m17:54:56.177623 [debug] [Thread-1 (]: Timing info for model.legal_demo.acris_cases (compile): 17:54:56.100547 => 17:54:56.177102
[0m17:54:56.179484 [debug] [Thread-1 (]: Began executing node model.legal_demo.acris_cases
[0m17:54:56.216974 [debug] [Thread-1 (]: Writing runtime sql for node "model.legal_demo.acris_cases"
[0m17:54:56.289943 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m17:54:56.293024 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: BEGIN
[0m17:54:56.294691 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:54:56.320470 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:54:56.322864 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m17:54:56.325418 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */

  
    
    

    create  table
      "legal_demo"."main"."acris_clean__dbt_tmp"
  
    as (
      

SELECT *
FROM read_csv_auto('/opt/airflow/data/first_500k_acris.csv', header=True, delim=',')
    );
  
  
[0m17:54:59.725582 [debug] [Thread-1 (]: SQL status: OK in 3.0 seconds
[0m17:54:59.736177 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m17:54:59.739248 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
alter table "legal_demo"."main"."acris_clean" rename to "acris_clean__dbt_backup"
[0m17:54:59.744320 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:54:59.752255 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m17:54:59.756117 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
alter table "legal_demo"."main"."acris_clean__dbt_tmp" rename to "acris_clean"
[0m17:54:59.759397 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:54:59.786881 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: COMMIT
[0m17:54:59.789661 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m17:54:59.791686 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: COMMIT
[0m17:54:59.858243 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:54:59.868377 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m17:54:59.870427 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
drop table if exists "legal_demo"."main"."acris_clean__dbt_backup" cascade
[0m17:54:59.880009 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:54:59.884590 [debug] [Thread-1 (]: Timing info for model.legal_demo.acris_cases (execute): 17:54:56.181093 => 17:54:59.884061
[0m17:54:59.886703 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: Close
[0m17:54:59.960618 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dc26592e-06ce-4a1f-aaf9-a19568d6b111', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x791e8757e9d0>]}
[0m17:54:59.963850 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main.acris_clean ............................. [[32mOK[0m in 3.86s]
[0m17:54:59.966405 [debug] [Thread-1 (]: Finished running node model.legal_demo.acris_cases
[0m17:54:59.970889 [debug] [MainThread]: Using duckdb connection "master"
[0m17:54:59.972686 [debug] [MainThread]: On master: BEGIN
[0m17:54:59.974706 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:55:00.000332 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:55:00.002853 [debug] [MainThread]: On master: COMMIT
[0m17:55:00.004630 [debug] [MainThread]: Using duckdb connection "master"
[0m17:55:00.006477 [debug] [MainThread]: On master: COMMIT
[0m17:55:00.010010 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:55:00.012095 [debug] [MainThread]: On master: Close
[0m17:55:00.019251 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:55:00.021349 [debug] [MainThread]: Connection 'list_legal_demo_main' was properly closed.
[0m17:55:00.023728 [debug] [MainThread]: Connection 'model.legal_demo.acris_cases' was properly closed.
[0m17:55:00.025792 [info ] [MainThread]: 
[0m17:55:00.027666 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.28 seconds (4.28s).
[0m17:55:00.029943 [debug] [MainThread]: Command end result
[0m17:55:00.138678 [info ] [MainThread]: 
[0m17:55:00.141347 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:55:00.143328 [info ] [MainThread]: 
[0m17:55:00.144982 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:55:00.147714 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.511052, "process_user_time": 9.655441, "process_kernel_time": 1.836236, "process_mem_max_rss": "297376", "process_out_blocks": "8384", "process_in_blocks": "0"}
[0m17:55:00.150098 [debug] [MainThread]: Command `dbt run` succeeded at 17:55:00.149895 after 5.51 seconds
[0m17:55:00.152117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x791e957c1850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x791e9103e710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x791e957047d0>]}
[0m17:55:00.153810 [debug] [MainThread]: Flushing usage events
[0m18:13:06.913864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x759ea5958410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x759ea5d39490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x759ea5bf5d90>]}


============================== 18:13:06.969993 | 79f1e901-1679-43fa-9ae3-3e2b9a2daace ==============================
[0m18:13:06.969993 [info ] [MainThread]: Running with dbt=1.7.4
[0m18:13:06.972724 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:13:07.462645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '79f1e901-1679-43fa-9ae3-3e2b9a2daace', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x759e9c51a010>]}
[0m18:13:07.567683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '79f1e901-1679-43fa-9ae3-3e2b9a2daace', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x759ea597c490>]}
[0m18:13:07.570910 [info ] [MainThread]: Registered adapter: duckdb=1.7.4
[0m18:13:07.597117 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m18:13:07.798805 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:13:07.801710 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:13:07.811917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '79f1e901-1679-43fa-9ae3-3e2b9a2daace', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x759e9c346c10>]}
[0m18:13:07.863193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '79f1e901-1679-43fa-9ae3-3e2b9a2daace', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x759e9c437310>]}
[0m18:13:07.865369 [info ] [MainThread]: Found 1 model, 0 sources, 0 exposures, 0 metrics, 394 macros, 0 groups, 0 semantic models
[0m18:13:07.867287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '79f1e901-1679-43fa-9ae3-3e2b9a2daace', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x759ea564b810>]}
[0m18:13:07.871452 [info ] [MainThread]: 
[0m18:13:07.874066 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:13:07.877914 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_legal_demo'
[0m18:13:07.896095 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo"
[0m18:13:07.898786 [debug] [ThreadPool]: On list_legal_demo: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"legal_demo"'
    
  
  
[0m18:13:07.900813 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:13:07.949612 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:13:07.953955 [debug] [ThreadPool]: On list_legal_demo: Close
[0m18:13:07.972137 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_legal_demo, now create_legal_demo_main)
[0m18:13:07.975502 [debug] [ThreadPool]: Creating schema "database: "legal_demo"
schema: "main"
"
[0m18:13:07.986467 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m18:13:07.988714 [debug] [ThreadPool]: On create_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "create_legal_demo_main"} */

    
        select type from duckdb_databases()
        where database_name='legal_demo'
        and type='sqlite'
    
  
[0m18:13:07.990999 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:13:08.031098 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:13:08.034887 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m18:13:08.036996 [debug] [ThreadPool]: On create_legal_demo_main: BEGIN
[0m18:13:08.040869 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:13:08.042792 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m18:13:08.044591 [debug] [ThreadPool]: On create_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "create_legal_demo_main"} */

    
    
        create schema if not exists "legal_demo"."main"
    
[0m18:13:08.047885 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:13:08.050709 [debug] [ThreadPool]: On create_legal_demo_main: COMMIT
[0m18:13:08.052532 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m18:13:08.054266 [debug] [ThreadPool]: On create_legal_demo_main: COMMIT
[0m18:13:08.058503 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:13:08.060719 [debug] [ThreadPool]: On create_legal_demo_main: Close
[0m18:13:08.074150 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_legal_demo_main, now list_legal_demo_main)
[0m18:13:08.085137 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo_main"
[0m18:13:08.087159 [debug] [ThreadPool]: On list_legal_demo_main: BEGIN
[0m18:13:08.089081 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:13:08.115490 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:13:08.117546 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo_main"
[0m18:13:08.119142 [debug] [ThreadPool]: On list_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo_main"} */
select
      'legal_demo' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'legal_demo'
  
[0m18:13:08.153330 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:13:08.164293 [debug] [ThreadPool]: On list_legal_demo_main: ROLLBACK
[0m18:13:08.168046 [debug] [ThreadPool]: Failed to rollback 'list_legal_demo_main'
[0m18:13:08.169828 [debug] [ThreadPool]: On list_legal_demo_main: Close
[0m18:13:08.181584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '79f1e901-1679-43fa-9ae3-3e2b9a2daace', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x759ea56a4d90>]}
[0m18:13:08.184534 [debug] [MainThread]: Using duckdb connection "master"
[0m18:13:08.186688 [debug] [MainThread]: On master: BEGIN
[0m18:13:08.188459 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:13:08.212675 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m18:13:08.214420 [debug] [MainThread]: On master: COMMIT
[0m18:13:08.215928 [debug] [MainThread]: Using duckdb connection "master"
[0m18:13:08.217341 [debug] [MainThread]: On master: COMMIT
[0m18:13:08.219235 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m18:13:08.220853 [debug] [MainThread]: On master: Close
[0m18:13:08.227147 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:13:08.229113 [info ] [MainThread]: 
[0m18:13:08.241357 [debug] [Thread-1 (]: Began running node model.legal_demo.acris_cases
[0m18:13:08.243670 [info ] [Thread-1 (]: 1 of 1 START sql table model main.acris_clean .................................. [RUN]
[0m18:13:08.245850 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.legal_demo.acris_cases'
[0m18:13:08.247404 [debug] [Thread-1 (]: Began compiling node model.legal_demo.acris_cases
[0m18:13:08.256743 [debug] [Thread-1 (]: Writing injected SQL for node "model.legal_demo.acris_cases"
[0m18:13:08.270386 [debug] [Thread-1 (]: Timing info for model.legal_demo.acris_cases (compile): 18:13:08.248648 => 18:13:08.269809
[0m18:13:08.271981 [debug] [Thread-1 (]: Began executing node model.legal_demo.acris_cases
[0m18:13:08.316188 [debug] [Thread-1 (]: Writing runtime sql for node "model.legal_demo.acris_cases"
[0m18:13:08.331608 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m18:13:08.333362 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: BEGIN
[0m18:13:08.334907 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:13:08.360652 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:13:08.362870 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m18:13:08.364696 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */

  
    
    

    create  table
      "legal_demo"."main"."acris_clean__dbt_tmp"
  
    as (
      

SELECT *
FROM read_csv_auto('/opt/airflow/data/first_500k_acris.csv', header=True, delim=',')
    );
  
  
[0m18:13:11.555276 [debug] [Thread-1 (]: SQL status: OK in 3.0 seconds
[0m18:13:11.566322 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m18:13:11.568926 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
alter table "legal_demo"."main"."acris_clean" rename to "acris_clean__dbt_backup"
[0m18:13:11.572371 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:13:11.581378 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m18:13:11.584083 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
alter table "legal_demo"."main"."acris_clean__dbt_tmp" rename to "acris_clean"
[0m18:13:11.587144 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:13:11.612618 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: COMMIT
[0m18:13:11.615862 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m18:13:11.618169 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: COMMIT
[0m18:13:11.698568 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:13:11.708086 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m18:13:11.710446 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
drop table if exists "legal_demo"."main"."acris_clean__dbt_backup" cascade
[0m18:13:11.720122 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:13:11.724816 [debug] [Thread-1 (]: Timing info for model.legal_demo.acris_cases (execute): 18:13:08.273308 => 18:13:11.724503
[0m18:13:11.726718 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: Close
[0m18:13:11.795743 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '79f1e901-1679-43fa-9ae3-3e2b9a2daace', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x759e9c4b9cd0>]}
[0m18:13:11.799161 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main.acris_clean ............................. [[32mOK[0m in 3.55s]
[0m18:13:11.801756 [debug] [Thread-1 (]: Finished running node model.legal_demo.acris_cases
[0m18:13:11.807921 [debug] [MainThread]: Using duckdb connection "master"
[0m18:13:11.810041 [debug] [MainThread]: On master: BEGIN
[0m18:13:11.811905 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:13:11.885772 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m18:13:11.888185 [debug] [MainThread]: On master: COMMIT
[0m18:13:11.890008 [debug] [MainThread]: Using duckdb connection "master"
[0m18:13:11.892092 [debug] [MainThread]: On master: COMMIT
[0m18:13:11.894439 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m18:13:11.896066 [debug] [MainThread]: On master: Close
[0m18:13:11.901680 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:13:11.903469 [debug] [MainThread]: Connection 'list_legal_demo_main' was properly closed.
[0m18:13:11.904983 [debug] [MainThread]: Connection 'model.legal_demo.acris_cases' was properly closed.
[0m18:13:11.906843 [info ] [MainThread]: 
[0m18:13:11.909111 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.03 seconds (4.03s).
[0m18:13:11.911417 [debug] [MainThread]: Command end result
[0m18:13:11.950228 [info ] [MainThread]: 
[0m18:13:11.952570 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:13:11.954681 [info ] [MainThread]: 
[0m18:13:11.956412 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:13:11.959916 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.116899, "process_user_time": 8.74143, "process_kernel_time": 1.896882, "process_mem_max_rss": "299088", "process_out_blocks": "8384", "process_in_blocks": "0"}
[0m18:13:11.962493 [debug] [MainThread]: Command `dbt run` succeeded at 18:13:11.962187 after 5.12 seconds
[0m18:13:11.964310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x759ea55dec10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x759ea5b990d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x759eaa555850>]}
[0m18:13:11.966050 [debug] [MainThread]: Flushing usage events
[0m18:15:01.824426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7496df3a7e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7496df3a7f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7496dfe7add0>]}


============================== 18:15:01.834639 | 232c48e9-3b34-46ae-903f-3849e603dc2f ==============================
[0m18:15:01.834639 [info ] [MainThread]: Running with dbt=1.7.4
[0m18:15:01.836837 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:15:02.312825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '232c48e9-3b34-46ae-903f-3849e603dc2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7496dec7f050>]}
[0m18:15:02.431205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '232c48e9-3b34-46ae-903f-3849e603dc2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7496dba7fbd0>]}
[0m18:15:02.435298 [info ] [MainThread]: Registered adapter: duckdb=1.7.4
[0m18:15:02.461427 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m18:15:02.549833 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:15:02.552381 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:15:02.565777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '232c48e9-3b34-46ae-903f-3849e603dc2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7496d5b948d0>]}
[0m18:15:02.623257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '232c48e9-3b34-46ae-903f-3849e603dc2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7496dece7350>]}
[0m18:15:02.625803 [info ] [MainThread]: Found 1 model, 0 sources, 0 exposures, 0 metrics, 394 macros, 0 groups, 0 semantic models
[0m18:15:02.627720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '232c48e9-3b34-46ae-903f-3849e603dc2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7496df0d4b50>]}
[0m18:15:02.631976 [info ] [MainThread]: 
[0m18:15:02.635197 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:15:02.639453 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_legal_demo'
[0m18:15:02.659055 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo"
[0m18:15:02.661335 [debug] [ThreadPool]: On list_legal_demo: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"legal_demo"'
    
  
  
[0m18:15:02.663628 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:15:02.700144 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:15:02.704609 [debug] [ThreadPool]: On list_legal_demo: Close
[0m18:15:02.716383 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_legal_demo, now create_legal_demo_main)
[0m18:15:02.718764 [debug] [ThreadPool]: Creating schema "database: "legal_demo"
schema: "main"
"
[0m18:15:02.728469 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m18:15:02.730897 [debug] [ThreadPool]: On create_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "create_legal_demo_main"} */

    
        select type from duckdb_databases()
        where database_name='legal_demo'
        and type='sqlite'
    
  
[0m18:15:02.732911 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:15:02.764531 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:15:02.767405 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m18:15:02.769583 [debug] [ThreadPool]: On create_legal_demo_main: BEGIN
[0m18:15:02.772283 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:15:02.774311 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m18:15:02.775824 [debug] [ThreadPool]: On create_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "create_legal_demo_main"} */

    
    
        create schema if not exists "legal_demo"."main"
    
[0m18:15:02.778091 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:15:02.780336 [debug] [ThreadPool]: On create_legal_demo_main: COMMIT
[0m18:15:02.782010 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m18:15:02.783703 [debug] [ThreadPool]: On create_legal_demo_main: COMMIT
[0m18:15:02.787933 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:15:02.789756 [debug] [ThreadPool]: On create_legal_demo_main: Close
[0m18:15:02.799833 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_legal_demo_main, now list_legal_demo_main)
[0m18:15:02.807935 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo_main"
[0m18:15:02.810244 [debug] [ThreadPool]: On list_legal_demo_main: BEGIN
[0m18:15:02.811993 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:15:02.835919 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:15:02.837706 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo_main"
[0m18:15:02.839432 [debug] [ThreadPool]: On list_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo_main"} */
select
      'legal_demo' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'legal_demo'
  
[0m18:15:02.875391 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:15:02.884176 [debug] [ThreadPool]: On list_legal_demo_main: ROLLBACK
[0m18:15:02.887602 [debug] [ThreadPool]: Failed to rollback 'list_legal_demo_main'
[0m18:15:02.889592 [debug] [ThreadPool]: On list_legal_demo_main: Close
[0m18:15:02.898031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '232c48e9-3b34-46ae-903f-3849e603dc2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7496e25df910>]}
[0m18:15:02.899918 [debug] [MainThread]: Using duckdb connection "master"
[0m18:15:02.901646 [debug] [MainThread]: On master: BEGIN
[0m18:15:02.903298 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:15:02.927488 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m18:15:02.930313 [debug] [MainThread]: On master: COMMIT
[0m18:15:02.931640 [debug] [MainThread]: Using duckdb connection "master"
[0m18:15:02.932974 [debug] [MainThread]: On master: COMMIT
[0m18:15:02.934792 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m18:15:02.936799 [debug] [MainThread]: On master: Close
[0m18:15:02.943580 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:15:02.945671 [info ] [MainThread]: 
[0m18:15:02.959842 [debug] [Thread-1 (]: Began running node model.legal_demo.acris_cases
[0m18:15:02.962202 [info ] [Thread-1 (]: 1 of 1 START sql table model main.acris_clean .................................. [RUN]
[0m18:15:02.964397 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.legal_demo.acris_cases'
[0m18:15:02.966031 [debug] [Thread-1 (]: Began compiling node model.legal_demo.acris_cases
[0m18:15:02.979838 [debug] [Thread-1 (]: Writing injected SQL for node "model.legal_demo.acris_cases"
[0m18:15:02.993542 [debug] [Thread-1 (]: Timing info for model.legal_demo.acris_cases (compile): 18:15:02.967427 => 18:15:02.992922
[0m18:15:02.995219 [debug] [Thread-1 (]: Began executing node model.legal_demo.acris_cases
[0m18:15:03.036341 [debug] [Thread-1 (]: Writing runtime sql for node "model.legal_demo.acris_cases"
[0m18:15:03.053310 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m18:15:03.055092 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: BEGIN
[0m18:15:03.056726 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:15:03.082678 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:15:03.084867 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m18:15:03.086580 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */

  
    
    

    create  table
      "legal_demo"."main"."acris_clean__dbt_tmp"
  
    as (
      

SELECT *
FROM read_csv_auto('/opt/airflow/data/first_500k_acris.csv', header=True, delim=',')
    );
  
  
[0m18:15:06.107333 [debug] [Thread-1 (]: SQL status: OK in 3.0 seconds
[0m18:15:06.117552 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m18:15:06.119814 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
alter table "legal_demo"."main"."acris_clean" rename to "acris_clean__dbt_backup"
[0m18:15:06.123242 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:15:06.129557 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m18:15:06.131986 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
alter table "legal_demo"."main"."acris_clean__dbt_tmp" rename to "acris_clean"
[0m18:15:06.135079 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:15:06.161611 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: COMMIT
[0m18:15:06.164292 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m18:15:06.166262 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: COMMIT
[0m18:15:06.245846 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:15:06.254359 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m18:15:06.256694 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
drop table if exists "legal_demo"."main"."acris_clean__dbt_backup" cascade
[0m18:15:06.265721 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:15:06.270141 [debug] [Thread-1 (]: Timing info for model.legal_demo.acris_cases (execute): 18:15:02.996462 => 18:15:06.269562
[0m18:15:06.272431 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: Close
[0m18:15:06.346506 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '232c48e9-3b34-46ae-903f-3849e603dc2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7496d5bb0550>]}
[0m18:15:06.349343 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main.acris_clean ............................. [[32mOK[0m in 3.38s]
[0m18:15:06.351702 [debug] [Thread-1 (]: Finished running node model.legal_demo.acris_cases
[0m18:15:06.356014 [debug] [MainThread]: Using duckdb connection "master"
[0m18:15:06.358437 [debug] [MainThread]: On master: BEGIN
[0m18:15:06.360216 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:15:06.384658 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m18:15:06.386785 [debug] [MainThread]: On master: COMMIT
[0m18:15:06.388321 [debug] [MainThread]: Using duckdb connection "master"
[0m18:15:06.389911 [debug] [MainThread]: On master: COMMIT
[0m18:15:06.392054 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m18:15:06.394003 [debug] [MainThread]: On master: Close
[0m18:15:06.399197 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:15:06.400962 [debug] [MainThread]: Connection 'list_legal_demo_main' was properly closed.
[0m18:15:06.402607 [debug] [MainThread]: Connection 'model.legal_demo.acris_cases' was properly closed.
[0m18:15:06.404309 [info ] [MainThread]: 
[0m18:15:06.406137 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.77 seconds (3.77s).
[0m18:15:06.408723 [debug] [MainThread]: Command end result
[0m18:15:06.447737 [info ] [MainThread]: 
[0m18:15:06.450184 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:15:06.452132 [info ] [MainThread]: 
[0m18:15:06.453873 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:15:06.456888 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.717361, "process_user_time": 8.475771, "process_kernel_time": 1.309819, "process_mem_max_rss": "299028", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:15:06.459531 [debug] [MainThread]: Command `dbt run` succeeded at 18:15:06.459222 after 4.72 seconds
[0m18:15:06.461740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7496df3a6c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7496e39e07d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7496e3a0c490>]}
[0m18:15:06.463982 [debug] [MainThread]: Flushing usage events
[0m18:24:38.964630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7015882f6b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7015883309d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x701588471b50>]}


============================== 18:24:38.973928 | ab889043-5ca1-482d-b90b-d27491491009 ==============================
[0m18:24:38.973928 [info ] [MainThread]: Running with dbt=1.7.4
[0m18:24:38.975663 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:24:39.451486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ab889043-5ca1-482d-b90b-d27491491009', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x701584d1cc50>]}
[0m18:24:39.590724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ab889043-5ca1-482d-b90b-d27491491009', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x701584c6b550>]}
[0m18:24:39.593266 [info ] [MainThread]: Registered adapter: duckdb=1.7.4
[0m18:24:39.615915 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m18:24:39.706484 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:24:39.708760 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:24:39.718390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ab889043-5ca1-482d-b90b-d27491491009', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70157ec76390>]}
[0m18:24:39.769602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ab889043-5ca1-482d-b90b-d27491491009', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x701587ee2450>]}
[0m18:24:39.772254 [info ] [MainThread]: Found 1 model, 0 sources, 0 exposures, 0 metrics, 394 macros, 0 groups, 0 semantic models
[0m18:24:39.774424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ab889043-5ca1-482d-b90b-d27491491009', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x701587eda910>]}
[0m18:24:39.778602 [info ] [MainThread]: 
[0m18:24:39.781512 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:24:39.784744 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_legal_demo'
[0m18:24:39.802838 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo"
[0m18:24:39.805862 [debug] [ThreadPool]: On list_legal_demo: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"legal_demo"'
    
  
  
[0m18:24:39.807658 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:24:39.844612 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:24:39.848643 [debug] [ThreadPool]: On list_legal_demo: Close
[0m18:24:39.864794 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_legal_demo, now create_legal_demo_main)
[0m18:24:39.867352 [debug] [ThreadPool]: Creating schema "database: "legal_demo"
schema: "main"
"
[0m18:24:39.877871 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m18:24:39.880232 [debug] [ThreadPool]: On create_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "create_legal_demo_main"} */

    
        select type from duckdb_databases()
        where database_name='legal_demo'
        and type='sqlite'
    
  
[0m18:24:39.882256 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:24:39.912370 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:24:39.916597 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m18:24:39.918158 [debug] [ThreadPool]: On create_legal_demo_main: BEGIN
[0m18:24:39.921259 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:24:39.923349 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m18:24:39.924899 [debug] [ThreadPool]: On create_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "create_legal_demo_main"} */

    
    
        create schema if not exists "legal_demo"."main"
    
[0m18:24:39.927556 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:24:39.930048 [debug] [ThreadPool]: On create_legal_demo_main: COMMIT
[0m18:24:39.931689 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m18:24:39.933597 [debug] [ThreadPool]: On create_legal_demo_main: COMMIT
[0m18:24:39.936210 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:24:39.938156 [debug] [ThreadPool]: On create_legal_demo_main: Close
[0m18:24:39.949482 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_legal_demo_main, now list_legal_demo_main)
[0m18:24:39.960676 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo_main"
[0m18:24:39.963117 [debug] [ThreadPool]: On list_legal_demo_main: BEGIN
[0m18:24:39.964707 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:24:39.990270 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:24:39.992482 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo_main"
[0m18:24:39.994288 [debug] [ThreadPool]: On list_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo_main"} */
select
      'legal_demo' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'legal_demo'
  
[0m18:24:40.028432 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:24:40.039848 [debug] [ThreadPool]: On list_legal_demo_main: ROLLBACK
[0m18:24:40.042910 [debug] [ThreadPool]: Failed to rollback 'list_legal_demo_main'
[0m18:24:40.044933 [debug] [ThreadPool]: On list_legal_demo_main: Close
[0m18:24:40.054590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ab889043-5ca1-482d-b90b-d27491491009', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x701588192e10>]}
[0m18:24:40.057084 [debug] [MainThread]: Using duckdb connection "master"
[0m18:24:40.058708 [debug] [MainThread]: On master: BEGIN
[0m18:24:40.060134 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:24:40.084376 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m18:24:40.086281 [debug] [MainThread]: On master: COMMIT
[0m18:24:40.088013 [debug] [MainThread]: Using duckdb connection "master"
[0m18:24:40.089803 [debug] [MainThread]: On master: COMMIT
[0m18:24:40.091988 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m18:24:40.093607 [debug] [MainThread]: On master: Close
[0m18:24:40.098666 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:24:40.100465 [info ] [MainThread]: 
[0m18:24:40.113818 [debug] [Thread-1 (]: Began running node model.legal_demo.acris_cases
[0m18:24:40.115956 [info ] [Thread-1 (]: 1 of 1 START sql table model main.acris_clean .................................. [RUN]
[0m18:24:40.118228 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.legal_demo.acris_cases'
[0m18:24:40.119887 [debug] [Thread-1 (]: Began compiling node model.legal_demo.acris_cases
[0m18:24:40.130894 [debug] [Thread-1 (]: Writing injected SQL for node "model.legal_demo.acris_cases"
[0m18:24:40.145902 [debug] [Thread-1 (]: Timing info for model.legal_demo.acris_cases (compile): 18:24:40.121429 => 18:24:40.145411
[0m18:24:40.147499 [debug] [Thread-1 (]: Began executing node model.legal_demo.acris_cases
[0m18:24:40.189802 [debug] [Thread-1 (]: Writing runtime sql for node "model.legal_demo.acris_cases"
[0m18:24:40.204004 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m18:24:40.206117 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: BEGIN
[0m18:24:40.207845 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:24:40.236826 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:24:40.239273 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m18:24:40.240964 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */

  
    
    

    create  table
      "legal_demo"."main"."acris_clean__dbt_tmp"
  
    as (
      

SELECT *
FROM read_csv_auto('/opt/airflow/data/first_500k_acris.csv', header=True, delim=',')
    );
  
  
[0m18:24:42.726139 [debug] [Thread-1 (]: SQL status: OK in 2.0 seconds
[0m18:24:42.737124 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m18:24:42.739060 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
alter table "legal_demo"."main"."acris_clean" rename to "acris_clean__dbt_backup"
[0m18:24:42.742873 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:24:42.750697 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m18:24:42.753355 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
alter table "legal_demo"."main"."acris_clean__dbt_tmp" rename to "acris_clean"
[0m18:24:42.756134 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:24:42.780802 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: COMMIT
[0m18:24:42.783271 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m18:24:42.785430 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: COMMIT
[0m18:24:42.862023 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:24:42.871841 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m18:24:42.874420 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
drop table if exists "legal_demo"."main"."acris_clean__dbt_backup" cascade
[0m18:24:42.882740 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:24:42.886825 [debug] [Thread-1 (]: Timing info for model.legal_demo.acris_cases (execute): 18:24:40.148924 => 18:24:42.886478
[0m18:24:42.888598 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: Close
[0m18:24:42.958566 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab889043-5ca1-482d-b90b-d27491491009', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70157ed27ed0>]}
[0m18:24:42.961698 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main.acris_clean ............................. [[32mOK[0m in 2.84s]
[0m18:24:42.963809 [debug] [Thread-1 (]: Finished running node model.legal_demo.acris_cases
[0m18:24:42.969365 [debug] [MainThread]: Using duckdb connection "master"
[0m18:24:42.970913 [debug] [MainThread]: On master: BEGIN
[0m18:24:42.972875 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:24:42.997773 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m18:24:42.999926 [debug] [MainThread]: On master: COMMIT
[0m18:24:43.001502 [debug] [MainThread]: Using duckdb connection "master"
[0m18:24:43.003021 [debug] [MainThread]: On master: COMMIT
[0m18:24:43.004848 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m18:24:43.006783 [debug] [MainThread]: On master: Close
[0m18:24:43.012390 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:24:43.014562 [debug] [MainThread]: Connection 'list_legal_demo_main' was properly closed.
[0m18:24:43.016130 [debug] [MainThread]: Connection 'model.legal_demo.acris_cases' was properly closed.
[0m18:24:43.017743 [info ] [MainThread]: 
[0m18:24:43.019414 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.24 seconds (3.24s).
[0m18:24:43.021727 [debug] [MainThread]: Command end result
[0m18:24:43.060214 [info ] [MainThread]: 
[0m18:24:43.062133 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:24:43.063835 [info ] [MainThread]: 
[0m18:24:43.065490 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:24:43.067755 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.175353, "process_user_time": 7.944063, "process_kernel_time": 1.633283, "process_mem_max_rss": "299900", "process_out_blocks": "8384", "process_in_blocks": "0"}
[0m18:24:43.069876 [debug] [MainThread]: Command `dbt run` succeeded at 18:24:43.069630 after 4.18 seconds
[0m18:24:43.071381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70158ce0f290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7015882a2810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70158cd7ebd0>]}
[0m18:24:43.073215 [debug] [MainThread]: Flushing usage events
[0m18:26:06.548596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e8708286590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e8707d886d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e8707a49190>]}


============================== 18:26:06.559295 | cf3419e3-b815-44f0-b89f-56f74ad88b9f ==============================
[0m18:26:06.559295 [info ] [MainThread]: Running with dbt=1.7.4
[0m18:26:06.561197 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:26:06.943659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cf3419e3-b815-44f0-b89f-56f74ad88b9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e86fe43e1d0>]}
[0m18:26:07.045689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cf3419e3-b815-44f0-b89f-56f74ad88b9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e8708a61010>]}
[0m18:26:07.048348 [info ] [MainThread]: Registered adapter: duckdb=1.7.4
[0m18:26:07.069624 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m18:26:07.146367 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:26:07.148864 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:26:07.156663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cf3419e3-b815-44f0-b89f-56f74ad88b9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e86fe3bd210>]}
[0m18:26:07.206619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cf3419e3-b815-44f0-b89f-56f74ad88b9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e870767d190>]}
[0m18:26:07.208279 [info ] [MainThread]: Found 1 model, 0 sources, 0 exposures, 0 metrics, 394 macros, 0 groups, 0 semantic models
[0m18:26:07.209760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cf3419e3-b815-44f0-b89f-56f74ad88b9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e86fe4e3890>]}
[0m18:26:07.212809 [info ] [MainThread]: 
[0m18:26:07.214869 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:26:07.218212 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_legal_demo'
[0m18:26:07.234681 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo"
[0m18:26:07.237265 [debug] [ThreadPool]: On list_legal_demo: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"legal_demo"'
    
  
  
[0m18:26:07.239120 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:26:07.273837 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:26:07.277751 [debug] [ThreadPool]: On list_legal_demo: Close
[0m18:26:07.287970 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_legal_demo, now create_legal_demo_main)
[0m18:26:07.290202 [debug] [ThreadPool]: Creating schema "database: "legal_demo"
schema: "main"
"
[0m18:26:07.299319 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m18:26:07.300866 [debug] [ThreadPool]: On create_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "create_legal_demo_main"} */

    
        select type from duckdb_databases()
        where database_name='legal_demo'
        and type='sqlite'
    
  
[0m18:26:07.302750 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:26:07.329547 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:26:07.332614 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m18:26:07.334407 [debug] [ThreadPool]: On create_legal_demo_main: BEGIN
[0m18:26:07.337372 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:26:07.338946 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m18:26:07.340153 [debug] [ThreadPool]: On create_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "create_legal_demo_main"} */

    
    
        create schema if not exists "legal_demo"."main"
    
[0m18:26:07.342553 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:26:07.344797 [debug] [ThreadPool]: On create_legal_demo_main: COMMIT
[0m18:26:07.346818 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m18:26:07.393644 [debug] [ThreadPool]: On create_legal_demo_main: COMMIT
[0m18:26:07.397076 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:26:07.399737 [debug] [ThreadPool]: On create_legal_demo_main: Close
[0m18:26:07.410331 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_legal_demo_main, now list_legal_demo_main)
[0m18:26:07.418638 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo_main"
[0m18:26:07.421182 [debug] [ThreadPool]: On list_legal_demo_main: BEGIN
[0m18:26:07.422752 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:26:07.447182 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:26:07.449543 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo_main"
[0m18:26:07.451551 [debug] [ThreadPool]: On list_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo_main"} */
select
      'legal_demo' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'legal_demo'
  
[0m18:26:07.478996 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:26:07.487948 [debug] [ThreadPool]: On list_legal_demo_main: ROLLBACK
[0m18:26:07.490157 [debug] [ThreadPool]: Failed to rollback 'list_legal_demo_main'
[0m18:26:07.491806 [debug] [ThreadPool]: On list_legal_demo_main: Close
[0m18:26:07.498329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cf3419e3-b815-44f0-b89f-56f74ad88b9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e86fe208910>]}
[0m18:26:07.499872 [debug] [MainThread]: Using duckdb connection "master"
[0m18:26:07.500983 [debug] [MainThread]: On master: BEGIN
[0m18:26:07.502126 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:26:07.527143 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m18:26:07.529109 [debug] [MainThread]: On master: COMMIT
[0m18:26:07.530873 [debug] [MainThread]: Using duckdb connection "master"
[0m18:26:07.532251 [debug] [MainThread]: On master: COMMIT
[0m18:26:07.534458 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m18:26:07.536663 [debug] [MainThread]: On master: Close
[0m18:26:07.542443 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:26:07.544716 [info ] [MainThread]: 
[0m18:26:07.559940 [debug] [Thread-1 (]: Began running node model.legal_demo.acris_cases
[0m18:26:07.562743 [info ] [Thread-1 (]: 1 of 1 START sql table model main.acris_clean .................................. [RUN]
[0m18:26:07.564978 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.legal_demo.acris_cases'
[0m18:26:07.566640 [debug] [Thread-1 (]: Began compiling node model.legal_demo.acris_cases
[0m18:26:07.577037 [debug] [Thread-1 (]: Writing injected SQL for node "model.legal_demo.acris_cases"
[0m18:26:07.592447 [debug] [Thread-1 (]: Timing info for model.legal_demo.acris_cases (compile): 18:26:07.567970 => 18:26:07.591879
[0m18:26:07.594189 [debug] [Thread-1 (]: Began executing node model.legal_demo.acris_cases
[0m18:26:07.640786 [debug] [Thread-1 (]: Writing runtime sql for node "model.legal_demo.acris_cases"
[0m18:26:07.656553 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m18:26:07.658467 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: BEGIN
[0m18:26:07.660226 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:26:07.689826 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:26:07.692021 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m18:26:07.693477 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */

  
    
    

    create  table
      "legal_demo"."main"."acris_clean__dbt_tmp"
  
    as (
      

SELECT *
FROM read_csv_auto('/opt/airflow/data/first_500k_acris.csv', header=True, delim=',')
    );
  
  
[0m18:26:10.193885 [debug] [Thread-1 (]: SQL status: OK in 2.0 seconds
[0m18:26:10.224144 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m18:26:10.226378 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
alter table "legal_demo"."main"."acris_clean" rename to "acris_clean__dbt_backup"
[0m18:26:10.230021 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:26:10.236001 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m18:26:10.238045 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
alter table "legal_demo"."main"."acris_clean__dbt_tmp" rename to "acris_clean"
[0m18:26:10.240471 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:26:10.269062 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: COMMIT
[0m18:26:10.271775 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m18:26:10.273497 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: COMMIT
[0m18:26:10.344872 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:26:10.355311 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m18:26:10.357701 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
drop table if exists "legal_demo"."main"."acris_clean__dbt_backup" cascade
[0m18:26:10.365520 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:26:10.370931 [debug] [Thread-1 (]: Timing info for model.legal_demo.acris_cases (execute): 18:26:07.595528 => 18:26:10.370100
[0m18:26:10.372981 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: Close
[0m18:26:10.445997 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf3419e3-b815-44f0-b89f-56f74ad88b9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e86fe39d110>]}
[0m18:26:10.450106 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main.acris_clean ............................. [[32mOK[0m in 2.88s]
[0m18:26:10.452986 [debug] [Thread-1 (]: Finished running node model.legal_demo.acris_cases
[0m18:26:10.461173 [debug] [MainThread]: Using duckdb connection "master"
[0m18:26:10.463031 [debug] [MainThread]: On master: BEGIN
[0m18:26:10.464568 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:26:10.492568 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m18:26:10.494352 [debug] [MainThread]: On master: COMMIT
[0m18:26:10.495883 [debug] [MainThread]: Using duckdb connection "master"
[0m18:26:10.497425 [debug] [MainThread]: On master: COMMIT
[0m18:26:10.499545 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m18:26:10.501051 [debug] [MainThread]: On master: Close
[0m18:26:10.506570 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:26:10.508885 [debug] [MainThread]: Connection 'list_legal_demo_main' was properly closed.
[0m18:26:10.510704 [debug] [MainThread]: Connection 'model.legal_demo.acris_cases' was properly closed.
[0m18:26:10.512858 [info ] [MainThread]: 
[0m18:26:10.515323 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.30 seconds (3.30s).
[0m18:26:10.517967 [debug] [MainThread]: Command end result
[0m18:26:10.567290 [info ] [MainThread]: 
[0m18:26:10.569807 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:26:10.572273 [info ] [MainThread]: 
[0m18:26:10.574101 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:26:10.578179 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.1014485, "process_user_time": 7.487654, "process_kernel_time": 1.435436, "process_mem_max_rss": "298292", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:26:10.581023 [debug] [MainThread]: Command `dbt run` succeeded at 18:26:10.580659 after 4.10 seconds
[0m18:26:10.583542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e8707d5b610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e870c3a2810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e870c37ef90>]}
[0m18:26:10.585471 [debug] [MainThread]: Flushing usage events
[0m18:27:10.524055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ddc71cd7350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ddc71ccb150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ddc723f3e90>]}


============================== 18:27:10.532936 | 1d056dfa-7fa1-48fb-b9c9-aedf0f4aecf3 ==============================
[0m18:27:10.532936 [info ] [MainThread]: Running with dbt=1.7.4
[0m18:27:10.534985 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:27:10.916217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1d056dfa-7fa1-48fb-b9c9-aedf0f4aecf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ddc720ea010>]}
[0m18:27:11.021549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1d056dfa-7fa1-48fb-b9c9-aedf0f4aecf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ddc72c22a10>]}
[0m18:27:11.024292 [info ] [MainThread]: Registered adapter: duckdb=1.7.4
[0m18:27:11.046029 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m18:27:11.125567 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:27:11.128035 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:27:11.135957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1d056dfa-7fa1-48fb-b9c9-aedf0f4aecf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ddc68a9dd10>]}
[0m18:27:11.185408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1d056dfa-7fa1-48fb-b9c9-aedf0f4aecf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ddc68bd4490>]}
[0m18:27:11.187863 [info ] [MainThread]: Found 1 model, 0 sources, 0 exposures, 0 metrics, 394 macros, 0 groups, 0 semantic models
[0m18:27:11.189806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1d056dfa-7fa1-48fb-b9c9-aedf0f4aecf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ddc71caff50>]}
[0m18:27:11.193188 [info ] [MainThread]: 
[0m18:27:11.195449 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:27:11.198754 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_legal_demo'
[0m18:27:11.215088 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo"
[0m18:27:11.217655 [debug] [ThreadPool]: On list_legal_demo: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"legal_demo"'
    
  
  
[0m18:27:11.219721 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:27:11.253025 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:27:11.258089 [debug] [ThreadPool]: On list_legal_demo: Close
[0m18:27:11.270695 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_legal_demo, now create_legal_demo_main)
[0m18:27:11.273129 [debug] [ThreadPool]: Creating schema "database: "legal_demo"
schema: "main"
"
[0m18:27:11.283052 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m18:27:11.285201 [debug] [ThreadPool]: On create_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "create_legal_demo_main"} */

    
        select type from duckdb_databases()
        where database_name='legal_demo'
        and type='sqlite'
    
  
[0m18:27:11.287170 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:27:11.317607 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:27:11.321723 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m18:27:11.323696 [debug] [ThreadPool]: On create_legal_demo_main: BEGIN
[0m18:27:11.325866 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:27:11.327471 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m18:27:11.328887 [debug] [ThreadPool]: On create_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "create_legal_demo_main"} */

    
    
        create schema if not exists "legal_demo"."main"
    
[0m18:27:11.330935 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:27:11.333314 [debug] [ThreadPool]: On create_legal_demo_main: COMMIT
[0m18:27:11.334873 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m18:27:11.336521 [debug] [ThreadPool]: On create_legal_demo_main: COMMIT
[0m18:27:11.340311 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:27:11.341996 [debug] [ThreadPool]: On create_legal_demo_main: Close
[0m18:27:11.353787 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_legal_demo_main, now list_legal_demo_main)
[0m18:27:11.364448 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo_main"
[0m18:27:11.366887 [debug] [ThreadPool]: On list_legal_demo_main: BEGIN
[0m18:27:11.368921 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:27:11.395340 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:27:11.397387 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo_main"
[0m18:27:11.398941 [debug] [ThreadPool]: On list_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo_main"} */
select
      'legal_demo' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'legal_demo'
  
[0m18:27:11.428080 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:27:11.439369 [debug] [ThreadPool]: On list_legal_demo_main: ROLLBACK
[0m18:27:11.442596 [debug] [ThreadPool]: Failed to rollback 'list_legal_demo_main'
[0m18:27:11.444526 [debug] [ThreadPool]: On list_legal_demo_main: Close
[0m18:27:11.454205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1d056dfa-7fa1-48fb-b9c9-aedf0f4aecf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ddc71c8b990>]}
[0m18:27:11.456616 [debug] [MainThread]: Using duckdb connection "master"
[0m18:27:11.458262 [debug] [MainThread]: On master: BEGIN
[0m18:27:11.459642 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:27:11.484796 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m18:27:11.487145 [debug] [MainThread]: On master: COMMIT
[0m18:27:11.488916 [debug] [MainThread]: Using duckdb connection "master"
[0m18:27:11.490327 [debug] [MainThread]: On master: COMMIT
[0m18:27:11.492260 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m18:27:11.493787 [debug] [MainThread]: On master: Close
[0m18:27:11.499150 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:27:11.501527 [info ] [MainThread]: 
[0m18:27:11.515270 [debug] [Thread-1 (]: Began running node model.legal_demo.acris_cases
[0m18:27:11.518203 [info ] [Thread-1 (]: 1 of 1 START sql table model main.acris_clean .................................. [RUN]
[0m18:27:11.521114 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.legal_demo.acris_cases'
[0m18:27:11.522927 [debug] [Thread-1 (]: Began compiling node model.legal_demo.acris_cases
[0m18:27:11.532523 [debug] [Thread-1 (]: Writing injected SQL for node "model.legal_demo.acris_cases"
[0m18:27:11.548667 [debug] [Thread-1 (]: Timing info for model.legal_demo.acris_cases (compile): 18:27:11.524277 => 18:27:11.547882
[0m18:27:11.550800 [debug] [Thread-1 (]: Began executing node model.legal_demo.acris_cases
[0m18:27:11.593017 [debug] [Thread-1 (]: Writing runtime sql for node "model.legal_demo.acris_cases"
[0m18:27:11.617357 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m18:27:11.619409 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: BEGIN
[0m18:27:11.621754 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:27:11.648635 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:27:11.651121 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m18:27:11.653453 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */

  
    
    

    create  table
      "legal_demo"."main"."acris_clean__dbt_tmp"
  
    as (
      

SELECT *
FROM read_csv_auto('/opt/airflow/data/first_500k_acris.csv', header=True, delim=',')
    );
  
  
[0m18:27:14.153778 [debug] [Thread-1 (]: SQL status: OK in 2.0 seconds
[0m18:27:14.179571 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m18:27:14.183364 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
alter table "legal_demo"."main"."acris_clean" rename to "acris_clean__dbt_backup"
[0m18:27:14.187312 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:27:14.193523 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m18:27:14.196123 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
alter table "legal_demo"."main"."acris_clean__dbt_tmp" rename to "acris_clean"
[0m18:27:14.199012 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:27:14.229154 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: COMMIT
[0m18:27:14.231551 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m18:27:14.233429 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: COMMIT
[0m18:27:14.301588 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:27:14.310813 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m18:27:14.312809 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
drop table if exists "legal_demo"."main"."acris_clean__dbt_backup" cascade
[0m18:27:14.320790 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m18:27:14.325424 [debug] [Thread-1 (]: Timing info for model.legal_demo.acris_cases (execute): 18:27:11.552725 => 18:27:14.324706
[0m18:27:14.327540 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: Close
[0m18:27:14.397207 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d056dfa-7fa1-48fb-b9c9-aedf0f4aecf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ddc689d7490>]}
[0m18:27:14.400587 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main.acris_clean ............................. [[32mOK[0m in 2.88s]
[0m18:27:14.403374 [debug] [Thread-1 (]: Finished running node model.legal_demo.acris_cases
[0m18:27:14.409906 [debug] [MainThread]: Using duckdb connection "master"
[0m18:27:14.411522 [debug] [MainThread]: On master: BEGIN
[0m18:27:14.412951 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:27:14.438353 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m18:27:14.440048 [debug] [MainThread]: On master: COMMIT
[0m18:27:14.441569 [debug] [MainThread]: Using duckdb connection "master"
[0m18:27:14.442856 [debug] [MainThread]: On master: COMMIT
[0m18:27:14.444429 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m18:27:14.445797 [debug] [MainThread]: On master: Close
[0m18:27:14.450764 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:27:14.452689 [debug] [MainThread]: Connection 'list_legal_demo_main' was properly closed.
[0m18:27:14.454587 [debug] [MainThread]: Connection 'model.legal_demo.acris_cases' was properly closed.
[0m18:27:14.456443 [info ] [MainThread]: 
[0m18:27:14.457974 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.26 seconds (3.26s).
[0m18:27:14.459868 [debug] [MainThread]: Command end result
[0m18:27:14.502824 [info ] [MainThread]: 
[0m18:27:14.505191 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:27:14.507012 [info ] [MainThread]: 
[0m18:27:14.508958 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:27:14.512919 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.0583777, "process_user_time": 5.756497, "process_kernel_time": 1.383812, "process_mem_max_rss": "296136", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:27:14.515191 [debug] [MainThread]: Command `dbt run` succeeded at 18:27:14.514968 after 4.06 seconds
[0m18:27:14.517387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ddc76a6abd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ddc76a69850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ddc76afb290>]}
[0m18:27:14.519185 [debug] [MainThread]: Flushing usage events
[0m19:19:25.517265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c652fdd3f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c65302a5050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c652fda7690>]}


============================== 19:19:25.572571 | 30c1fcc8-d035-4f8a-bdd2-90d5f009ab60 ==============================
[0m19:19:25.572571 [info ] [MainThread]: Running with dbt=1.7.4
[0m19:19:25.575075 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:19:25.980185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '30c1fcc8-d035-4f8a-bdd2-90d5f009ab60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c6530533050>]}
[0m19:19:26.107189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '30c1fcc8-d035-4f8a-bdd2-90d5f009ab60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c65302a6c10>]}
[0m19:19:26.110160 [info ] [MainThread]: Registered adapter: duckdb=1.7.4
[0m19:19:26.134366 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m19:19:26.269704 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:19:26.271820 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:19:26.279643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '30c1fcc8-d035-4f8a-bdd2-90d5f009ab60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c6526ba9690>]}
[0m19:19:26.327588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '30c1fcc8-d035-4f8a-bdd2-90d5f009ab60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c6526c82fd0>]}
[0m19:19:26.329413 [info ] [MainThread]: Found 1 model, 0 sources, 0 exposures, 0 metrics, 394 macros, 0 groups, 0 semantic models
[0m19:19:26.331073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '30c1fcc8-d035-4f8a-bdd2-90d5f009ab60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c6526c4f110>]}
[0m19:19:26.334733 [info ] [MainThread]: 
[0m19:19:26.337171 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m19:19:26.340361 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_legal_demo'
[0m19:19:26.361291 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo"
[0m19:19:26.363896 [debug] [ThreadPool]: On list_legal_demo: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"legal_demo"'
    
  
  
[0m19:19:26.365811 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:19:26.428273 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m19:19:26.434278 [debug] [ThreadPool]: On list_legal_demo: Close
[0m19:19:26.446840 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_legal_demo, now create_legal_demo_main)
[0m19:19:26.450051 [debug] [ThreadPool]: Creating schema "database: "legal_demo"
schema: "main"
"
[0m19:19:26.460240 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m19:19:26.462602 [debug] [ThreadPool]: On create_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "create_legal_demo_main"} */

    
        select type from duckdb_databases()
        where database_name='legal_demo'
        and type='sqlite'
    
  
[0m19:19:26.464750 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:19:26.498624 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m19:19:26.502384 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m19:19:26.504880 [debug] [ThreadPool]: On create_legal_demo_main: BEGIN
[0m19:19:26.507227 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m19:19:26.509104 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m19:19:26.510874 [debug] [ThreadPool]: On create_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "create_legal_demo_main"} */

    
    
        create schema if not exists "legal_demo"."main"
    
[0m19:19:26.514493 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m19:19:26.517461 [debug] [ThreadPool]: On create_legal_demo_main: COMMIT
[0m19:19:26.519373 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m19:19:26.520848 [debug] [ThreadPool]: On create_legal_demo_main: COMMIT
[0m19:19:26.523761 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m19:19:26.525194 [debug] [ThreadPool]: On create_legal_demo_main: Close
[0m19:19:26.538262 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_legal_demo_main, now list_legal_demo_main)
[0m19:19:26.547016 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo_main"
[0m19:19:26.549179 [debug] [ThreadPool]: On list_legal_demo_main: BEGIN
[0m19:19:26.550823 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:19:26.574721 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m19:19:26.576787 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo_main"
[0m19:19:26.578661 [debug] [ThreadPool]: On list_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo_main"} */
select
      'legal_demo' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'legal_demo'
  
[0m19:19:26.617626 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m19:19:26.628111 [debug] [ThreadPool]: On list_legal_demo_main: ROLLBACK
[0m19:19:26.631382 [debug] [ThreadPool]: Failed to rollback 'list_legal_demo_main'
[0m19:19:26.633557 [debug] [ThreadPool]: On list_legal_demo_main: Close
[0m19:19:26.643427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '30c1fcc8-d035-4f8a-bdd2-90d5f009ab60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c653052e3d0>]}
[0m19:19:26.645373 [debug] [MainThread]: Using duckdb connection "master"
[0m19:19:26.646822 [debug] [MainThread]: On master: BEGIN
[0m19:19:26.648744 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:19:26.674352 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m19:19:26.676375 [debug] [MainThread]: On master: COMMIT
[0m19:19:26.677715 [debug] [MainThread]: Using duckdb connection "master"
[0m19:19:26.679112 [debug] [MainThread]: On master: COMMIT
[0m19:19:26.681120 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m19:19:26.682896 [debug] [MainThread]: On master: Close
[0m19:19:26.688580 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:19:26.690327 [info ] [MainThread]: 
[0m19:19:26.702933 [debug] [Thread-1 (]: Began running node model.legal_demo.acris_cases
[0m19:19:26.705274 [info ] [Thread-1 (]: 1 of 1 START sql table model main.acris_clean .................................. [RUN]
[0m19:19:26.707562 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.legal_demo.acris_cases'
[0m19:19:26.709086 [debug] [Thread-1 (]: Began compiling node model.legal_demo.acris_cases
[0m19:19:26.719966 [debug] [Thread-1 (]: Writing injected SQL for node "model.legal_demo.acris_cases"
[0m19:19:26.734175 [debug] [Thread-1 (]: Timing info for model.legal_demo.acris_cases (compile): 19:19:26.710429 => 19:19:26.733521
[0m19:19:26.736290 [debug] [Thread-1 (]: Began executing node model.legal_demo.acris_cases
[0m19:19:26.780773 [debug] [Thread-1 (]: Writing runtime sql for node "model.legal_demo.acris_cases"
[0m19:19:26.795138 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m19:19:26.796938 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: BEGIN
[0m19:19:26.798579 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:19:26.824856 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m19:19:26.826998 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m19:19:26.829006 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */

  
    
    

    create  table
      "legal_demo"."main"."acris_clean__dbt_tmp"
  
    as (
      

SELECT *
FROM read_csv_auto('/opt/airflow/data/first_500k_acris.csv', header=True, delim=',')
    );
  
  
[0m19:19:30.208957 [debug] [Thread-1 (]: SQL status: OK in 3.0 seconds
[0m19:19:30.219998 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m19:19:30.221779 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
alter table "legal_demo"."main"."acris_clean" rename to "acris_clean__dbt_backup"
[0m19:19:30.224914 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m19:19:30.231852 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m19:19:30.233716 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
alter table "legal_demo"."main"."acris_clean__dbt_tmp" rename to "acris_clean"
[0m19:19:30.235802 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m19:19:30.262448 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: COMMIT
[0m19:19:30.265298 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m19:19:30.267617 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: COMMIT
[0m19:19:30.342412 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m19:19:30.352379 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m19:19:30.354564 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
drop table if exists "legal_demo"."main"."acris_clean__dbt_backup" cascade
[0m19:19:30.363574 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m19:19:30.367773 [debug] [Thread-1 (]: Timing info for model.legal_demo.acris_cases (execute): 19:19:26.737618 => 19:19:30.367242
[0m19:19:30.369607 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: Close
[0m19:19:30.441145 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30c1fcc8-d035-4f8a-bdd2-90d5f009ab60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c6526a2c4d0>]}
[0m19:19:30.443780 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main.acris_clean ............................. [[32mOK[0m in 3.73s]
[0m19:19:30.445786 [debug] [Thread-1 (]: Finished running node model.legal_demo.acris_cases
[0m19:19:30.450769 [debug] [MainThread]: Using duckdb connection "master"
[0m19:19:30.452400 [debug] [MainThread]: On master: BEGIN
[0m19:19:30.453859 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:19:30.477014 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m19:19:30.478897 [debug] [MainThread]: On master: COMMIT
[0m19:19:30.480528 [debug] [MainThread]: Using duckdb connection "master"
[0m19:19:30.482583 [debug] [MainThread]: On master: COMMIT
[0m19:19:30.484883 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m19:19:30.486423 [debug] [MainThread]: On master: Close
[0m19:19:30.491602 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:19:30.493264 [debug] [MainThread]: Connection 'list_legal_demo_main' was properly closed.
[0m19:19:30.494814 [debug] [MainThread]: Connection 'model.legal_demo.acris_cases' was properly closed.
[0m19:19:30.496434 [info ] [MainThread]: 
[0m19:19:30.498940 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.16 seconds (4.16s).
[0m19:19:30.501680 [debug] [MainThread]: Command end result
[0m19:19:30.534783 [info ] [MainThread]: 
[0m19:19:30.536623 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:19:30.538259 [info ] [MainThread]: 
[0m19:19:30.539866 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:19:30.542172 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.0971746, "process_user_time": 8.736488, "process_kernel_time": 1.866206, "process_mem_max_rss": "299480", "process_out_blocks": "8384", "process_in_blocks": "0"}
[0m19:19:30.543991 [debug] [MainThread]: Command `dbt run` succeeded at 19:19:30.543799 after 5.10 seconds
[0m19:19:30.545885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c652fdfec90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c6534c5d7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c6534cfa810>]}
[0m19:19:30.547469 [debug] [MainThread]: Flushing usage events
[0m19:20:42.396542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c183a989cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c183a9aa010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c183a55bf10>]}


============================== 19:20:42.406330 | c01ff57d-983b-43c5-a77b-260f53bf0882 ==============================
[0m19:20:42.406330 [info ] [MainThread]: Running with dbt=1.7.4
[0m19:20:42.408074 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:20:42.842861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c01ff57d-983b-43c5-a77b-260f53bf0882', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c183a28de10>]}
[0m19:20:42.975907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c01ff57d-983b-43c5-a77b-260f53bf0882', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c183a843550>]}
[0m19:20:42.979117 [info ] [MainThread]: Registered adapter: duckdb=1.7.4
[0m19:20:43.001407 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m19:20:43.087690 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:20:43.091752 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:20:43.102046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c01ff57d-983b-43c5-a77b-260f53bf0882', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c1831157290>]}
[0m19:20:43.156611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c01ff57d-983b-43c5-a77b-260f53bf0882', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c18310e3710>]}
[0m19:20:43.158681 [info ] [MainThread]: Found 1 model, 0 sources, 0 exposures, 0 metrics, 394 macros, 0 groups, 0 semantic models
[0m19:20:43.160440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c01ff57d-983b-43c5-a77b-260f53bf0882', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c1831093650>]}
[0m19:20:43.164295 [info ] [MainThread]: 
[0m19:20:43.171968 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m19:20:43.175586 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_legal_demo'
[0m19:20:43.194814 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo"
[0m19:20:43.196786 [debug] [ThreadPool]: On list_legal_demo: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"legal_demo"'
    
  
  
[0m19:20:43.198528 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:20:43.240448 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m19:20:43.244977 [debug] [ThreadPool]: On list_legal_demo: Close
[0m19:20:43.255199 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_legal_demo, now create_legal_demo_main)
[0m19:20:43.303349 [debug] [ThreadPool]: Creating schema "database: "legal_demo"
schema: "main"
"
[0m19:20:43.313269 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m19:20:43.315447 [debug] [ThreadPool]: On create_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "create_legal_demo_main"} */

    
        select type from duckdb_databases()
        where database_name='legal_demo'
        and type='sqlite'
    
  
[0m19:20:43.317097 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:20:43.345550 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m19:20:43.348554 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m19:20:43.350262 [debug] [ThreadPool]: On create_legal_demo_main: BEGIN
[0m19:20:43.352225 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m19:20:43.353801 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m19:20:43.355167 [debug] [ThreadPool]: On create_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "create_legal_demo_main"} */

    
    
        create schema if not exists "legal_demo"."main"
    
[0m19:20:43.357344 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m19:20:43.360413 [debug] [ThreadPool]: On create_legal_demo_main: COMMIT
[0m19:20:43.362267 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m19:20:43.363675 [debug] [ThreadPool]: On create_legal_demo_main: COMMIT
[0m19:20:43.366905 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m19:20:43.368488 [debug] [ThreadPool]: On create_legal_demo_main: Close
[0m19:20:43.378351 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_legal_demo_main, now list_legal_demo_main)
[0m19:20:43.386963 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo_main"
[0m19:20:43.389480 [debug] [ThreadPool]: On list_legal_demo_main: BEGIN
[0m19:20:43.391254 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:20:43.415769 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m19:20:43.417625 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo_main"
[0m19:20:43.418994 [debug] [ThreadPool]: On list_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo_main"} */
select
      'legal_demo' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'legal_demo'
  
[0m19:20:43.448783 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m19:20:43.456982 [debug] [ThreadPool]: On list_legal_demo_main: ROLLBACK
[0m19:20:43.460385 [debug] [ThreadPool]: Failed to rollback 'list_legal_demo_main'
[0m19:20:43.462289 [debug] [ThreadPool]: On list_legal_demo_main: Close
[0m19:20:43.468600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c01ff57d-983b-43c5-a77b-260f53bf0882', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c183a2948d0>]}
[0m19:20:43.470474 [debug] [MainThread]: Using duckdb connection "master"
[0m19:20:43.471810 [debug] [MainThread]: On master: BEGIN
[0m19:20:43.472941 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:20:43.496061 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m19:20:43.497941 [debug] [MainThread]: On master: COMMIT
[0m19:20:43.499650 [debug] [MainThread]: Using duckdb connection "master"
[0m19:20:43.501091 [debug] [MainThread]: On master: COMMIT
[0m19:20:43.503183 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m19:20:43.504637 [debug] [MainThread]: On master: Close
[0m19:20:43.509958 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:20:43.511689 [info ] [MainThread]: 
[0m19:20:43.524820 [debug] [Thread-1 (]: Began running node model.legal_demo.acris_cases
[0m19:20:43.526996 [info ] [Thread-1 (]: 1 of 1 START sql table model main.acris_clean .................................. [RUN]
[0m19:20:43.529601 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.legal_demo.acris_cases'
[0m19:20:43.531110 [debug] [Thread-1 (]: Began compiling node model.legal_demo.acris_cases
[0m19:20:43.542800 [debug] [Thread-1 (]: Writing injected SQL for node "model.legal_demo.acris_cases"
[0m19:20:43.555257 [debug] [Thread-1 (]: Timing info for model.legal_demo.acris_cases (compile): 19:20:43.532274 => 19:20:43.554731
[0m19:20:43.556758 [debug] [Thread-1 (]: Began executing node model.legal_demo.acris_cases
[0m19:20:43.599259 [debug] [Thread-1 (]: Writing runtime sql for node "model.legal_demo.acris_cases"
[0m19:20:43.612649 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m19:20:43.614165 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: BEGIN
[0m19:20:43.615694 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:20:43.644282 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m19:20:43.646434 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m19:20:43.647916 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */

  
    
    

    create  table
      "legal_demo"."main"."acris_clean__dbt_tmp"
  
    as (
      

SELECT *
FROM read_csv_auto('/opt/airflow/data/first_500k_acris.csv', header=True, delim=',')
    );
  
  
[0m19:20:46.603322 [debug] [Thread-1 (]: SQL status: OK in 3.0 seconds
[0m19:20:46.620083 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m19:20:46.622811 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
alter table "legal_demo"."main"."acris_clean" rename to "acris_clean__dbt_backup"
[0m19:20:46.626562 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m19:20:46.632474 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m19:20:46.635111 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
alter table "legal_demo"."main"."acris_clean__dbt_tmp" rename to "acris_clean"
[0m19:20:46.637546 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m19:20:46.663893 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: COMMIT
[0m19:20:46.666994 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m19:20:46.668895 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: COMMIT
[0m19:20:46.746603 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m19:20:46.757066 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m19:20:46.759282 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
drop table if exists "legal_demo"."main"."acris_clean__dbt_backup" cascade
[0m19:20:46.767767 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m19:20:46.771562 [debug] [Thread-1 (]: Timing info for model.legal_demo.acris_cases (execute): 19:20:43.558242 => 19:20:46.771197
[0m19:20:46.773480 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: Close
[0m19:20:46.852183 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c01ff57d-983b-43c5-a77b-260f53bf0882', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c183a28d310>]}
[0m19:20:46.855936 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main.acris_clean ............................. [[32mOK[0m in 3.32s]
[0m19:20:46.858862 [debug] [Thread-1 (]: Finished running node model.legal_demo.acris_cases
[0m19:20:46.866309 [debug] [MainThread]: Using duckdb connection "master"
[0m19:20:46.868601 [debug] [MainThread]: On master: BEGIN
[0m19:20:46.870199 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:20:46.914863 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m19:20:46.917164 [debug] [MainThread]: On master: COMMIT
[0m19:20:46.918943 [debug] [MainThread]: Using duckdb connection "master"
[0m19:20:46.920485 [debug] [MainThread]: On master: COMMIT
[0m19:20:46.922667 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m19:20:46.924650 [debug] [MainThread]: On master: Close
[0m19:20:46.930894 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:20:46.933033 [debug] [MainThread]: Connection 'list_legal_demo_main' was properly closed.
[0m19:20:46.934632 [debug] [MainThread]: Connection 'model.legal_demo.acris_cases' was properly closed.
[0m19:20:46.936544 [info ] [MainThread]: 
[0m19:20:46.938126 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.77 seconds (3.77s).
[0m19:20:46.940332 [debug] [MainThread]: Command end result
[0m19:20:46.987264 [info ] [MainThread]: 
[0m19:20:46.989494 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:20:46.991880 [info ] [MainThread]: 
[0m19:20:46.993854 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:20:46.997439 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.6748686, "process_user_time": 8.293629, "process_kernel_time": 1.366291, "process_mem_max_rss": "295168", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:20:47.000231 [debug] [MainThread]: Command `dbt run` succeeded at 19:20:47.000016 after 4.68 seconds
[0m19:20:47.002422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c183be53b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c183a232f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c183a99df90>]}
[0m19:20:47.004771 [debug] [MainThread]: Flushing usage events
[0m19:21:46.505152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d61dc47c250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d61dc4a50d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d61dc1894d0>]}


============================== 19:21:46.515494 | 17f2e9cd-db69-496f-8ab5-c8e546468c6c ==============================
[0m19:21:46.515494 [info ] [MainThread]: Running with dbt=1.7.4
[0m19:21:46.517464 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:21:46.910464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '17f2e9cd-db69-496f-8ab5-c8e546468c6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d61dc02f690>]}
[0m19:21:47.017056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '17f2e9cd-db69-496f-8ab5-c8e546468c6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d61d2cfc750>]}
[0m19:21:47.020172 [info ] [MainThread]: Registered adapter: duckdb=1.7.4
[0m19:21:47.041371 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m19:21:47.125969 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:21:47.128128 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:21:47.135880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '17f2e9cd-db69-496f-8ab5-c8e546468c6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d61d2b7d050>]}
[0m19:21:47.185144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '17f2e9cd-db69-496f-8ab5-c8e546468c6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d61d2b54c10>]}
[0m19:21:47.187532 [info ] [MainThread]: Found 1 model, 0 sources, 0 exposures, 0 metrics, 394 macros, 0 groups, 0 semantic models
[0m19:21:47.190088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '17f2e9cd-db69-496f-8ab5-c8e546468c6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d61dc1b9850>]}
[0m19:21:47.193982 [info ] [MainThread]: 
[0m19:21:47.196499 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m19:21:47.199958 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_legal_demo'
[0m19:21:47.219607 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo"
[0m19:21:47.221692 [debug] [ThreadPool]: On list_legal_demo: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"legal_demo"'
    
  
  
[0m19:21:47.223771 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:21:47.261270 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m19:21:47.265438 [debug] [ThreadPool]: On list_legal_demo: Close
[0m19:21:47.276237 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_legal_demo, now create_legal_demo_main)
[0m19:21:47.278598 [debug] [ThreadPool]: Creating schema "database: "legal_demo"
schema: "main"
"
[0m19:21:47.290281 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m19:21:47.292132 [debug] [ThreadPool]: On create_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "create_legal_demo_main"} */

    
        select type from duckdb_databases()
        where database_name='legal_demo'
        and type='sqlite'
    
  
[0m19:21:47.293574 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:21:47.324100 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m19:21:47.370294 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m19:21:47.372788 [debug] [ThreadPool]: On create_legal_demo_main: BEGIN
[0m19:21:47.376005 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m19:21:47.378071 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m19:21:47.379669 [debug] [ThreadPool]: On create_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "create_legal_demo_main"} */

    
    
        create schema if not exists "legal_demo"."main"
    
[0m19:21:47.382033 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m19:21:47.385037 [debug] [ThreadPool]: On create_legal_demo_main: COMMIT
[0m19:21:47.386721 [debug] [ThreadPool]: Using duckdb connection "create_legal_demo_main"
[0m19:21:47.388287 [debug] [ThreadPool]: On create_legal_demo_main: COMMIT
[0m19:21:47.391878 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m19:21:47.393490 [debug] [ThreadPool]: On create_legal_demo_main: Close
[0m19:21:47.405357 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_legal_demo_main, now list_legal_demo_main)
[0m19:21:47.418246 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo_main"
[0m19:21:47.421073 [debug] [ThreadPool]: On list_legal_demo_main: BEGIN
[0m19:21:47.423282 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:21:47.446939 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m19:21:47.449138 [debug] [ThreadPool]: Using duckdb connection "list_legal_demo_main"
[0m19:21:47.450742 [debug] [ThreadPool]: On list_legal_demo_main: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "connection_name": "list_legal_demo_main"} */
select
      'legal_demo' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'legal_demo'
  
[0m19:21:47.479727 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m19:21:47.489806 [debug] [ThreadPool]: On list_legal_demo_main: ROLLBACK
[0m19:21:47.492882 [debug] [ThreadPool]: Failed to rollback 'list_legal_demo_main'
[0m19:21:47.494909 [debug] [ThreadPool]: On list_legal_demo_main: Close
[0m19:21:47.502497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '17f2e9cd-db69-496f-8ab5-c8e546468c6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d61dbdc6d50>]}
[0m19:21:47.504840 [debug] [MainThread]: Using duckdb connection "master"
[0m19:21:47.506549 [debug] [MainThread]: On master: BEGIN
[0m19:21:47.508125 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:21:47.533308 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m19:21:47.535623 [debug] [MainThread]: On master: COMMIT
[0m19:21:47.537275 [debug] [MainThread]: Using duckdb connection "master"
[0m19:21:47.538907 [debug] [MainThread]: On master: COMMIT
[0m19:21:47.541788 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m19:21:47.543710 [debug] [MainThread]: On master: Close
[0m19:21:47.549461 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:21:47.551747 [info ] [MainThread]: 
[0m19:21:47.574953 [debug] [Thread-1 (]: Began running node model.legal_demo.acris_cases
[0m19:21:47.577487 [info ] [Thread-1 (]: 1 of 1 START sql table model main.acris_clean .................................. [RUN]
[0m19:21:47.579924 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.legal_demo.acris_cases'
[0m19:21:47.581440 [debug] [Thread-1 (]: Began compiling node model.legal_demo.acris_cases
[0m19:21:47.593810 [debug] [Thread-1 (]: Writing injected SQL for node "model.legal_demo.acris_cases"
[0m19:21:47.608519 [debug] [Thread-1 (]: Timing info for model.legal_demo.acris_cases (compile): 19:21:47.582883 => 19:21:47.607907
[0m19:21:47.610252 [debug] [Thread-1 (]: Began executing node model.legal_demo.acris_cases
[0m19:21:47.657907 [debug] [Thread-1 (]: Writing runtime sql for node "model.legal_demo.acris_cases"
[0m19:21:47.667856 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m19:21:47.669409 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: BEGIN
[0m19:21:47.670907 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:21:47.697294 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m19:21:47.699275 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m19:21:47.701016 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */

  
    
    

    create  table
      "legal_demo"."main"."acris_clean__dbt_tmp"
  
    as (
      

SELECT *
FROM read_csv_auto('/opt/airflow/data/first_500k_acris.csv', header=True, delim=',')
    );
  
  
[0m19:21:50.237884 [debug] [Thread-1 (]: SQL status: OK in 3.0 seconds
[0m19:21:50.257986 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m19:21:50.260090 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
alter table "legal_demo"."main"."acris_clean" rename to "acris_clean__dbt_backup"
[0m19:21:50.262869 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m19:21:50.268257 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m19:21:50.270022 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
alter table "legal_demo"."main"."acris_clean__dbt_tmp" rename to "acris_clean"
[0m19:21:50.272619 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m19:21:50.299950 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: COMMIT
[0m19:21:50.302364 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m19:21:50.304083 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: COMMIT
[0m19:21:50.378488 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m19:21:50.388711 [debug] [Thread-1 (]: Using duckdb connection "model.legal_demo.acris_cases"
[0m19:21:50.390989 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "legal_demo", "target_name": "dev", "node_id": "model.legal_demo.acris_cases"} */
drop table if exists "legal_demo"."main"."acris_clean__dbt_backup" cascade
[0m19:21:50.398795 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m19:21:50.402842 [debug] [Thread-1 (]: Timing info for model.legal_demo.acris_cases (execute): 19:21:47.611602 => 19:21:50.402509
[0m19:21:50.404882 [debug] [Thread-1 (]: On model.legal_demo.acris_cases: Close
[0m19:21:50.478050 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17f2e9cd-db69-496f-8ab5-c8e546468c6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d61d2c7fbd0>]}
[0m19:21:50.480771 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main.acris_clean ............................. [[32mOK[0m in 2.90s]
[0m19:21:50.483124 [debug] [Thread-1 (]: Finished running node model.legal_demo.acris_cases
[0m19:21:50.491958 [debug] [MainThread]: Using duckdb connection "master"
[0m19:21:50.493699 [debug] [MainThread]: On master: BEGIN
[0m19:21:50.495023 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:21:50.526329 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m19:21:50.528279 [debug] [MainThread]: On master: COMMIT
[0m19:21:50.529728 [debug] [MainThread]: Using duckdb connection "master"
[0m19:21:50.531137 [debug] [MainThread]: On master: COMMIT
[0m19:21:50.533430 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m19:21:50.534979 [debug] [MainThread]: On master: Close
[0m19:21:50.541858 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:21:50.543645 [debug] [MainThread]: Connection 'list_legal_demo_main' was properly closed.
[0m19:21:50.545005 [debug] [MainThread]: Connection 'model.legal_demo.acris_cases' was properly closed.
[0m19:21:50.546783 [info ] [MainThread]: 
[0m19:21:50.548681 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.35 seconds (3.35s).
[0m19:21:50.556480 [debug] [MainThread]: Command end result
[0m19:21:50.613473 [info ] [MainThread]: 
[0m19:21:50.615236 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:21:50.616845 [info ] [MainThread]: 
[0m19:21:50.618591 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:21:50.621966 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.1847796, "process_user_time": 7.801579, "process_kernel_time": 1.375573, "process_mem_max_rss": "299092", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:21:50.624660 [debug] [MainThread]: Command `dbt run` succeeded at 19:21:50.624445 after 4.19 seconds
[0m19:21:50.626634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d61dbd76f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d61dc175490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d61e0c37350>]}
[0m19:21:50.628675 [debug] [MainThread]: Flushing usage events
